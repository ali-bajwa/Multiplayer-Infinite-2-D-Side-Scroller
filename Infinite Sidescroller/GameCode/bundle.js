(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
// This file contains shortcuts for the methods of the Box2D library that are used
// too often to type their long names

var B2d = function(){

};

B2d.prototype.init = function(){
	include();

	this.b2Vec2 = Box2D.Common.Math.b2Vec2;
	this.b2BodyDef = Box2D.Dynamics.b2BodyDef;
	this.b2Body = Box2D.Dynamics.b2Body;
	this.b2FixtureDef = Box2D.Dynamics.b2FixtureDef;
	this.b2Fixture = Box2D.Dynamics.b2Fixture;
	this.b2World = Box2D.Dynamics.b2World;
	this.b2MassData = Box2D.Collision.Shapes.b2MassData;
	this.b2PolygonShape = Box2D.Collision.Shapes.b2PolygonShape;
	this.b2CircleShape = Box2D.Collision.Shapes.b2CircleShape;
	this.b2DebugDraw = Box2D.Dynamics.b2DebugDraw; 
	this.b2ContactListener = Box2D.Dynamics.b2ContactListener;

};

module.exports = new B2d;

var Includes = require("./Includes.js"); var include_data = Includes.get_include_data({
	current_module: "B2d", 
	include_options: Includes.choices.OTHER_STUFF
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"./Includes.js":17}],2:[function(require,module,exports){
var Config = function(){
	this.SCREEN_W = 0; // set up when the page is loaded (to 95% of width of containing element) 
	this.SCREEN_H = 600;

	this.MAIN_CANVAS_NAME = "display_canvas";
	this.DEBUG_CANVAS_NAME = "debug_canvas";

	// Frames Per Second. Essentially, frequency of createjs.Ticker 
	// Warning! Frequency of the Box2D physics updates may be different
	// (Currently not implemented)
	this.FPS = 30; 

	// Box2D stuff >>>
	this.B2D = {
		SCALE: 30,
		SPS: 60, 			// Steps Per Second
		VELOCITY_ITR: 8,	// velocity iterations
		POSITION_ITR: 3,	// position iterations
		debug_draw: false
	};

	this.TerrainSlice = {
		grid_rows: 20,
		grid_columns: 20,
		cell_w: 1, // in meters

		// is automatically incremented each time new TerrainSliceModel is instantiated:
		next_slice_id: 0 
	};
	
	// <<<
};

module.exports = new Config;

},{}],3:[function(require,module,exports){

//Controller component(AI script)
var AntController = (function() {

	var init = function() {
		include();
		//AntModel.ant = PhysicsController.get_rectangular_body(1, 0.5, 600 / 30 + (2.5 / 2), 510 / 30 - (1.5 / 2), true);
		AntModel.ant = PhysicsController.get_rectangular({userData: {id: "ant"}}, "ant");
		ant = AntModel.ant;
		PhysicsController.setup_collision_listener({BeginContact: begin_contact, EndContact: end_contact}, {must_be_involved: ant});
	};

	var change_state = function(progress_state) {
		AntModel.AI_state = progress_state;

	}

	// // //Set up Collision handler
	
	
	var begin_contact = function(contact, info)
		{
		//handle collisions here
		
		var mean_hero;
		if(info.A.body_id == "hero")
		{
			mean_hero = info.A;
			if(mean_hero.fixture != "bottom sensor" && AntModel.can_attack)
			{
				ant.me_hurt_hero = true;
				console.log(contact);
				console.log(info);
			}	
			else
			{

				AntModel.hero_hurt_me = true;
				console.log(contact);
				console.log(info);
			}
		}
		else if(info.B.body_id == "hero")
		{
			mean_hero = info.B;
			if(mean_hero.fixture != "bottom sensor" && AntModel.can_attack)
			{
				ant.me_hurt_hero = true;
				console.log(contact);
				console.log(info);
			}	
			else
			{

				AntModel.hero_hurt_me = true;
				console.log(contact);
				console.log(info);
			}
		}
	};

	var end_contact = function() {

			AntModel.me_hurt_hero = false;

	};
	
	
	//add the new listener to the main listener in PhysicsController


	//gameController calls update for each instance
	var get_ant = function() {
		return AntModel.ant;
	};

	var update = function() {
		//write your AI script here
		//Do your maintenance here
		//example maintenance: check cooldown

		//if enemy is dead, die
		if (AntModel.hp == 1) {
			
			if (AntModel.hero_hurt_me)
			{
				AntModel.hp--;
				AntModel.hero_hurt_me = false;
			}
		} 
		else if (AntModel.hp <= 0 && AntModel.death_tick == 30) {
			//AntModel.ant.DestroyFixture();
			AntModel.death_tick++;
		}
		else if (AntModel.hp <= 0 && AntModel.death_tick > 30){}
		else if (AntModel.hp <= 0) {
			
			change_state("death");
			GraphicsController.change_ant("death");
			console.log("Death Triggered");
			AntModel.death_tick++;
		}
		//else move & attack
	
		else {

			if (AntModel.AI_state == "walk") {
				var Antbody = AntModel.ant;
				var velocity = Antbody.GetLinearVelocity();
				velocity.x = -AntModel.speed;
				Antbody.SetLinearVelocity(velocity); // body.SetLinearVelocity(new b2Vec2(5, 0)); would work too
				Antbody.SetAwake(true);
			}
			if (AntModel.can_attack && AntModel.me_hurt_hero && model.AI_state == "walk") 
			{

				
			}
			if (AntModel.hero_hurt_me)
			{
				AntModel.hp--;
				AntModel.hero_hurt_me = false;
				change_state("upside_down");
				GraphicsController.change_ant("upside_down");
			}
		}
	}


	return {
		init: init,
		update: update,
		get_ant: get_ant
	};

})();

module.exports = AntController;

var Includes = require("../Includes.js");
var include_data = Includes.get_include_data({
	current_module: "AntController",
	include_options: Includes.choices.DEFAULT
});
eval(include_data.name_statements);
var include = function(){eval(include_data.module_statements);}

},{"../Includes.js":17}],4:[function(require,module,exports){

var AssetController = (function(){
	/*
	   AssetController is in charge of setting up all bitmaps/animations/other resources
	   for everyone else.
   */

	// use AssetModel.loader.getResult("id_of_the_asset");

	var init = function(asset_path){
		include();	

		/* TODO make model with the easily managed tables of resources which will be
		   added to the loader automatically
		*/

		//loader = new createjs.LoadQueue(false); // loading resourses using preload.js
		//loader.addEventListener("complete", handleComplete);
		var manifest = AssetModel.manifest;	
		AssetModel.loader.loadManifest(manifest, true, asset_path);
		
	};

	var post_init = function(){
		/* this function will be done differently at some point
		 * it'll have something to do with refactoring InitController
		 */

		//AssetModel.animations["ant"] = new createjs.SpriteSheet({
			//"framerate": 0.2,
			//"images": [get_asset("Ant1"), get_asset("Ant2"), get_asset("Ant3")],
			//"frames": { "regX": 3, "regY": 6, "height": 25, "width": 50, "count": 6},
			//"animations": {
				//"walk": [0, 1, "walk"],
				//"upside_down": [2, 3, "upside_down"],
				//"death": [4, 5, "death"]
			//}
		//})

	};
	

	var get_asset = function(id){

		var result = AssetModel.loader.getResult(id);

		if(!result){
			throw "Error: asset with id " + id + " could not be loaded." +
				" Check that id is valid and that assets were properly loaded";
		}
		
		return result;
	};
		


	
	return {
		init: init,
		get_asset: get_asset,
	};

})();

module.exports = AssetController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "AssetController", 
	include_options: Includes.choices.DEFAULT
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":17}],5:[function(require,module,exports){

var EnemyController = (function(){
	var init = function(){
		
		include();
	};
	
	var move = function(offset_x, offset_y){
		// needs to change to not use gamemodel directly
		//GameModel.chomper.x += offset_x;
		//GameModel.chomper.y += offset_y;
	};

	return {
		move: move,
		init: init,
	};
})();

module.exports = EnemyController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "EnemyController", 
	include_options: Includes.choices.DEFAULT
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":17}],6:[function(require,module,exports){


var GameController = (function(){

	var init = function(){
		include();
	};
		

	var update_all = function(event){
		/*
		 * main function pretty much
		 * everyghing else is called from here every tick
		 */
		

		var delta = event.delta;

		// !!!! world simulation step goes somewhere right here
		// as per current design, will take delta as an argument
		
		//TerrainController.generate_terrain(); 
		PlayerController.update();
		
		WorldController.update(delta);

		TerrainController.update();

		// Should be called after all movement of objects is done:
		AntController.update();
		GraphicsController.update();
	};


	return {
		init: init,
		update_all: update_all,
	};

})();

module.exports = GameController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "GameController", 
	include_options: Includes.choices.DEFAULT
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":17}],7:[function(require,module,exports){

var GraphicsController = (function(){
	/* all the graphics stuff. and what did you expect?
	*/

	var get_asset; 
	var hero, ant; // for quicker access

	var init = function(){
		/* is ran from the InitController once when the game is loaded */

		include(); // satisfy requirements

		get_asset = AssetController.get_asset; // for quicker access

		init_animations();


		GraphicsModel.stage = new createjs.Stage(Config.MAIN_CANVAS_NAME);
		GraphicsModel.stage.canvas.width = Config.SCREEN_W;
		GraphicsModel.stage.canvas.height = Config.SCREEN_H;

		GraphicsModel.hero = request_bitmap("greek_warrior");
		GraphicsModel.ant = request_animated("ant", "walk");

		hero = GraphicsModel.hero;

		ant = GraphicsModel.ant;
		ant.gotoAndPlay("walk");

		set_reg_position(hero, -20, +10);
		
		set_reg_position(ant, 0, 0);
		
		reg_for_render(GraphicsModel.hero, PlayerController.get_hero());
		reg_for_render(GraphicsModel.ant, AntController.get_ant());

		GraphicsModel.camera.following = hero;
        //PIZZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
		GraphicsModel.score = new createjs.Text();
		reg_for_render(GraphicsModel.score);
		GraphicsModel.health = new createjs.Text();
		reg_for_render(GraphicsModel.health);
		hud_temp();

	};
    
	var update = function(delta){
		/* is ran each tick from the GameController.update_all */

	    update_camera(); // needs to be updated first

		check_for_new_terrain();

		synchronize_to_physical_bodies();

	    //PIZZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
		hud_temp_update();

		ant_special_render_temp(); // TEMPORARY!!!!!!!!!!!

		GraphicsModel.stage.update();
	};

    //DELETE ME PIZZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
	var hud_temp = function () {
	    GraphicsModel.health.text = "100";
	    GraphicsModel.health.x = 10;
	    GraphicsModel.health.y = 30;
	    GraphicsModel.health.font = "20px Arial";
	    GraphicsModel.health.color = "#ff0000";
	    GraphicsModel.score.text = "10";
	    GraphicsModel.score.x = 10;
	    GraphicsModel.score.y = 10;
	    GraphicsModel.score.font = "20px Arial";
	}

    //DELETE ME PIZZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
	var hud_temp_update = function () {
	    temp_score = parseInt(GraphicsModel.score.text);
	    temp_score += 1;
	    GraphicsModel.score.text = temp_score.toString();
	}

	var update_camera = function(){
		var camera = GraphicsModel.camera;
		var center = camera.center;

		center.x = Config.SCREEN_W/2 - camera.offset_from_followed.x;
		center.y = Config.SCREEN_H/2 - camera.offset_from_followed.y;

		if(camera.following != null){
			camera.offset.x = center.x - camera.following.body.GetWorldCenter().x * Config.B2D.SCALE;
			camera.offset.y =  center.y - camera.following.body.GetWorldCenter().y * Config.B2D.SCALE;
		}

		adjust_debug_draw(); // goes last
	};

	//**********TEMPORARY*****************
	var change_ant = function(state){
		if(state == "death")
		{	
			console.log("ANT GOES HERE")
			ant.gotoAndStop("death");
		}
		else if(state == "upside_down")
		{
			console.log("ANT GOES HERE")
			ant.gotoAndPlay("upside_down");
		}
		


	}	


	//*************************************
	var adjust_debug_draw = function(){
		var camera = GraphicsModel.camera;
		TestController.set_debug_offset(camera.offset.x, camera.offset.y);
	};

	var init_animations = function(){
		
		GraphicsModel.spritesheets["ant"] = new createjs.SpriteSheet({
			"framerate": 1,
			"images": [get_asset("Ant1"), get_asset("Ant2"), get_asset("Ant3")],
			"frames": { "regX": 3, "regY": 6, "height": 25, "width": 50, "count": 6},
			"animations": {
				"walk": [0, 1, "walk"],
				"upside_down": [2, 3, "upside_down"],
				"death": [4, 5, "death"]
			}
		})

	};
	
	var request_bitmap = function(id){
		// if id is invalid, throw meaningful exception?
		var bitmap = new createjs.Bitmap(get_asset(id));
		// more complicated setting for registration position may be needed, depending on the body attached
		if (!(bitmap.image)){
			throw "Error: image wasn't correctly loaded for this bitmap";
		}
		
		bitmap.regX = bitmap.image.width/2;
		bitmap.regY = bitmap.image.height/2;

		return bitmap;
		// TODO research DisplayObject's caching. and maybe incorporate
	};

	var request_animated = function(id, start_frame){
		// this implementation is temporary
		// until I setup efficient facility for defining spritesheets
		// within GraphicsController

		if(!id || !start_frame){
			if(!id){
				throw "wrong id";
			}else{
				throw "wrong start_frame";
			}
		};

		var sprite = new createjs.Sprite(GraphicsModel.spritesheets[id], start_frame);

		return sprite;
	};

	var ant_special_render_temp = function(){
		/* how to handle special render? TEMPORARY */

		var hero_pos = hero.body.GetWorldCenter();
		var ant_pos = ant.body.GetWorldCenter();

		//if(ant.body.userdata.state.ant == "death"){
		//	ant.gotoAndStop("death");
		//}

		//ant.gotoAndPlay("upside_down");

	};
	
	
	var synchronize_to_physical_bodies = function(){

		var tiles = GraphicsModel.all_physical;

		for(var i = 0; i < tiles.length; i++){
			var tile = tiles[i];
			var body = tile.body;

			var tile_pos = trans_xy(body.GetWorldCenter());

			tile.x = tile_pos.x;
			tile.y = tile_pos.y;
		}

	};
	

	var check_for_new_terrain = function(){
		/* If new terrain has been generated, render it
		 */

		var new_slices = TerrainController.GetNewTerrainSlices();
		while(new_slices.length > 0){

			var slice = new_slices.pop();

			for(var i = 0; i < slice.grid_rows; i++){
				/* graphics pass. should be probably moved to the graphics controller
				 * didn't decide on it yet
				 */


				var lvl = slice.grid_rows - i; // level from the bottom

				for(var j = 0; j < slice.grid_columns; j++){
					var id = slice.grid[i][j].id;
					if(id != 0){
						// TODO: should make proper terrain collection thing to pull from 
						var tile_texture = ["grass", "middle_terrain", "bottom_terrain"][id-1];
						var tile = request_bitmap(tile_texture);
						var body = slice.grid[i][j].body;
						var body_position = body.GetWorldCenter();
						var trans_pos = trans_xy(body_position);
						tile.x = trans_pos.x;
						tile.y = trans_pos.y;
						reg_for_render(tile, body);
					} // fi


				} // end for

			}//end for

		} // end while

	}; // end check_for_new_terrain

	var trans_xy = function(position_vector_unscaled){
		// takes position vector with values in meters, translates
		// it to pixel position taking the camera position into account
		var camera = GraphicsModel.camera;

		var x = (position_vector_unscaled.x * Config.B2D.SCALE) + camera.offset.x;
		var y = (position_vector_unscaled.y * Config.B2D.SCALE) + camera.offset.y;

		return {x: x, y: y};	
	};

	var set_reg_position = function(easeljs_obj, offset_x, offset_y){
		// sets registration position of the easeljs object
		// regisration position is the relative point of the object
		// that you move when you set object's x and y coordinats
		// i.e. if reg. position of the player is head, and you set their
		// position to (0, 0), their head will be at (0, 0)
		// currently the registration position is set to the middle of the body
		// to match what box2d does
		// last two arguments are optional and set PIXEL offset from the normal registration
		// position
		
		// this if statement should be temporary
		if(easeljs_obj.image){
			var w = easeljs_obj.image.width;	
			var h = easeljs_obj.image.height;	
		}else{
			var w = easeljs_obj.spriteSheet._frameWidth;
			var h = easeljs_obj.spriteSheet._frameHeight;
		};

		var offset_x = offset_x || 0;
		var offset_y = offset_y || 0;

		easeljs_obj.regX = w/2 + offset_x;
		easeljs_obj.regY = h/2 + offset_y;

	};

	var reg_for_render = function(easeljs_obj, physical_body){
		// registeres object for rendering within graphics controller
		// if (OPTIONAL!) physical_body is given, graphics controller will automatically
		// set the easeljs_obj's position to position of that body, each tick.
			
		if(physical_body){

			easeljs_obj.body = physical_body;
			GraphicsModel.all_physical.push(easeljs_obj);
		}


		AddToStage(easeljs_obj);
	};

	var AddToStage = function(element){
		// can be updated later to manage z-index or whatever
		GraphicsModel.stage.addChild(element);
	};

	var get_stage = function(){
		return GraphicsModel.stage;
	};

	return {
		// declare public
		init: init, 
		update: update,
		get_stage: get_stage,
		change_ant: change_ant,
	};
})();

module.exports = GraphicsController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "GraphicsController", 
	include_options: Includes.choices.DEFAULT
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":17}],8:[function(require,module,exports){
var InitController = (function(){
	// why do you want to put initialization of everything into the InitController?
	// Because if initialization of smth depends on initialization of smth else,
	// it's easier to control here
	//
	// e.g. if you try to do var foo = $('#foo'); somewhere in other module,
	// you can get foo = null; as code of that module can execute before the html document
	// was fully loaded, but >InitController.init< is called after document was loaded, so
	// -1 potential problem. Btw, at this moment in time the the stuff is set to work that way
	// using html (<body onload=...); maybe using JS would be better? Idk;
		

	var init = function(mode){
		include();

		enable_arrowkey_scroll(false);
		setup_screen();
		setup_events();

		init_all_modules(mode); // call .init function of everyone. e.g. PlayerController.init(); etc.

		
		// Notice that asset dependent stuff doesn't (and mustn't) start until
		// all assets are completely loaded. That includes ticker, i.e. no ticks are processed
		// until everything is loaded. If you want something different, e.g. display some sort of loading
		// animation - let me know.
		// Look into the setup_asset_dependent function
			AssetModel.loader = new createjs.LoadQueue(false); // loading resourses using preload.js
			AssetModel.loader.addEventListener("complete", setup_asset_dependant);

		// if more stuff needs to be done for the test mode, 
		// or more types of it needs to be added
		// you can safely make the following a separate function
			var asset_path = (mode == "test") ? "./assets/art/" : "../GameCode/assets/art/";

		AssetController.init(asset_path);

	};

	var init_all_modules = function(mode){
		// TODO: better way to do stuff like that (call certain function
		// of every module in the order. 
		// Also, init and update functions of each module should probably
		// accept some argument. I think to make this argument an object,
		// this way we can add more things to be passed w/o any problem and
		// we won't need to change anything
		
		B2d.init(); // goes first

		//AssetController.init(); // called from the InitController.init// stuff has to change
		GameController.init();
		KeyboardController.init();
		PhysicsController.init();

		TestController.init(mode);

		PlayerController.init();
		TerrainController.init();
		TerrainSliceController.init();
		WorldController.init();

		// WARNING!!! GraphicsController.init is called from the
		// setup_asset_dependent function as it, well, depends on assets being loaded

	};


	var enable_arrowkey_scroll = function(enable_scroll){
		if(enable_scroll == false){                                                          
			document.addEventListener('keydown', function(e){ // .getElementById("display_canvas")
				arrows = [37, 38, 39, 40];                                          
				if(arrows.indexOf(e.keyCode) > -1){                                 
					e.preventDefault();                                             
					return false;                                                   
				}else{                                                              
					return true                                                     
				}                                                                   
			})                                                                      
		}		
	};
	
	var setup_screen = function(){

		// Setting up other stuff:
		// e.g setup canvas size
		
		// TODO: allow resizes?

		Config.SCREEN_W = $('#canvas_container').width(); // is dynamically set to pixel width of the containing element

		// possible resizing technique: 
		// http://www.fabiobiondi.com/blog/2012/08/createjs-and-html5-canvas-resize-fullscreen-and-liquid-layouts/

		
		//$('#debug_canvas').width(String(SCREEN_W) + "px");
		//$('#display_canvas').width(String(SCREEN_W) + "px");

		//$('#debug_canvas').height(String(SCREEN_H) + "px");
		//$('#display_canvas').height(String(SCREEN_H) + "px");
		
	};

	var setup_ticker = function(){

		createjs.Ticker.setFPS(Config.FPS);

		// ticker: on each tick call GameController.update_all();
		createjs.Ticker.addEventListener("tick", GameController.update_all);

	
	};

	var setup_events = function(){


		// keyboard input event: on each keyboard event call appropriate KeyboardController function
		document.onkeydown = KeyboardController.keydown;
		document.onkeyup = KeyboardController.keyup;

			// on interrupt event: stop/pause ticker ?

	};

	var setup_asset_dependant = function(){
		// this may need to move to either load_game or some sort of resizing function
		
		AntController.init();
		GraphicsController.init();


		setup_ticker();

		//TerrainController.generate_terrain(); // Initial terrain generation // deprecated, generation will be called from update each tick
	};


	return {
		init: init,
	};
})();

module.exports = InitController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "InitController", 
	include_options: Includes.choices.ALL
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":17}],9:[function(require,module,exports){
var KeyboardController = (function()
{
	// TODO: does this section belong into the controller? >>>
	var keys = {};

	var TR_TABLES = // translation tables
	{
		code_to_name: {
			37: "left",
			38: "up",
			39: "right",
			40: "down"
		}
	}

	// <<< end TODO

	var init = function(){
		
		include();
	};
	
	var get_active_commands_function = function(table){
		// get all commands associated with keys that are defined in the >table<,
		// and are currently pressed
		//
		// returns: array of commands
		
		var commands = [];
		
		$.each(table, function(key, cmd){
			if(keys[key]){
				commands.push(cmd);
			}
		});

		var get_key = function(key){
			if(commands.indexOf(key) > -1){
				return true;
			}else{
				return false
			};
		};

		return get_key;
	};

	// public:
	
	var keydown = function(event){
		keys[event.keyCode] = true;
	};

	var keyup = function(event){
		delete keys[event.keyCode];
	};


	var movement_commands = function(){
		return get_active_commands_function(TR_TABLES.code_to_name);
	};


	return {
		keydown: keydown,
		keyup: keyup,

		movement_commands: movement_commands,
		init: init,
	};

})();

module.exports = KeyboardController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "KeyboardController", 
	include_options: Includes.choices.DEFAULT
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":17}],10:[function(require,module,exports){
// Notes:
// notice that you can reuse body definitions multiple times, it makes sense to have
// collection of body definitions that are commonly use and maybe allow some sort of 
// inheritance (i.e. you can make some definition on top of the another definition)
// // bodies are allowed to have userData on them that is just reference to some object.
// may be useful in some situations
//
// Question:
// does it make sense to allow users to pass any properties as part of object definition
// and just apply those properties automatically to the userData property of body?

var B2dConfig;

var PhysicsController = (function(){

	var init = function(){
		include();

		B2dConfig = Config.B2D;

		PhysicsModel.scale = B2dConfig.SCALE;
		PhysicsModel.step_amount = 1/(B2dConfig.SPS);

		PhysicsModel.gravity = new B2d.b2Vec2(0,20); // earth gravity
		PhysicsModel.world = new B2d.b2World(PhysicsModel.gravity, true);

	};
	
	var step = function (delta_ms) {
		// !? should I set upper limit on delta to prevent world from
		// fast forwarding if the ticker was paused? or that is not a problem in our case?
		// investigation is needed

		var delta = delta_ms/1000;

		PhysicsModel.timeToCover += delta;

		while (PhysicsModel.timeToCover > PhysicsModel.step_amount) {
			PhysicsModel.timeToCover -= PhysicsModel.step_amount;
			PhysicsModel.world.Step(
				PhysicsModel.step_amount,
				B2dConfig.POSITION_ITR, // velocity iterations
				B2dConfig.VELOCITY_ITR // position iterations
			);
		}
	};  // end step 

	var draw_debug = function(){
		if (B2dConfig.debug_draw) {
			PhysicsModel.world.DrawDebugData();
		}
	};

	var get_parent_chain = function(template, default_def){
		var next = template;
		var ancestors = [];

		while(next != null){
			ancestors.push(next);
			next = next["parent"];
		}

		if(default_def){
			ancestors.push(default_def);
		}

		return ancestors;
		
	};

	var apply_parents = function(template_name, template_collection){
		// TODO: refactor the code so this thing is done only once
		// at the load tim
		// that could probably be done even for other things.
		// idea: store compiled body/fixture etc. together with the
		// template. this way you'll have easy access to the all defined
		// options for debugging;
		
		var default_tmplate = template_collection["default"];

		var chain = get_parent_chain(template_collection[template_name], default_tmplate);

		var final_definition = {};

		for(var i = chain.length - 1; i >= 0 ; i--){
			// may be needed to be made more efficient by moving the other way
			// and not considering options that were already encountered in children
			var current = chain[i];


			for(var prop in current){
				final_definition[prop] = current[prop];
			}
		}

		return final_definition;
	}; // end apply_parents
		
	var target_props = {
		body_def: [
			"active",
			"allowSleep",
			"angle",
			"angularDamping",
			"angularVelocity",
			"awake",
			"bullet",
			"fixedRotation",
			"inertiaScale",
			"linearDamping",
			"linearVelocity",
			"position",
			"type",
			"userData"
		],
		fixture_def: [
			"density",
			//"filter", implement later if needed
			"friction",
			"isSensor",
			"restitution",
			"shape",
			"userData"
		]
	};

	var apply_property_list = function(source, destination, list){
		/**
		 * takes two objects and the list of strings
		 * copies all properties with names found in the list
		 * from source to destination
		 * scips properties which are null/undefined
		 */

		for(var i = 0; i < list.length; i++){
			var prop = list[i];
			if(source[prop] != null){
				destination[prop] = source[prop];
			}
		}

		return destination;
	};

	var PropertyUndefined = function PropertyUndefined(property_name){
		this.name = "PropertyUndefined";
		this.message = "Error: " + property_name + " is not defined";
	};
	PropertyUndefined.prototype = Object.create(Error.prototype);
	PropertyUndefined.prototype.constructor = PropertyUndefined;

	var get_formal_body_def = function(non_formal_def){
		/**
		 * turn non formal definition into the formal one
		 * non-formal definition is an object that contains
		 * properties SOME of which are box2d properties or are 
		 * intended to be transformed into such. E.g. the non-formal
		 * definition may contain properties vx and vy which will be transformed
		 * into the linearVelocity vector in the formal definition
		 */

		var nfdef = non_formal_def;

		var definition = new B2d.b2BodyDef();

		if(nfdef.vx != null && nfdef.vy != null){
			// check for informal parameter specification first
			nfdef.linearVelocity = new B2d.b2Vec2(nfdef.vx, nfdef.vy);
		}else{
			// maybe the linearVelocity was specified directly as vector,
			// and not through informal parameters; checking that, and if not,
			// exception
			if(!(nfdef.linearVelocity)){
				throw new PropertyUndefined("linearVelocity");
			}
		}

		if(nfdef.x != null && nfdef.y != null){
			// same procedure as for the linear velocity
			// checking for informal specification here
			// and if present, turning into the formal
			nfdef.position = new B2d.b2Vec2(nfdef.x, nfdef.y);
		}else{
			// checking if formal was specified directly
			if(!(nfdef.position)){
				// if not, throw custom exception
				throw new PropertyUndefined("position");
			}
		}

		if(nfdef.type){
			nfdef.type = {
				"static": B2d.b2Body.b2_staticBody, 
				"dynamic": B2d.b2Body.b2_dynamicBody,
				"kinematic": B2d.b2Body.b2_kinematicBody
			}[nfdef.type]; // turn string-type into b2d type
		}else{
			throw new PropertyUndefined("type");
		}

		apply_property_list(nfdef, definition, target_props.body_def);

		return definition;

	};

	var get_formal_fixture_def = function(non_formal_def){
		/**
		 * turns non-formal definition into the formal one
		 * see get_fromal_body_def for explanation
		 */

		var nfdef = non_formal_def;
		var shape = nfdef.shape;
		var fixture_def = new B2d.b2FixtureDef();

		apply_property_list(non_formal_def, fixture_def, target_props.fixture_def);

		switch (shape) {
			case "rectangle":

				if(nfdef.width != null && nfdef.height != null){
					fixture_def.shape = new B2d.b2PolygonShape();
					fixture_def.shape.SetAsBox(nfdef.width/2, nfdef.height/2);
				}else{
					throw new PropertyUndefined("width or height");
				}
				break;
			case "polygon":

				if(nfdef.points != null){
					fixture_def.shape = new B2d.b2PolygonShape();
					fixture_def.shape.SetAsArray(nfdef.points, nfdef.points.length);
				}else{
					throw new PropertyUndefined("points");
				}
				break;
			case "circle":

				if(nfdef.radius != null){
					fixture_def.shape = new B2d.b2CircleShape(nfdef.radius);
				}else{
					throw new PropertyUndefined("radius");
				}
				break;
			default:
				throw "Error: shape must be one of the following: " + 
					'"polygon", "rectangle", "circle". You specified: ' +
					String(shape);
		}

		return fixture_def;

	};
	

	var get_body = function(non_formal_def){
		/**
		 * takes non-formal definition
		 * returns body based on this definition
		 *
		 */
		var definition = get_formal_body_def(non_formal_def);

		var body = PhysicsModel.world.CreateBody(definition);

		if(body.userData == null){
			body.userData = {};
		}

		// append passed definition to the user data of the body
		// for debugging purposes, and also to allow easy specification of 
		// custom parameters during definition. If this will cause confusion,
		// I'll remove that
		body.userData.def = non_formal_def;

		return body;
	
	};

	var attach_fixture = function(body, non_formal_def, fixture_description){
		/**
		 * given b2d body, (non-formal) fixture definition and (OPTIONAL) fixture_description
		 * this function attaches fixture to the body
		 */

		var fixture_def = get_formal_fixture_def(non_formal_def);

		if(fixture_def.userData == null){
			fixture_def.userData = {};
		}

		fixture_def.userData.def = non_formal_def;
		fixture_def.userData.description = fixture_description;
		
		//if offset is defined, set the offset of the fixture here
		// offset is of the form {x: number, y: number}
		if(non_formal_def.offset != null){
			fixture_def.position = non_formal_def.offset;
		}
		
		body.CreateFixture(fixture_def);
		
	};

	//non_formal_def class, used to contain informal data
	var non_formal_def = function(){
		var shape,density,isSensor,height,width,offset;
	}
	
	
	var attach_sensors = function(body){
		// get the width and height of the body's main fixture
		// and create 4 sensor fixtures based on those parameters
		// calculate offset of sensors so that they match the main fixture
		var x = body.GetPosition().x;
		var y = body.GetPosition().y;
		var h = body.GetFixtureList().GetAABB().GetExtents().x;
		var w = body.GetFixtureList().GetAABB().GetExtents().y;
		
		//attach top fixture
		var top_sensor = {};
		top_sensor.shape = "rectangle";
		top_sensor.density = 0;
		top_sensor.isSensor = true;
		top_sensor.height = 0.1;
		top_sensor.width = w*2;
		top_sensor.offset = {x:0, y:(-1*h)};
		attach_fixture(body,top_sensor,"top sensor");

		//attach bottom fixture
		var bottom_sensor = {}
		bottom_sensor.shape = "rectangle";
		bottom_sensor.density = 0;
		bottom_sensor.isSensor = true;
		bottom_sensor.height = 0.1;
		bottom_sensor.width = w*2;
		bottom_sensor.offset = {x:0, y:h};
		attach_fixture(body,bottom_sensor,"bottom sensor");
		
		//attach left fixture
		var left_sensor = {};
		left_sensor.shape = "rectangle";
		left_sensor.density = 0;
		left_sensor.isSensor = true;
		left_sensor.height = h*2;
		left_sensor.width = 0.1;
		left_sensor.offset = {x:(-1*w),y:0};
		attach_fixture(body,left_sensor,"left sensor");
		
		//attach right fixture
		var right_sensor = {};
		right_sensor.shape = "rectangle";
		right_sensor.density = 0;
		right_sensor.isSensor = true;
		right_sensor.height = h*2;
		right_sensor.width = 0.1;
		right_sensor.offset = {x:w, y:0};
		attach_fixture(body,right_sensor,"right sensor");
	};
	
	
	

	var get_rectangular = function(def, template_name){
		// get appropriate template collection to draw from
		var template_collection = PhysicsModel.r_templates;
		var compiled_template = apply_parents(template_name, template_collection);

		// apply custom override
		var final_def = compiled_template;
		for(var prop in def){
			final_def[prop] = def[prop];
		}

		final_def.shape = "rectangle";

		// final_def contains all final data, about body we are about to create
		// it takes into account template given and all it's parents
		// and also manually specified parameters. However, this definition is raw,
		// i.e. some data in it may not be in its final form, e.g. linear velocity is specified
		// as two parameters, vx and vy, while it whould be converted into the vector
		// for box2d. so final_def is a final description, but not in final form


		var body = get_body(final_def);
		 
		attach_fixture(body, final_def, "main");
		
		if(final_def.border_sensors){
			attach_sensors(body);
		}

		return body;
	};

	var get_circular = function(def, template){
		var type = "circular";
		// dont' forget about refactoring some stuff into the
		// set_common function
		
		var definition = new B2d.b2BodyDef();
		
	};
		
	var get_polygonal = function(def, template){
		var type = "polygonal";
		
		var definition = new B2d.b2BodyDef();
		
	};

	var set_debug_draw = function(debug_draw){
		PhysicsModel.world.SetDebugDraw(debug_draw);
	};

	var setup_collision_listener = function(functions, optional){
		
		/**
		 * takes two objects, >functions< and >optional<
		 * first object should contain any of the following properties:
		 * BeginContact, PreSolve, PostSolve, EndContact
		 * with there values being functions to be called on each event
		 * the optional object is for some named parameters that might be used later
		 * Notice that this function wraps calls of the given functions, to give more
		 * helpful info about the collision in particular, it will provide info about the
		 * sides on which objects collided, granted that sided sensors are present
		 *
		 * supported properties of >optional<:
		 * 	must_be_involved: b2d_body
		 * 		report only contacts in which this body is involved
		 * 		e.g. if you pass it body of the player, only collisions with the
		 * 		player will cause passed functions to be called
		 */

		var listener = new B2d.b2ContactListener;

		var names = ["BeginContact", "EndContact", "PreSolve", "PostSolve"];
		for(var i = 0; i < 4; i++){
			var name = names[i];
			var custom_function = functions[name];

			if(custom_function){
				// if given function was specified
				
				// wrap it properly and attach to the listener
				listener[name] = (function(custom_function, must_be_involved){
					// self calling function to deal with scope issues
					 
					return function wrapper(contact, second_arg){
						// >second_arg< will be impulse of collision in case of PreSolve,
						// oldManifold in case of PostSolve, and null otherwise
						
						var fixture_A = contact.m_fixtureA;
						var fixture_B = contact.m_fixtureB;
						var body_A = fixture_A.GetBody();
						var body_B = fixture_B.GetBody();
						
						if(!must_be_involved || // if no checking for bodies involved OR
							body_A === must_be_involved || // first body matches OR
							body_B === must_be_involved // second body matches
						){
							// whatever info you want to unpack for the custom function to easily use:
							var info = {}; 

							// TODO:THIS SHOULD BE CHANGED together with
							// how id's are attached to the fixtures
							// not changing now, to avoid merge conflicts with
							// @Sean's work >>>
							info.A = {};
							info.B = {};

							info.A.fixture = fixture_A;
							info.B.fixture = fixture_B;

							info.A.body = body_A;
							info.B.body = body_B;

							info.A.body_id = get_custom_property(body_A, "id");
							info.B.body_id = get_custom_property(body_B, "id");

							info.A.fixture_id = get_custom_property(fixture_A, "description");
							info.B.fixture_id = get_custom_property(fixture_B, "description");
							// <<< end of terribleness

							// call the custom function
							if(second_arg){
								// specifying the implulse/oldManifold if present
								custom_function(contact, second_arg, info);
							}else{
								// or not specifying if it is not
								custom_function(contact, info);
							}
						}
					};
				})(custom_function, optional.must_be_involved);
			}
		}

		PhysicsModel.world.SetContactListener(listener);
	
	};

	var get_custom_property = function(b2d_obj, property_name){
		
		/**
		 * given any box2d object that has GetUserData method
		 * this function will return custom property with given
		 * property_name if this property is set on userData of the object
		 * if not, the function returns null
		 */
		var user_data = b2d_obj.GetUserData();
		if(user_data && user_data[property_name]){
			return user_data[property_name];
		}else{
			return null;
		}
	};
	
	
	
	
	return {
		get_body: get_body,
		get_rectangular: get_rectangular,
		setup_collision_listener: setup_collision_listener,
		step: step,
		init: init,
		set_debug_draw: set_debug_draw,
		draw_debug: draw_debug,
	};
})();


module.exports = PhysicsController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "PhysicsController", 
	include_options: Includes.choices.DEFAULT
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":17}],11:[function(require,module,exports){

var PlayerController = (function(){

	var hero; // for quick access

	var init = function(){
		include();
		PlayerModel.hero = PhysicsController.get_rectangular({userData: {id: "hero"}, border_sensors: true}, "player");
		hero = PlayerModel.hero;

		var end_contact = function(contact, info){
			
			console.log(contact);
			console.log(info);
		};

		PhysicsController.setup_collision_listener({EndContact: end_contact}, {must_be_involved: hero});
		
	};

	var update = function (){

		var cmds = KeyboardController.movement_commands();

		var MOVEMENT_EDGE = 500; // where terrain start scrolling


		if(cmds("right")){
		    // temporary

		    move_right(hero);
		}
		if(cmds("left")){
			// temporary
		    
		    move_left(hero);
		}

		if(cmds("up")){
			jump();
		}

	};

	var get_hero = function(){
		return PlayerModel.hero;
	};

	var move_right = function(){
		var body = GameModel.hero.b2b;
		var velocity = body.GetLinearVelocity();
		velocity.x = 5;
		body.SetLinearVelocity(velocity); // body.SetLinearVelocity(new b2Vec2(5, 0)); would work too
		body.SetAwake(true);
		//GameModel.hero.x += 10; // old
		//GameModel.hero.x = (body.GetPosition().x + 1.5/2) * 30 ; 
	};

	var jumps = 0;

	var jump = function(){
	    var body = PlayerModel.hero;
	    if (body.GetLinearVelocity().y == 0) {
	        jumps = 0;
	    }
		if (jumps == 0){
		    body.ApplyImpulse(new B2d.b2Vec2(0, -100), body.GetWorldCenter());
		    jumps += 1;
		}
		else if (jumps == 1 && body.GetLinearVelocity().y > -1) {
		    body.ApplyImpulse(new B2d.b2Vec2(0, -100), body.GetWorldCenter());
		    jumps += 1;
		}

		//GameModel.hero.y = body.GetPosition().y * 30;
	
	};

	var set_coordinates = function(position_vector){
		// TODO: remove;
		// temporary/testing
		GameModel.hero.x = (position_vector.x - 1.5/2) * 30 ;
		GameModel.hero.y = (position_vector.y + 2.5/2) * 30 ;

	};

	var b2b_get_coordinates = function(){
		return GameModel.hero.b2b.GetWorldCenter();
	};

	var move_left = function(){
		var velocity = hero.GetLinearVelocity();
		velocity.x = -5;
		hero.SetLinearVelocity(velocity); // hero.SetLinearVelocity(new b2Vec2(5, 0)); would work too
		hero.SetAwake(true);
	};

	var move_right = function(){
		var velocity = hero.GetLinearVelocity();
		velocity.x = +5;
		hero.SetLinearVelocity(velocity); // hero.SetLinearVelocity(new b2Vec2(5, 0)); would work too
		hero.SetAwake(true);
	};

	var move = function(offset_x, offset_y){
		// unimplemented
		// should it hard-set position (not safe!)
		// or just allow to set any velocity/impulse vector?
	};

	return {
		init: init,
		move_right: move_right,
		move_left: move_left,
		//move: move, // uniplemented. what will it do?
		set_coordinates: set_coordinates,
		b2b_get_coordinates: b2b_get_coordinates,
		update: update,
		jump: jump,
		get_hero: get_hero,

	};
})();

module.exports = PlayerController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "PlayerController", 
	include_options: Includes.choices.DEFAULT
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":17}],12:[function(require,module,exports){

var TerrainController = (function(){
	/* this will be the physical representation of the terrain
	 * currently it contains graphical bits, but that will change
	 */

	var init = function(){
		include();
	};
	

	var update = function(){
		// check for any chunks to be unloaded/deleted will go here, for now
		// maybe it'll check for all players to be sufficiently far to the right
		// of it, maybe one chunk in advance, or smth like that
		while(TerrainModel.terrain_slices_queue.length < 4){
			var slice = NewTerrainSlice();
			TerrainModel.terrain_slices_queue.push(slice);
		};
	};


	var NewTerrainSlice = function(){
		/* this takes care of appending new terrain slice to the generated terrain
		 * it calculates it's origin x and y positions and whatever other stuff,
		 * generates slice; sets up everything
		 */

		var slice = TerrainSliceController.generate();
		MarkAsNewTerrainSlice(slice); // so that graphics and other stuff will notice

		return slice;

	};

	var retrieve_world_parameters = function(){};
	
	var for_each_tile = function(f){
		// takes function >f< that takes three parameters: tile (eseljs object),
		// terrain_lvl (int), and tile_index (int)
		// calls this function for every tile of the terrain
		
		var queues = TerrainModel.terrain_queues;

		$.each(queues, function(terrain_lvl){
			$.each(queues[terrain_lvl], function(tile_index){
				f(queues[terrain_lvl][tile_index], terrain_lvl, tile_index);
			});
		});

	};

	var move_left = function(pixels){
		// Should I scrap this function and just use >move<, or is this a helpful shortcut?
		
		move((-1)*pixels, 0);

	}; // end move_left
	
	var move = function(offset_x, offset_y){
		if(offset_x != 0){
			for_each_tile(function(tile, terrain_lvl, tile_index){
				tile.x += offset_x;
			});

		}// fi

		if(offset_y != 0){
			for_each_tile(function(tile, terrain_lvl, tile_index){
				tile.y += offset_y;
			});

		}

	};

	var MarkAsNewTerrainSlice = function(slice){
		TerrainModel.new_slices.push(slice);
	};

	var NewSlicesAvailable = function(){
		return (TerrainModel.new_slices.length > 0);
	};

	var GetNewTerrainSlices = function(){
		return TerrainModel.new_slices;
	};

	return {
		move_left: move_left,
		move: move,
		update: update,
		init: init,
		NewTerrainSlice: NewTerrainSlice,
		MarkAsNewTerrainSlice: MarkAsNewTerrainSlice,
		NewSlicesAvailable: NewSlicesAvailable,
		GetNewTerrainSlices: GetNewTerrainSlices,
	}
})();

module.exports = TerrainController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "TerrainController", 
	include_options: Includes.choices.DEFAULT
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":17}],13:[function(require,module,exports){

var TerrainSliceController = (function () {

	var init = function(){
		/* is ran from the InitController once when the game is loaded */

		include(); // satisfy requirements

	};

	var update = function(slice){
		

	};

	var get_next_origin = function(){
	};

	var generate = function(){

		var slice = new TerrainSliceModel();
		slice.origin.x = slice.id * slice.grid_columns * slice.cell_w;
		slice.origin.y = 0;

		for(var i = 0; i < slice.grid_rows; i++){
			/* 	assigning id's
				that is the first pass. later it may be used to layout general form of the terrain
			   	assigning each cell in the grid some role, marked by its id.
			 	that role may include for it to be a piece of the bigger object >>>
			*/

			slice.grid[i] = [];
			var lvl = slice.grid_rows - i; // level from the bottom
			var prob = slice.lvl_prob[lvl];

			for(var j = 0; j < slice.grid_columns; j++){
				if(prob){
					var random_id = GameUtility.random_choice(prob, [1, 2, 3]); // chose random terrain tile id
					// the tile in the grid might be made to be separate object later
					// the tile_id will determine the type of object in that tile,
					// such as type of terrain etc. the tiles with different id's do not
					// necessarily differ in physics representation, they might just have
					// different appearance
					slice.grid[i][j] = {id: random_id};

				}else{
					// 0 will be the id for the "air" i.e. nothing
					slice.grid[i][j] = {id: 0};
				}
			} // for end
			// <<< assigning ids
			
		} // for end


		for(var i = 0; i < slice.grid_rows; i++){
			/*	creating physics representations
			 *	2nd pass; this will be used to create all the objects and such
			 *	physics-wise. It may examine id's of the adjacent tiles to find
			 *	larger pieces of terrain to unite under the common bounding box
			 *	if they have similar enough properties or belong together for some reason
			 */

			var lvl = slice.grid_rows - i; // level from the bottom

			for(var j = 0; j < slice.grid_columns; j++){
				var id = slice.grid[i][j].id;
				if(id != 0){ // if not air
					var x = slice.origin.x + j * slice.cell_w + slice.cell_w/2;
					var y = slice.origin.y + i * slice.cell_w + slice.cell_w/2;
					var body = PhysicsController.get_rectangular({x: x, y: y}, "terrain_tile");
					slice.grid[i][j].body = body;
				}

			} // end for

		}//end for
		
		return slice;
	};

	return {
		// declare public
		init: init, 
		update: update,
		generate: generate,
	};
})();

module.exports = TerrainSliceController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "TerrainSliceController", 
	include_options: Includes.choices.DEFAULT
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":17}],14:[function(require,module,exports){
var TestController = (function(){
	// placeholder for implementing testing
	// may be changed/removed/upgraded depending on how we will handle our tests
	
	
	var preinit_tests = function(){
	//For tests requiring run before init is called
	
	
	};
	
	
	var test = function(){
		// if you need some sort of tests launched, this is one of the places to do it
		QUnit.test( "hello test", function( assert ) {
			assert.ok( 1 == "1", "Passed!" );
		});
		Includes.automated_tests();
	};

	var post_loading_tests = function(){
		// TODO: call when loading assets is completed if there are some tests that need
		// to be done at that moment. (Refer to InitController.init and 
		// InitController.setup_asset_dependent methods
	};

	var init = function(mode){
		include();
		// Sets up the debug canvas during testing
		TestModel.d_canvas = document.getElementById(Config.DEBUG_CANVAS_NAME);

		if(mode == "test"){
			TestModel.context = TestModel.d_canvas.getContext("2d");
			
			TestModel.debugDraw = new B2d.b2DebugDraw();
			TestModel.debugDraw.SetSprite(TestModel.context);
			TestModel.debugDraw.SetDrawScale(Config.B2D.SCALE);
			TestModel.debugDraw.SetFillAlpha(0.3);
			TestModel.debugDraw.SetLineThickness(1.0);
			TestModel.debugDraw.SetFlags(B2d.b2DebugDraw.e_shapeBit | B2d.b2DebugDraw.e_jointBit);

			PhysicsController.set_debug_draw(TestModel.debugDraw);

			Config.B2D.debug_draw = true;
			// Screen_W was setup only after this was called

			TestModel.d_canvas.width = Config.SCREEN_W;
			TestModel.d_canvas.height = Config.SCREEN_H;

			//$('#'+Config.DEBUG_CANVAS_NAME).show();

		}else{
			//d_canvas.hide();
		}
	};
	
	//this function sets the x and y offsets of the debug canvas
	var set_debug_offset = function(x_offset, y_offset){
		context = TestModel.context;
		context.save();
		context.clearRect(0, 0, Config.SCREEN_W, Config.SCREEN_H);
		context.translate(x_offset, y_offset);
		PhysicsController.draw_debug();
		context.restore();
	};

	return {
		init: init, 
		test: test,
		post_loading_tests: post_loading_tests,
		preinit_tests: preinit_tests,
		set_debug_offset: set_debug_offset
	}
})();

module.exports = TestController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "TestController", 
	include_options: Includes.choices.DEFAULT
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":17}],15:[function(require,module,exports){
	
var WorldController = (function(){
	/* all the physics control of the whole world
	*/

    var body_test;
    var body_test2;
	//var temp = 0;

	var init = function(){
		/* is ran from the InitController once when the game is loaded */

		include(); // satisfy requirements

		body_test = PhysicsController.get_rectangular({}, "test");
		body_test2 = PhysicsController.get_rectangular({}, "platform");
	};

	var update = function(delta){
		/* is ran each tick from the GameController.update_all */
		PhysicsController.step(delta);

		//if(temp++ == 0){
			//TerrainController.NewTerrainSlice();
		//}

	};

	var MarkAsNewTerrainSlice = function(slice){
		
	};

	return {
		// declare public
		init: init, 
		update: update,
	};
})();

module.exports = WorldController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "WorldController", 
	include_options: Includes.choices.DEFAULT
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":17}],16:[function(require,module,exports){
var GameUtility = (function()
{
  function arrow_key_scrolling(flag) {
    // Configures arrow key scrolling for canvas
    if (flag == false) {
      document.addEventListener('keydown', function (e) { // .getElementById("display_canvas")
        arrows = [37, 38, 39, 40];
        if (arrows.indexOf(e.keyCode) > -1) {
          e.preventDefault();
          return false;
        } else {
          return true
        }
      })
    }
  }

	var lg = function()
	{
		/*
		 * shortcut to console.log()
		 * prints all arguments to console
		 * first argument is used as a label for the rest
		 *
		 * each labeled group is enclosed into the colored delimiters
		 * >>> and <<< so it's easily distinguished. I found it helpful,
		 * if you don't let me know, or use something else
		 */
		console.log("%s %c %s", arguments[0], "background: #DAF2B1", ">>>");
		
		for(var i = 1; i < arguments.length; i++)
		{
			console.log("\t", arguments[i]);
		}
		console.log("%c<<<", "background: #DAF2B1");

	};

	var random_choice = function(probabilities, choices){
		/*
		   takes 2 arrays with elements at corresponding indexes
		   being choice and it's probability. picks random one.
		   choices are anything, probability is integer a, such that
		   probability of a choice is a/10. with a < 10, of course
		   and probabilities adding up to 10. 
		   Yes, it's not very good implementation (read: terrible), 
		   and since you noticed, now it's your job to improve it.

		*/

		// array with choices duplicated a proper amount of times based on
		// their probability
		var blah = []; 

		for(var i = 0; i < choices.length; i++){
			for(var j = 0; j < probabilities[i]; j++){
				blah.push(choices[i]);
			}
		}

		var rand_index = Math.floor(Math.random() * blah.length);

		return blah[rand_index];
	};

	

	return {
		lg: lg,
		random_choice: random_choice
	};

})();

module.exports = GameUtility;

},{}],17:[function(require,module,exports){
var Include = function(){

	var modules;

	// simple enumerator // option codes MUST be power of 2 or sum of other options (with 0 being the only exception), and unique
	var choices = (function(){
		// simple options: numberic value must be 0 or some power of 2, name should be all caps and unique
		var result = {NONE: 0, ALL_CONTROLLERS: 1, ALL_MODELS: 2, OWN_MODEL: 4, OTHER_STUFF: 8};

		// complex options: should consist of simple options, bitwise(!) OR'ed or AND'ed together in any fashion
		result.DEFAULT = (result.ALL_CONTROLLERS | result.OWN_MODEL | result.OTHER_STUFF);
		result.ALL =  (result.ALL_CONTROLLERS | result.ALL_MODELS | result.OTHER_STUFF); 

		// object is immutable
		return Object.freeze(result);
	})();

	var module_names = {
		Controllers: [
			"AssetController",
			"EnemyController",
			"GameController",
			"GraphicsController",
			"InitController",
			"KeyboardController",
			"PhysicsController",
			"PlayerController",
			"TerrainController",
			"TerrainSliceController",
			"TestController",
			"WorldController",
			"AntController",
		],

		Models: [
		
			"AssetModel",
			"GameModel",
			"GraphicsModel",
			"KeyboardModel",
			"PhysicsModel",
			"PlayerModel",
			"TerrainModel",
			"TerrainSliceModel",
			"TestModel",
			"WorldModel",
			"AntModel",
		],

		Other: [
		
			"B2d",
			"Box2D",
			"Config",
			"GameUtility",
		]

	};//end module_names


	var init = function(){

		modules = {
			AssetController: require("./Controllers/AssetController.js"),
			GraphicsController: require("./Controllers/GraphicsController.js"),
			KeyboardController: require("./Controllers/KeyboardController.js"),
			PhysicsController: require("./Controllers/PhysicsController.js"),
			PlayerController: require("./Controllers/PlayerController.js"),
			TerrainController: require("./Controllers/TerrainController.js"),
			TerrainSliceController: require("./Controllers/TerrainSliceController.js"),
			WorldController: require("./Controllers/WorldController.js"),
			InitController: require("./Controllers/InitController.js"),
			TestController: require("./Controllers/TestController.js"),
			GameController: require("./Controllers/GameController.js"),
			EnemyController: require("./Controllers/EnemyController.js"),
			AntController: require("./Controllers/AntController.js"),
			
			// Models

			GameModel: require("./Models/GameModel.js"),
			TerrainSliceModel: require("./Models/TerrainSliceModel.js"),
			AssetModel: require("./Models/AssetModel.js"),
			PhysicsModel: require("./Models/PhysicsModel.js"),
			GraphicsModel: require("./Models/GraphicsModel.js"),
			TerrainModel: require("./Models/TerrainModel.js"),
			WorldModel: require("./Models/WorldModel.js"),
			KeyboardModel: require("./Models/KeyboardModel.js"),
			PlayerModel: require("./Models/PlayerModel.js"),
			TestModel: require("./Models/TestModel.js"),
			AntModel: require("./Models/AntModel.js"),
				
			// Other stuff
			
			Config: require("./Config.js"),
			GameUtility: require("./GameUtility.js"),
			B2d: require("./B2d.js"),
			Box2D: require("box2dweb"),
		
		};
	}; // end init

	var option_is_set = function(what_mods_selected, options){
		if(what_mods_selected == 0 && options == 0){
			return true;
		}
		// be mindful of bitwise operator ahead
		return (what_mods_selected & options);
	};//end option_is_set

	var get_module = function(name){
		// can be modified to throw object error instead of simple one
		// in that case it may contain list of difined modules
		// may also be modified to check whether module is missing from 
		// module_names, modules, or both, and give more accurate description
		var message = "Module " + name + 
			" is undefined. Note that you must hardcode all new modules" + 
			" into the Includes.module_names AND Includes.modules."
		
		if(modules){
			if(modules[name]){
				return modules[name];
			}else if(console.warn){ // check if console.warn is available
				console.warn(message);
			}else{
				throw message;
			}
		}else{
			throw "Error: You must run the Includes.init() before you can use any modules";
		}
	};//end get_module
	

	var get_names = function(current_module_name, options_code){
		var result = {Models: [], Controllers: [], Other: []};

		if(option_is_set(choices.NONE, options_code)){
			return result;
		}

		if (option_is_set(choices.ALL_CONTROLLERS, options_code)){

			var controller_names = module_names.Controllers;

			for(var i = 0; i < controller_names.length; i++){

				var ctl_name = controller_names[i];

				if(ctl_name != current_module_name){
					result.Controllers.push(ctl_name);
				}
			}
			
		}

		if (option_is_set(choices.ALL_MODELS, options_code)){
			result.Models = module_names.Models;
		}
		else if(option_is_set(choices.OWN_MODEL, options_code)){
			var own_model = current_module_name.replace("Controller", "Model");
			result.Models.push(own_model);
		}

		if(option_is_set(choices.OTHER_STUFF, options_code)){
			result.Other = module_names.Other;
		}

		return result;
	};//end get_names

	var get_name_statements = function(names){
		var result = "";
		for(var section_index = 0; section_index < 3; section_index++){
			var section = ["Models", "Controllers", "Other"][section_index];
			for(var i = 0; i < names[section].length; i++){
				result += ("var " + names[section][i] + "; ");
			}
		}

		return result;
		
	};//end get_name_statements

	var get_module_statements = function(names){
		var result = "";
		for(var section_index = 0; section_index < 3; section_index++){
			var section = ["Models", "Controllers", "Other"][section_index];
			for(var i = 0; i < names[section].length; i++){
				result += (names[section][i] + " = Includes.get_module(\"" + names[section][i] + "\"); ");
			}
		}

		return result;
	};//end get_module_statements

	var get_include_data = function(params){
		var current_module = params.current_module;
		var include_options = params.include_options;
		var names = get_names(current_module, include_options);

		var name_statements = get_name_statements(names);
		var module_statements = get_module_statements(names);

		return {
			imported_modules: names,
			name_statements: name_statements,
			module_statements: module_statements,
		};

	};//end get_include_data

	var automated_tests = function(){
		
		QUnit.test("option matching function", function( assert) {

			//If both are none
			assert.equal(option_is_set(choices.NONE, choices.NONE), true);

			assert.throws(option_is_set(choices.NONE, -1));

			//If both match, it returns the value of choices
			//If they don't match, it returns 0
			
			//MATCH
			assert.equal(option_is_set(choices.ALL_CONTROLLERS, choices.ALL_CONTROLLERS), 1);
			assert.equal(option_is_set(choices.ALL_MODELS, choices.ALL_MODELS), 2);
			assert.equal(option_is_set(choices.OTHER_STUFF, choices.OTHER_STUFF), 8);

			//Mismatch
			assert.equal(option_is_set(choices.NONE, choices.ALL_CONTROLLERS), 0);
			assert.equal(option_is_set(choices.OTHER_STUFF, choices.NONE), 0);
			assert.equal(option_is_set(choices.ALL_MODELS, choices.ALL_CONTROLLERS), 0);
			assert.equal(option_is_set(choices.OWN_MODEL, choices.ALL_MODELS), 0);
		});//end option matching test
		
	};//end automated_tests


	return {
		init: init,
		module_names: module_names,
		get_module: get_module,
		get_include_data: get_include_data,
		choices: choices,
		automated_tests: automated_tests
	};

};

module.exports = new Include;


},{"./B2d.js":1,"./Config.js":2,"./Controllers/AntController.js":3,"./Controllers/AssetController.js":4,"./Controllers/EnemyController.js":5,"./Controllers/GameController.js":6,"./Controllers/GraphicsController.js":7,"./Controllers/InitController.js":8,"./Controllers/KeyboardController.js":9,"./Controllers/PhysicsController.js":10,"./Controllers/PlayerController.js":11,"./Controllers/TerrainController.js":12,"./Controllers/TerrainSliceController.js":13,"./Controllers/TestController.js":14,"./Controllers/WorldController.js":15,"./GameUtility.js":16,"./Models/AntModel.js":18,"./Models/AssetModel.js":19,"./Models/GameModel.js":20,"./Models/GraphicsModel.js":21,"./Models/KeyboardModel.js":22,"./Models/PhysicsModel.js":23,"./Models/PlayerModel.js":24,"./Models/TerrainModel.js":25,"./Models/TerrainSliceModel.js":26,"./Models/TestModel.js":27,"./Models/WorldModel.js":28,"box2dweb":30}],18:[function(require,module,exports){
//Model Component (representation of enemy data)


var AntModel = function(){
	//define your constants here
	this.H = 31;//height
	this.W = 50;
	this.sprite_array = [];  //single source for sprites
	this.type = "enemy";
	
	this.hero_hurt_me = false;
	this.me_hurt_hero = false;
	this.death_tick = 0;

	//set your game logic parameters here
	this.object_id = 1; //hardcode a unique identifier for each new enemy class
	this.hp = 2;
	this.speed = 4;
	this.damage = 1;
	//this.attack_cooldown = 4; //use this for enemies who need
	this.can_attack = true;//use this for enemies who alternate between 
	//this.cooldown_timer=-1;
	this.AI_state = "walk";//use this to keep track of the enemy's AI state
	
	/* THIS DOES NOT BELONG HERE. 
	//define fixture (friction, density, etc.)
	this.fixture_def = new box2d.b2FixtureDef
	//density = (mass/volume)
	this.fixture_def.density = 1;
	//friction is what you would imagine
	this.fixture_def.friction = 1;
	//restitution = bounciness
	this.fixture_def.restitution = 0.5;
	//shape = the internal box2d polygon used for collision
	this.fixture_def.shape = new box2d.b2PolygonShape().AsBox(H,W);
	
	//define body (physics stuff)
	this.body_def = new box2d.b2BodyDef();
	this.body_def.type = box2d.b2Body.b2_dynamicBody;
	this.body_def.is_sensor = true;
	this.body.SetLinearVelocity(new box2d.b2Vec2(0, 0));*/
	
	//define sprite (the graphics)
	//walking sprite
	
	//Accessor to state and sprite
	/*
	NOTES ON GRAPHICS
	each sprite sheet contains a number of frames in a single animation. 
	create a new sprite_sheet object for each animation
	set this.sprite to the default starting animation
	
	framerate is the number of frames cycled per second
	images loads the actual png file from the assets folder
	frames specifies how the raw image should be partitioned to generate the actual frames 
		regX & regY are xy offsets
		height and width give the dimensions of the individual frames
		count specifies the number of frames
	You need to make sure that height*count <= the height of the original file (same for width)
	
	
	be aware that the origin of the body.shape(H/2,W/2) != the origin of the sprite (0,0)
	regX and regY are xy offsets for the sprite. use these to keep the 
	sprite in the right place relative to the box2d body
	
	*/
	
};

module.exports = new AntModel;


},{}],19:[function(require,module,exports){
var AssetModel = new function(){
	// As always, almost anything is initialized in the InitController
	
	this.loader;

	this.manifest = [ // defining resources to be loaded in bulk with preload.js
			{src: "greek_warrior.png", id: "greek_warrior"},
			//{src:, id:},
			{src: "middle_terrain.png", id:"middle_terrain"},
			{src: "bottom_terrain.png", id: "bottom_terrain"},
			{src: "grass.png", id: "grass"},
			{src: "AntChompers.png", id: "Ant1"},
			{src: "AntChompers2.png", id: "Ant2"},
			{src: "AntChompersDeath.png", id: "Ant3"}
		]; 
		// TODO make adding resources easier? Automatic loading 
		// of everything from assets, automatic names etc.?

	this.shapes = {}; // maybe this aren't needed

	this.bitmaps = {};

	this.animations = {};

};

module.exports = AssetModel;

},{}],20:[function(require,module,exports){
var GameModel = new function(){ // main model

};

module.exports = GameModel;

},{}],21:[function(require,module,exports){
var GraphicsModel = function(){
	this.stage; // main stage to where everything will be drawn
	// note that every graphics object must be augmented with
	// the reference to the corresponding physics object, if any
	this.hero;
	this.other_players = []; // array of players other then hero for multiplayer
	this.ant;
    //PIZZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
	this.health;
	this.score;
	// all object registered for continious update to match their physical body
	// position 
	this.all_physical = []; 

	// all spritesheet definitions (added at the initialization stage
	// because they need assets to be loaded)
	this.spritesheets = {}; 

	this.camera = {
		// should be easeljs object or null
		following: null,

		// internal camera implementation thing to know how far to offset from the
		// initial position
		offset: {x: 0, y: 0},

		// the offset of the camera from the followed object
		// e.g. offset of {x: 100, y: 100} will center camera
		// 100 pixels to the right and 100 pixels below the followed object
		offset_from_followed: {x: 400, y: -100},
		//offset_from_followed: {x: 330, y: -205}, //FOR GAME PAGE
		// this is center of the screen in pixels. gets dynamically recalculated 
		// during the camera update so if it's ever changed, camera still works as expected
		center: {x: 0, y: 0}

	};
};

module.exports = new GraphicsModel;


},{}],22:[function(require,module,exports){

},{}],23:[function(require,module,exports){

var PhysicsModel = function() {
	
	this.gravity;
	this.world;
 
	// getting context of the debug canvas, for box2d to draw debuggin boxes

	// timeToCover is the time that simulation must cover to catch up to the real world time;
	// since createjs ticker is what we use for timing, and box2d ticks
	// must be of constant length and independent from the graphics framerate,
	// we keep track of time that passed since last box2d step by adding time deltas
	// to the timeToCover. Then, when timeToCover exceeds desired box2d step length,
	// we perform the step and subtract the corresponding time from the timeToCover;
	// If anything is still unclear, ask me (AK);
		this.timeToCover = 0; 

	this.step_amount;

}; 

var templates;
/*
 * Parameters for b2d body definition
	active: true
	allowSleep: true
	angle: 0
	angularDamping: 0
	angularVelocity: 0
	awake: true
	bullet: false
	fixedRotation: false
	inertiaScale: 1
	linearDamping: 0
	linearVelocity: b2Vec2
	position: b2Vec2
	type: 0
	userData: null
*/

/*
 * Fixture definition parameters:
	density: 0
	filter: b2FilterData
	friction: 0.2
	isSensor: false
	restitution: 0
	shape: null
	userData: null
 */

// rectangular
PhysicsModel.prototype.r_templates = r_templates = {};
// circular
PhysicsModel.prototype.c_templates = c_templates = {};
// polygonal
PhysicsModel.prototype.p_templates = p_templates = {};



r_templates["default"] = {

	//shape: "rectangle", // implied from the template type
	x: 3,
	y: 3,
	vx: 0,
	vy: 0,

	width: 5,
	height: 5,
	density: 2,
	friction: 1,
	restitution: 0.2,
	isSensor: false,


	active: true,
	allowSleep: true,
	angle: 0,
	angularVelocity: 0,
	awake: true,
	bullet: false,
	fixedRotation: false,
	type: "dynamic",

};

r_templates.living = {
	fixedRotation: true,
	awake: true,
	isSensor: false,
	//mobexp++
};

r_templates.terrain_tile = {
	type: "static",
	width: 1,
	height: 1,
	//mobexp++
};

r_templates.player = {
	parent: r_templates.living,
	width: 1.5,
	height: 2.5,
	type: "dynamic",
	//mobexp++
};

r_templates.ant = {
	parent: r_templates.living,
	width: 1,
	height: 0.5,
	type: "dynamic",
	x: 40,
	y: 10,
	//mobexp++
};

r_templates.test = {
	width: 1,
	height: 2,
	fixedRotation: false,
	//mobexp++
}

r_templates.platform = {
    x: 10,
    y: 11,
    width: 10,
    height: .5,
    type: "static",
}

module.exports = new PhysicsModel;

},{}],24:[function(require,module,exports){
var PlayerModel = function(){
	this.hero;
	this.type = "hero";
};

module.exports = new PlayerModel;


},{}],25:[function(require,module,exports){
var TerrainModel = function(){
	//This is physics, for graphics look into the GraphicsController/Model
	this.terrain_slices_queue = [];
	this.new_slices = [];

};

module.exports = new TerrainModel;

},{}],26:[function(require,module,exports){
TerrainSliceConfig = require ("../Config.js").TerrainSlice;

var TerrainSliceModel = function(){
	this.id = TerrainSliceConfig.next_slice_id++; // automaticall assign id and increment 

	this.grid_columns = TerrainSliceConfig.grid_columns;
	this.grid_rows = TerrainSliceConfig.grid_rows;
	this.cell_w = TerrainSliceConfig.cell_w;
	
	// grid[i][j] is the element in the i's column and j's row
	// the grid is maid to match the screen coordinates and the current box2d coordinates
	// i.e. grid[0][0] is the one in the top left corner of the terrain slice
	// do we want to change it? would it be easier to generate terrain if we start at the bottom?
	// if yes, then what makes more sense, changing coordinate systems or just switching generation
	// loops around? discuss
	//
	// notice that the grid is a terrain generation device only. once terrain slice is loaded,
	// box2d physics simulation may (and will) go nuts on it, changing whatever it wants,
	// and changes won't anyhow be reflected in the grid. to keep track of all the bodies
	// in the terrain slice, if that will be needed, other mechanisms should be used.
	// idea: have a collections of bodies by type, and setup sensor collision beams
	// at the terrain slices' boundaries to keep track of bodies flying over from one
	// terrain slice to another. Btw, Ali, I hate you for making me to type "terrain slice"
	// instead of the "chunk" 
	this.grid = [];
	
	this.origin = {x: null, y: null};
	

	
	
};

TerrainSliceModel.prototype.lvl_prob = [
	[7, 2, 1],
	[0, 7, 3],
	[0, 1, 9]
]

module.exports = TerrainSliceModel;

},{"../Config.js":2}],27:[function(require,module,exports){
var TestModel = function(){

};

module.exports = new TestModel;


},{}],28:[function(require,module,exports){
var WorldModel = function(){
	
};

module.exports = new WorldModel;


},{}],29:[function(require,module,exports){

/*
 * Rules for working on the (client-side) game code:
 *
 * 1. If you think that one of these rules is stupid or useless, tell me, along with some better suggestions.
 *
 * 2. Model [name]Model can only be accessed through [name]Controller. If you need to do something to 
 * 		change [name]Model from [other_name]Controller, write function in the [name]Controller that does
 * 		what you need, and call it from the [other_name]Controller
 *
 * 3. Controllers are allowed to have private methods/fields. Models aren't. 
 *
 * 4. Controllers aren't allowed to have public data fields. 
 * 		Those data fields that are present must not reflect state of the game, they must be related to
 * 		some internal functionality of the controller
 *
 * 5. If you write some function that doesn't logically belong to one of the controllers,
 * 		put it in the Utility
 *
 * 6. Variables are named like that: variable_name
 * 		Except (singleton)class names, that are written like that: ClassName
 *
 * 7. And all the obvious stuff that everyone knows:
 * 		function must do one thing; don't make function public unless it needs to be that; 
 * 		comment ambigious code, for larger functions indicate their purpose (through commenting);
 */


// main namespace that is exposed to global scope (window object)
window.sidescroller_game = (function namespace(){

		var Includes = require("./Includes.js"); var include_data = Includes.get_include_data({
		current_module: "None", 
		include_options: Includes.choices.ALL_CONTROLLERS
	}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}

	// Game initiation section: >>>
		
	var load_game = function(mode)
	{

		Includes.init(); // first
		include(); // second

		InitController.init(mode); // init all the stuff

		if(mode == "test"){
			TestController.test();
		}
	};


	var run = function(mode)
	{
		// done this way to ensure that load_game's internals aren't accessible to the world:
		load_game(mode);
	}; 
	
	return {
		run: run
	}; // expose function run to the world

})(); 


},{"./Includes.js":17}],30:[function(require,module,exports){
/*
* Copyright (c) 2006-2007 Erin Catto http://www.gphysics.com
*
* This software is provided 'as-is', without any express or implied
* warranty.  In no event will the authors be held liable for any damages
* arising from the use of this software.
* Permission is granted to anyone to use this software for any purpose,
* including commercial applications, and to alter it and redistribute it
* freely, subject to the following restrictions:
* 1. The origin of this software must not be misrepresented; you must not
* claim that you wrote the original software. If you use this software
* in a product, an acknowledgment in the product documentation would be
* appreciated but is not required.
* 2. Altered source versions must be plainly marked as such, and must not be
* misrepresented as being the original software.
* 3. This notice may not be removed or altered from any source distribution.
*/
"use strict"

var Box2D = {};

(function (a2j, undefined) {
   
   function emptyFn() {};
   a2j.inherit = function(cls, base) {
      var tmpCtr = cls;
      emptyFn.prototype = base.prototype;
      cls.prototype = new emptyFn;
      cls.prototype.constructor = tmpCtr;
   };
   
   a2j.generateCallback = function generateCallback(context, cb) {
      return function () {
         cb.apply(context, arguments);
      };
   };
   
   a2j.NVector = function NVector(length) {
      if (length === undefined) length = 0;
      var tmp = new Array(length || 0);
      for (var i = 0; i < length; ++i)
      tmp[i] = 0;
      return tmp;
   };
   
   a2j.is = function is(o1, o2) {
      if (o1 === null) return false;
      if ((o2 instanceof Function) && (o1 instanceof o2)) return true;
      if ((o1.constructor.__implements != undefined) && (o1.constructor.__implements[o2])) return true;
      return false;
   };
   
   a2j.parseUInt = function(v) {
      return Math.abs(parseInt(v));
   }
   
})(Box2D);

//#TODO remove assignments from global namespace
var Vector = Array;
var Vector_a2j_Number = Box2D.NVector;
//package structure
if (typeof(Box2D) === "undefined") Box2D = {};
if (typeof(Box2D.Collision) === "undefined") Box2D.Collision = {};
if (typeof(Box2D.Collision.Shapes) === "undefined") Box2D.Collision.Shapes = {};
if (typeof(Box2D.Common) === "undefined") Box2D.Common = {};
if (typeof(Box2D.Common.Math) === "undefined") Box2D.Common.Math = {};
if (typeof(Box2D.Dynamics) === "undefined") Box2D.Dynamics = {};
if (typeof(Box2D.Dynamics.Contacts) === "undefined") Box2D.Dynamics.Contacts = {};
if (typeof(Box2D.Dynamics.Controllers) === "undefined") Box2D.Dynamics.Controllers = {};
if (typeof(Box2D.Dynamics.Joints) === "undefined") Box2D.Dynamics.Joints = {};
//pre-definitions
(function () {
   Box2D.Collision.IBroadPhase = 'Box2D.Collision.IBroadPhase';

   function b2AABB() {
      b2AABB.b2AABB.apply(this, arguments);
   };
   Box2D.Collision.b2AABB = b2AABB;

   function b2Bound() {
      b2Bound.b2Bound.apply(this, arguments);
   };
   Box2D.Collision.b2Bound = b2Bound;

   function b2BoundValues() {
      b2BoundValues.b2BoundValues.apply(this, arguments);
      if (this.constructor === b2BoundValues) this.b2BoundValues.apply(this, arguments);
   };
   Box2D.Collision.b2BoundValues = b2BoundValues;

   function b2Collision() {
      b2Collision.b2Collision.apply(this, arguments);
   };
   Box2D.Collision.b2Collision = b2Collision;

   function b2ContactID() {
      b2ContactID.b2ContactID.apply(this, arguments);
      if (this.constructor === b2ContactID) this.b2ContactID.apply(this, arguments);
   };
   Box2D.Collision.b2ContactID = b2ContactID;

   function b2ContactPoint() {
      b2ContactPoint.b2ContactPoint.apply(this, arguments);
   };
   Box2D.Collision.b2ContactPoint = b2ContactPoint;

   function b2Distance() {
      b2Distance.b2Distance.apply(this, arguments);
   };
   Box2D.Collision.b2Distance = b2Distance;

   function b2DistanceInput() {
      b2DistanceInput.b2DistanceInput.apply(this, arguments);
   };
   Box2D.Collision.b2DistanceInput = b2DistanceInput;

   function b2DistanceOutput() {
      b2DistanceOutput.b2DistanceOutput.apply(this, arguments);
   };
   Box2D.Collision.b2DistanceOutput = b2DistanceOutput;

   function b2DistanceProxy() {
      b2DistanceProxy.b2DistanceProxy.apply(this, arguments);
   };
   Box2D.Collision.b2DistanceProxy = b2DistanceProxy;

   function b2DynamicTree() {
      b2DynamicTree.b2DynamicTree.apply(this, arguments);
      if (this.constructor === b2DynamicTree) this.b2DynamicTree.apply(this, arguments);
   };
   Box2D.Collision.b2DynamicTree = b2DynamicTree;

   function b2DynamicTreeBroadPhase() {
      b2DynamicTreeBroadPhase.b2DynamicTreeBroadPhase.apply(this, arguments);
   };
   Box2D.Collision.b2DynamicTreeBroadPhase = b2DynamicTreeBroadPhase;

   function b2DynamicTreeNode() {
      b2DynamicTreeNode.b2DynamicTreeNode.apply(this, arguments);
   };
   Box2D.Collision.b2DynamicTreeNode = b2DynamicTreeNode;

   function b2DynamicTreePair() {
      b2DynamicTreePair.b2DynamicTreePair.apply(this, arguments);
   };
   Box2D.Collision.b2DynamicTreePair = b2DynamicTreePair;

   function b2Manifold() {
      b2Manifold.b2Manifold.apply(this, arguments);
      if (this.constructor === b2Manifold) this.b2Manifold.apply(this, arguments);
   };
   Box2D.Collision.b2Manifold = b2Manifold;

   function b2ManifoldPoint() {
      b2ManifoldPoint.b2ManifoldPoint.apply(this, arguments);
      if (this.constructor === b2ManifoldPoint) this.b2ManifoldPoint.apply(this, arguments);
   };
   Box2D.Collision.b2ManifoldPoint = b2ManifoldPoint;

   function b2Point() {
      b2Point.b2Point.apply(this, arguments);
   };
   Box2D.Collision.b2Point = b2Point;

   function b2RayCastInput() {
      b2RayCastInput.b2RayCastInput.apply(this, arguments);
      if (this.constructor === b2RayCastInput) this.b2RayCastInput.apply(this, arguments);
   };
   Box2D.Collision.b2RayCastInput = b2RayCastInput;

   function b2RayCastOutput() {
      b2RayCastOutput.b2RayCastOutput.apply(this, arguments);
   };
   Box2D.Collision.b2RayCastOutput = b2RayCastOutput;

   function b2Segment() {
      b2Segment.b2Segment.apply(this, arguments);
   };
   Box2D.Collision.b2Segment = b2Segment;

   function b2SeparationFunction() {
      b2SeparationFunction.b2SeparationFunction.apply(this, arguments);
   };
   Box2D.Collision.b2SeparationFunction = b2SeparationFunction;

   function b2Simplex() {
      b2Simplex.b2Simplex.apply(this, arguments);
      if (this.constructor === b2Simplex) this.b2Simplex.apply(this, arguments);
   };
   Box2D.Collision.b2Simplex = b2Simplex;

   function b2SimplexCache() {
      b2SimplexCache.b2SimplexCache.apply(this, arguments);
   };
   Box2D.Collision.b2SimplexCache = b2SimplexCache;

   function b2SimplexVertex() {
      b2SimplexVertex.b2SimplexVertex.apply(this, arguments);
   };
   Box2D.Collision.b2SimplexVertex = b2SimplexVertex;

   function b2TimeOfImpact() {
      b2TimeOfImpact.b2TimeOfImpact.apply(this, arguments);
   };
   Box2D.Collision.b2TimeOfImpact = b2TimeOfImpact;

   function b2TOIInput() {
      b2TOIInput.b2TOIInput.apply(this, arguments);
   };
   Box2D.Collision.b2TOIInput = b2TOIInput;

   function b2WorldManifold() {
      b2WorldManifold.b2WorldManifold.apply(this, arguments);
      if (this.constructor === b2WorldManifold) this.b2WorldManifold.apply(this, arguments);
   };
   Box2D.Collision.b2WorldManifold = b2WorldManifold;

   function ClipVertex() {
      ClipVertex.ClipVertex.apply(this, arguments);
   };
   Box2D.Collision.ClipVertex = ClipVertex;

   function Features() {
      Features.Features.apply(this, arguments);
   };
   Box2D.Collision.Features = Features;

   function b2CircleShape() {
      b2CircleShape.b2CircleShape.apply(this, arguments);
      if (this.constructor === b2CircleShape) this.b2CircleShape.apply(this, arguments);
   };
   Box2D.Collision.Shapes.b2CircleShape = b2CircleShape;

   function b2EdgeChainDef() {
      b2EdgeChainDef.b2EdgeChainDef.apply(this, arguments);
      if (this.constructor === b2EdgeChainDef) this.b2EdgeChainDef.apply(this, arguments);
   };
   Box2D.Collision.Shapes.b2EdgeChainDef = b2EdgeChainDef;

   function b2EdgeShape() {
      b2EdgeShape.b2EdgeShape.apply(this, arguments);
      if (this.constructor === b2EdgeShape) this.b2EdgeShape.apply(this, arguments);
   };
   Box2D.Collision.Shapes.b2EdgeShape = b2EdgeShape;

   function b2MassData() {
      b2MassData.b2MassData.apply(this, arguments);
   };
   Box2D.Collision.Shapes.b2MassData = b2MassData;

   function b2PolygonShape() {
      b2PolygonShape.b2PolygonShape.apply(this, arguments);
      if (this.constructor === b2PolygonShape) this.b2PolygonShape.apply(this, arguments);
   };
   Box2D.Collision.Shapes.b2PolygonShape = b2PolygonShape;

   function b2Shape() {
      b2Shape.b2Shape.apply(this, arguments);
      if (this.constructor === b2Shape) this.b2Shape.apply(this, arguments);
   };
   Box2D.Collision.Shapes.b2Shape = b2Shape;
   Box2D.Common.b2internal = 'Box2D.Common.b2internal';

   function b2Color() {
      b2Color.b2Color.apply(this, arguments);
      if (this.constructor === b2Color) this.b2Color.apply(this, arguments);
   };
   Box2D.Common.b2Color = b2Color;

   function b2Settings() {
      b2Settings.b2Settings.apply(this, arguments);
   };
   Box2D.Common.b2Settings = b2Settings;

   function b2Mat22() {
      b2Mat22.b2Mat22.apply(this, arguments);
      if (this.constructor === b2Mat22) this.b2Mat22.apply(this, arguments);
   };
   Box2D.Common.Math.b2Mat22 = b2Mat22;

   function b2Mat33() {
      b2Mat33.b2Mat33.apply(this, arguments);
      if (this.constructor === b2Mat33) this.b2Mat33.apply(this, arguments);
   };
   Box2D.Common.Math.b2Mat33 = b2Mat33;

   function b2Math() {
      b2Math.b2Math.apply(this, arguments);
   };
   Box2D.Common.Math.b2Math = b2Math;

   function b2Sweep() {
      b2Sweep.b2Sweep.apply(this, arguments);
   };
   Box2D.Common.Math.b2Sweep = b2Sweep;

   function b2Transform() {
      b2Transform.b2Transform.apply(this, arguments);
      if (this.constructor === b2Transform) this.b2Transform.apply(this, arguments);
   };
   Box2D.Common.Math.b2Transform = b2Transform;

   function b2Vec2() {
      b2Vec2.b2Vec2.apply(this, arguments);
      if (this.constructor === b2Vec2) this.b2Vec2.apply(this, arguments);
   };
   Box2D.Common.Math.b2Vec2 = b2Vec2;

   function b2Vec3() {
      b2Vec3.b2Vec3.apply(this, arguments);
      if (this.constructor === b2Vec3) this.b2Vec3.apply(this, arguments);
   };
   Box2D.Common.Math.b2Vec3 = b2Vec3;

   function b2Body() {
      b2Body.b2Body.apply(this, arguments);
      if (this.constructor === b2Body) this.b2Body.apply(this, arguments);
   };
   Box2D.Dynamics.b2Body = b2Body;

   function b2BodyDef() {
      b2BodyDef.b2BodyDef.apply(this, arguments);
      if (this.constructor === b2BodyDef) this.b2BodyDef.apply(this, arguments);
   };
   Box2D.Dynamics.b2BodyDef = b2BodyDef;

   function b2ContactFilter() {
      b2ContactFilter.b2ContactFilter.apply(this, arguments);
   };
   Box2D.Dynamics.b2ContactFilter = b2ContactFilter;

   function b2ContactImpulse() {
      b2ContactImpulse.b2ContactImpulse.apply(this, arguments);
   };
   Box2D.Dynamics.b2ContactImpulse = b2ContactImpulse;

   function b2ContactListener() {
      b2ContactListener.b2ContactListener.apply(this, arguments);
   };
   Box2D.Dynamics.b2ContactListener = b2ContactListener;

   function b2ContactManager() {
      b2ContactManager.b2ContactManager.apply(this, arguments);
      if (this.constructor === b2ContactManager) this.b2ContactManager.apply(this, arguments);
   };
   Box2D.Dynamics.b2ContactManager = b2ContactManager;

   function b2DebugDraw() {
      b2DebugDraw.b2DebugDraw.apply(this, arguments);
      if (this.constructor === b2DebugDraw) this.b2DebugDraw.apply(this, arguments);
   };
   Box2D.Dynamics.b2DebugDraw = b2DebugDraw;

   function b2DestructionListener() {
      b2DestructionListener.b2DestructionListener.apply(this, arguments);
   };
   Box2D.Dynamics.b2DestructionListener = b2DestructionListener;

   function b2FilterData() {
      b2FilterData.b2FilterData.apply(this, arguments);
   };
   Box2D.Dynamics.b2FilterData = b2FilterData;

   function b2Fixture() {
      b2Fixture.b2Fixture.apply(this, arguments);
      if (this.constructor === b2Fixture) this.b2Fixture.apply(this, arguments);
   };
   Box2D.Dynamics.b2Fixture = b2Fixture;

   function b2FixtureDef() {
      b2FixtureDef.b2FixtureDef.apply(this, arguments);
      if (this.constructor === b2FixtureDef) this.b2FixtureDef.apply(this, arguments);
   };
   Box2D.Dynamics.b2FixtureDef = b2FixtureDef;

   function b2Island() {
      b2Island.b2Island.apply(this, arguments);
      if (this.constructor === b2Island) this.b2Island.apply(this, arguments);
   };
   Box2D.Dynamics.b2Island = b2Island;

   function b2TimeStep() {
      b2TimeStep.b2TimeStep.apply(this, arguments);
   };
   Box2D.Dynamics.b2TimeStep = b2TimeStep;

   function b2World() {
      b2World.b2World.apply(this, arguments);
      if (this.constructor === b2World) this.b2World.apply(this, arguments);
   };
   Box2D.Dynamics.b2World = b2World;

   function b2CircleContact() {
      b2CircleContact.b2CircleContact.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2CircleContact = b2CircleContact;

   function b2Contact() {
      b2Contact.b2Contact.apply(this, arguments);
      if (this.constructor === b2Contact) this.b2Contact.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2Contact = b2Contact;

   function b2ContactConstraint() {
      b2ContactConstraint.b2ContactConstraint.apply(this, arguments);
      if (this.constructor === b2ContactConstraint) this.b2ContactConstraint.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2ContactConstraint = b2ContactConstraint;

   function b2ContactConstraintPoint() {
      b2ContactConstraintPoint.b2ContactConstraintPoint.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2ContactConstraintPoint = b2ContactConstraintPoint;

   function b2ContactEdge() {
      b2ContactEdge.b2ContactEdge.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2ContactEdge = b2ContactEdge;

   function b2ContactFactory() {
      b2ContactFactory.b2ContactFactory.apply(this, arguments);
      if (this.constructor === b2ContactFactory) this.b2ContactFactory.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2ContactFactory = b2ContactFactory;

   function b2ContactRegister() {
      b2ContactRegister.b2ContactRegister.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2ContactRegister = b2ContactRegister;

   function b2ContactResult() {
      b2ContactResult.b2ContactResult.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2ContactResult = b2ContactResult;

   function b2ContactSolver() {
      b2ContactSolver.b2ContactSolver.apply(this, arguments);
      if (this.constructor === b2ContactSolver) this.b2ContactSolver.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2ContactSolver = b2ContactSolver;

   function b2EdgeAndCircleContact() {
      b2EdgeAndCircleContact.b2EdgeAndCircleContact.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2EdgeAndCircleContact = b2EdgeAndCircleContact;

   function b2NullContact() {
      b2NullContact.b2NullContact.apply(this, arguments);
      if (this.constructor === b2NullContact) this.b2NullContact.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2NullContact = b2NullContact;

   function b2PolyAndCircleContact() {
      b2PolyAndCircleContact.b2PolyAndCircleContact.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2PolyAndCircleContact = b2PolyAndCircleContact;

   function b2PolyAndEdgeContact() {
      b2PolyAndEdgeContact.b2PolyAndEdgeContact.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2PolyAndEdgeContact = b2PolyAndEdgeContact;

   function b2PolygonContact() {
      b2PolygonContact.b2PolygonContact.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2PolygonContact = b2PolygonContact;

   function b2PositionSolverManifold() {
      b2PositionSolverManifold.b2PositionSolverManifold.apply(this, arguments);
      if (this.constructor === b2PositionSolverManifold) this.b2PositionSolverManifold.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2PositionSolverManifold = b2PositionSolverManifold;

   function b2BuoyancyController() {
      b2BuoyancyController.b2BuoyancyController.apply(this, arguments);
   };
   Box2D.Dynamics.Controllers.b2BuoyancyController = b2BuoyancyController;

   function b2ConstantAccelController() {
      b2ConstantAccelController.b2ConstantAccelController.apply(this, arguments);
   };
   Box2D.Dynamics.Controllers.b2ConstantAccelController = b2ConstantAccelController;

   function b2ConstantForceController() {
      b2ConstantForceController.b2ConstantForceController.apply(this, arguments);
   };
   Box2D.Dynamics.Controllers.b2ConstantForceController = b2ConstantForceController;

   function b2Controller() {
      b2Controller.b2Controller.apply(this, arguments);
   };
   Box2D.Dynamics.Controllers.b2Controller = b2Controller;

   function b2ControllerEdge() {
      b2ControllerEdge.b2ControllerEdge.apply(this, arguments);
   };
   Box2D.Dynamics.Controllers.b2ControllerEdge = b2ControllerEdge;

   function b2GravityController() {
      b2GravityController.b2GravityController.apply(this, arguments);
   };
   Box2D.Dynamics.Controllers.b2GravityController = b2GravityController;

   function b2TensorDampingController() {
      b2TensorDampingController.b2TensorDampingController.apply(this, arguments);
   };
   Box2D.Dynamics.Controllers.b2TensorDampingController = b2TensorDampingController;

   function b2DistanceJoint() {
      b2DistanceJoint.b2DistanceJoint.apply(this, arguments);
      if (this.constructor === b2DistanceJoint) this.b2DistanceJoint.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2DistanceJoint = b2DistanceJoint;

   function b2DistanceJointDef() {
      b2DistanceJointDef.b2DistanceJointDef.apply(this, arguments);
      if (this.constructor === b2DistanceJointDef) this.b2DistanceJointDef.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2DistanceJointDef = b2DistanceJointDef;

   function b2FrictionJoint() {
      b2FrictionJoint.b2FrictionJoint.apply(this, arguments);
      if (this.constructor === b2FrictionJoint) this.b2FrictionJoint.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2FrictionJoint = b2FrictionJoint;

   function b2FrictionJointDef() {
      b2FrictionJointDef.b2FrictionJointDef.apply(this, arguments);
      if (this.constructor === b2FrictionJointDef) this.b2FrictionJointDef.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2FrictionJointDef = b2FrictionJointDef;

   function b2GearJoint() {
      b2GearJoint.b2GearJoint.apply(this, arguments);
      if (this.constructor === b2GearJoint) this.b2GearJoint.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2GearJoint = b2GearJoint;

   function b2GearJointDef() {
      b2GearJointDef.b2GearJointDef.apply(this, arguments);
      if (this.constructor === b2GearJointDef) this.b2GearJointDef.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2GearJointDef = b2GearJointDef;

   function b2Jacobian() {
      b2Jacobian.b2Jacobian.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2Jacobian = b2Jacobian;

   function b2Joint() {
      b2Joint.b2Joint.apply(this, arguments);
      if (this.constructor === b2Joint) this.b2Joint.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2Joint = b2Joint;

   function b2JointDef() {
      b2JointDef.b2JointDef.apply(this, arguments);
      if (this.constructor === b2JointDef) this.b2JointDef.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2JointDef = b2JointDef;

   function b2JointEdge() {
      b2JointEdge.b2JointEdge.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2JointEdge = b2JointEdge;

   function b2LineJoint() {
      b2LineJoint.b2LineJoint.apply(this, arguments);
      if (this.constructor === b2LineJoint) this.b2LineJoint.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2LineJoint = b2LineJoint;

   function b2LineJointDef() {
      b2LineJointDef.b2LineJointDef.apply(this, arguments);
      if (this.constructor === b2LineJointDef) this.b2LineJointDef.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2LineJointDef = b2LineJointDef;

   function b2MouseJoint() {
      b2MouseJoint.b2MouseJoint.apply(this, arguments);
      if (this.constructor === b2MouseJoint) this.b2MouseJoint.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2MouseJoint = b2MouseJoint;

   function b2MouseJointDef() {
      b2MouseJointDef.b2MouseJointDef.apply(this, arguments);
      if (this.constructor === b2MouseJointDef) this.b2MouseJointDef.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2MouseJointDef = b2MouseJointDef;

   function b2PrismaticJoint() {
      b2PrismaticJoint.b2PrismaticJoint.apply(this, arguments);
      if (this.constructor === b2PrismaticJoint) this.b2PrismaticJoint.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2PrismaticJoint = b2PrismaticJoint;

   function b2PrismaticJointDef() {
      b2PrismaticJointDef.b2PrismaticJointDef.apply(this, arguments);
      if (this.constructor === b2PrismaticJointDef) this.b2PrismaticJointDef.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2PrismaticJointDef = b2PrismaticJointDef;

   function b2PulleyJoint() {
      b2PulleyJoint.b2PulleyJoint.apply(this, arguments);
      if (this.constructor === b2PulleyJoint) this.b2PulleyJoint.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2PulleyJoint = b2PulleyJoint;

   function b2PulleyJointDef() {
      b2PulleyJointDef.b2PulleyJointDef.apply(this, arguments);
      if (this.constructor === b2PulleyJointDef) this.b2PulleyJointDef.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2PulleyJointDef = b2PulleyJointDef;

   function b2RevoluteJoint() {
      b2RevoluteJoint.b2RevoluteJoint.apply(this, arguments);
      if (this.constructor === b2RevoluteJoint) this.b2RevoluteJoint.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2RevoluteJoint = b2RevoluteJoint;

   function b2RevoluteJointDef() {
      b2RevoluteJointDef.b2RevoluteJointDef.apply(this, arguments);
      if (this.constructor === b2RevoluteJointDef) this.b2RevoluteJointDef.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2RevoluteJointDef = b2RevoluteJointDef;

   function b2WeldJoint() {
      b2WeldJoint.b2WeldJoint.apply(this, arguments);
      if (this.constructor === b2WeldJoint) this.b2WeldJoint.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2WeldJoint = b2WeldJoint;

   function b2WeldJointDef() {
      b2WeldJointDef.b2WeldJointDef.apply(this, arguments);
      if (this.constructor === b2WeldJointDef) this.b2WeldJointDef.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2WeldJointDef = b2WeldJointDef;
})(); //definitions
Box2D.postDefs = [];
(function () {
   var b2CircleShape = Box2D.Collision.Shapes.b2CircleShape,
      b2EdgeChainDef = Box2D.Collision.Shapes.b2EdgeChainDef,
      b2EdgeShape = Box2D.Collision.Shapes.b2EdgeShape,
      b2MassData = Box2D.Collision.Shapes.b2MassData,
      b2PolygonShape = Box2D.Collision.Shapes.b2PolygonShape,
      b2Shape = Box2D.Collision.Shapes.b2Shape,
      b2Color = Box2D.Common.b2Color,
      b2internal = Box2D.Common.b2internal,
      b2Settings = Box2D.Common.b2Settings,
      b2Mat22 = Box2D.Common.Math.b2Mat22,
      b2Mat33 = Box2D.Common.Math.b2Mat33,
      b2Math = Box2D.Common.Math.b2Math,
      b2Sweep = Box2D.Common.Math.b2Sweep,
      b2Transform = Box2D.Common.Math.b2Transform,
      b2Vec2 = Box2D.Common.Math.b2Vec2,
      b2Vec3 = Box2D.Common.Math.b2Vec3,
      b2AABB = Box2D.Collision.b2AABB,
      b2Bound = Box2D.Collision.b2Bound,
      b2BoundValues = Box2D.Collision.b2BoundValues,
      b2Collision = Box2D.Collision.b2Collision,
      b2ContactID = Box2D.Collision.b2ContactID,
      b2ContactPoint = Box2D.Collision.b2ContactPoint,
      b2Distance = Box2D.Collision.b2Distance,
      b2DistanceInput = Box2D.Collision.b2DistanceInput,
      b2DistanceOutput = Box2D.Collision.b2DistanceOutput,
      b2DistanceProxy = Box2D.Collision.b2DistanceProxy,
      b2DynamicTree = Box2D.Collision.b2DynamicTree,
      b2DynamicTreeBroadPhase = Box2D.Collision.b2DynamicTreeBroadPhase,
      b2DynamicTreeNode = Box2D.Collision.b2DynamicTreeNode,
      b2DynamicTreePair = Box2D.Collision.b2DynamicTreePair,
      b2Manifold = Box2D.Collision.b2Manifold,
      b2ManifoldPoint = Box2D.Collision.b2ManifoldPoint,
      b2Point = Box2D.Collision.b2Point,
      b2RayCastInput = Box2D.Collision.b2RayCastInput,
      b2RayCastOutput = Box2D.Collision.b2RayCastOutput,
      b2Segment = Box2D.Collision.b2Segment,
      b2SeparationFunction = Box2D.Collision.b2SeparationFunction,
      b2Simplex = Box2D.Collision.b2Simplex,
      b2SimplexCache = Box2D.Collision.b2SimplexCache,
      b2SimplexVertex = Box2D.Collision.b2SimplexVertex,
      b2TimeOfImpact = Box2D.Collision.b2TimeOfImpact,
      b2TOIInput = Box2D.Collision.b2TOIInput,
      b2WorldManifold = Box2D.Collision.b2WorldManifold,
      ClipVertex = Box2D.Collision.ClipVertex,
      Features = Box2D.Collision.Features,
      IBroadPhase = Box2D.Collision.IBroadPhase;

   b2AABB.b2AABB = function () {
      this.lowerBound = new b2Vec2();
      this.upperBound = new b2Vec2();
   };
   b2AABB.prototype.IsValid = function () {
      var dX = this.upperBound.x - this.lowerBound.x;
      var dY = this.upperBound.y - this.lowerBound.y;
      var valid = dX >= 0.0 && dY >= 0.0;
      valid = valid && this.lowerBound.IsValid() && this.upperBound.IsValid();
      return valid;
   }
   b2AABB.prototype.GetCenter = function () {
      return new b2Vec2((this.lowerBound.x + this.upperBound.x) / 2, (this.lowerBound.y + this.upperBound.y) / 2);
   }
   b2AABB.prototype.GetExtents = function () {
      return new b2Vec2((this.upperBound.x - this.lowerBound.x) / 2, (this.upperBound.y - this.lowerBound.y) / 2);
   }
   b2AABB.prototype.Contains = function (aabb) {
      var result = true;
      result = result && this.lowerBound.x <= aabb.lowerBound.x;
      result = result && this.lowerBound.y <= aabb.lowerBound.y;
      result = result && aabb.upperBound.x <= this.upperBound.x;
      result = result && aabb.upperBound.y <= this.upperBound.y;
      return result;
   }
   b2AABB.prototype.RayCast = function (output, input) {
      var tmin = (-Number.MAX_VALUE);
      var tmax = Number.MAX_VALUE;
      var pX = input.p1.x;
      var pY = input.p1.y;
      var dX = input.p2.x - input.p1.x;
      var dY = input.p2.y - input.p1.y;
      var absDX = Math.abs(dX);
      var absDY = Math.abs(dY);
      var normal = output.normal;
      var inv_d = 0;
      var t1 = 0;
      var t2 = 0;
      var t3 = 0;
      var s = 0; {
         if (absDX < Number.MIN_VALUE) {
            if (pX < this.lowerBound.x || this.upperBound.x < pX) return false;
         }
         else {
            inv_d = 1.0 / dX;
            t1 = (this.lowerBound.x - pX) * inv_d;
            t2 = (this.upperBound.x - pX) * inv_d;
            s = (-1.0);
            if (t1 > t2) {
               t3 = t1;
               t1 = t2;
               t2 = t3;
               s = 1.0;
            }
            if (t1 > tmin) {
               normal.x = s;
               normal.y = 0;
               tmin = t1;
            }
            tmax = Math.min(tmax, t2);
            if (tmin > tmax) return false;
         }
      } {
         if (absDY < Number.MIN_VALUE) {
            if (pY < this.lowerBound.y || this.upperBound.y < pY) return false;
         }
         else {
            inv_d = 1.0 / dY;
            t1 = (this.lowerBound.y - pY) * inv_d;
            t2 = (this.upperBound.y - pY) * inv_d;
            s = (-1.0);
            if (t1 > t2) {
               t3 = t1;
               t1 = t2;
               t2 = t3;
               s = 1.0;
            }
            if (t1 > tmin) {
               normal.y = s;
               normal.x = 0;
               tmin = t1;
            }
            tmax = Math.min(tmax, t2);
            if (tmin > tmax) return false;
         }
      }
      output.fraction = tmin;
      return true;
   }
   b2AABB.prototype.TestOverlap = function (other) {
      var d1X = other.lowerBound.x - this.upperBound.x;
      var d1Y = other.lowerBound.y - this.upperBound.y;
      var d2X = this.lowerBound.x - other.upperBound.x;
      var d2Y = this.lowerBound.y - other.upperBound.y;
      if (d1X > 0.0 || d1Y > 0.0) return false;
      if (d2X > 0.0 || d2Y > 0.0) return false;
      return true;
   }
   b2AABB.Combine = function (aabb1, aabb2) {
      var aabb = new b2AABB();
      aabb.Combine(aabb1, aabb2);
      return aabb;
   }
   b2AABB.prototype.Combine = function (aabb1, aabb2) {
      this.lowerBound.x = Math.min(aabb1.lowerBound.x, aabb2.lowerBound.x);
      this.lowerBound.y = Math.min(aabb1.lowerBound.y, aabb2.lowerBound.y);
      this.upperBound.x = Math.max(aabb1.upperBound.x, aabb2.upperBound.x);
      this.upperBound.y = Math.max(aabb1.upperBound.y, aabb2.upperBound.y);
   }
   b2Bound.b2Bound = function () {};
   b2Bound.prototype.IsLower = function () {
      return (this.value & 1) == 0;
   }
   b2Bound.prototype.IsUpper = function () {
      return (this.value & 1) == 1;
   }
   b2Bound.prototype.Swap = function (b) {
      var tempValue = this.value;
      var tempProxy = this.proxy;
      var tempStabbingCount = this.stabbingCount;
      this.value = b.value;
      this.proxy = b.proxy;
      this.stabbingCount = b.stabbingCount;
      b.value = tempValue;
      b.proxy = tempProxy;
      b.stabbingCount = tempStabbingCount;
   }
   b2BoundValues.b2BoundValues = function () {};
   b2BoundValues.prototype.b2BoundValues = function () {
      this.lowerValues = new Vector_a2j_Number();
      this.lowerValues[0] = 0.0;
      this.lowerValues[1] = 0.0;
      this.upperValues = new Vector_a2j_Number();
      this.upperValues[0] = 0.0;
      this.upperValues[1] = 0.0;
   }
   b2Collision.b2Collision = function () {};
   b2Collision.ClipSegmentToLine = function (vOut, vIn, normal, offset) {
      if (offset === undefined) offset = 0;
      var cv;
      var numOut = 0;
      cv = vIn[0];
      var vIn0 = cv.v;
      cv = vIn[1];
      var vIn1 = cv.v;
      var distance0 = normal.x * vIn0.x + normal.y * vIn0.y - offset;
      var distance1 = normal.x * vIn1.x + normal.y * vIn1.y - offset;
      if (distance0 <= 0.0) vOut[numOut++].Set(vIn[0]);
      if (distance1 <= 0.0) vOut[numOut++].Set(vIn[1]);
      if (distance0 * distance1 < 0.0) {
         var interp = distance0 / (distance0 - distance1);
         cv = vOut[numOut];
         var tVec = cv.v;
         tVec.x = vIn0.x + interp * (vIn1.x - vIn0.x);
         tVec.y = vIn0.y + interp * (vIn1.y - vIn0.y);
         cv = vOut[numOut];
         var cv2;
         if (distance0 > 0.0) {
            cv2 = vIn[0];
            cv.id = cv2.id;
         }
         else {
            cv2 = vIn[1];
            cv.id = cv2.id;
         }++numOut;
      }
      return numOut;
   }
   b2Collision.EdgeSeparation = function (poly1, xf1, edge1, poly2, xf2) {
      if (edge1 === undefined) edge1 = 0;
      var count1 = parseInt(poly1.m_vertexCount);
      var vertices1 = poly1.m_vertices;
      var normals1 = poly1.m_normals;
      var count2 = parseInt(poly2.m_vertexCount);
      var vertices2 = poly2.m_vertices;
      var tMat;
      var tVec;
      tMat = xf1.R;
      tVec = normals1[edge1];
      var normal1WorldX = (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      var normal1WorldY = (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      tMat = xf2.R;
      var normal1X = (tMat.col1.x * normal1WorldX + tMat.col1.y * normal1WorldY);
      var normal1Y = (tMat.col2.x * normal1WorldX + tMat.col2.y * normal1WorldY);
      var index = 0;
      var minDot = Number.MAX_VALUE;
      for (var i = 0; i < count2; ++i) {
         tVec = vertices2[i];
         var dot = tVec.x * normal1X + tVec.y * normal1Y;
         if (dot < minDot) {
            minDot = dot;
            index = i;
         }
      }
      tVec = vertices1[edge1];
      tMat = xf1.R;
      var v1X = xf1.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      var v1Y = xf1.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      tVec = vertices2[index];
      tMat = xf2.R;
      var v2X = xf2.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      var v2Y = xf2.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      v2X -= v1X;
      v2Y -= v1Y;
      var separation = v2X * normal1WorldX + v2Y * normal1WorldY;
      return separation;
   }
   b2Collision.FindMaxSeparation = function (edgeIndex, poly1, xf1, poly2, xf2) {
      var count1 = parseInt(poly1.m_vertexCount);
      var normals1 = poly1.m_normals;
      var tVec;
      var tMat;
      tMat = xf2.R;
      tVec = poly2.m_centroid;
      var dX = xf2.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      var dY = xf2.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      tMat = xf1.R;
      tVec = poly1.m_centroid;
      dX -= xf1.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      dY -= xf1.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      var dLocal1X = (dX * xf1.R.col1.x + dY * xf1.R.col1.y);
      var dLocal1Y = (dX * xf1.R.col2.x + dY * xf1.R.col2.y);
      var edge = 0;
      var maxDot = (-Number.MAX_VALUE);
      for (var i = 0; i < count1; ++i) {
         tVec = normals1[i];
         var dot = (tVec.x * dLocal1X + tVec.y * dLocal1Y);
         if (dot > maxDot) {
            maxDot = dot;
            edge = i;
         }
      }
      var s = b2Collision.EdgeSeparation(poly1, xf1, edge, poly2, xf2);
      var prevEdge = parseInt(edge - 1 >= 0 ? edge - 1 : count1 - 1);
      var sPrev = b2Collision.EdgeSeparation(poly1, xf1, prevEdge, poly2, xf2);
      var nextEdge = parseInt(edge + 1 < count1 ? edge + 1 : 0);
      var sNext = b2Collision.EdgeSeparation(poly1, xf1, nextEdge, poly2, xf2);
      var bestEdge = 0;
      var bestSeparation = 0;
      var increment = 0;
      if (sPrev > s && sPrev > sNext) {
         increment = (-1);
         bestEdge = prevEdge;
         bestSeparation = sPrev;
      }
      else if (sNext > s) {
         increment = 1;
         bestEdge = nextEdge;
         bestSeparation = sNext;
      }
      else {
         edgeIndex[0] = edge;
         return s;
      }
      while (true) {
         if (increment == (-1)) edge = bestEdge - 1 >= 0 ? bestEdge - 1 : count1 - 1;
         else edge = bestEdge + 1 < count1 ? bestEdge + 1 : 0;s = b2Collision.EdgeSeparation(poly1, xf1, edge, poly2, xf2);
         if (s > bestSeparation) {
            bestEdge = edge;
            bestSeparation = s;
         }
         else {
            break;
         }
      }
      edgeIndex[0] = bestEdge;
      return bestSeparation;
   }
   b2Collision.FindIncidentEdge = function (c, poly1, xf1, edge1, poly2, xf2) {
      if (edge1 === undefined) edge1 = 0;
      var count1 = parseInt(poly1.m_vertexCount);
      var normals1 = poly1.m_normals;
      var count2 = parseInt(poly2.m_vertexCount);
      var vertices2 = poly2.m_vertices;
      var normals2 = poly2.m_normals;
      var tMat;
      var tVec;
      tMat = xf1.R;
      tVec = normals1[edge1];
      var normal1X = (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      var normal1Y = (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      tMat = xf2.R;
      var tX = (tMat.col1.x * normal1X + tMat.col1.y * normal1Y);
      normal1Y = (tMat.col2.x * normal1X + tMat.col2.y * normal1Y);
      normal1X = tX;
      var index = 0;
      var minDot = Number.MAX_VALUE;
      for (var i = 0; i < count2; ++i) {
         tVec = normals2[i];
         var dot = (normal1X * tVec.x + normal1Y * tVec.y);
         if (dot < minDot) {
            minDot = dot;
            index = i;
         }
      }
      var tClip;
      var i1 = parseInt(index);
      var i2 = parseInt(i1 + 1 < count2 ? i1 + 1 : 0);
      tClip = c[0];
      tVec = vertices2[i1];
      tMat = xf2.R;
      tClip.v.x = xf2.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      tClip.v.y = xf2.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      tClip.id.features.referenceEdge = edge1;
      tClip.id.features.incidentEdge = i1;
      tClip.id.features.incidentVertex = 0;
      tClip = c[1];
      tVec = vertices2[i2];
      tMat = xf2.R;
      tClip.v.x = xf2.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      tClip.v.y = xf2.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      tClip.id.features.referenceEdge = edge1;
      tClip.id.features.incidentEdge = i2;
      tClip.id.features.incidentVertex = 1;
   }
   b2Collision.MakeClipPointVector = function () {
      var r = new Vector(2);
      r[0] = new ClipVertex();
      r[1] = new ClipVertex();
      return r;
   }
   b2Collision.CollidePolygons = function (manifold, polyA, xfA, polyB, xfB) {
      var cv;
      manifold.m_pointCount = 0;
      var totalRadius = polyA.m_radius + polyB.m_radius;
      var edgeA = 0;
      b2Collision.s_edgeAO[0] = edgeA;
      var separationA = b2Collision.FindMaxSeparation(b2Collision.s_edgeAO, polyA, xfA, polyB, xfB);
      edgeA = b2Collision.s_edgeAO[0];
      if (separationA > totalRadius) return;
      var edgeB = 0;
      b2Collision.s_edgeBO[0] = edgeB;
      var separationB = b2Collision.FindMaxSeparation(b2Collision.s_edgeBO, polyB, xfB, polyA, xfA);
      edgeB = b2Collision.s_edgeBO[0];
      if (separationB > totalRadius) return;
      var poly1;
      var poly2;
      var xf1;
      var xf2;
      var edge1 = 0;
      var flip = 0;
      var k_relativeTol = 0.98;
      var k_absoluteTol = 0.001;
      var tMat;
      if (separationB > k_relativeTol * separationA + k_absoluteTol) {
         poly1 = polyB;
         poly2 = polyA;
         xf1 = xfB;
         xf2 = xfA;
         edge1 = edgeB;
         manifold.m_type = b2Manifold.e_faceB;
         flip = 1;
      }
      else {
         poly1 = polyA;
         poly2 = polyB;
         xf1 = xfA;
         xf2 = xfB;
         edge1 = edgeA;
         manifold.m_type = b2Manifold.e_faceA;
         flip = 0;
      }
      var incidentEdge = b2Collision.s_incidentEdge;
      b2Collision.FindIncidentEdge(incidentEdge, poly1, xf1, edge1, poly2, xf2);
      var count1 = parseInt(poly1.m_vertexCount);
      var vertices1 = poly1.m_vertices;
      var local_v11 = vertices1[edge1];
      var local_v12;
      if (edge1 + 1 < count1) {
         local_v12 = vertices1[parseInt(edge1 + 1)];
      }
      else {
         local_v12 = vertices1[0];
      }
      var localTangent = b2Collision.s_localTangent;
      localTangent.Set(local_v12.x - local_v11.x, local_v12.y - local_v11.y);
      localTangent.Normalize();
      var localNormal = b2Collision.s_localNormal;
      localNormal.x = localTangent.y;
      localNormal.y = (-localTangent.x);
      var planePoint = b2Collision.s_planePoint;
      planePoint.Set(0.5 * (local_v11.x + local_v12.x), 0.5 * (local_v11.y + local_v12.y));
      var tangent = b2Collision.s_tangent;
      tMat = xf1.R;
      tangent.x = (tMat.col1.x * localTangent.x + tMat.col2.x * localTangent.y);
      tangent.y = (tMat.col1.y * localTangent.x + tMat.col2.y * localTangent.y);
      var tangent2 = b2Collision.s_tangent2;
      tangent2.x = (-tangent.x);
      tangent2.y = (-tangent.y);
      var normal = b2Collision.s_normal;
      normal.x = tangent.y;
      normal.y = (-tangent.x);
      var v11 = b2Collision.s_v11;
      var v12 = b2Collision.s_v12;
      v11.x = xf1.position.x + (tMat.col1.x * local_v11.x + tMat.col2.x * local_v11.y);
      v11.y = xf1.position.y + (tMat.col1.y * local_v11.x + tMat.col2.y * local_v11.y);
      v12.x = xf1.position.x + (tMat.col1.x * local_v12.x + tMat.col2.x * local_v12.y);
      v12.y = xf1.position.y + (tMat.col1.y * local_v12.x + tMat.col2.y * local_v12.y);
      var frontOffset = normal.x * v11.x + normal.y * v11.y;
      var sideOffset1 = (-tangent.x * v11.x) - tangent.y * v11.y + totalRadius;
      var sideOffset2 = tangent.x * v12.x + tangent.y * v12.y + totalRadius;
      var clipPoints1 = b2Collision.s_clipPoints1;
      var clipPoints2 = b2Collision.s_clipPoints2;
      var np = 0;
      np = b2Collision.ClipSegmentToLine(clipPoints1, incidentEdge, tangent2, sideOffset1);
      if (np < 2) return;
      np = b2Collision.ClipSegmentToLine(clipPoints2, clipPoints1, tangent, sideOffset2);
      if (np < 2) return;
      manifold.m_localPlaneNormal.SetV(localNormal);
      manifold.m_localPoint.SetV(planePoint);
      var pointCount = 0;
      for (var i = 0; i < b2Settings.b2_maxManifoldPoints; ++i) {
         cv = clipPoints2[i];
         var separation = normal.x * cv.v.x + normal.y * cv.v.y - frontOffset;
         if (separation <= totalRadius) {
            var cp = manifold.m_points[pointCount];
            tMat = xf2.R;
            var tX = cv.v.x - xf2.position.x;
            var tY = cv.v.y - xf2.position.y;
            cp.m_localPoint.x = (tX * tMat.col1.x + tY * tMat.col1.y);
            cp.m_localPoint.y = (tX * tMat.col2.x + tY * tMat.col2.y);
            cp.m_id.Set(cv.id);
            cp.m_id.features.flip = flip;
            ++pointCount;
         }
      }
      manifold.m_pointCount = pointCount;
   }
   b2Collision.CollideCircles = function (manifold, circle1, xf1, circle2, xf2) {
      manifold.m_pointCount = 0;
      var tMat;
      var tVec;
      tMat = xf1.R;
      tVec = circle1.m_p;
      var p1X = xf1.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      var p1Y = xf1.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      tMat = xf2.R;
      tVec = circle2.m_p;
      var p2X = xf2.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      var p2Y = xf2.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      var dX = p2X - p1X;
      var dY = p2Y - p1Y;
      var distSqr = dX * dX + dY * dY;
      var radius = circle1.m_radius + circle2.m_radius;
      if (distSqr > radius * radius) {
         return;
      }
      manifold.m_type = b2Manifold.e_circles;
      manifold.m_localPoint.SetV(circle1.m_p);
      manifold.m_localPlaneNormal.SetZero();
      manifold.m_pointCount = 1;
      manifold.m_points[0].m_localPoint.SetV(circle2.m_p);
      manifold.m_points[0].m_id.key = 0;
   }
   b2Collision.CollidePolygonAndCircle = function (manifold, polygon, xf1, circle, xf2) {
      manifold.m_pointCount = 0;
      var tPoint;
      var dX = 0;
      var dY = 0;
      var positionX = 0;
      var positionY = 0;
      var tVec;
      var tMat;
      tMat = xf2.R;
      tVec = circle.m_p;
      var cX = xf2.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      var cY = xf2.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      dX = cX - xf1.position.x;
      dY = cY - xf1.position.y;
      tMat = xf1.R;
      var cLocalX = (dX * tMat.col1.x + dY * tMat.col1.y);
      var cLocalY = (dX * tMat.col2.x + dY * tMat.col2.y);
      var dist = 0;
      var normalIndex = 0;
      var separation = (-Number.MAX_VALUE);
      var radius = polygon.m_radius + circle.m_radius;
      var vertexCount = parseInt(polygon.m_vertexCount);
      var vertices = polygon.m_vertices;
      var normals = polygon.m_normals;
      for (var i = 0; i < vertexCount; ++i) {
         tVec = vertices[i];
         dX = cLocalX - tVec.x;
         dY = cLocalY - tVec.y;
         tVec = normals[i];
         var s = tVec.x * dX + tVec.y * dY;
         if (s > radius) {
            return;
         }
         if (s > separation) {
            separation = s;
            normalIndex = i;
         }
      }
      var vertIndex1 = parseInt(normalIndex);
      var vertIndex2 = parseInt(vertIndex1 + 1 < vertexCount ? vertIndex1 + 1 : 0);
      var v1 = vertices[vertIndex1];
      var v2 = vertices[vertIndex2];
      if (separation < Number.MIN_VALUE) {
         manifold.m_pointCount = 1;
         manifold.m_type = b2Manifold.e_faceA;
         manifold.m_localPlaneNormal.SetV(normals[normalIndex]);
         manifold.m_localPoint.x = 0.5 * (v1.x + v2.x);
         manifold.m_localPoint.y = 0.5 * (v1.y + v2.y);
         manifold.m_points[0].m_localPoint.SetV(circle.m_p);
         manifold.m_points[0].m_id.key = 0;
         return;
      }
      var u1 = (cLocalX - v1.x) * (v2.x - v1.x) + (cLocalY - v1.y) * (v2.y - v1.y);
      var u2 = (cLocalX - v2.x) * (v1.x - v2.x) + (cLocalY - v2.y) * (v1.y - v2.y);
      if (u1 <= 0.0) {
         if ((cLocalX - v1.x) * (cLocalX - v1.x) + (cLocalY - v1.y) * (cLocalY - v1.y) > radius * radius) return;
         manifold.m_pointCount = 1;
         manifold.m_type = b2Manifold.e_faceA;
         manifold.m_localPlaneNormal.x = cLocalX - v1.x;
         manifold.m_localPlaneNormal.y = cLocalY - v1.y;
         manifold.m_localPlaneNormal.Normalize();
         manifold.m_localPoint.SetV(v1);
         manifold.m_points[0].m_localPoint.SetV(circle.m_p);
         manifold.m_points[0].m_id.key = 0;
      }
      else if (u2 <= 0) {
         if ((cLocalX - v2.x) * (cLocalX - v2.x) + (cLocalY - v2.y) * (cLocalY - v2.y) > radius * radius) return;
         manifold.m_pointCount = 1;
         manifold.m_type = b2Manifold.e_faceA;
         manifold.m_localPlaneNormal.x = cLocalX - v2.x;
         manifold.m_localPlaneNormal.y = cLocalY - v2.y;
         manifold.m_localPlaneNormal.Normalize();
         manifold.m_localPoint.SetV(v2);
         manifold.m_points[0].m_localPoint.SetV(circle.m_p);
         manifold.m_points[0].m_id.key = 0;
      }
      else {
         var faceCenterX = 0.5 * (v1.x + v2.x);
         var faceCenterY = 0.5 * (v1.y + v2.y);
         separation = (cLocalX - faceCenterX) * normals[vertIndex1].x + (cLocalY - faceCenterY) * normals[vertIndex1].y;
         if (separation > radius) return;
         manifold.m_pointCount = 1;
         manifold.m_type = b2Manifold.e_faceA;
         manifold.m_localPlaneNormal.x = normals[vertIndex1].x;
         manifold.m_localPlaneNormal.y = normals[vertIndex1].y;
         manifold.m_localPlaneNormal.Normalize();
         manifold.m_localPoint.Set(faceCenterX, faceCenterY);
         manifold.m_points[0].m_localPoint.SetV(circle.m_p);
         manifold.m_points[0].m_id.key = 0;
      }
   }
   b2Collision.TestOverlap = function (a, b) {
      var t1 = b.lowerBound;
      var t2 = a.upperBound;
      var d1X = t1.x - t2.x;
      var d1Y = t1.y - t2.y;
      t1 = a.lowerBound;
      t2 = b.upperBound;
      var d2X = t1.x - t2.x;
      var d2Y = t1.y - t2.y;
      if (d1X > 0.0 || d1Y > 0.0) return false;
      if (d2X > 0.0 || d2Y > 0.0) return false;
      return true;
   }
   Box2D.postDefs.push(function () {
      Box2D.Collision.b2Collision.s_incidentEdge = b2Collision.MakeClipPointVector();
      Box2D.Collision.b2Collision.s_clipPoints1 = b2Collision.MakeClipPointVector();
      Box2D.Collision.b2Collision.s_clipPoints2 = b2Collision.MakeClipPointVector();
      Box2D.Collision.b2Collision.s_edgeAO = new Vector_a2j_Number(1);
      Box2D.Collision.b2Collision.s_edgeBO = new Vector_a2j_Number(1);
      Box2D.Collision.b2Collision.s_localTangent = new b2Vec2();
      Box2D.Collision.b2Collision.s_localNormal = new b2Vec2();
      Box2D.Collision.b2Collision.s_planePoint = new b2Vec2();
      Box2D.Collision.b2Collision.s_normal = new b2Vec2();
      Box2D.Collision.b2Collision.s_tangent = new b2Vec2();
      Box2D.Collision.b2Collision.s_tangent2 = new b2Vec2();
      Box2D.Collision.b2Collision.s_v11 = new b2Vec2();
      Box2D.Collision.b2Collision.s_v12 = new b2Vec2();
      Box2D.Collision.b2Collision.b2CollidePolyTempVec = new b2Vec2();
      Box2D.Collision.b2Collision.b2_nullFeature = 0x000000ff;
   });
   b2ContactID.b2ContactID = function () {
      this.features = new Features();
   };
   b2ContactID.prototype.b2ContactID = function () {
      this.features._m_id = this;
   }
   b2ContactID.prototype.Set = function (id) {
      this.key = id._key;
   }
   b2ContactID.prototype.Copy = function () {
      var id = new b2ContactID();
      id.key = this.key;
      return id;
   }
   Object.defineProperty(b2ContactID.prototype, 'key', {
      enumerable: false,
      configurable: true,
      get: function () {
         return this._key;
      }
   });
   Object.defineProperty(b2ContactID.prototype, 'key', {
      enumerable: false,
      configurable: true,
      set: function (value) {
         if (value === undefined) value = 0;
         this._key = value;
         this.features._referenceEdge = this._key & 0x000000ff;
         this.features._incidentEdge = ((this._key & 0x0000ff00) >> 8) & 0x000000ff;
         this.features._incidentVertex = ((this._key & 0x00ff0000) >> 16) & 0x000000ff;
         this.features._flip = ((this._key & 0xff000000) >> 24) & 0x000000ff;
      }
   });
   b2ContactPoint.b2ContactPoint = function () {
      this.position = new b2Vec2();
      this.velocity = new b2Vec2();
      this.normal = new b2Vec2();
      this.id = new b2ContactID();
   };
   b2Distance.b2Distance = function () {};
   b2Distance.Distance = function (output, cache, input) {
      ++b2Distance.b2_gjkCalls;
      var proxyA = input.proxyA;
      var proxyB = input.proxyB;
      var transformA = input.transformA;
      var transformB = input.transformB;
      var simplex = b2Distance.s_simplex;
      simplex.ReadCache(cache, proxyA, transformA, proxyB, transformB);
      var vertices = simplex.m_vertices;
      var k_maxIters = 20;
      var saveA = b2Distance.s_saveA;
      var saveB = b2Distance.s_saveB;
      var saveCount = 0;
      var closestPoint = simplex.GetClosestPoint();
      var distanceSqr1 = closestPoint.LengthSquared();
      var distanceSqr2 = distanceSqr1;
      var i = 0;
      var p;
      var iter = 0;
      while (iter < k_maxIters) {
         saveCount = simplex.m_count;
         for (i = 0;
         i < saveCount; i++) {
            saveA[i] = vertices[i].indexA;
            saveB[i] = vertices[i].indexB;
         }
         switch (simplex.m_count) {
         case 1:
            break;
         case 2:
            simplex.Solve2();
            break;
         case 3:
            simplex.Solve3();
            break;
         default:
            b2Settings.b2Assert(false);
         }
         if (simplex.m_count == 3) {
            break;
         }
         p = simplex.GetClosestPoint();
         distanceSqr2 = p.LengthSquared();
         if (distanceSqr2 > distanceSqr1) {}
         distanceSqr1 = distanceSqr2;
         var d = simplex.GetSearchDirection();
         if (d.LengthSquared() < Number.MIN_VALUE * Number.MIN_VALUE) {
            break;
         }
         var vertex = vertices[simplex.m_count];
         vertex.indexA = proxyA.GetSupport(b2Math.MulTMV(transformA.R, d.GetNegative()));
         vertex.wA = b2Math.MulX(transformA, proxyA.GetVertex(vertex.indexA));
         vertex.indexB = proxyB.GetSupport(b2Math.MulTMV(transformB.R, d));
         vertex.wB = b2Math.MulX(transformB, proxyB.GetVertex(vertex.indexB));
         vertex.w = b2Math.SubtractVV(vertex.wB, vertex.wA);
         ++iter;
         ++b2Distance.b2_gjkIters;
         var duplicate = false;
         for (i = 0;
         i < saveCount; i++) {
            if (vertex.indexA == saveA[i] && vertex.indexB == saveB[i]) {
               duplicate = true;
               break;
            }
         }
         if (duplicate) {
            break;
         }++simplex.m_count;
      }
      b2Distance.b2_gjkMaxIters = b2Math.Max(b2Distance.b2_gjkMaxIters, iter);
      simplex.GetWitnessPoints(output.pointA, output.pointB);
      output.distance = b2Math.SubtractVV(output.pointA, output.pointB).Length();
      output.iterations = iter;
      simplex.WriteCache(cache);
      if (input.useRadii) {
         var rA = proxyA.m_radius;
         var rB = proxyB.m_radius;
         if (output.distance > rA + rB && output.distance > Number.MIN_VALUE) {
            output.distance -= rA + rB;
            var normal = b2Math.SubtractVV(output.pointB, output.pointA);
            normal.Normalize();
            output.pointA.x += rA * normal.x;
            output.pointA.y += rA * normal.y;
            output.pointB.x -= rB * normal.x;
            output.pointB.y -= rB * normal.y;
         }
         else {
            p = new b2Vec2();
            p.x = .5 * (output.pointA.x + output.pointB.x);
            p.y = .5 * (output.pointA.y + output.pointB.y);
            output.pointA.x = output.pointB.x = p.x;
            output.pointA.y = output.pointB.y = p.y;
            output.distance = 0.0;
         }
      }
   }
   Box2D.postDefs.push(function () {
      Box2D.Collision.b2Distance.s_simplex = new b2Simplex();
      Box2D.Collision.b2Distance.s_saveA = new Vector_a2j_Number(3);
      Box2D.Collision.b2Distance.s_saveB = new Vector_a2j_Number(3);
   });
   b2DistanceInput.b2DistanceInput = function () {};
   b2DistanceOutput.b2DistanceOutput = function () {
      this.pointA = new b2Vec2();
      this.pointB = new b2Vec2();
   };
   b2DistanceProxy.b2DistanceProxy = function () {};
   b2DistanceProxy.prototype.Set = function (shape) {
      switch (shape.GetType()) {
      case b2Shape.e_circleShape:
         {
            var circle = (shape instanceof b2CircleShape ? shape : null);
            this.m_vertices = new Vector(1, true);
            this.m_vertices[0] = circle.m_p;
            this.m_count = 1;
            this.m_radius = circle.m_radius;
         }
         break;
      case b2Shape.e_polygonShape:
         {
            var polygon = (shape instanceof b2PolygonShape ? shape : null);
            this.m_vertices = polygon.m_vertices;
            this.m_count = polygon.m_vertexCount;
            this.m_radius = polygon.m_radius;
         }
         break;
      default:
         b2Settings.b2Assert(false);
      }
   }
   b2DistanceProxy.prototype.GetSupport = function (d) {
      var bestIndex = 0;
      var bestValue = this.m_vertices[0].x * d.x + this.m_vertices[0].y * d.y;
      for (var i = 1; i < this.m_count; ++i) {
         var value = this.m_vertices[i].x * d.x + this.m_vertices[i].y * d.y;
         if (value > bestValue) {
            bestIndex = i;
            bestValue = value;
         }
      }
      return bestIndex;
   }
   b2DistanceProxy.prototype.GetSupportVertex = function (d) {
      var bestIndex = 0;
      var bestValue = this.m_vertices[0].x * d.x + this.m_vertices[0].y * d.y;
      for (var i = 1; i < this.m_count; ++i) {
         var value = this.m_vertices[i].x * d.x + this.m_vertices[i].y * d.y;
         if (value > bestValue) {
            bestIndex = i;
            bestValue = value;
         }
      }
      return this.m_vertices[bestIndex];
   }
   b2DistanceProxy.prototype.GetVertexCount = function () {
      return this.m_count;
   }
   b2DistanceProxy.prototype.GetVertex = function (index) {
      if (index === undefined) index = 0;
      b2Settings.b2Assert(0 <= index && index < this.m_count);
      return this.m_vertices[index];
   }
   b2DynamicTree.b2DynamicTree = function () {};
   b2DynamicTree.prototype.b2DynamicTree = function () {
      this.m_root = null;
      this.m_freeList = null;
      this.m_path = 0;
      this.m_insertionCount = 0;
   }
   b2DynamicTree.prototype.CreateProxy = function (aabb, userData) {
      var node = this.AllocateNode();
      var extendX = b2Settings.b2_aabbExtension;
      var extendY = b2Settings.b2_aabbExtension;
      node.aabb.lowerBound.x = aabb.lowerBound.x - extendX;
      node.aabb.lowerBound.y = aabb.lowerBound.y - extendY;
      node.aabb.upperBound.x = aabb.upperBound.x + extendX;
      node.aabb.upperBound.y = aabb.upperBound.y + extendY;
      node.userData = userData;
      this.InsertLeaf(node);
      return node;
   }
   b2DynamicTree.prototype.DestroyProxy = function (proxy) {
      this.RemoveLeaf(proxy);
      this.FreeNode(proxy);
   }
   b2DynamicTree.prototype.MoveProxy = function (proxy, aabb, displacement) {
      b2Settings.b2Assert(proxy.IsLeaf());
      if (proxy.aabb.Contains(aabb)) {
         return false;
      }
      this.RemoveLeaf(proxy);
      var extendX = b2Settings.b2_aabbExtension + b2Settings.b2_aabbMultiplier * (displacement.x > 0 ? displacement.x : (-displacement.x));
      var extendY = b2Settings.b2_aabbExtension + b2Settings.b2_aabbMultiplier * (displacement.y > 0 ? displacement.y : (-displacement.y));
      proxy.aabb.lowerBound.x = aabb.lowerBound.x - extendX;
      proxy.aabb.lowerBound.y = aabb.lowerBound.y - extendY;
      proxy.aabb.upperBound.x = aabb.upperBound.x + extendX;
      proxy.aabb.upperBound.y = aabb.upperBound.y + extendY;
      this.InsertLeaf(proxy);
      return true;
   }
   b2DynamicTree.prototype.Rebalance = function (iterations) {
      if (iterations === undefined) iterations = 0;
      if (this.m_root == null) return;
      for (var i = 0; i < iterations; i++) {
         var node = this.m_root;
         var bit = 0;
         while (node.IsLeaf() == false) {
            node = (this.m_path >> bit) & 1 ? node.child2 : node.child1;
            bit = (bit + 1) & 31;
         }++this.m_path;
         this.RemoveLeaf(node);
         this.InsertLeaf(node);
      }
   }
   b2DynamicTree.prototype.GetFatAABB = function (proxy) {
      return proxy.aabb;
   }
   b2DynamicTree.prototype.GetUserData = function (proxy) {
      return proxy.userData;
   }
   b2DynamicTree.prototype.Query = function (callback, aabb) {
      if (this.m_root == null) return;
      var stack = new Vector();
      var count = 0;
      stack[count++] = this.m_root;
      while (count > 0) {
         var node = stack[--count];
         if (node.aabb.TestOverlap(aabb)) {
            if (node.IsLeaf()) {
               var proceed = callback(node);
               if (!proceed) return;
            }
            else {
               stack[count++] = node.child1;
               stack[count++] = node.child2;
            }
         }
      }
   }
   b2DynamicTree.prototype.RayCast = function (callback, input) {
      if (this.m_root == null) return;
      var p1 = input.p1;
      var p2 = input.p2;
      var r = b2Math.SubtractVV(p1, p2);
      r.Normalize();
      var v = b2Math.CrossFV(1.0, r);
      var abs_v = b2Math.AbsV(v);
      var maxFraction = input.maxFraction;
      var segmentAABB = new b2AABB();
      var tX = 0;
      var tY = 0; {
         tX = p1.x + maxFraction * (p2.x - p1.x);
         tY = p1.y + maxFraction * (p2.y - p1.y);
         segmentAABB.lowerBound.x = Math.min(p1.x, tX);
         segmentAABB.lowerBound.y = Math.min(p1.y, tY);
         segmentAABB.upperBound.x = Math.max(p1.x, tX);
         segmentAABB.upperBound.y = Math.max(p1.y, tY);
      }
      var stack = new Vector();
      var count = 0;
      stack[count++] = this.m_root;
      while (count > 0) {
         var node = stack[--count];
         if (node.aabb.TestOverlap(segmentAABB) == false) {
            continue;
         }
         var c = node.aabb.GetCenter();
         var h = node.aabb.GetExtents();
         var separation = Math.abs(v.x * (p1.x - c.x) + v.y * (p1.y - c.y)) - abs_v.x * h.x - abs_v.y * h.y;
         if (separation > 0.0) continue;
         if (node.IsLeaf()) {
            var subInput = new b2RayCastInput();
            subInput.p1 = input.p1;
            subInput.p2 = input.p2;
            subInput.maxFraction = input.maxFraction;
            maxFraction = callback(subInput, node);
            if (maxFraction == 0.0) return;
            if (maxFraction > 0.0) {
               tX = p1.x + maxFraction * (p2.x - p1.x);
               tY = p1.y + maxFraction * (p2.y - p1.y);
               segmentAABB.lowerBound.x = Math.min(p1.x, tX);
               segmentAABB.lowerBound.y = Math.min(p1.y, tY);
               segmentAABB.upperBound.x = Math.max(p1.x, tX);
               segmentAABB.upperBound.y = Math.max(p1.y, tY);
            }
         }
         else {
            stack[count++] = node.child1;
            stack[count++] = node.child2;
         }
      }
   }
   b2DynamicTree.prototype.AllocateNode = function () {
      if (this.m_freeList) {
         var node = this.m_freeList;
         this.m_freeList = node.parent;
         node.parent = null;
         node.child1 = null;
         node.child2 = null;
         return node;
      }
      return new b2DynamicTreeNode();
   }
   b2DynamicTree.prototype.FreeNode = function (node) {
      node.parent = this.m_freeList;
      this.m_freeList = node;
   }
   b2DynamicTree.prototype.InsertLeaf = function (leaf) {
      ++this.m_insertionCount;
      if (this.m_root == null) {
         this.m_root = leaf;
         this.m_root.parent = null;
         return;
      }
      var center = leaf.aabb.GetCenter();
      var sibling = this.m_root;
      if (sibling.IsLeaf() == false) {
         do {
            var child1 = sibling.child1;
            var child2 = sibling.child2;
            var norm1 = Math.abs((child1.aabb.lowerBound.x + child1.aabb.upperBound.x) / 2 - center.x) + Math.abs((child1.aabb.lowerBound.y + child1.aabb.upperBound.y) / 2 - center.y);
            var norm2 = Math.abs((child2.aabb.lowerBound.x + child2.aabb.upperBound.x) / 2 - center.x) + Math.abs((child2.aabb.lowerBound.y + child2.aabb.upperBound.y) / 2 - center.y);
            if (norm1 < norm2) {
               sibling = child1;
            }
            else {
               sibling = child2;
            }
         }
         while (sibling.IsLeaf() == false)
      }
      var node1 = sibling.parent;
      var node2 = this.AllocateNode();
      node2.parent = node1;
      node2.userData = null;
      node2.aabb.Combine(leaf.aabb, sibling.aabb);
      if (node1) {
         if (sibling.parent.child1 == sibling) {
            node1.child1 = node2;
         }
         else {
            node1.child2 = node2;
         }
         node2.child1 = sibling;
         node2.child2 = leaf;
         sibling.parent = node2;
         leaf.parent = node2;
         do {
            if (node1.aabb.Contains(node2.aabb)) break;
            node1.aabb.Combine(node1.child1.aabb, node1.child2.aabb);
            node2 = node1;
            node1 = node1.parent;
         }
         while (node1)
      }
      else {
         node2.child1 = sibling;
         node2.child2 = leaf;
         sibling.parent = node2;
         leaf.parent = node2;
         this.m_root = node2;
      }
   }
   b2DynamicTree.prototype.RemoveLeaf = function (leaf) {
      if (leaf == this.m_root) {
         this.m_root = null;
         return;
      }
      var node2 = leaf.parent;
      var node1 = node2.parent;
      var sibling;
      if (node2.child1 == leaf) {
         sibling = node2.child2;
      }
      else {
         sibling = node2.child1;
      }
      if (node1) {
         if (node1.child1 == node2) {
            node1.child1 = sibling;
         }
         else {
            node1.child2 = sibling;
         }
         sibling.parent = node1;
         this.FreeNode(node2);
         while (node1) {
            var oldAABB = node1.aabb;
            node1.aabb = b2AABB.Combine(node1.child1.aabb, node1.child2.aabb);
            if (oldAABB.Contains(node1.aabb)) break;
            node1 = node1.parent;
         }
      }
      else {
         this.m_root = sibling;
         sibling.parent = null;
         this.FreeNode(node2);
      }
   }
   b2DynamicTreeBroadPhase.b2DynamicTreeBroadPhase = function () {
      this.m_tree = new b2DynamicTree();
      this.m_moveBuffer = new Vector();
      this.m_pairBuffer = new Vector();
      this.m_pairCount = 0;
   };
   b2DynamicTreeBroadPhase.prototype.CreateProxy = function (aabb, userData) {
      var proxy = this.m_tree.CreateProxy(aabb, userData);
      ++this.m_proxyCount;
      this.BufferMove(proxy);
      return proxy;
   }
   b2DynamicTreeBroadPhase.prototype.DestroyProxy = function (proxy) {
      this.UnBufferMove(proxy);
      --this.m_proxyCount;
      this.m_tree.DestroyProxy(proxy);
   }
   b2DynamicTreeBroadPhase.prototype.MoveProxy = function (proxy, aabb, displacement) {
      var buffer = this.m_tree.MoveProxy(proxy, aabb, displacement);
      if (buffer) {
         this.BufferMove(proxy);
      }
   }
   b2DynamicTreeBroadPhase.prototype.TestOverlap = function (proxyA, proxyB) {
      var aabbA = this.m_tree.GetFatAABB(proxyA);
      var aabbB = this.m_tree.GetFatAABB(proxyB);
      return aabbA.TestOverlap(aabbB);
   }
   b2DynamicTreeBroadPhase.prototype.GetUserData = function (proxy) {
      return this.m_tree.GetUserData(proxy);
   }
   b2DynamicTreeBroadPhase.prototype.GetFatAABB = function (proxy) {
      return this.m_tree.GetFatAABB(proxy);
   }
   b2DynamicTreeBroadPhase.prototype.GetProxyCount = function () {
      return this.m_proxyCount;
   }
   b2DynamicTreeBroadPhase.prototype.UpdatePairs = function (callback) {
      var __this = this;
      __this.m_pairCount = 0;
      var i = 0,
         queryProxy;
       function QueryCallback(proxy) {
          if (proxy == queryProxy) return true;
          if (__this.m_pairCount == __this.m_pairBuffer.length) {
             __this.m_pairBuffer[__this.m_pairCount] = new b2DynamicTreePair();
          }
          var pair = __this.m_pairBuffer[__this.m_pairCount];
          pair.proxyA = proxy < queryProxy ? proxy : queryProxy;
          pair.proxyB = proxy >= queryProxy ? proxy : queryProxy;++__this.m_pairCount;
          return true;
       };
      for (i = 0;
      i < __this.m_moveBuffer.length; ++i) {
         queryProxy = __this.m_moveBuffer[i];
         var fatAABB = __this.m_tree.GetFatAABB(queryProxy);
         __this.m_tree.Query(QueryCallback, fatAABB);
      }
      __this.m_moveBuffer.length = 0;
      for (var i = 0; i < __this.m_pairCount;) {
         var primaryPair = __this.m_pairBuffer[i];
         var userDataA = __this.m_tree.GetUserData(primaryPair.proxyA);
         var userDataB = __this.m_tree.GetUserData(primaryPair.proxyB);
         callback(userDataA, userDataB);
         ++i;
         while (i < __this.m_pairCount) {
            var pair = __this.m_pairBuffer[i];
            if (pair.proxyA != primaryPair.proxyA || pair.proxyB != primaryPair.proxyB) {
               break;
            }++i;
         }
      }
   }
   b2DynamicTreeBroadPhase.prototype.Query = function (callback, aabb) {
      this.m_tree.Query(callback, aabb);
   }
   b2DynamicTreeBroadPhase.prototype.RayCast = function (callback, input) {
      this.m_tree.RayCast(callback, input);
   }
   b2DynamicTreeBroadPhase.prototype.Validate = function () {}
   b2DynamicTreeBroadPhase.prototype.Rebalance = function (iterations) {
      if (iterations === undefined) iterations = 0;
      this.m_tree.Rebalance(iterations);
   }
   b2DynamicTreeBroadPhase.prototype.BufferMove = function (proxy) {
      this.m_moveBuffer[this.m_moveBuffer.length] = proxy;
   }
   b2DynamicTreeBroadPhase.prototype.UnBufferMove = function (proxy) {
      var i = parseInt(this.m_moveBuffer.indexOf(proxy));
      this.m_moveBuffer.splice(i, 1);
   }
   b2DynamicTreeBroadPhase.prototype.ComparePairs = function (pair1, pair2) {
      return 0;
   }
   b2DynamicTreeBroadPhase.__implements = {};
   b2DynamicTreeBroadPhase.__implements[IBroadPhase] = true;
   b2DynamicTreeNode.b2DynamicTreeNode = function () {
      this.aabb = new b2AABB();
   };
   b2DynamicTreeNode.prototype.IsLeaf = function () {
      return this.child1 == null;
   }
   b2DynamicTreePair.b2DynamicTreePair = function () {};
   b2Manifold.b2Manifold = function () {
      this.m_pointCount = 0;
   };
   b2Manifold.prototype.b2Manifold = function () {
      this.m_points = new Vector(b2Settings.b2_maxManifoldPoints);
      for (var i = 0; i < b2Settings.b2_maxManifoldPoints; i++) {
         this.m_points[i] = new b2ManifoldPoint();
      }
      this.m_localPlaneNormal = new b2Vec2();
      this.m_localPoint = new b2Vec2();
   }
   b2Manifold.prototype.Reset = function () {
      for (var i = 0; i < b2Settings.b2_maxManifoldPoints; i++) {
         ((this.m_points[i] instanceof b2ManifoldPoint ? this.m_points[i] : null)).Reset();
      }
      this.m_localPlaneNormal.SetZero();
      this.m_localPoint.SetZero();
      this.m_type = 0;
      this.m_pointCount = 0;
   }
   b2Manifold.prototype.Set = function (m) {
      this.m_pointCount = m.m_pointCount;
      for (var i = 0; i < b2Settings.b2_maxManifoldPoints; i++) {
         ((this.m_points[i] instanceof b2ManifoldPoint ? this.m_points[i] : null)).Set(m.m_points[i]);
      }
      this.m_localPlaneNormal.SetV(m.m_localPlaneNormal);
      this.m_localPoint.SetV(m.m_localPoint);
      this.m_type = m.m_type;
   }
   b2Manifold.prototype.Copy = function () {
      var copy = new b2Manifold();
      copy.Set(this);
      return copy;
   }
   Box2D.postDefs.push(function () {
      Box2D.Collision.b2Manifold.e_circles = 0x0001;
      Box2D.Collision.b2Manifold.e_faceA = 0x0002;
      Box2D.Collision.b2Manifold.e_faceB = 0x0004;
   });
   b2ManifoldPoint.b2ManifoldPoint = function () {
      this.m_localPoint = new b2Vec2();
      this.m_id = new b2ContactID();
   };
   b2ManifoldPoint.prototype.b2ManifoldPoint = function () {
      this.Reset();
   }
   b2ManifoldPoint.prototype.Reset = function () {
      this.m_localPoint.SetZero();
      this.m_normalImpulse = 0.0;
      this.m_tangentImpulse = 0.0;
      this.m_id.key = 0;
   }
   b2ManifoldPoint.prototype.Set = function (m) {
      this.m_localPoint.SetV(m.m_localPoint);
      this.m_normalImpulse = m.m_normalImpulse;
      this.m_tangentImpulse = m.m_tangentImpulse;
      this.m_id.Set(m.m_id);
   }
   b2Point.b2Point = function () {
      this.p = new b2Vec2();
   };
   b2Point.prototype.Support = function (xf, vX, vY) {
      if (vX === undefined) vX = 0;
      if (vY === undefined) vY = 0;
      return this.p;
   }
   b2Point.prototype.GetFirstVertex = function (xf) {
      return this.p;
   }
   b2RayCastInput.b2RayCastInput = function () {
      this.p1 = new b2Vec2();
      this.p2 = new b2Vec2();
   };
   b2RayCastInput.prototype.b2RayCastInput = function (p1, p2, maxFraction) {
      if (p1 === undefined) p1 = null;
      if (p2 === undefined) p2 = null;
      if (maxFraction === undefined) maxFraction = 1;
      if (p1) this.p1.SetV(p1);
      if (p2) this.p2.SetV(p2);
      this.maxFraction = maxFraction;
   }
   b2RayCastOutput.b2RayCastOutput = function () {
      this.normal = new b2Vec2();
   };
   b2Segment.b2Segment = function () {
      this.p1 = new b2Vec2();
      this.p2 = new b2Vec2();
   };
   b2Segment.prototype.TestSegment = function (lambda, normal, segment, maxLambda) {
      if (maxLambda === undefined) maxLambda = 0;
      var s = segment.p1;
      var rX = segment.p2.x - s.x;
      var rY = segment.p2.y - s.y;
      var dX = this.p2.x - this.p1.x;
      var dY = this.p2.y - this.p1.y;
      var nX = dY;
      var nY = (-dX);
      var k_slop = 100.0 * Number.MIN_VALUE;
      var denom = (-(rX * nX + rY * nY));
      if (denom > k_slop) {
         var bX = s.x - this.p1.x;
         var bY = s.y - this.p1.y;
         var a = (bX * nX + bY * nY);
         if (0.0 <= a && a <= maxLambda * denom) {
            var mu2 = (-rX * bY) + rY * bX;
            if ((-k_slop * denom) <= mu2 && mu2 <= denom * (1.0 + k_slop)) {
               a /= denom;
               var nLen = Math.sqrt(nX * nX + nY * nY);
               nX /= nLen;
               nY /= nLen;
               lambda[0] = a;
               normal.Set(nX, nY);
               return true;
            }
         }
      }
      return false;
   }
   b2Segment.prototype.Extend = function (aabb) {
      this.ExtendForward(aabb);
      this.ExtendBackward(aabb);
   }
   b2Segment.prototype.ExtendForward = function (aabb) {
      var dX = this.p2.x - this.p1.x;
      var dY = this.p2.y - this.p1.y;
      var lambda = Math.min(dX > 0 ? (aabb.upperBound.x - this.p1.x) / dX : dX < 0 ? (aabb.lowerBound.x - this.p1.x) / dX : Number.POSITIVE_INFINITY,
      dY > 0 ? (aabb.upperBound.y - this.p1.y) / dY : dY < 0 ? (aabb.lowerBound.y - this.p1.y) / dY : Number.POSITIVE_INFINITY);
      this.p2.x = this.p1.x + dX * lambda;
      this.p2.y = this.p1.y + dY * lambda;
   }
   b2Segment.prototype.ExtendBackward = function (aabb) {
      var dX = (-this.p2.x) + this.p1.x;
      var dY = (-this.p2.y) + this.p1.y;
      var lambda = Math.min(dX > 0 ? (aabb.upperBound.x - this.p2.x) / dX : dX < 0 ? (aabb.lowerBound.x - this.p2.x) / dX : Number.POSITIVE_INFINITY,
      dY > 0 ? (aabb.upperBound.y - this.p2.y) / dY : dY < 0 ? (aabb.lowerBound.y - this.p2.y) / dY : Number.POSITIVE_INFINITY);
      this.p1.x = this.p2.x + dX * lambda;
      this.p1.y = this.p2.y + dY * lambda;
   }
   b2SeparationFunction.b2SeparationFunction = function () {
      this.m_localPoint = new b2Vec2();
      this.m_axis = new b2Vec2();
   };
   b2SeparationFunction.prototype.Initialize = function (cache, proxyA, transformA, proxyB, transformB) {
      this.m_proxyA = proxyA;
      this.m_proxyB = proxyB;
      var count = parseInt(cache.count);
      b2Settings.b2Assert(0 < count && count < 3);
      var localPointA;
      var localPointA1;
      var localPointA2;
      var localPointB;
      var localPointB1;
      var localPointB2;
      var pointAX = 0;
      var pointAY = 0;
      var pointBX = 0;
      var pointBY = 0;
      var normalX = 0;
      var normalY = 0;
      var tMat;
      var tVec;
      var s = 0;
      var sgn = 0;
      if (count == 1) {
         this.m_type = b2SeparationFunction.e_points;
         localPointA = this.m_proxyA.GetVertex(cache.indexA[0]);
         localPointB = this.m_proxyB.GetVertex(cache.indexB[0]);
         tVec = localPointA;
         tMat = transformA.R;
         pointAX = transformA.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
         pointAY = transformA.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
         tVec = localPointB;
         tMat = transformB.R;
         pointBX = transformB.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
         pointBY = transformB.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
         this.m_axis.x = pointBX - pointAX;
         this.m_axis.y = pointBY - pointAY;
         this.m_axis.Normalize();
      }
      else if (cache.indexB[0] == cache.indexB[1]) {
         this.m_type = b2SeparationFunction.e_faceA;
         localPointA1 = this.m_proxyA.GetVertex(cache.indexA[0]);
         localPointA2 = this.m_proxyA.GetVertex(cache.indexA[1]);
         localPointB = this.m_proxyB.GetVertex(cache.indexB[0]);
         this.m_localPoint.x = 0.5 * (localPointA1.x + localPointA2.x);
         this.m_localPoint.y = 0.5 * (localPointA1.y + localPointA2.y);
         this.m_axis = b2Math.CrossVF(b2Math.SubtractVV(localPointA2, localPointA1), 1.0);
         this.m_axis.Normalize();
         tVec = this.m_axis;
         tMat = transformA.R;
         normalX = tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
         normalY = tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
         tVec = this.m_localPoint;
         tMat = transformA.R;
         pointAX = transformA.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
         pointAY = transformA.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
         tVec = localPointB;
         tMat = transformB.R;
         pointBX = transformB.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
         pointBY = transformB.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
         s = (pointBX - pointAX) * normalX + (pointBY - pointAY) * normalY;
         if (s < 0.0) {
            this.m_axis.NegativeSelf();
         }
      }
      else if (cache.indexA[0] == cache.indexA[0]) {
         this.m_type = b2SeparationFunction.e_faceB;
         localPointB1 = this.m_proxyB.GetVertex(cache.indexB[0]);
         localPointB2 = this.m_proxyB.GetVertex(cache.indexB[1]);
         localPointA = this.m_proxyA.GetVertex(cache.indexA[0]);
         this.m_localPoint.x = 0.5 * (localPointB1.x + localPointB2.x);
         this.m_localPoint.y = 0.5 * (localPointB1.y + localPointB2.y);
         this.m_axis = b2Math.CrossVF(b2Math.SubtractVV(localPointB2, localPointB1), 1.0);
         this.m_axis.Normalize();
         tVec = this.m_axis;
         tMat = transformB.R;
         normalX = tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
         normalY = tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
         tVec = this.m_localPoint;
         tMat = transformB.R;
         pointBX = transformB.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
         pointBY = transformB.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
         tVec = localPointA;
         tMat = transformA.R;
         pointAX = transformA.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
         pointAY = transformA.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
         s = (pointAX - pointBX) * normalX + (pointAY - pointBY) * normalY;
         if (s < 0.0) {
            this.m_axis.NegativeSelf();
         }
      }
      else {
         localPointA1 = this.m_proxyA.GetVertex(cache.indexA[0]);
         localPointA2 = this.m_proxyA.GetVertex(cache.indexA[1]);
         localPointB1 = this.m_proxyB.GetVertex(cache.indexB[0]);
         localPointB2 = this.m_proxyB.GetVertex(cache.indexB[1]);
         var pA = b2Math.MulX(transformA, localPointA);
         var dA = b2Math.MulMV(transformA.R, b2Math.SubtractVV(localPointA2, localPointA1));
         var pB = b2Math.MulX(transformB, localPointB);
         var dB = b2Math.MulMV(transformB.R, b2Math.SubtractVV(localPointB2, localPointB1));
         var a = dA.x * dA.x + dA.y * dA.y;
         var e = dB.x * dB.x + dB.y * dB.y;
         var r = b2Math.SubtractVV(dB, dA);
         var c = dA.x * r.x + dA.y * r.y;
         var f = dB.x * r.x + dB.y * r.y;
         var b = dA.x * dB.x + dA.y * dB.y;
         var denom = a * e - b * b;
         s = 0.0;
         if (denom != 0.0) {
            s = b2Math.Clamp((b * f - c * e) / denom, 0.0, 1.0);
         }
         var t = (b * s + f) / e;
         if (t < 0.0) {
            t = 0.0;
            s = b2Math.Clamp((b - c) / a, 0.0, 1.0);
         }
         localPointA = new b2Vec2();
         localPointA.x = localPointA1.x + s * (localPointA2.x - localPointA1.x);
         localPointA.y = localPointA1.y + s * (localPointA2.y - localPointA1.y);
         localPointB = new b2Vec2();
         localPointB.x = localPointB1.x + s * (localPointB2.x - localPointB1.x);
         localPointB.y = localPointB1.y + s * (localPointB2.y - localPointB1.y);
         if (s == 0.0 || s == 1.0) {
            this.m_type = b2SeparationFunction.e_faceB;
            this.m_axis = b2Math.CrossVF(b2Math.SubtractVV(localPointB2, localPointB1), 1.0);
            this.m_axis.Normalize();
            this.m_localPoint = localPointB;
            tVec = this.m_axis;
            tMat = transformB.R;
            normalX = tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
            normalY = tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
            tVec = this.m_localPoint;
            tMat = transformB.R;
            pointBX = transformB.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
            pointBY = transformB.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
            tVec = localPointA;
            tMat = transformA.R;
            pointAX = transformA.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
            pointAY = transformA.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
            sgn = (pointAX - pointBX) * normalX + (pointAY - pointBY) * normalY;
            if (s < 0.0) {
               this.m_axis.NegativeSelf();
            }
         }
         else {
            this.m_type = b2SeparationFunction.e_faceA;
            this.m_axis = b2Math.CrossVF(b2Math.SubtractVV(localPointA2, localPointA1), 1.0);
            this.m_localPoint = localPointA;
            tVec = this.m_axis;
            tMat = transformA.R;
            normalX = tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
            normalY = tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
            tVec = this.m_localPoint;
            tMat = transformA.R;
            pointAX = transformA.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
            pointAY = transformA.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
            tVec = localPointB;
            tMat = transformB.R;
            pointBX = transformB.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
            pointBY = transformB.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
            sgn = (pointBX - pointAX) * normalX + (pointBY - pointAY) * normalY;
            if (s < 0.0) {
               this.m_axis.NegativeSelf();
            }
         }
      }
   }
   b2SeparationFunction.prototype.Evaluate = function (transformA, transformB) {
      var axisA;
      var axisB;
      var localPointA;
      var localPointB;
      var pointA;
      var pointB;
      var seperation = 0;
      var normal;
      switch (this.m_type) {
      case b2SeparationFunction.e_points:
         {
            axisA = b2Math.MulTMV(transformA.R, this.m_axis);
            axisB = b2Math.MulTMV(transformB.R, this.m_axis.GetNegative());
            localPointA = this.m_proxyA.GetSupportVertex(axisA);
            localPointB = this.m_proxyB.GetSupportVertex(axisB);
            pointA = b2Math.MulX(transformA, localPointA);
            pointB = b2Math.MulX(transformB, localPointB);
            seperation = (pointB.x - pointA.x) * this.m_axis.x + (pointB.y - pointA.y) * this.m_axis.y;
            return seperation;
         }
      case b2SeparationFunction.e_faceA:
         {
            normal = b2Math.MulMV(transformA.R, this.m_axis);
            pointA = b2Math.MulX(transformA, this.m_localPoint);
            axisB = b2Math.MulTMV(transformB.R, normal.GetNegative());
            localPointB = this.m_proxyB.GetSupportVertex(axisB);
            pointB = b2Math.MulX(transformB, localPointB);
            seperation = (pointB.x - pointA.x) * normal.x + (pointB.y - pointA.y) * normal.y;
            return seperation;
         }
      case b2SeparationFunction.e_faceB:
         {
            normal = b2Math.MulMV(transformB.R, this.m_axis);
            pointB = b2Math.MulX(transformB, this.m_localPoint);
            axisA = b2Math.MulTMV(transformA.R, normal.GetNegative());
            localPointA = this.m_proxyA.GetSupportVertex(axisA);
            pointA = b2Math.MulX(transformA, localPointA);
            seperation = (pointA.x - pointB.x) * normal.x + (pointA.y - pointB.y) * normal.y;
            return seperation;
         }
      default:
         b2Settings.b2Assert(false);
         return 0.0;
      }
   }
   Box2D.postDefs.push(function () {
      Box2D.Collision.b2SeparationFunction.e_points = 0x01;
      Box2D.Collision.b2SeparationFunction.e_faceA = 0x02;
      Box2D.Collision.b2SeparationFunction.e_faceB = 0x04;
   });
   b2Simplex.b2Simplex = function () {
      this.m_v1 = new b2SimplexVertex();
      this.m_v2 = new b2SimplexVertex();
      this.m_v3 = new b2SimplexVertex();
      this.m_vertices = new Vector(3);
   };
   b2Simplex.prototype.b2Simplex = function () {
      this.m_vertices[0] = this.m_v1;
      this.m_vertices[1] = this.m_v2;
      this.m_vertices[2] = this.m_v3;
   }
   b2Simplex.prototype.ReadCache = function (cache, proxyA, transformA, proxyB, transformB) {
      b2Settings.b2Assert(0 <= cache.count && cache.count <= 3);
      var wALocal;
      var wBLocal;
      this.m_count = cache.count;
      var vertices = this.m_vertices;
      for (var i = 0; i < this.m_count; i++) {
         var v = vertices[i];
         v.indexA = cache.indexA[i];
         v.indexB = cache.indexB[i];
         wALocal = proxyA.GetVertex(v.indexA);
         wBLocal = proxyB.GetVertex(v.indexB);
         v.wA = b2Math.MulX(transformA, wALocal);
         v.wB = b2Math.MulX(transformB, wBLocal);
         v.w = b2Math.SubtractVV(v.wB, v.wA);
         v.a = 0;
      }
      if (this.m_count > 1) {
         var metric1 = cache.metric;
         var metric2 = this.GetMetric();
         if (metric2 < .5 * metric1 || 2.0 * metric1 < metric2 || metric2 < Number.MIN_VALUE) {
            this.m_count = 0;
         }
      }
      if (this.m_count == 0) {
         v = vertices[0];
         v.indexA = 0;
         v.indexB = 0;
         wALocal = proxyA.GetVertex(0);
         wBLocal = proxyB.GetVertex(0);
         v.wA = b2Math.MulX(transformA, wALocal);
         v.wB = b2Math.MulX(transformB, wBLocal);
         v.w = b2Math.SubtractVV(v.wB, v.wA);
         this.m_count = 1;
      }
   }
   b2Simplex.prototype.WriteCache = function (cache) {
      cache.metric = this.GetMetric();
      cache.count = Box2D.parseUInt(this.m_count);
      var vertices = this.m_vertices;
      for (var i = 0; i < this.m_count; i++) {
         cache.indexA[i] = Box2D.parseUInt(vertices[i].indexA);
         cache.indexB[i] = Box2D.parseUInt(vertices[i].indexB);
      }
   }
   b2Simplex.prototype.GetSearchDirection = function () {
      switch (this.m_count) {
      case 1:
         return this.m_v1.w.GetNegative();
      case 2:
         {
            var e12 = b2Math.SubtractVV(this.m_v2.w, this.m_v1.w);
            var sgn = b2Math.CrossVV(e12, this.m_v1.w.GetNegative());
            if (sgn > 0.0) {
               return b2Math.CrossFV(1.0, e12);
            }
            else {
               return b2Math.CrossVF(e12, 1.0);
            }
         }
      default:
         b2Settings.b2Assert(false);
         return new b2Vec2();
      }
   }
   b2Simplex.prototype.GetClosestPoint = function () {
      switch (this.m_count) {
      case 0:
         b2Settings.b2Assert(false);
         return new b2Vec2();
      case 1:
         return this.m_v1.w;
      case 2:
         return new b2Vec2(this.m_v1.a * this.m_v1.w.x + this.m_v2.a * this.m_v2.w.x, this.m_v1.a * this.m_v1.w.y + this.m_v2.a * this.m_v2.w.y);
      default:
         b2Settings.b2Assert(false);
         return new b2Vec2();
      }
   }
   b2Simplex.prototype.GetWitnessPoints = function (pA, pB) {
      switch (this.m_count) {
      case 0:
         b2Settings.b2Assert(false);
         break;
      case 1:
         pA.SetV(this.m_v1.wA);
         pB.SetV(this.m_v1.wB);
         break;
      case 2:
         pA.x = this.m_v1.a * this.m_v1.wA.x + this.m_v2.a * this.m_v2.wA.x;
         pA.y = this.m_v1.a * this.m_v1.wA.y + this.m_v2.a * this.m_v2.wA.y;
         pB.x = this.m_v1.a * this.m_v1.wB.x + this.m_v2.a * this.m_v2.wB.x;
         pB.y = this.m_v1.a * this.m_v1.wB.y + this.m_v2.a * this.m_v2.wB.y;
         break;
      case 3:
         pB.x = pA.x = this.m_v1.a * this.m_v1.wA.x + this.m_v2.a * this.m_v2.wA.x + this.m_v3.a * this.m_v3.wA.x;
         pB.y = pA.y = this.m_v1.a * this.m_v1.wA.y + this.m_v2.a * this.m_v2.wA.y + this.m_v3.a * this.m_v3.wA.y;
         break;
      default:
         b2Settings.b2Assert(false);
         break;
      }
   }
   b2Simplex.prototype.GetMetric = function () {
      switch (this.m_count) {
      case 0:
         b2Settings.b2Assert(false);
         return 0.0;
      case 1:
         return 0.0;
      case 2:
         return b2Math.SubtractVV(this.m_v1.w, this.m_v2.w).Length();
      case 3:
         return b2Math.CrossVV(b2Math.SubtractVV(this.m_v2.w, this.m_v1.w), b2Math.SubtractVV(this.m_v3.w, this.m_v1.w));
      default:
         b2Settings.b2Assert(false);
         return 0.0;
      }
   }
   b2Simplex.prototype.Solve2 = function () {
      var w1 = this.m_v1.w;
      var w2 = this.m_v2.w;
      var e12 = b2Math.SubtractVV(w2, w1);
      var d12_2 = (-(w1.x * e12.x + w1.y * e12.y));
      if (d12_2 <= 0.0) {
         this.m_v1.a = 1.0;
         this.m_count = 1;
         return;
      }
      var d12_1 = (w2.x * e12.x + w2.y * e12.y);
      if (d12_1 <= 0.0) {
         this.m_v2.a = 1.0;
         this.m_count = 1;
         this.m_v1.Set(this.m_v2);
         return;
      }
      var inv_d12 = 1.0 / (d12_1 + d12_2);
      this.m_v1.a = d12_1 * inv_d12;
      this.m_v2.a = d12_2 * inv_d12;
      this.m_count = 2;
   }
   b2Simplex.prototype.Solve3 = function () {
      var w1 = this.m_v1.w;
      var w2 = this.m_v2.w;
      var w3 = this.m_v3.w;
      var e12 = b2Math.SubtractVV(w2, w1);
      var w1e12 = b2Math.Dot(w1, e12);
      var w2e12 = b2Math.Dot(w2, e12);
      var d12_1 = w2e12;
      var d12_2 = (-w1e12);
      var e13 = b2Math.SubtractVV(w3, w1);
      var w1e13 = b2Math.Dot(w1, e13);
      var w3e13 = b2Math.Dot(w3, e13);
      var d13_1 = w3e13;
      var d13_2 = (-w1e13);
      var e23 = b2Math.SubtractVV(w3, w2);
      var w2e23 = b2Math.Dot(w2, e23);
      var w3e23 = b2Math.Dot(w3, e23);
      var d23_1 = w3e23;
      var d23_2 = (-w2e23);
      var n123 = b2Math.CrossVV(e12, e13);
      var d123_1 = n123 * b2Math.CrossVV(w2, w3);
      var d123_2 = n123 * b2Math.CrossVV(w3, w1);
      var d123_3 = n123 * b2Math.CrossVV(w1, w2);
      if (d12_2 <= 0.0 && d13_2 <= 0.0) {
         this.m_v1.a = 1.0;
         this.m_count = 1;
         return;
      }
      if (d12_1 > 0.0 && d12_2 > 0.0 && d123_3 <= 0.0) {
         var inv_d12 = 1.0 / (d12_1 + d12_2);
         this.m_v1.a = d12_1 * inv_d12;
         this.m_v2.a = d12_2 * inv_d12;
         this.m_count = 2;
         return;
      }
      if (d13_1 > 0.0 && d13_2 > 0.0 && d123_2 <= 0.0) {
         var inv_d13 = 1.0 / (d13_1 + d13_2);
         this.m_v1.a = d13_1 * inv_d13;
         this.m_v3.a = d13_2 * inv_d13;
         this.m_count = 2;
         this.m_v2.Set(this.m_v3);
         return;
      }
      if (d12_1 <= 0.0 && d23_2 <= 0.0) {
         this.m_v2.a = 1.0;
         this.m_count = 1;
         this.m_v1.Set(this.m_v2);
         return;
      }
      if (d13_1 <= 0.0 && d23_1 <= 0.0) {
         this.m_v3.a = 1.0;
         this.m_count = 1;
         this.m_v1.Set(this.m_v3);
         return;
      }
      if (d23_1 > 0.0 && d23_2 > 0.0 && d123_1 <= 0.0) {
         var inv_d23 = 1.0 / (d23_1 + d23_2);
         this.m_v2.a = d23_1 * inv_d23;
         this.m_v3.a = d23_2 * inv_d23;
         this.m_count = 2;
         this.m_v1.Set(this.m_v3);
         return;
      }
      var inv_d123 = 1.0 / (d123_1 + d123_2 + d123_3);
      this.m_v1.a = d123_1 * inv_d123;
      this.m_v2.a = d123_2 * inv_d123;
      this.m_v3.a = d123_3 * inv_d123;
      this.m_count = 3;
   }
   b2SimplexCache.b2SimplexCache = function () {
      this.indexA = new Vector_a2j_Number(3);
      this.indexB = new Vector_a2j_Number(3);
   };
   b2SimplexVertex.b2SimplexVertex = function () {};
   b2SimplexVertex.prototype.Set = function (other) {
      this.wA.SetV(other.wA);
      this.wB.SetV(other.wB);
      this.w.SetV(other.w);
      this.a = other.a;
      this.indexA = other.indexA;
      this.indexB = other.indexB;
   }
   b2TimeOfImpact.b2TimeOfImpact = function () {};
   b2TimeOfImpact.TimeOfImpact = function (input) {
      ++b2TimeOfImpact.b2_toiCalls;
      var proxyA = input.proxyA;
      var proxyB = input.proxyB;
      var sweepA = input.sweepA;
      var sweepB = input.sweepB;
      b2Settings.b2Assert(sweepA.t0 == sweepB.t0);
      b2Settings.b2Assert(1.0 - sweepA.t0 > Number.MIN_VALUE);
      var radius = proxyA.m_radius + proxyB.m_radius;
      var tolerance = input.tolerance;
      var alpha = 0.0;
      var k_maxIterations = 1000;
      var iter = 0;
      var target = 0.0;
      b2TimeOfImpact.s_cache.count = 0;
      b2TimeOfImpact.s_distanceInput.useRadii = false;
      for (;;) {
         sweepA.GetTransform(b2TimeOfImpact.s_xfA, alpha);
         sweepB.GetTransform(b2TimeOfImpact.s_xfB, alpha);
         b2TimeOfImpact.s_distanceInput.proxyA = proxyA;
         b2TimeOfImpact.s_distanceInput.proxyB = proxyB;
         b2TimeOfImpact.s_distanceInput.transformA = b2TimeOfImpact.s_xfA;
         b2TimeOfImpact.s_distanceInput.transformB = b2TimeOfImpact.s_xfB;
         b2Distance.Distance(b2TimeOfImpact.s_distanceOutput, b2TimeOfImpact.s_cache, b2TimeOfImpact.s_distanceInput);
         if (b2TimeOfImpact.s_distanceOutput.distance <= 0.0) {
            alpha = 1.0;
            break;
         }
         b2TimeOfImpact.s_fcn.Initialize(b2TimeOfImpact.s_cache, proxyA, b2TimeOfImpact.s_xfA, proxyB, b2TimeOfImpact.s_xfB);
         var separation = b2TimeOfImpact.s_fcn.Evaluate(b2TimeOfImpact.s_xfA, b2TimeOfImpact.s_xfB);
         if (separation <= 0.0) {
            alpha = 1.0;
            break;
         }
         if (iter == 0) {
            if (separation > radius) {
               target = b2Math.Max(radius - tolerance, 0.75 * radius);
            }
            else {
               target = b2Math.Max(separation - tolerance, 0.02 * radius);
            }
         }
         if (separation - target < 0.5 * tolerance) {
            if (iter == 0) {
               alpha = 1.0;
               break;
            }
            break;
         }
         var newAlpha = alpha; {
            var x1 = alpha;
            var x2 = 1.0;
            var f1 = separation;
            sweepA.GetTransform(b2TimeOfImpact.s_xfA, x2);
            sweepB.GetTransform(b2TimeOfImpact.s_xfB, x2);
            var f2 = b2TimeOfImpact.s_fcn.Evaluate(b2TimeOfImpact.s_xfA, b2TimeOfImpact.s_xfB);
            if (f2 >= target) {
               alpha = 1.0;
               break;
            }
            var rootIterCount = 0;
            for (;;) {
               var x = 0;
               if (rootIterCount & 1) {
                  x = x1 + (target - f1) * (x2 - x1) / (f2 - f1);
               }
               else {
                  x = 0.5 * (x1 + x2);
               }
               sweepA.GetTransform(b2TimeOfImpact.s_xfA, x);
               sweepB.GetTransform(b2TimeOfImpact.s_xfB, x);
               var f = b2TimeOfImpact.s_fcn.Evaluate(b2TimeOfImpact.s_xfA, b2TimeOfImpact.s_xfB);
               if (b2Math.Abs(f - target) < 0.025 * tolerance) {
                  newAlpha = x;
                  break;
               }
               if (f > target) {
                  x1 = x;
                  f1 = f;
               }
               else {
                  x2 = x;
                  f2 = f;
               }++rootIterCount;
               ++b2TimeOfImpact.b2_toiRootIters;
               if (rootIterCount == 50) {
                  break;
               }
            }
            b2TimeOfImpact.b2_toiMaxRootIters = b2Math.Max(b2TimeOfImpact.b2_toiMaxRootIters, rootIterCount);
         }
         if (newAlpha < (1.0 + 100.0 * Number.MIN_VALUE) * alpha) {
            break;
         }
         alpha = newAlpha;
         iter++;
         ++b2TimeOfImpact.b2_toiIters;
         if (iter == k_maxIterations) {
            break;
         }
      }
      b2TimeOfImpact.b2_toiMaxIters = b2Math.Max(b2TimeOfImpact.b2_toiMaxIters, iter);
      return alpha;
   }
   Box2D.postDefs.push(function () {
      Box2D.Collision.b2TimeOfImpact.b2_toiCalls = 0;
      Box2D.Collision.b2TimeOfImpact.b2_toiIters = 0;
      Box2D.Collision.b2TimeOfImpact.b2_toiMaxIters = 0;
      Box2D.Collision.b2TimeOfImpact.b2_toiRootIters = 0;
      Box2D.Collision.b2TimeOfImpact.b2_toiMaxRootIters = 0;
      Box2D.Collision.b2TimeOfImpact.s_cache = new b2SimplexCache();
      Box2D.Collision.b2TimeOfImpact.s_distanceInput = new b2DistanceInput();
      Box2D.Collision.b2TimeOfImpact.s_xfA = new b2Transform();
      Box2D.Collision.b2TimeOfImpact.s_xfB = new b2Transform();
      Box2D.Collision.b2TimeOfImpact.s_fcn = new b2SeparationFunction();
      Box2D.Collision.b2TimeOfImpact.s_distanceOutput = new b2DistanceOutput();
   });
   b2TOIInput.b2TOIInput = function () {
      this.proxyA = new b2DistanceProxy();
      this.proxyB = new b2DistanceProxy();
      this.sweepA = new b2Sweep();
      this.sweepB = new b2Sweep();
   };
   b2WorldManifold.b2WorldManifold = function () {
      this.m_normal = new b2Vec2();
   };
   b2WorldManifold.prototype.b2WorldManifold = function () {
      this.m_points = new Vector(b2Settings.b2_maxManifoldPoints);
      for (var i = 0; i < b2Settings.b2_maxManifoldPoints; i++) {
         this.m_points[i] = new b2Vec2();
      }
   }
   b2WorldManifold.prototype.Initialize = function (manifold, xfA, radiusA, xfB, radiusB) {
      if (radiusA === undefined) radiusA = 0;
      if (radiusB === undefined) radiusB = 0;
      if (manifold.m_pointCount == 0) {
         return;
      }
      var i = 0;
      var tVec;
      var tMat;
      var normalX = 0;
      var normalY = 0;
      var planePointX = 0;
      var planePointY = 0;
      var clipPointX = 0;
      var clipPointY = 0;
      switch (manifold.m_type) {
      case b2Manifold.e_circles:
         {
            tMat = xfA.R;
            tVec = manifold.m_localPoint;
            var pointAX = xfA.position.x + tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
            var pointAY = xfA.position.y + tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
            tMat = xfB.R;
            tVec = manifold.m_points[0].m_localPoint;
            var pointBX = xfB.position.x + tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
            var pointBY = xfB.position.y + tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
            var dX = pointBX - pointAX;
            var dY = pointBY - pointAY;
            var d2 = dX * dX + dY * dY;
            if (d2 > Number.MIN_VALUE * Number.MIN_VALUE) {
               var d = Math.sqrt(d2);
               this.m_normal.x = dX / d;
               this.m_normal.y = dY / d;
            }
            else {
               this.m_normal.x = 1;
               this.m_normal.y = 0;
            }
            var cAX = pointAX + radiusA * this.m_normal.x;
            var cAY = pointAY + radiusA * this.m_normal.y;
            var cBX = pointBX - radiusB * this.m_normal.x;
            var cBY = pointBY - radiusB * this.m_normal.y;
            this.m_points[0].x = 0.5 * (cAX + cBX);
            this.m_points[0].y = 0.5 * (cAY + cBY);
         }
         break;
      case b2Manifold.e_faceA:
         {
            tMat = xfA.R;
            tVec = manifold.m_localPlaneNormal;
            normalX = tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
            normalY = tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
            tMat = xfA.R;
            tVec = manifold.m_localPoint;
            planePointX = xfA.position.x + tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
            planePointY = xfA.position.y + tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
            this.m_normal.x = normalX;
            this.m_normal.y = normalY;
            for (i = 0;
            i < manifold.m_pointCount; i++) {
               tMat = xfB.R;
               tVec = manifold.m_points[i].m_localPoint;
               clipPointX = xfB.position.x + tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
               clipPointY = xfB.position.y + tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
               this.m_points[i].x = clipPointX + 0.5 * (radiusA - (clipPointX - planePointX) * normalX - (clipPointY - planePointY) * normalY - radiusB) * normalX;
               this.m_points[i].y = clipPointY + 0.5 * (radiusA - (clipPointX - planePointX) * normalX - (clipPointY - planePointY) * normalY - radiusB) * normalY;
            }
         }
         break;
      case b2Manifold.e_faceB:
         {
            tMat = xfB.R;
            tVec = manifold.m_localPlaneNormal;
            normalX = tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
            normalY = tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
            tMat = xfB.R;
            tVec = manifold.m_localPoint;
            planePointX = xfB.position.x + tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
            planePointY = xfB.position.y + tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
            this.m_normal.x = (-normalX);
            this.m_normal.y = (-normalY);
            for (i = 0;
            i < manifold.m_pointCount; i++) {
               tMat = xfA.R;
               tVec = manifold.m_points[i].m_localPoint;
               clipPointX = xfA.position.x + tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
               clipPointY = xfA.position.y + tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
               this.m_points[i].x = clipPointX + 0.5 * (radiusB - (clipPointX - planePointX) * normalX - (clipPointY - planePointY) * normalY - radiusA) * normalX;
               this.m_points[i].y = clipPointY + 0.5 * (radiusB - (clipPointX - planePointX) * normalX - (clipPointY - planePointY) * normalY - radiusA) * normalY;
            }
         }
         break;
      }
   }
   ClipVertex.ClipVertex = function () {
      this.v = new b2Vec2();
      this.id = new b2ContactID();
   };
   ClipVertex.prototype.Set = function (other) {
      this.v.SetV(other.v);
      this.id.Set(other.id);
   }
   Features.Features = function () {};
   Object.defineProperty(Features.prototype, 'referenceEdge', {
      enumerable: false,
      configurable: true,
      get: function () {
         return this._referenceEdge;
      }
   });
   Object.defineProperty(Features.prototype, 'referenceEdge', {
      enumerable: false,
      configurable: true,
      set: function (value) {
         if (value === undefined) value = 0;
         this._referenceEdge = value;
         this._m_id._key = (this._m_id._key & 0xffffff00) | (this._referenceEdge & 0x000000ff);
      }
   });
   Object.defineProperty(Features.prototype, 'incidentEdge', {
      enumerable: false,
      configurable: true,
      get: function () {
         return this._incidentEdge;
      }
   });
   Object.defineProperty(Features.prototype, 'incidentEdge', {
      enumerable: false,
      configurable: true,
      set: function (value) {
         if (value === undefined) value = 0;
         this._incidentEdge = value;
         this._m_id._key = (this._m_id._key & 0xffff00ff) | ((this._incidentEdge << 8) & 0x0000ff00);
      }
   });
   Object.defineProperty(Features.prototype, 'incidentVertex', {
      enumerable: false,
      configurable: true,
      get: function () {
         return this._incidentVertex;
      }
   });
   Object.defineProperty(Features.prototype, 'incidentVertex', {
      enumerable: false,
      configurable: true,
      set: function (value) {
         if (value === undefined) value = 0;
         this._incidentVertex = value;
         this._m_id._key = (this._m_id._key & 0xff00ffff) | ((this._incidentVertex << 16) & 0x00ff0000);
      }
   });
   Object.defineProperty(Features.prototype, 'flip', {
      enumerable: false,
      configurable: true,
      get: function () {
         return this._flip;
      }
   });
   Object.defineProperty(Features.prototype, 'flip', {
      enumerable: false,
      configurable: true,
      set: function (value) {
         if (value === undefined) value = 0;
         this._flip = value;
         this._m_id._key = (this._m_id._key & 0x00ffffff) | ((this._flip << 24) & 0xff000000);
      }
   });
})();
(function () {
   var b2Color = Box2D.Common.b2Color,
      b2internal = Box2D.Common.b2internal,
      b2Settings = Box2D.Common.b2Settings,
      b2CircleShape = Box2D.Collision.Shapes.b2CircleShape,
      b2EdgeChainDef = Box2D.Collision.Shapes.b2EdgeChainDef,
      b2EdgeShape = Box2D.Collision.Shapes.b2EdgeShape,
      b2MassData = Box2D.Collision.Shapes.b2MassData,
      b2PolygonShape = Box2D.Collision.Shapes.b2PolygonShape,
      b2Shape = Box2D.Collision.Shapes.b2Shape,
      b2Mat22 = Box2D.Common.Math.b2Mat22,
      b2Mat33 = Box2D.Common.Math.b2Mat33,
      b2Math = Box2D.Common.Math.b2Math,
      b2Sweep = Box2D.Common.Math.b2Sweep,
      b2Transform = Box2D.Common.Math.b2Transform,
      b2Vec2 = Box2D.Common.Math.b2Vec2,
      b2Vec3 = Box2D.Common.Math.b2Vec3,
      b2Body = Box2D.Dynamics.b2Body,
      b2BodyDef = Box2D.Dynamics.b2BodyDef,
      b2ContactFilter = Box2D.Dynamics.b2ContactFilter,
      b2ContactImpulse = Box2D.Dynamics.b2ContactImpulse,
      b2ContactListener = Box2D.Dynamics.b2ContactListener,
      b2ContactManager = Box2D.Dynamics.b2ContactManager,
      b2DebugDraw = Box2D.Dynamics.b2DebugDraw,
      b2DestructionListener = Box2D.Dynamics.b2DestructionListener,
      b2FilterData = Box2D.Dynamics.b2FilterData,
      b2Fixture = Box2D.Dynamics.b2Fixture,
      b2FixtureDef = Box2D.Dynamics.b2FixtureDef,
      b2Island = Box2D.Dynamics.b2Island,
      b2TimeStep = Box2D.Dynamics.b2TimeStep,
      b2World = Box2D.Dynamics.b2World,
      b2AABB = Box2D.Collision.b2AABB,
      b2Bound = Box2D.Collision.b2Bound,
      b2BoundValues = Box2D.Collision.b2BoundValues,
      b2Collision = Box2D.Collision.b2Collision,
      b2ContactID = Box2D.Collision.b2ContactID,
      b2ContactPoint = Box2D.Collision.b2ContactPoint,
      b2Distance = Box2D.Collision.b2Distance,
      b2DistanceInput = Box2D.Collision.b2DistanceInput,
      b2DistanceOutput = Box2D.Collision.b2DistanceOutput,
      b2DistanceProxy = Box2D.Collision.b2DistanceProxy,
      b2DynamicTree = Box2D.Collision.b2DynamicTree,
      b2DynamicTreeBroadPhase = Box2D.Collision.b2DynamicTreeBroadPhase,
      b2DynamicTreeNode = Box2D.Collision.b2DynamicTreeNode,
      b2DynamicTreePair = Box2D.Collision.b2DynamicTreePair,
      b2Manifold = Box2D.Collision.b2Manifold,
      b2ManifoldPoint = Box2D.Collision.b2ManifoldPoint,
      b2Point = Box2D.Collision.b2Point,
      b2RayCastInput = Box2D.Collision.b2RayCastInput,
      b2RayCastOutput = Box2D.Collision.b2RayCastOutput,
      b2Segment = Box2D.Collision.b2Segment,
      b2SeparationFunction = Box2D.Collision.b2SeparationFunction,
      b2Simplex = Box2D.Collision.b2Simplex,
      b2SimplexCache = Box2D.Collision.b2SimplexCache,
      b2SimplexVertex = Box2D.Collision.b2SimplexVertex,
      b2TimeOfImpact = Box2D.Collision.b2TimeOfImpact,
      b2TOIInput = Box2D.Collision.b2TOIInput,
      b2WorldManifold = Box2D.Collision.b2WorldManifold,
      ClipVertex = Box2D.Collision.ClipVertex,
      Features = Box2D.Collision.Features,
      IBroadPhase = Box2D.Collision.IBroadPhase;

   Box2D.inherit(b2CircleShape, Box2D.Collision.Shapes.b2Shape);
   b2CircleShape.prototype.__super = Box2D.Collision.Shapes.b2Shape.prototype;
   b2CircleShape.b2CircleShape = function () {
      Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this, arguments);
      this.m_p = new b2Vec2();
   };
   b2CircleShape.prototype.Copy = function () {
      var s = new b2CircleShape();
      s.Set(this);
      return s;
   }
   b2CircleShape.prototype.Set = function (other) {
      this.__super.Set.call(this, other);
      if (Box2D.is(other, b2CircleShape)) {
         var other2 = (other instanceof b2CircleShape ? other : null);
         this.m_p.SetV(other2.m_p);
      }
   }
   b2CircleShape.prototype.TestPoint = function (transform, p) {
      var tMat = transform.R;
      var dX = transform.position.x + (tMat.col1.x * this.m_p.x + tMat.col2.x * this.m_p.y);
      var dY = transform.position.y + (tMat.col1.y * this.m_p.x + tMat.col2.y * this.m_p.y);
      dX = p.x - dX;
      dY = p.y - dY;
      return (dX * dX + dY * dY) <= this.m_radius * this.m_radius;
   }
   b2CircleShape.prototype.RayCast = function (output, input, transform) {
      var tMat = transform.R;
      var positionX = transform.position.x + (tMat.col1.x * this.m_p.x + tMat.col2.x * this.m_p.y);
      var positionY = transform.position.y + (tMat.col1.y * this.m_p.x + tMat.col2.y * this.m_p.y);
      var sX = input.p1.x - positionX;
      var sY = input.p1.y - positionY;
      var b = (sX * sX + sY * sY) - this.m_radius * this.m_radius;
      var rX = input.p2.x - input.p1.x;
      var rY = input.p2.y - input.p1.y;
      var c = (sX * rX + sY * rY);
      var rr = (rX * rX + rY * rY);
      var sigma = c * c - rr * b;
      if (sigma < 0.0 || rr < Number.MIN_VALUE) {
         return false;
      }
      var a = (-(c + Math.sqrt(sigma)));
      if (0.0 <= a && a <= input.maxFraction * rr) {
         a /= rr;
         output.fraction = a;
         output.normal.x = sX + a * rX;
         output.normal.y = sY + a * rY;
         output.normal.Normalize();
         return true;
      }
      return false;
   }
   b2CircleShape.prototype.ComputeAABB = function (aabb, transform) {
      var tMat = transform.R;
      var pX = transform.position.x + (tMat.col1.x * this.m_p.x + tMat.col2.x * this.m_p.y);
      var pY = transform.position.y + (tMat.col1.y * this.m_p.x + tMat.col2.y * this.m_p.y);
      aabb.lowerBound.Set(pX - this.m_radius, pY - this.m_radius);
      aabb.upperBound.Set(pX + this.m_radius, pY + this.m_radius);
   }
   b2CircleShape.prototype.ComputeMass = function (massData, density) {
      if (density === undefined) density = 0;
      massData.mass = density * b2Settings.b2_pi * this.m_radius * this.m_radius;
      massData.center.SetV(this.m_p);
      massData.I = massData.mass * (0.5 * this.m_radius * this.m_radius + (this.m_p.x * this.m_p.x + this.m_p.y * this.m_p.y));
   }
   b2CircleShape.prototype.ComputeSubmergedArea = function (normal, offset, xf, c) {
      if (offset === undefined) offset = 0;
      var p = b2Math.MulX(xf, this.m_p);
      var l = (-(b2Math.Dot(normal, p) - offset));
      if (l < (-this.m_radius) + Number.MIN_VALUE) {
         return 0;
      }
      if (l > this.m_radius) {
         c.SetV(p);
         return Math.PI * this.m_radius * this.m_radius;
      }
      var r2 = this.m_radius * this.m_radius;
      var l2 = l * l;
      var area = r2 * (Math.asin(l / this.m_radius) + Math.PI / 2) + l * Math.sqrt(r2 - l2);
      var com = (-2 / 3 * Math.pow(r2 - l2, 1.5) / area);
      c.x = p.x + normal.x * com;
      c.y = p.y + normal.y * com;
      return area;
   }
   b2CircleShape.prototype.GetLocalPosition = function () {
      return this.m_p;
   }
   b2CircleShape.prototype.SetLocalPosition = function (position) {
      this.m_p.SetV(position);
   }
   b2CircleShape.prototype.GetRadius = function () {
      return this.m_radius;
   }
   b2CircleShape.prototype.SetRadius = function (radius) {
      if (radius === undefined) radius = 0;
      this.m_radius = radius;
   }
   b2CircleShape.prototype.b2CircleShape = function (radius) {
      if (radius === undefined) radius = 0;
      this.__super.b2Shape.call(this);
      this.m_type = b2Shape.e_circleShape;
      this.m_radius = radius;
   }
   b2EdgeChainDef.b2EdgeChainDef = function () {};
   b2EdgeChainDef.prototype.b2EdgeChainDef = function () {
      this.vertexCount = 0;
      this.isALoop = true;
      this.vertices = [];
   }
   Box2D.inherit(b2EdgeShape, Box2D.Collision.Shapes.b2Shape);
   b2EdgeShape.prototype.__super = Box2D.Collision.Shapes.b2Shape.prototype;
   b2EdgeShape.b2EdgeShape = function () {
      Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this, arguments);
      this.s_supportVec = new b2Vec2();
      this.m_v1 = new b2Vec2();
      this.m_v2 = new b2Vec2();
      this.m_coreV1 = new b2Vec2();
      this.m_coreV2 = new b2Vec2();
      this.m_normal = new b2Vec2();
      this.m_direction = new b2Vec2();
      this.m_cornerDir1 = new b2Vec2();
      this.m_cornerDir2 = new b2Vec2();
   };
   b2EdgeShape.prototype.TestPoint = function (transform, p) {
      return false;
   }
   b2EdgeShape.prototype.RayCast = function (output, input, transform) {
      var tMat;
      var rX = input.p2.x - input.p1.x;
      var rY = input.p2.y - input.p1.y;
      tMat = transform.R;
      var v1X = transform.position.x + (tMat.col1.x * this.m_v1.x + tMat.col2.x * this.m_v1.y);
      var v1Y = transform.position.y + (tMat.col1.y * this.m_v1.x + tMat.col2.y * this.m_v1.y);
      var nX = transform.position.y + (tMat.col1.y * this.m_v2.x + tMat.col2.y * this.m_v2.y) - v1Y;
      var nY = (-(transform.position.x + (tMat.col1.x * this.m_v2.x + tMat.col2.x * this.m_v2.y) - v1X));
      var k_slop = 100.0 * Number.MIN_VALUE;
      var denom = (-(rX * nX + rY * nY));
      if (denom > k_slop) {
         var bX = input.p1.x - v1X;
         var bY = input.p1.y - v1Y;
         var a = (bX * nX + bY * nY);
         if (0.0 <= a && a <= input.maxFraction * denom) {
            var mu2 = (-rX * bY) + rY * bX;
            if ((-k_slop * denom) <= mu2 && mu2 <= denom * (1.0 + k_slop)) {
               a /= denom;
               output.fraction = a;
               var nLen = Math.sqrt(nX * nX + nY * nY);
               output.normal.x = nX / nLen;
               output.normal.y = nY / nLen;
               return true;
            }
         }
      }
      return false;
   }
   b2EdgeShape.prototype.ComputeAABB = function (aabb, transform) {
      var tMat = transform.R;
      var v1X = transform.position.x + (tMat.col1.x * this.m_v1.x + tMat.col2.x * this.m_v1.y);
      var v1Y = transform.position.y + (tMat.col1.y * this.m_v1.x + tMat.col2.y * this.m_v1.y);
      var v2X = transform.position.x + (tMat.col1.x * this.m_v2.x + tMat.col2.x * this.m_v2.y);
      var v2Y = transform.position.y + (tMat.col1.y * this.m_v2.x + tMat.col2.y * this.m_v2.y);
      if (v1X < v2X) {
         aabb.lowerBound.x = v1X;
         aabb.upperBound.x = v2X;
      }
      else {
         aabb.lowerBound.x = v2X;
         aabb.upperBound.x = v1X;
      }
      if (v1Y < v2Y) {
         aabb.lowerBound.y = v1Y;
         aabb.upperBound.y = v2Y;
      }
      else {
         aabb.lowerBound.y = v2Y;
         aabb.upperBound.y = v1Y;
      }
   }
   b2EdgeShape.prototype.ComputeMass = function (massData, density) {
      if (density === undefined) density = 0;
      massData.mass = 0;
      massData.center.SetV(this.m_v1);
      massData.I = 0;
   }
   b2EdgeShape.prototype.ComputeSubmergedArea = function (normal, offset, xf, c) {
      if (offset === undefined) offset = 0;
      var v0 = new b2Vec2(normal.x * offset, normal.y * offset);
      var v1 = b2Math.MulX(xf, this.m_v1);
      var v2 = b2Math.MulX(xf, this.m_v2);
      var d1 = b2Math.Dot(normal, v1) - offset;
      var d2 = b2Math.Dot(normal, v2) - offset;
      if (d1 > 0) {
         if (d2 > 0) {
            return 0;
         }
         else {
            v1.x = (-d2 / (d1 - d2) * v1.x) + d1 / (d1 - d2) * v2.x;
            v1.y = (-d2 / (d1 - d2) * v1.y) + d1 / (d1 - d2) * v2.y;
         }
      }
      else {
         if (d2 > 0) {
            v2.x = (-d2 / (d1 - d2) * v1.x) + d1 / (d1 - d2) * v2.x;
            v2.y = (-d2 / (d1 - d2) * v1.y) + d1 / (d1 - d2) * v2.y;
         }
         else {}
      }
      c.x = (v0.x + v1.x + v2.x) / 3;
      c.y = (v0.y + v1.y + v2.y) / 3;
      return 0.5 * ((v1.x - v0.x) * (v2.y - v0.y) - (v1.y - v0.y) * (v2.x - v0.x));
   }
   b2EdgeShape.prototype.GetLength = function () {
      return this.m_length;
   }
   b2EdgeShape.prototype.GetVertex1 = function () {
      return this.m_v1;
   }
   b2EdgeShape.prototype.GetVertex2 = function () {
      return this.m_v2;
   }
   b2EdgeShape.prototype.GetCoreVertex1 = function () {
      return this.m_coreV1;
   }
   b2EdgeShape.prototype.GetCoreVertex2 = function () {
      return this.m_coreV2;
   }
   b2EdgeShape.prototype.GetNormalVector = function () {
      return this.m_normal;
   }
   b2EdgeShape.prototype.GetDirectionVector = function () {
      return this.m_direction;
   }
   b2EdgeShape.prototype.GetCorner1Vector = function () {
      return this.m_cornerDir1;
   }
   b2EdgeShape.prototype.GetCorner2Vector = function () {
      return this.m_cornerDir2;
   }
   b2EdgeShape.prototype.Corner1IsConvex = function () {
      return this.m_cornerConvex1;
   }
   b2EdgeShape.prototype.Corner2IsConvex = function () {
      return this.m_cornerConvex2;
   }
   b2EdgeShape.prototype.GetFirstVertex = function (xf) {
      var tMat = xf.R;
      return new b2Vec2(xf.position.x + (tMat.col1.x * this.m_coreV1.x + tMat.col2.x * this.m_coreV1.y), xf.position.y + (tMat.col1.y * this.m_coreV1.x + tMat.col2.y * this.m_coreV1.y));
   }
   b2EdgeShape.prototype.GetNextEdge = function () {
      return this.m_nextEdge;
   }
   b2EdgeShape.prototype.GetPrevEdge = function () {
      return this.m_prevEdge;
   }
   b2EdgeShape.prototype.Support = function (xf, dX, dY) {
      if (dX === undefined) dX = 0;
      if (dY === undefined) dY = 0;
      var tMat = xf.R;
      var v1X = xf.position.x + (tMat.col1.x * this.m_coreV1.x + tMat.col2.x * this.m_coreV1.y);
      var v1Y = xf.position.y + (tMat.col1.y * this.m_coreV1.x + tMat.col2.y * this.m_coreV1.y);
      var v2X = xf.position.x + (tMat.col1.x * this.m_coreV2.x + tMat.col2.x * this.m_coreV2.y);
      var v2Y = xf.position.y + (tMat.col1.y * this.m_coreV2.x + tMat.col2.y * this.m_coreV2.y);
      if ((v1X * dX + v1Y * dY) > (v2X * dX + v2Y * dY)) {
         this.s_supportVec.x = v1X;
         this.s_supportVec.y = v1Y;
      }
      else {
         this.s_supportVec.x = v2X;
         this.s_supportVec.y = v2Y;
      }
      return this.s_supportVec;
   }
   b2EdgeShape.prototype.b2EdgeShape = function (v1, v2) {
      this.__super.b2Shape.call(this);
      this.m_type = b2Shape.e_edgeShape;
      this.m_prevEdge = null;
      this.m_nextEdge = null;
      this.m_v1 = v1;
      this.m_v2 = v2;
      this.m_direction.Set(this.m_v2.x - this.m_v1.x, this.m_v2.y - this.m_v1.y);
      this.m_length = this.m_direction.Normalize();
      this.m_normal.Set(this.m_direction.y, (-this.m_direction.x));
      this.m_coreV1.Set((-b2Settings.b2_toiSlop * (this.m_normal.x - this.m_direction.x)) + this.m_v1.x, (-b2Settings.b2_toiSlop * (this.m_normal.y - this.m_direction.y)) + this.m_v1.y);
      this.m_coreV2.Set((-b2Settings.b2_toiSlop * (this.m_normal.x + this.m_direction.x)) + this.m_v2.x, (-b2Settings.b2_toiSlop * (this.m_normal.y + this.m_direction.y)) + this.m_v2.y);
      this.m_cornerDir1 = this.m_normal;
      this.m_cornerDir2.Set((-this.m_normal.x), (-this.m_normal.y));
   }
   b2EdgeShape.prototype.SetPrevEdge = function (edge, core, cornerDir, convex) {
      this.m_prevEdge = edge;
      this.m_coreV1 = core;
      this.m_cornerDir1 = cornerDir;
      this.m_cornerConvex1 = convex;
   }
   b2EdgeShape.prototype.SetNextEdge = function (edge, core, cornerDir, convex) {
      this.m_nextEdge = edge;
      this.m_coreV2 = core;
      this.m_cornerDir2 = cornerDir;
      this.m_cornerConvex2 = convex;
   }
   b2MassData.b2MassData = function () {
      this.mass = 0.0;
      this.center = new b2Vec2(0, 0);
      this.I = 0.0;
   };
   Box2D.inherit(b2PolygonShape, Box2D.Collision.Shapes.b2Shape);
   b2PolygonShape.prototype.__super = Box2D.Collision.Shapes.b2Shape.prototype;
   b2PolygonShape.b2PolygonShape = function () {
      Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this, arguments);
   };
   b2PolygonShape.prototype.Copy = function () {
      var s = new b2PolygonShape();
      s.Set(this);
      return s;
   }
   b2PolygonShape.prototype.Set = function (other) {
      this.__super.Set.call(this, other);
      if (Box2D.is(other, b2PolygonShape)) {
         var other2 = (other instanceof b2PolygonShape ? other : null);
         this.m_centroid.SetV(other2.m_centroid);
         this.m_vertexCount = other2.m_vertexCount;
         this.Reserve(this.m_vertexCount);
         for (var i = 0; i < this.m_vertexCount; i++) {
            this.m_vertices[i].SetV(other2.m_vertices[i]);
            this.m_normals[i].SetV(other2.m_normals[i]);
         }
      }
   }
   b2PolygonShape.prototype.SetAsArray = function (vertices, vertexCount) {
      if (vertexCount === undefined) vertexCount = 0;
      var v = new Vector();
      var i = 0,
         tVec;
      for (i = 0;
      i < vertices.length; ++i) {
         tVec = vertices[i];
         v.push(tVec);
      }
      this.SetAsVector(v, vertexCount);
   }
   b2PolygonShape.AsArray = function (vertices, vertexCount) {
      if (vertexCount === undefined) vertexCount = 0;
      var polygonShape = new b2PolygonShape();
      polygonShape.SetAsArray(vertices, vertexCount);
      return polygonShape;
   }
   b2PolygonShape.prototype.SetAsVector = function (vertices, vertexCount) {
      if (vertexCount === undefined) vertexCount = 0;
      if (vertexCount == 0) vertexCount = vertices.length;
      b2Settings.b2Assert(2 <= vertexCount);
      this.m_vertexCount = vertexCount;
      this.Reserve(vertexCount);
      var i = 0;
      for (i = 0;
      i < this.m_vertexCount; i++) {
         this.m_vertices[i].SetV(vertices[i]);
      }
      for (i = 0;
      i < this.m_vertexCount; ++i) {
         var i1 = parseInt(i);
         var i2 = parseInt(i + 1 < this.m_vertexCount ? i + 1 : 0);
         var edge = b2Math.SubtractVV(this.m_vertices[i2], this.m_vertices[i1]);
         b2Settings.b2Assert(edge.LengthSquared() > Number.MIN_VALUE);
         this.m_normals[i].SetV(b2Math.CrossVF(edge, 1.0));
         this.m_normals[i].Normalize();
      }
      this.m_centroid = b2PolygonShape.ComputeCentroid(this.m_vertices, this.m_vertexCount);
   }
   b2PolygonShape.AsVector = function (vertices, vertexCount) {
      if (vertexCount === undefined) vertexCount = 0;
      var polygonShape = new b2PolygonShape();
      polygonShape.SetAsVector(vertices, vertexCount);
      return polygonShape;
   }
   b2PolygonShape.prototype.SetAsBox = function (hx, hy) {
      if (hx === undefined) hx = 0;
      if (hy === undefined) hy = 0;
      this.m_vertexCount = 4;
      this.Reserve(4);
      this.m_vertices[0].Set((-hx), (-hy));
      this.m_vertices[1].Set(hx, (-hy));
      this.m_vertices[2].Set(hx, hy);
      this.m_vertices[3].Set((-hx), hy);
      this.m_normals[0].Set(0.0, (-1.0));
      this.m_normals[1].Set(1.0, 0.0);
      this.m_normals[2].Set(0.0, 1.0);
      this.m_normals[3].Set((-1.0), 0.0);
      this.m_centroid.SetZero();
   }
   b2PolygonShape.AsBox = function (hx, hy) {
      if (hx === undefined) hx = 0;
      if (hy === undefined) hy = 0;
      var polygonShape = new b2PolygonShape();
      polygonShape.SetAsBox(hx, hy);
      return polygonShape;
   }
   b2PolygonShape.prototype.SetAsOrientedBox = function (hx, hy, center, angle) {
      if (hx === undefined) hx = 0;
      if (hy === undefined) hy = 0;
      if (center === undefined) center = null;
      if (angle === undefined) angle = 0.0;
      this.m_vertexCount = 4;
      this.Reserve(4);
      this.m_vertices[0].Set((-hx), (-hy));
      this.m_vertices[1].Set(hx, (-hy));
      this.m_vertices[2].Set(hx, hy);
      this.m_vertices[3].Set((-hx), hy);
      this.m_normals[0].Set(0.0, (-1.0));
      this.m_normals[1].Set(1.0, 0.0);
      this.m_normals[2].Set(0.0, 1.0);
      this.m_normals[3].Set((-1.0), 0.0);
      this.m_centroid = center;
      var xf = new b2Transform();
      xf.position = center;
      xf.R.Set(angle);
      for (var i = 0; i < this.m_vertexCount; ++i) {
         this.m_vertices[i] = b2Math.MulX(xf, this.m_vertices[i]);
         this.m_normals[i] = b2Math.MulMV(xf.R, this.m_normals[i]);
      }
   }
   b2PolygonShape.AsOrientedBox = function (hx, hy, center, angle) {
      if (hx === undefined) hx = 0;
      if (hy === undefined) hy = 0;
      if (center === undefined) center = null;
      if (angle === undefined) angle = 0.0;
      var polygonShape = new b2PolygonShape();
      polygonShape.SetAsOrientedBox(hx, hy, center, angle);
      return polygonShape;
   }
   b2PolygonShape.prototype.SetAsEdge = function (v1, v2) {
      this.m_vertexCount = 2;
      this.Reserve(2);
      this.m_vertices[0].SetV(v1);
      this.m_vertices[1].SetV(v2);
      this.m_centroid.x = 0.5 * (v1.x + v2.x);
      this.m_centroid.y = 0.5 * (v1.y + v2.y);
      this.m_normals[0] = b2Math.CrossVF(b2Math.SubtractVV(v2, v1), 1.0);
      this.m_normals[0].Normalize();
      this.m_normals[1].x = (-this.m_normals[0].x);
      this.m_normals[1].y = (-this.m_normals[0].y);
   }
   b2PolygonShape.AsEdge = function (v1, v2) {
      var polygonShape = new b2PolygonShape();
      polygonShape.SetAsEdge(v1, v2);
      return polygonShape;
   }
   b2PolygonShape.prototype.TestPoint = function (xf, p) {
      var tVec;
      var tMat = xf.R;
      var tX = p.x - xf.position.x;
      var tY = p.y - xf.position.y;
      var pLocalX = (tX * tMat.col1.x + tY * tMat.col1.y);
      var pLocalY = (tX * tMat.col2.x + tY * tMat.col2.y);
      for (var i = 0; i < this.m_vertexCount; ++i) {
         tVec = this.m_vertices[i];
         tX = pLocalX - tVec.x;
         tY = pLocalY - tVec.y;
         tVec = this.m_normals[i];
         var dot = (tVec.x * tX + tVec.y * tY);
         if (dot > 0.0) {
            return false;
         }
      }
      return true;
   }
   b2PolygonShape.prototype.RayCast = function (output, input, transform) {
      var lower = 0.0;
      var upper = input.maxFraction;
      var tX = 0;
      var tY = 0;
      var tMat;
      var tVec;
      tX = input.p1.x - transform.position.x;
      tY = input.p1.y - transform.position.y;
      tMat = transform.R;
      var p1X = (tX * tMat.col1.x + tY * tMat.col1.y);
      var p1Y = (tX * tMat.col2.x + tY * tMat.col2.y);
      tX = input.p2.x - transform.position.x;
      tY = input.p2.y - transform.position.y;
      tMat = transform.R;
      var p2X = (tX * tMat.col1.x + tY * tMat.col1.y);
      var p2Y = (tX * tMat.col2.x + tY * tMat.col2.y);
      var dX = p2X - p1X;
      var dY = p2Y - p1Y;
      var index = parseInt((-1));
      for (var i = 0; i < this.m_vertexCount; ++i) {
         tVec = this.m_vertices[i];
         tX = tVec.x - p1X;
         tY = tVec.y - p1Y;
         tVec = this.m_normals[i];
         var numerator = (tVec.x * tX + tVec.y * tY);
         var denominator = (tVec.x * dX + tVec.y * dY);
         if (denominator == 0.0) {
            if (numerator < 0.0) {
               return false;
            }
         }
         else {
            if (denominator < 0.0 && numerator < lower * denominator) {
               lower = numerator / denominator;
               index = i;
            }
            else if (denominator > 0.0 && numerator < upper * denominator) {
               upper = numerator / denominator;
            }
         }
         if (upper < lower - Number.MIN_VALUE) {
            return false;
         }
      }
      if (index >= 0) {
         output.fraction = lower;
         tMat = transform.R;
         tVec = this.m_normals[index];
         output.normal.x = (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
         output.normal.y = (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
         return true;
      }
      return false;
   }
   b2PolygonShape.prototype.ComputeAABB = function (aabb, xf) {
      var tMat = xf.R;
      var tVec = this.m_vertices[0];
      var lowerX = xf.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      var lowerY = xf.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      var upperX = lowerX;
      var upperY = lowerY;
      for (var i = 1; i < this.m_vertexCount; ++i) {
         tVec = this.m_vertices[i];
         var vX = xf.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
         var vY = xf.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
         lowerX = lowerX < vX ? lowerX : vX;
         lowerY = lowerY < vY ? lowerY : vY;
         upperX = upperX > vX ? upperX : vX;
         upperY = upperY > vY ? upperY : vY;
      }
      aabb.lowerBound.x = lowerX - this.m_radius;
      aabb.lowerBound.y = lowerY - this.m_radius;
      aabb.upperBound.x = upperX + this.m_radius;
      aabb.upperBound.y = upperY + this.m_radius;
   }
   b2PolygonShape.prototype.ComputeMass = function (massData, density) {
      if (density === undefined) density = 0;
      if (this.m_vertexCount == 2) {
         massData.center.x = 0.5 * (this.m_vertices[0].x + this.m_vertices[1].x);
         massData.center.y = 0.5 * (this.m_vertices[0].y + this.m_vertices[1].y);
         massData.mass = 0.0;
         massData.I = 0.0;
         return;
      }
      var centerX = 0.0;
      var centerY = 0.0;
      var area = 0.0;
      var I = 0.0;
      var p1X = 0.0;
      var p1Y = 0.0;
      var k_inv3 = 1.0 / 3.0;
      for (var i = 0; i < this.m_vertexCount; ++i) {
         var p2 = this.m_vertices[i];
         var p3 = i + 1 < this.m_vertexCount ? this.m_vertices[parseInt(i + 1)] : this.m_vertices[0];
         var e1X = p2.x - p1X;
         var e1Y = p2.y - p1Y;
         var e2X = p3.x - p1X;
         var e2Y = p3.y - p1Y;
         var D = e1X * e2Y - e1Y * e2X;
         var triangleArea = 0.5 * D;area += triangleArea;
         centerX += triangleArea * k_inv3 * (p1X + p2.x + p3.x);
         centerY += triangleArea * k_inv3 * (p1Y + p2.y + p3.y);
         var px = p1X;
         var py = p1Y;
         var ex1 = e1X;
         var ey1 = e1Y;
         var ex2 = e2X;
         var ey2 = e2Y;
         var intx2 = k_inv3 * (0.25 * (ex1 * ex1 + ex2 * ex1 + ex2 * ex2) + (px * ex1 + px * ex2)) + 0.5 * px * px;
         var inty2 = k_inv3 * (0.25 * (ey1 * ey1 + ey2 * ey1 + ey2 * ey2) + (py * ey1 + py * ey2)) + 0.5 * py * py;I += D * (intx2 + inty2);
      }
      massData.mass = density * area;
      centerX *= 1.0 / area;
      centerY *= 1.0 / area;
      massData.center.Set(centerX, centerY);
      massData.I = density * I;
   }
   b2PolygonShape.prototype.ComputeSubmergedArea = function (normal, offset, xf, c) {
      if (offset === undefined) offset = 0;
      var normalL = b2Math.MulTMV(xf.R, normal);
      var offsetL = offset - b2Math.Dot(normal, xf.position);
      var depths = new Vector_a2j_Number();
      var diveCount = 0;
      var intoIndex = parseInt((-1));
      var outoIndex = parseInt((-1));
      var lastSubmerged = false;
      var i = 0;
      for (i = 0;
      i < this.m_vertexCount; ++i) {
         depths[i] = b2Math.Dot(normalL, this.m_vertices[i]) - offsetL;
         var isSubmerged = depths[i] < (-Number.MIN_VALUE);
         if (i > 0) {
            if (isSubmerged) {
               if (!lastSubmerged) {
                  intoIndex = i - 1;
                  diveCount++;
               }
            }
            else {
               if (lastSubmerged) {
                  outoIndex = i - 1;
                  diveCount++;
               }
            }
         }
         lastSubmerged = isSubmerged;
      }
      switch (diveCount) {
      case 0:
         if (lastSubmerged) {
            var md = new b2MassData();
            this.ComputeMass(md, 1);
            c.SetV(b2Math.MulX(xf, md.center));
            return md.mass;
         }
         else {
            return 0;
         }
         break;
      case 1:
         if (intoIndex == (-1)) {
            intoIndex = this.m_vertexCount - 1;
         }
         else {
            outoIndex = this.m_vertexCount - 1;
         }
         break;
      }
      var intoIndex2 = parseInt((intoIndex + 1) % this.m_vertexCount);
      var outoIndex2 = parseInt((outoIndex + 1) % this.m_vertexCount);
      var intoLamdda = (0 - depths[intoIndex]) / (depths[intoIndex2] - depths[intoIndex]);
      var outoLamdda = (0 - depths[outoIndex]) / (depths[outoIndex2] - depths[outoIndex]);
      var intoVec = new b2Vec2(this.m_vertices[intoIndex].x * (1 - intoLamdda) + this.m_vertices[intoIndex2].x * intoLamdda, this.m_vertices[intoIndex].y * (1 - intoLamdda) + this.m_vertices[intoIndex2].y * intoLamdda);
      var outoVec = new b2Vec2(this.m_vertices[outoIndex].x * (1 - outoLamdda) + this.m_vertices[outoIndex2].x * outoLamdda, this.m_vertices[outoIndex].y * (1 - outoLamdda) + this.m_vertices[outoIndex2].y * outoLamdda);
      var area = 0;
      var center = new b2Vec2();
      var p2 = this.m_vertices[intoIndex2];
      var p3;
      i = intoIndex2;
      while (i != outoIndex2) {
         i = (i + 1) % this.m_vertexCount;
         if (i == outoIndex2) p3 = outoVec;
         else p3 = this.m_vertices[i];
         var triangleArea = 0.5 * ((p2.x - intoVec.x) * (p3.y - intoVec.y) - (p2.y - intoVec.y) * (p3.x - intoVec.x));
         area += triangleArea;
         center.x += triangleArea * (intoVec.x + p2.x + p3.x) / 3;
         center.y += triangleArea * (intoVec.y + p2.y + p3.y) / 3;
         p2 = p3;
      }
      center.Multiply(1 / area);
      c.SetV(b2Math.MulX(xf, center));
      return area;
   }
   b2PolygonShape.prototype.GetVertexCount = function () {
      return this.m_vertexCount;
   }
   b2PolygonShape.prototype.GetVertices = function () {
      return this.m_vertices;
   }
   b2PolygonShape.prototype.GetNormals = function () {
      return this.m_normals;
   }
   b2PolygonShape.prototype.GetSupport = function (d) {
      var bestIndex = 0;
      var bestValue = this.m_vertices[0].x * d.x + this.m_vertices[0].y * d.y;
      for (var i = 1; i < this.m_vertexCount; ++i) {
         var value = this.m_vertices[i].x * d.x + this.m_vertices[i].y * d.y;
         if (value > bestValue) {
            bestIndex = i;
            bestValue = value;
         }
      }
      return bestIndex;
   }
   b2PolygonShape.prototype.GetSupportVertex = function (d) {
      var bestIndex = 0;
      var bestValue = this.m_vertices[0].x * d.x + this.m_vertices[0].y * d.y;
      for (var i = 1; i < this.m_vertexCount; ++i) {
         var value = this.m_vertices[i].x * d.x + this.m_vertices[i].y * d.y;
         if (value > bestValue) {
            bestIndex = i;
            bestValue = value;
         }
      }
      return this.m_vertices[bestIndex];
   }
   b2PolygonShape.prototype.Validate = function () {
      return false;
   }
   b2PolygonShape.prototype.b2PolygonShape = function () {
      this.__super.b2Shape.call(this);
      this.m_type = b2Shape.e_polygonShape;
      this.m_centroid = new b2Vec2();
      this.m_vertices = new Vector();
      this.m_normals = new Vector();
   }
   b2PolygonShape.prototype.Reserve = function (count) {
      if (count === undefined) count = 0;
      for (var i = parseInt(this.m_vertices.length); i < count; i++) {
         this.m_vertices[i] = new b2Vec2();
         this.m_normals[i] = new b2Vec2();
      }
   }
   b2PolygonShape.ComputeCentroid = function (vs, count) {
      if (count === undefined) count = 0;
      var c = new b2Vec2();
      var area = 0.0;
      var p1X = 0.0;
      var p1Y = 0.0;
      var inv3 = 1.0 / 3.0;
      for (var i = 0; i < count; ++i) {
         var p2 = vs[i];
         var p3 = i + 1 < count ? vs[parseInt(i + 1)] : vs[0];
         var e1X = p2.x - p1X;
         var e1Y = p2.y - p1Y;
         var e2X = p3.x - p1X;
         var e2Y = p3.y - p1Y;
         var D = (e1X * e2Y - e1Y * e2X);
         var triangleArea = 0.5 * D;area += triangleArea;
         c.x += triangleArea * inv3 * (p1X + p2.x + p3.x);
         c.y += triangleArea * inv3 * (p1Y + p2.y + p3.y);
      }
      c.x *= 1.0 / area;
      c.y *= 1.0 / area;
      return c;
   }
   b2PolygonShape.ComputeOBB = function (obb, vs, count) {
      if (count === undefined) count = 0;
      var i = 0;
      var p = new Vector(count + 1);
      for (i = 0;
      i < count; ++i) {
         p[i] = vs[i];
      }
      p[count] = p[0];
      var minArea = Number.MAX_VALUE;
      for (i = 1;
      i <= count; ++i) {
         var root = p[parseInt(i - 1)];
         var uxX = p[i].x - root.x;
         var uxY = p[i].y - root.y;
         var length = Math.sqrt(uxX * uxX + uxY * uxY);
         uxX /= length;
         uxY /= length;
         var uyX = (-uxY);
         var uyY = uxX;
         var lowerX = Number.MAX_VALUE;
         var lowerY = Number.MAX_VALUE;
         var upperX = (-Number.MAX_VALUE);
         var upperY = (-Number.MAX_VALUE);
         for (var j = 0; j < count; ++j) {
            var dX = p[j].x - root.x;
            var dY = p[j].y - root.y;
            var rX = (uxX * dX + uxY * dY);
            var rY = (uyX * dX + uyY * dY);
            if (rX < lowerX) lowerX = rX;
            if (rY < lowerY) lowerY = rY;
            if (rX > upperX) upperX = rX;
            if (rY > upperY) upperY = rY;
         }
         var area = (upperX - lowerX) * (upperY - lowerY);
         if (area < 0.95 * minArea) {
            minArea = area;
            obb.R.col1.x = uxX;
            obb.R.col1.y = uxY;
            obb.R.col2.x = uyX;
            obb.R.col2.y = uyY;
            var centerX = 0.5 * (lowerX + upperX);
            var centerY = 0.5 * (lowerY + upperY);
            var tMat = obb.R;
            obb.center.x = root.x + (tMat.col1.x * centerX + tMat.col2.x * centerY);
            obb.center.y = root.y + (tMat.col1.y * centerX + tMat.col2.y * centerY);
            obb.extents.x = 0.5 * (upperX - lowerX);
            obb.extents.y = 0.5 * (upperY - lowerY);
         }
      }
   }
   Box2D.postDefs.push(function () {
      Box2D.Collision.Shapes.b2PolygonShape.s_mat = new b2Mat22();
   });
   b2Shape.b2Shape = function () {};
   b2Shape.prototype.Copy = function () {
      return null;
   }
   b2Shape.prototype.Set = function (other) {
      this.m_radius = other.m_radius;
   }
   b2Shape.prototype.GetType = function () {
      return this.m_type;
   }
   b2Shape.prototype.TestPoint = function (xf, p) {
      return false;
   }
   b2Shape.prototype.RayCast = function (output, input, transform) {
      return false;
   }
   b2Shape.prototype.ComputeAABB = function (aabb, xf) {}
   b2Shape.prototype.ComputeMass = function (massData, density) {
      if (density === undefined) density = 0;
   }
   b2Shape.prototype.ComputeSubmergedArea = function (normal, offset, xf, c) {
      if (offset === undefined) offset = 0;
      return 0;
   }
   b2Shape.TestOverlap = function (shape1, transform1, shape2, transform2) {
      var input = new b2DistanceInput();
      input.proxyA = new b2DistanceProxy();
      input.proxyA.Set(shape1);
      input.proxyB = new b2DistanceProxy();
      input.proxyB.Set(shape2);
      input.transformA = transform1;
      input.transformB = transform2;
      input.useRadii = true;
      var simplexCache = new b2SimplexCache();
      simplexCache.count = 0;
      var output = new b2DistanceOutput();
      b2Distance.Distance(output, simplexCache, input);
      return output.distance < 10.0 * Number.MIN_VALUE;
   }
   b2Shape.prototype.b2Shape = function () {
      this.m_type = b2Shape.e_unknownShape;
      this.m_radius = b2Settings.b2_linearSlop;
   }
   Box2D.postDefs.push(function () {
      Box2D.Collision.Shapes.b2Shape.e_unknownShape = parseInt((-1));
      Box2D.Collision.Shapes.b2Shape.e_circleShape = 0;
      Box2D.Collision.Shapes.b2Shape.e_polygonShape = 1;
      Box2D.Collision.Shapes.b2Shape.e_edgeShape = 2;
      Box2D.Collision.Shapes.b2Shape.e_shapeTypeCount = 3;
      Box2D.Collision.Shapes.b2Shape.e_hitCollide = 1;
      Box2D.Collision.Shapes.b2Shape.e_missCollide = 0;
      Box2D.Collision.Shapes.b2Shape.e_startsInsideCollide = parseInt((-1));
   });
})();
(function () {
   var b2Color = Box2D.Common.b2Color,
      b2internal = Box2D.Common.b2internal,
      b2Settings = Box2D.Common.b2Settings,
      b2Mat22 = Box2D.Common.Math.b2Mat22,
      b2Mat33 = Box2D.Common.Math.b2Mat33,
      b2Math = Box2D.Common.Math.b2Math,
      b2Sweep = Box2D.Common.Math.b2Sweep,
      b2Transform = Box2D.Common.Math.b2Transform,
      b2Vec2 = Box2D.Common.Math.b2Vec2,
      b2Vec3 = Box2D.Common.Math.b2Vec3;

   b2Color.b2Color = function () {
      this._r = 0;
      this._g = 0;
      this._b = 0;
   };
   b2Color.prototype.b2Color = function (rr, gg, bb) {
      if (rr === undefined) rr = 0;
      if (gg === undefined) gg = 0;
      if (bb === undefined) bb = 0;
      this._r = Box2D.parseUInt(255 * b2Math.Clamp(rr, 0.0, 1.0));
      this._g = Box2D.parseUInt(255 * b2Math.Clamp(gg, 0.0, 1.0));
      this._b = Box2D.parseUInt(255 * b2Math.Clamp(bb, 0.0, 1.0));
   }
   b2Color.prototype.Set = function (rr, gg, bb) {
      if (rr === undefined) rr = 0;
      if (gg === undefined) gg = 0;
      if (bb === undefined) bb = 0;
      this._r = Box2D.parseUInt(255 * b2Math.Clamp(rr, 0.0, 1.0));
      this._g = Box2D.parseUInt(255 * b2Math.Clamp(gg, 0.0, 1.0));
      this._b = Box2D.parseUInt(255 * b2Math.Clamp(bb, 0.0, 1.0));
   }
   Object.defineProperty(b2Color.prototype, 'r', {
      enumerable: false,
      configurable: true,
      set: function (rr) {
         if (rr === undefined) rr = 0;
         this._r = Box2D.parseUInt(255 * b2Math.Clamp(rr, 0.0, 1.0));
      }
   });
   Object.defineProperty(b2Color.prototype, 'g', {
      enumerable: false,
      configurable: true,
      set: function (gg) {
         if (gg === undefined) gg = 0;
         this._g = Box2D.parseUInt(255 * b2Math.Clamp(gg, 0.0, 1.0));
      }
   });
   Object.defineProperty(b2Color.prototype, 'b', {
      enumerable: false,
      configurable: true,
      set: function (bb) {
         if (bb === undefined) bb = 0;
         this._b = Box2D.parseUInt(255 * b2Math.Clamp(bb, 0.0, 1.0));
      }
   });
   Object.defineProperty(b2Color.prototype, 'color', {
      enumerable: false,
      configurable: true,
      get: function () {
         return (this._r << 16) | (this._g << 8) | (this._b);
      }
   });
   b2Settings.b2Settings = function () {};
   b2Settings.b2MixFriction = function (friction1, friction2) {
      if (friction1 === undefined) friction1 = 0;
      if (friction2 === undefined) friction2 = 0;
      return Math.sqrt(friction1 * friction2);
   }
   b2Settings.b2MixRestitution = function (restitution1, restitution2) {
      if (restitution1 === undefined) restitution1 = 0;
      if (restitution2 === undefined) restitution2 = 0;
      return restitution1 > restitution2 ? restitution1 : restitution2;
   }
   b2Settings.b2Assert = function (a) {
      if (!a) {
         throw "Assertion Failed";
      }
   }
   Box2D.postDefs.push(function () {
      Box2D.Common.b2Settings.VERSION = "2.1alpha";
      Box2D.Common.b2Settings.USHRT_MAX = 0x0000ffff;
      Box2D.Common.b2Settings.b2_pi = Math.PI;
      Box2D.Common.b2Settings.b2_maxManifoldPoints = 2;
      Box2D.Common.b2Settings.b2_aabbExtension = 0.1;
      Box2D.Common.b2Settings.b2_aabbMultiplier = 2.0;
      Box2D.Common.b2Settings.b2_polygonRadius = 2.0 * b2Settings.b2_linearSlop;
      Box2D.Common.b2Settings.b2_linearSlop = 0.005;
      Box2D.Common.b2Settings.b2_angularSlop = 2.0 / 180.0 * b2Settings.b2_pi;
      Box2D.Common.b2Settings.b2_toiSlop = 8.0 * b2Settings.b2_linearSlop;
      Box2D.Common.b2Settings.b2_maxTOIContactsPerIsland = 32;
      Box2D.Common.b2Settings.b2_maxTOIJointsPerIsland = 32;
      Box2D.Common.b2Settings.b2_velocityThreshold = 1.0;
      Box2D.Common.b2Settings.b2_maxLinearCorrection = 0.2;
      Box2D.Common.b2Settings.b2_maxAngularCorrection = 8.0 / 180.0 * b2Settings.b2_pi;
      Box2D.Common.b2Settings.b2_maxTranslation = 2.0;
      Box2D.Common.b2Settings.b2_maxTranslationSquared = b2Settings.b2_maxTranslation * b2Settings.b2_maxTranslation;
      Box2D.Common.b2Settings.b2_maxRotation = 0.5 * b2Settings.b2_pi;
      Box2D.Common.b2Settings.b2_maxRotationSquared = b2Settings.b2_maxRotation * b2Settings.b2_maxRotation;
      Box2D.Common.b2Settings.b2_contactBaumgarte = 0.2;
      Box2D.Common.b2Settings.b2_timeToSleep = 0.5;
      Box2D.Common.b2Settings.b2_linearSleepTolerance = 0.01;
      Box2D.Common.b2Settings.b2_angularSleepTolerance = 2.0 / 180.0 * b2Settings.b2_pi;
   });
})();
(function () {
   var b2AABB = Box2D.Collision.b2AABB,
      b2Color = Box2D.Common.b2Color,
      b2internal = Box2D.Common.b2internal,
      b2Settings = Box2D.Common.b2Settings,
      b2Mat22 = Box2D.Common.Math.b2Mat22,
      b2Mat33 = Box2D.Common.Math.b2Mat33,
      b2Math = Box2D.Common.Math.b2Math,
      b2Sweep = Box2D.Common.Math.b2Sweep,
      b2Transform = Box2D.Common.Math.b2Transform,
      b2Vec2 = Box2D.Common.Math.b2Vec2,
      b2Vec3 = Box2D.Common.Math.b2Vec3;

   b2Mat22.b2Mat22 = function () {
      this.col1 = new b2Vec2();
      this.col2 = new b2Vec2();
   };
   b2Mat22.prototype.b2Mat22 = function () {
      this.SetIdentity();
   }
   b2Mat22.FromAngle = function (angle) {
      if (angle === undefined) angle = 0;
      var mat = new b2Mat22();
      mat.Set(angle);
      return mat;
   }
   b2Mat22.FromVV = function (c1, c2) {
      var mat = new b2Mat22();
      mat.SetVV(c1, c2);
      return mat;
   }
   b2Mat22.prototype.Set = function (angle) {
      if (angle === undefined) angle = 0;
      var c = Math.cos(angle);
      var s = Math.sin(angle);
      this.col1.x = c;
      this.col2.x = (-s);
      this.col1.y = s;
      this.col2.y = c;
   }
   b2Mat22.prototype.SetVV = function (c1, c2) {
      this.col1.SetV(c1);
      this.col2.SetV(c2);
   }
   b2Mat22.prototype.Copy = function () {
      var mat = new b2Mat22();
      mat.SetM(this);
      return mat;
   }
   b2Mat22.prototype.SetM = function (m) {
      this.col1.SetV(m.col1);
      this.col2.SetV(m.col2);
   }
   b2Mat22.prototype.AddM = function (m) {
      this.col1.x += m.col1.x;
      this.col1.y += m.col1.y;
      this.col2.x += m.col2.x;
      this.col2.y += m.col2.y;
   }
   b2Mat22.prototype.SetIdentity = function () {
      this.col1.x = 1.0;
      this.col2.x = 0.0;
      this.col1.y = 0.0;
      this.col2.y = 1.0;
   }
   b2Mat22.prototype.SetZero = function () {
      this.col1.x = 0.0;
      this.col2.x = 0.0;
      this.col1.y = 0.0;
      this.col2.y = 0.0;
   }
   b2Mat22.prototype.GetAngle = function () {
      return Math.atan2(this.col1.y, this.col1.x);
   }
   b2Mat22.prototype.GetInverse = function (out) {
      var a = this.col1.x;
      var b = this.col2.x;
      var c = this.col1.y;
      var d = this.col2.y;
      var det = a * d - b * c;
      if (det != 0.0) {
         det = 1.0 / det;
      }
      out.col1.x = det * d;
      out.col2.x = (-det * b);
      out.col1.y = (-det * c);
      out.col2.y = det * a;
      return out;
   }
   b2Mat22.prototype.Solve = function (out, bX, bY) {
      if (bX === undefined) bX = 0;
      if (bY === undefined) bY = 0;
      var a11 = this.col1.x;
      var a12 = this.col2.x;
      var a21 = this.col1.y;
      var a22 = this.col2.y;
      var det = a11 * a22 - a12 * a21;
      if (det != 0.0) {
         det = 1.0 / det;
      }
      out.x = det * (a22 * bX - a12 * bY);
      out.y = det * (a11 * bY - a21 * bX);
      return out;
   }
   b2Mat22.prototype.Abs = function () {
      this.col1.Abs();
      this.col2.Abs();
   }
   b2Mat33.b2Mat33 = function () {
      this.col1 = new b2Vec3();
      this.col2 = new b2Vec3();
      this.col3 = new b2Vec3();
   };
   b2Mat33.prototype.b2Mat33 = function (c1, c2, c3) {
      if (c1 === undefined) c1 = null;
      if (c2 === undefined) c2 = null;
      if (c3 === undefined) c3 = null;
      if (!c1 && !c2 && !c3) {
         this.col1.SetZero();
         this.col2.SetZero();
         this.col3.SetZero();
      }
      else {
         this.col1.SetV(c1);
         this.col2.SetV(c2);
         this.col3.SetV(c3);
      }
   }
   b2Mat33.prototype.SetVVV = function (c1, c2, c3) {
      this.col1.SetV(c1);
      this.col2.SetV(c2);
      this.col3.SetV(c3);
   }
   b2Mat33.prototype.Copy = function () {
      return new b2Mat33(this.col1, this.col2, this.col3);
   }
   b2Mat33.prototype.SetM = function (m) {
      this.col1.SetV(m.col1);
      this.col2.SetV(m.col2);
      this.col3.SetV(m.col3);
   }
   b2Mat33.prototype.AddM = function (m) {
      this.col1.x += m.col1.x;
      this.col1.y += m.col1.y;
      this.col1.z += m.col1.z;
      this.col2.x += m.col2.x;
      this.col2.y += m.col2.y;
      this.col2.z += m.col2.z;
      this.col3.x += m.col3.x;
      this.col3.y += m.col3.y;
      this.col3.z += m.col3.z;
   }
   b2Mat33.prototype.SetIdentity = function () {
      this.col1.x = 1.0;
      this.col2.x = 0.0;
      this.col3.x = 0.0;
      this.col1.y = 0.0;
      this.col2.y = 1.0;
      this.col3.y = 0.0;
      this.col1.z = 0.0;
      this.col2.z = 0.0;
      this.col3.z = 1.0;
   }
   b2Mat33.prototype.SetZero = function () {
      this.col1.x = 0.0;
      this.col2.x = 0.0;
      this.col3.x = 0.0;
      this.col1.y = 0.0;
      this.col2.y = 0.0;
      this.col3.y = 0.0;
      this.col1.z = 0.0;
      this.col2.z = 0.0;
      this.col3.z = 0.0;
   }
   b2Mat33.prototype.Solve22 = function (out, bX, bY) {
      if (bX === undefined) bX = 0;
      if (bY === undefined) bY = 0;
      var a11 = this.col1.x;
      var a12 = this.col2.x;
      var a21 = this.col1.y;
      var a22 = this.col2.y;
      var det = a11 * a22 - a12 * a21;
      if (det != 0.0) {
         det = 1.0 / det;
      }
      out.x = det * (a22 * bX - a12 * bY);
      out.y = det * (a11 * bY - a21 * bX);
      return out;
   }
   b2Mat33.prototype.Solve33 = function (out, bX, bY, bZ) {
      if (bX === undefined) bX = 0;
      if (bY === undefined) bY = 0;
      if (bZ === undefined) bZ = 0;
      var a11 = this.col1.x;
      var a21 = this.col1.y;
      var a31 = this.col1.z;
      var a12 = this.col2.x;
      var a22 = this.col2.y;
      var a32 = this.col2.z;
      var a13 = this.col3.x;
      var a23 = this.col3.y;
      var a33 = this.col3.z;
      var det = a11 * (a22 * a33 - a32 * a23) + a21 * (a32 * a13 - a12 * a33) + a31 * (a12 * a23 - a22 * a13);
      if (det != 0.0) {
         det = 1.0 / det;
      }
      out.x = det * (bX * (a22 * a33 - a32 * a23) + bY * (a32 * a13 - a12 * a33) + bZ * (a12 * a23 - a22 * a13));
      out.y = det * (a11 * (bY * a33 - bZ * a23) + a21 * (bZ * a13 - bX * a33) + a31 * (bX * a23 - bY * a13));
      out.z = det * (a11 * (a22 * bZ - a32 * bY) + a21 * (a32 * bX - a12 * bZ) + a31 * (a12 * bY - a22 * bX));
      return out;
   }
   b2Math.b2Math = function () {};
   b2Math.IsValid = function (x) {
      if (x === undefined) x = 0;
      return isFinite(x);
   }
   b2Math.Dot = function (a, b) {
      return a.x * b.x + a.y * b.y;
   }
   b2Math.CrossVV = function (a, b) {
      return a.x * b.y - a.y * b.x;
   }
   b2Math.CrossVF = function (a, s) {
      if (s === undefined) s = 0;
      var v = new b2Vec2(s * a.y, (-s * a.x));
      return v;
   }
   b2Math.CrossFV = function (s, a) {
      if (s === undefined) s = 0;
      var v = new b2Vec2((-s * a.y), s * a.x);
      return v;
   }
   b2Math.MulMV = function (A, v) {
      var u = new b2Vec2(A.col1.x * v.x + A.col2.x * v.y, A.col1.y * v.x + A.col2.y * v.y);
      return u;
   }
   b2Math.MulTMV = function (A, v) {
      var u = new b2Vec2(b2Math.Dot(v, A.col1), b2Math.Dot(v, A.col2));
      return u;
   }
   b2Math.MulX = function (T, v) {
      var a = b2Math.MulMV(T.R, v);
      a.x += T.position.x;
      a.y += T.position.y;
      return a;
   }
   b2Math.MulXT = function (T, v) {
      var a = b2Math.SubtractVV(v, T.position);
      var tX = (a.x * T.R.col1.x + a.y * T.R.col1.y);
      a.y = (a.x * T.R.col2.x + a.y * T.R.col2.y);
      a.x = tX;
      return a;
   }
   b2Math.AddVV = function (a, b) {
      var v = new b2Vec2(a.x + b.x, a.y + b.y);
      return v;
   }
   b2Math.SubtractVV = function (a, b) {
      var v = new b2Vec2(a.x - b.x, a.y - b.y);
      return v;
   }
   b2Math.Distance = function (a, b) {
      var cX = a.x - b.x;
      var cY = a.y - b.y;
      return Math.sqrt(cX * cX + cY * cY);
   }
   b2Math.DistanceSquared = function (a, b) {
      var cX = a.x - b.x;
      var cY = a.y - b.y;
      return (cX * cX + cY * cY);
   }
   b2Math.MulFV = function (s, a) {
      if (s === undefined) s = 0;
      var v = new b2Vec2(s * a.x, s * a.y);
      return v;
   }
   b2Math.AddMM = function (A, B) {
      var C = b2Mat22.FromVV(b2Math.AddVV(A.col1, B.col1), b2Math.AddVV(A.col2, B.col2));
      return C;
   }
   b2Math.MulMM = function (A, B) {
      var C = b2Mat22.FromVV(b2Math.MulMV(A, B.col1), b2Math.MulMV(A, B.col2));
      return C;
   }
   b2Math.MulTMM = function (A, B) {
      var c1 = new b2Vec2(b2Math.Dot(A.col1, B.col1), b2Math.Dot(A.col2, B.col1));
      var c2 = new b2Vec2(b2Math.Dot(A.col1, B.col2), b2Math.Dot(A.col2, B.col2));
      var C = b2Mat22.FromVV(c1, c2);
      return C;
   }
   b2Math.Abs = function (a) {
      if (a === undefined) a = 0;
      return a > 0.0 ? a : (-a);
   }
   b2Math.AbsV = function (a) {
      var b = new b2Vec2(b2Math.Abs(a.x), b2Math.Abs(a.y));
      return b;
   }
   b2Math.AbsM = function (A) {
      var B = b2Mat22.FromVV(b2Math.AbsV(A.col1), b2Math.AbsV(A.col2));
      return B;
   }
   b2Math.Min = function (a, b) {
      if (a === undefined) a = 0;
      if (b === undefined) b = 0;
      return a < b ? a : b;
   }
   b2Math.MinV = function (a, b) {
      var c = new b2Vec2(b2Math.Min(a.x, b.x), b2Math.Min(a.y, b.y));
      return c;
   }
   b2Math.Max = function (a, b) {
      if (a === undefined) a = 0;
      if (b === undefined) b = 0;
      return a > b ? a : b;
   }
   b2Math.MaxV = function (a, b) {
      var c = new b2Vec2(b2Math.Max(a.x, b.x), b2Math.Max(a.y, b.y));
      return c;
   }
   b2Math.Clamp = function (a, low, high) {
      if (a === undefined) a = 0;
      if (low === undefined) low = 0;
      if (high === undefined) high = 0;
      return a < low ? low : a > high ? high : a;
   }
   b2Math.ClampV = function (a, low, high) {
      return b2Math.MaxV(low, b2Math.MinV(a, high));
   }
   b2Math.Swap = function (a, b) {
      var tmp = a[0];
      a[0] = b[0];
      b[0] = tmp;
   }
   b2Math.Random = function () {
      return Math.random() * 2 - 1;
   }
   b2Math.RandomRange = function (lo, hi) {
      if (lo === undefined) lo = 0;
      if (hi === undefined) hi = 0;
      var r = Math.random();
      r = (hi - lo) * r + lo;
      return r;
   }
   b2Math.NextPowerOfTwo = function (x) {
      if (x === undefined) x = 0;
      x |= (x >> 1) & 0x7FFFFFFF;
      x |= (x >> 2) & 0x3FFFFFFF;
      x |= (x >> 4) & 0x0FFFFFFF;
      x |= (x >> 8) & 0x00FFFFFF;
      x |= (x >> 16) & 0x0000FFFF;
      return x + 1;
   }
   b2Math.IsPowerOfTwo = function (x) {
      if (x === undefined) x = 0;
      var result = x > 0 && (x & (x - 1)) == 0;
      return result;
   }
   Box2D.postDefs.push(function () {
      Box2D.Common.Math.b2Math.b2Vec2_zero = new b2Vec2(0.0, 0.0);
      Box2D.Common.Math.b2Math.b2Mat22_identity = b2Mat22.FromVV(new b2Vec2(1.0, 0.0), new b2Vec2(0.0, 1.0));
      Box2D.Common.Math.b2Math.b2Transform_identity = new b2Transform(b2Math.b2Vec2_zero, b2Math.b2Mat22_identity);
   });
   b2Sweep.b2Sweep = function () {
      this.localCenter = new b2Vec2();
      this.c0 = new b2Vec2;
      this.c = new b2Vec2();
   };
   b2Sweep.prototype.Set = function (other) {
      this.localCenter.SetV(other.localCenter);
      this.c0.SetV(other.c0);
      this.c.SetV(other.c);
      this.a0 = other.a0;
      this.a = other.a;
      this.t0 = other.t0;
   }
   b2Sweep.prototype.Copy = function () {
      var copy = new b2Sweep();
      copy.localCenter.SetV(this.localCenter);
      copy.c0.SetV(this.c0);
      copy.c.SetV(this.c);
      copy.a0 = this.a0;
      copy.a = this.a;
      copy.t0 = this.t0;
      return copy;
   }
   b2Sweep.prototype.GetTransform = function (xf, alpha) {
      if (alpha === undefined) alpha = 0;
      xf.position.x = (1.0 - alpha) * this.c0.x + alpha * this.c.x;
      xf.position.y = (1.0 - alpha) * this.c0.y + alpha * this.c.y;
      var angle = (1.0 - alpha) * this.a0 + alpha * this.a;
      xf.R.Set(angle);
      var tMat = xf.R;
      xf.position.x -= (tMat.col1.x * this.localCenter.x + tMat.col2.x * this.localCenter.y);
      xf.position.y -= (tMat.col1.y * this.localCenter.x + tMat.col2.y * this.localCenter.y);
   }
   b2Sweep.prototype.Advance = function (t) {
      if (t === undefined) t = 0;
      if (this.t0 < t && 1.0 - this.t0 > Number.MIN_VALUE) {
         var alpha = (t - this.t0) / (1.0 - this.t0);
         this.c0.x = (1.0 - alpha) * this.c0.x + alpha * this.c.x;
         this.c0.y = (1.0 - alpha) * this.c0.y + alpha * this.c.y;
         this.a0 = (1.0 - alpha) * this.a0 + alpha * this.a;
         this.t0 = t;
      }
   }
   b2Transform.b2Transform = function () {
      this.position = new b2Vec2;
      this.R = new b2Mat22();
   };
   b2Transform.prototype.b2Transform = function (pos, r) {
      if (pos === undefined) pos = null;
      if (r === undefined) r = null;
      if (pos) {
         this.position.SetV(pos);
         this.R.SetM(r);
      }
   }
   b2Transform.prototype.Initialize = function (pos, r) {
      this.position.SetV(pos);
      this.R.SetM(r);
   }
   b2Transform.prototype.SetIdentity = function () {
      this.position.SetZero();
      this.R.SetIdentity();
   }
   b2Transform.prototype.Set = function (x) {
      this.position.SetV(x.position);
      this.R.SetM(x.R);
   }
   b2Transform.prototype.GetAngle = function () {
      return Math.atan2(this.R.col1.y, this.R.col1.x);
   }
   b2Vec2.b2Vec2 = function () {};
   b2Vec2.prototype.b2Vec2 = function (x_, y_) {
      if (x_ === undefined) x_ = 0;
      if (y_ === undefined) y_ = 0;
      this.x = x_;
      this.y = y_;
   }
   b2Vec2.prototype.SetZero = function () {
      this.x = 0.0;
      this.y = 0.0;
   }
   b2Vec2.prototype.Set = function (x_, y_) {
      if (x_ === undefined) x_ = 0;
      if (y_ === undefined) y_ = 0;
      this.x = x_;
      this.y = y_;
   }
   b2Vec2.prototype.SetV = function (v) {
      this.x = v.x;
      this.y = v.y;
   }
   b2Vec2.prototype.GetNegative = function () {
      return new b2Vec2((-this.x), (-this.y));
   }
   b2Vec2.prototype.NegativeSelf = function () {
      this.x = (-this.x);
      this.y = (-this.y);
   }
   b2Vec2.Make = function (x_, y_) {
      if (x_ === undefined) x_ = 0;
      if (y_ === undefined) y_ = 0;
      return new b2Vec2(x_, y_);
   }
   b2Vec2.prototype.Copy = function () {
      return new b2Vec2(this.x, this.y);
   }
   b2Vec2.prototype.Add = function (v) {
      this.x += v.x;
      this.y += v.y;
   }
   b2Vec2.prototype.Subtract = function (v) {
      this.x -= v.x;
      this.y -= v.y;
   }
   b2Vec2.prototype.Multiply = function (a) {
      if (a === undefined) a = 0;
      this.x *= a;
      this.y *= a;
   }
   b2Vec2.prototype.MulM = function (A) {
      var tX = this.x;
      this.x = A.col1.x * tX + A.col2.x * this.y;
      this.y = A.col1.y * tX + A.col2.y * this.y;
   }
   b2Vec2.prototype.MulTM = function (A) {
      var tX = b2Math.Dot(this, A.col1);
      this.y = b2Math.Dot(this, A.col2);
      this.x = tX;
   }
   b2Vec2.prototype.CrossVF = function (s) {
      if (s === undefined) s = 0;
      var tX = this.x;
      this.x = s * this.y;
      this.y = (-s * tX);
   }
   b2Vec2.prototype.CrossFV = function (s) {
      if (s === undefined) s = 0;
      var tX = this.x;
      this.x = (-s * this.y);
      this.y = s * tX;
   }
   b2Vec2.prototype.MinV = function (b) {
      this.x = this.x < b.x ? this.x : b.x;
      this.y = this.y < b.y ? this.y : b.y;
   }
   b2Vec2.prototype.MaxV = function (b) {
      this.x = this.x > b.x ? this.x : b.x;
      this.y = this.y > b.y ? this.y : b.y;
   }
   b2Vec2.prototype.Abs = function () {
      if (this.x < 0) this.x = (-this.x);
      if (this.y < 0) this.y = (-this.y);
   }
   b2Vec2.prototype.Length = function () {
      return Math.sqrt(this.x * this.x + this.y * this.y);
   }
   b2Vec2.prototype.LengthSquared = function () {
      return (this.x * this.x + this.y * this.y);
   }
   b2Vec2.prototype.Normalize = function () {
      var length = Math.sqrt(this.x * this.x + this.y * this.y);
      if (length < Number.MIN_VALUE) {
         return 0.0;
      }
      var invLength = 1.0 / length;
      this.x *= invLength;
      this.y *= invLength;
      return length;
   }
   b2Vec2.prototype.IsValid = function () {
      return b2Math.IsValid(this.x) && b2Math.IsValid(this.y);
   }
   b2Vec3.b2Vec3 = function () {};
   b2Vec3.prototype.b2Vec3 = function (x, y, z) {
      if (x === undefined) x = 0;
      if (y === undefined) y = 0;
      if (z === undefined) z = 0;
      this.x = x;
      this.y = y;
      this.z = z;
   }
   b2Vec3.prototype.SetZero = function () {
      this.x = this.y = this.z = 0.0;
   }
   b2Vec3.prototype.Set = function (x, y, z) {
      if (x === undefined) x = 0;
      if (y === undefined) y = 0;
      if (z === undefined) z = 0;
      this.x = x;
      this.y = y;
      this.z = z;
   }
   b2Vec3.prototype.SetV = function (v) {
      this.x = v.x;
      this.y = v.y;
      this.z = v.z;
   }
   b2Vec3.prototype.GetNegative = function () {
      return new b2Vec3((-this.x), (-this.y), (-this.z));
   }
   b2Vec3.prototype.NegativeSelf = function () {
      this.x = (-this.x);
      this.y = (-this.y);
      this.z = (-this.z);
   }
   b2Vec3.prototype.Copy = function () {
      return new b2Vec3(this.x, this.y, this.z);
   }
   b2Vec3.prototype.Add = function (v) {
      this.x += v.x;
      this.y += v.y;
      this.z += v.z;
   }
   b2Vec3.prototype.Subtract = function (v) {
      this.x -= v.x;
      this.y -= v.y;
      this.z -= v.z;
   }
   b2Vec3.prototype.Multiply = function (a) {
      if (a === undefined) a = 0;
      this.x *= a;
      this.y *= a;
      this.z *= a;
   }
})();
(function () {
   var b2ControllerEdge = Box2D.Dynamics.Controllers.b2ControllerEdge,
      b2Mat22 = Box2D.Common.Math.b2Mat22,
      b2Mat33 = Box2D.Common.Math.b2Mat33,
      b2Math = Box2D.Common.Math.b2Math,
      b2Sweep = Box2D.Common.Math.b2Sweep,
      b2Transform = Box2D.Common.Math.b2Transform,
      b2Vec2 = Box2D.Common.Math.b2Vec2,
      b2Vec3 = Box2D.Common.Math.b2Vec3,
      b2Color = Box2D.Common.b2Color,
      b2internal = Box2D.Common.b2internal,
      b2Settings = Box2D.Common.b2Settings,
      b2AABB = Box2D.Collision.b2AABB,
      b2Bound = Box2D.Collision.b2Bound,
      b2BoundValues = Box2D.Collision.b2BoundValues,
      b2Collision = Box2D.Collision.b2Collision,
      b2ContactID = Box2D.Collision.b2ContactID,
      b2ContactPoint = Box2D.Collision.b2ContactPoint,
      b2Distance = Box2D.Collision.b2Distance,
      b2DistanceInput = Box2D.Collision.b2DistanceInput,
      b2DistanceOutput = Box2D.Collision.b2DistanceOutput,
      b2DistanceProxy = Box2D.Collision.b2DistanceProxy,
      b2DynamicTree = Box2D.Collision.b2DynamicTree,
      b2DynamicTreeBroadPhase = Box2D.Collision.b2DynamicTreeBroadPhase,
      b2DynamicTreeNode = Box2D.Collision.b2DynamicTreeNode,
      b2DynamicTreePair = Box2D.Collision.b2DynamicTreePair,
      b2Manifold = Box2D.Collision.b2Manifold,
      b2ManifoldPoint = Box2D.Collision.b2ManifoldPoint,
      b2Point = Box2D.Collision.b2Point,
      b2RayCastInput = Box2D.Collision.b2RayCastInput,
      b2RayCastOutput = Box2D.Collision.b2RayCastOutput,
      b2Segment = Box2D.Collision.b2Segment,
      b2SeparationFunction = Box2D.Collision.b2SeparationFunction,
      b2Simplex = Box2D.Collision.b2Simplex,
      b2SimplexCache = Box2D.Collision.b2SimplexCache,
      b2SimplexVertex = Box2D.Collision.b2SimplexVertex,
      b2TimeOfImpact = Box2D.Collision.b2TimeOfImpact,
      b2TOIInput = Box2D.Collision.b2TOIInput,
      b2WorldManifold = Box2D.Collision.b2WorldManifold,
      ClipVertex = Box2D.Collision.ClipVertex,
      Features = Box2D.Collision.Features,
      IBroadPhase = Box2D.Collision.IBroadPhase,
      b2CircleShape = Box2D.Collision.Shapes.b2CircleShape,
      b2EdgeChainDef = Box2D.Collision.Shapes.b2EdgeChainDef,
      b2EdgeShape = Box2D.Collision.Shapes.b2EdgeShape,
      b2MassData = Box2D.Collision.Shapes.b2MassData,
      b2PolygonShape = Box2D.Collision.Shapes.b2PolygonShape,
      b2Shape = Box2D.Collision.Shapes.b2Shape,
      b2Body = Box2D.Dynamics.b2Body,
      b2BodyDef = Box2D.Dynamics.b2BodyDef,
      b2ContactFilter = Box2D.Dynamics.b2ContactFilter,
      b2ContactImpulse = Box2D.Dynamics.b2ContactImpulse,
      b2ContactListener = Box2D.Dynamics.b2ContactListener,
      b2ContactManager = Box2D.Dynamics.b2ContactManager,
      b2DebugDraw = Box2D.Dynamics.b2DebugDraw,
      b2DestructionListener = Box2D.Dynamics.b2DestructionListener,
      b2FilterData = Box2D.Dynamics.b2FilterData,
      b2Fixture = Box2D.Dynamics.b2Fixture,
      b2FixtureDef = Box2D.Dynamics.b2FixtureDef,
      b2Island = Box2D.Dynamics.b2Island,
      b2TimeStep = Box2D.Dynamics.b2TimeStep,
      b2World = Box2D.Dynamics.b2World,
      b2CircleContact = Box2D.Dynamics.Contacts.b2CircleContact,
      b2Contact = Box2D.Dynamics.Contacts.b2Contact,
      b2ContactConstraint = Box2D.Dynamics.Contacts.b2ContactConstraint,
      b2ContactConstraintPoint = Box2D.Dynamics.Contacts.b2ContactConstraintPoint,
      b2ContactEdge = Box2D.Dynamics.Contacts.b2ContactEdge,
      b2ContactFactory = Box2D.Dynamics.Contacts.b2ContactFactory,
      b2ContactRegister = Box2D.Dynamics.Contacts.b2ContactRegister,
      b2ContactResult = Box2D.Dynamics.Contacts.b2ContactResult,
      b2ContactSolver = Box2D.Dynamics.Contacts.b2ContactSolver,
      b2EdgeAndCircleContact = Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,
      b2NullContact = Box2D.Dynamics.Contacts.b2NullContact,
      b2PolyAndCircleContact = Box2D.Dynamics.Contacts.b2PolyAndCircleContact,
      b2PolyAndEdgeContact = Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,
      b2PolygonContact = Box2D.Dynamics.Contacts.b2PolygonContact,
      b2PositionSolverManifold = Box2D.Dynamics.Contacts.b2PositionSolverManifold,
      b2Controller = Box2D.Dynamics.Controllers.b2Controller,
      b2DistanceJoint = Box2D.Dynamics.Joints.b2DistanceJoint,
      b2DistanceJointDef = Box2D.Dynamics.Joints.b2DistanceJointDef,
      b2FrictionJoint = Box2D.Dynamics.Joints.b2FrictionJoint,
      b2FrictionJointDef = Box2D.Dynamics.Joints.b2FrictionJointDef,
      b2GearJoint = Box2D.Dynamics.Joints.b2GearJoint,
      b2GearJointDef = Box2D.Dynamics.Joints.b2GearJointDef,
      b2Jacobian = Box2D.Dynamics.Joints.b2Jacobian,
      b2Joint = Box2D.Dynamics.Joints.b2Joint,
      b2JointDef = Box2D.Dynamics.Joints.b2JointDef,
      b2JointEdge = Box2D.Dynamics.Joints.b2JointEdge,
      b2LineJoint = Box2D.Dynamics.Joints.b2LineJoint,
      b2LineJointDef = Box2D.Dynamics.Joints.b2LineJointDef,
      b2MouseJoint = Box2D.Dynamics.Joints.b2MouseJoint,
      b2MouseJointDef = Box2D.Dynamics.Joints.b2MouseJointDef,
      b2PrismaticJoint = Box2D.Dynamics.Joints.b2PrismaticJoint,
      b2PrismaticJointDef = Box2D.Dynamics.Joints.b2PrismaticJointDef,
      b2PulleyJoint = Box2D.Dynamics.Joints.b2PulleyJoint,
      b2PulleyJointDef = Box2D.Dynamics.Joints.b2PulleyJointDef,
      b2RevoluteJoint = Box2D.Dynamics.Joints.b2RevoluteJoint,
      b2RevoluteJointDef = Box2D.Dynamics.Joints.b2RevoluteJointDef,
      b2WeldJoint = Box2D.Dynamics.Joints.b2WeldJoint,
      b2WeldJointDef = Box2D.Dynamics.Joints.b2WeldJointDef;

   b2Body.b2Body = function () {
      this.m_xf = new b2Transform();
      this.m_sweep = new b2Sweep();
      this.m_linearVelocity = new b2Vec2();
      this.m_force = new b2Vec2();
   };
   b2Body.prototype.connectEdges = function (s1, s2, angle1) {
      if (angle1 === undefined) angle1 = 0;
      var angle2 = Math.atan2(s2.GetDirectionVector().y, s2.GetDirectionVector().x);
      var coreOffset = Math.tan((angle2 - angle1) * 0.5);
      var core = b2Math.MulFV(coreOffset, s2.GetDirectionVector());
      core = b2Math.SubtractVV(core, s2.GetNormalVector());
      core = b2Math.MulFV(b2Settings.b2_toiSlop, core);
      core = b2Math.AddVV(core, s2.GetVertex1());
      var cornerDir = b2Math.AddVV(s1.GetDirectionVector(), s2.GetDirectionVector());
      cornerDir.Normalize();
      var convex = b2Math.Dot(s1.GetDirectionVector(), s2.GetNormalVector()) > 0.0;
      s1.SetNextEdge(s2, core, cornerDir, convex);
      s2.SetPrevEdge(s1, core, cornerDir, convex);
      return angle2;
   }
   b2Body.prototype.CreateFixture = function (def) {
      if (this.m_world.IsLocked() == true) {
         return null;
      }
      var fixture = new b2Fixture();
      fixture.Create(this, this.m_xf, def);
      if (this.m_flags & b2Body.e_activeFlag) {
         var broadPhase = this.m_world.m_contactManager.m_broadPhase;
         fixture.CreateProxy(broadPhase, this.m_xf);
      }
      fixture.m_next = this.m_fixtureList;
      this.m_fixtureList = fixture;
      ++this.m_fixtureCount;
      fixture.m_body = this;
      if (fixture.m_density > 0.0) {
         this.ResetMassData();
      }
      this.m_world.m_flags |= b2World.e_newFixture;
      return fixture;
   }
   b2Body.prototype.CreateFixture2 = function (shape, density) {
      if (density === undefined) density = 0.0;
      var def = new b2FixtureDef();
      def.shape = shape;
      def.density = density;
      return this.CreateFixture(def);
   }
   b2Body.prototype.DestroyFixture = function (fixture) {
      if (this.m_world.IsLocked() == true) {
         return;
      }
      var node = this.m_fixtureList;
      var ppF = null;
      var found = false;
      while (node != null) {
         if (node == fixture) {
            if (ppF) ppF.m_next = fixture.m_next;
            else this.m_fixtureList = fixture.m_next;
            found = true;
            break;
         }
         ppF = node;
         node = node.m_next;
      }
      var edge = this.m_contactList;
      while (edge) {
         var c = edge.contact;
         edge = edge.next;
         var fixtureA = c.GetFixtureA();
         var fixtureB = c.GetFixtureB();
         if (fixture == fixtureA || fixture == fixtureB) {
            this.m_world.m_contactManager.Destroy(c);
         }
      }
      if (this.m_flags & b2Body.e_activeFlag) {
         var broadPhase = this.m_world.m_contactManager.m_broadPhase;
         fixture.DestroyProxy(broadPhase);
      }
      else {}
      fixture.Destroy();
      fixture.m_body = null;
      fixture.m_next = null;
      --this.m_fixtureCount;
      this.ResetMassData();
   }
   b2Body.prototype.SetPositionAndAngle = function (position, angle) {
      if (angle === undefined) angle = 0;
      var f;
      if (this.m_world.IsLocked() == true) {
         return;
      }
      this.m_xf.R.Set(angle);
      this.m_xf.position.SetV(position);
      var tMat = this.m_xf.R;
      var tVec = this.m_sweep.localCenter;
      this.m_sweep.c.x = (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      this.m_sweep.c.y = (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      this.m_sweep.c.x += this.m_xf.position.x;
      this.m_sweep.c.y += this.m_xf.position.y;
      this.m_sweep.c0.SetV(this.m_sweep.c);
      this.m_sweep.a0 = this.m_sweep.a = angle;
      var broadPhase = this.m_world.m_contactManager.m_broadPhase;
      for (f = this.m_fixtureList;
      f; f = f.m_next) {
         f.Synchronize(broadPhase, this.m_xf, this.m_xf);
      }
      this.m_world.m_contactManager.FindNewContacts();
   }
   b2Body.prototype.SetTransform = function (xf) {
      this.SetPositionAndAngle(xf.position, xf.GetAngle());
   }
   b2Body.prototype.GetTransform = function () {
      return this.m_xf;
   }
   b2Body.prototype.GetPosition = function () {
      return this.m_xf.position;
   }
   b2Body.prototype.SetPosition = function (position) {
      this.SetPositionAndAngle(position, this.GetAngle());
   }
   b2Body.prototype.GetAngle = function () {
      return this.m_sweep.a;
   }
   b2Body.prototype.SetAngle = function (angle) {
      if (angle === undefined) angle = 0;
      this.SetPositionAndAngle(this.GetPosition(), angle);
   }
   b2Body.prototype.GetWorldCenter = function () {
      return this.m_sweep.c;
   }
   b2Body.prototype.GetLocalCenter = function () {
      return this.m_sweep.localCenter;
   }
   b2Body.prototype.SetLinearVelocity = function (v) {
      if (this.m_type == b2Body.b2_staticBody) {
         return;
      }
      this.m_linearVelocity.SetV(v);
   }
   b2Body.prototype.GetLinearVelocity = function () {
      return this.m_linearVelocity;
   }
   b2Body.prototype.SetAngularVelocity = function (omega) {
      if (omega === undefined) omega = 0;
      if (this.m_type == b2Body.b2_staticBody) {
         return;
      }
      this.m_angularVelocity = omega;
   }
   b2Body.prototype.GetAngularVelocity = function () {
      return this.m_angularVelocity;
   }
   b2Body.prototype.GetDefinition = function () {
      var bd = new b2BodyDef();
      bd.type = this.GetType();
      bd.allowSleep = (this.m_flags & b2Body.e_allowSleepFlag) == b2Body.e_allowSleepFlag;
      bd.angle = this.GetAngle();
      bd.angularDamping = this.m_angularDamping;
      bd.angularVelocity = this.m_angularVelocity;
      bd.fixedRotation = (this.m_flags & b2Body.e_fixedRotationFlag) == b2Body.e_fixedRotationFlag;
      bd.bullet = (this.m_flags & b2Body.e_bulletFlag) == b2Body.e_bulletFlag;
      bd.awake = (this.m_flags & b2Body.e_awakeFlag) == b2Body.e_awakeFlag;
      bd.linearDamping = this.m_linearDamping;
      bd.linearVelocity.SetV(this.GetLinearVelocity());
      bd.position = this.GetPosition();
      bd.userData = this.GetUserData();
      return bd;
   }
   b2Body.prototype.ApplyForce = function (force, point) {
      if (this.m_type != b2Body.b2_dynamicBody) {
         return;
      }
      if (this.IsAwake() == false) {
         this.SetAwake(true);
      }
      this.m_force.x += force.x;
      this.m_force.y += force.y;
      this.m_torque += ((point.x - this.m_sweep.c.x) * force.y - (point.y - this.m_sweep.c.y) * force.x);
   }
   b2Body.prototype.ApplyTorque = function (torque) {
      if (torque === undefined) torque = 0;
      if (this.m_type != b2Body.b2_dynamicBody) {
         return;
      }
      if (this.IsAwake() == false) {
         this.SetAwake(true);
      }
      this.m_torque += torque;
   }
   b2Body.prototype.ApplyImpulse = function (impulse, point) {
      if (this.m_type != b2Body.b2_dynamicBody) {
         return;
      }
      if (this.IsAwake() == false) {
         this.SetAwake(true);
      }
      this.m_linearVelocity.x += this.m_invMass * impulse.x;
      this.m_linearVelocity.y += this.m_invMass * impulse.y;
      this.m_angularVelocity += this.m_invI * ((point.x - this.m_sweep.c.x) * impulse.y - (point.y - this.m_sweep.c.y) * impulse.x);
   }
   b2Body.prototype.Split = function (callback) {
      var linearVelocity = this.GetLinearVelocity().Copy();
      var angularVelocity = this.GetAngularVelocity();
      var center = this.GetWorldCenter();
      var body1 = this;
      var body2 = this.m_world.CreateBody(this.GetDefinition());
      var prev;
      for (var f = body1.m_fixtureList; f;) {
         if (callback(f)) {
            var next = f.m_next;
            if (prev) {
               prev.m_next = next;
            }
            else {
               body1.m_fixtureList = next;
            }
            body1.m_fixtureCount--;
            f.m_next = body2.m_fixtureList;
            body2.m_fixtureList = f;
            body2.m_fixtureCount++;
            f.m_body = body2;
            f = next;
         }
         else {
            prev = f;
            f = f.m_next;
         }
      }
      body1.ResetMassData();
      body2.ResetMassData();
      var center1 = body1.GetWorldCenter();
      var center2 = body2.GetWorldCenter();
      var velocity1 = b2Math.AddVV(linearVelocity, b2Math.CrossFV(angularVelocity, b2Math.SubtractVV(center1, center)));
      var velocity2 = b2Math.AddVV(linearVelocity, b2Math.CrossFV(angularVelocity, b2Math.SubtractVV(center2, center)));
      body1.SetLinearVelocity(velocity1);
      body2.SetLinearVelocity(velocity2);
      body1.SetAngularVelocity(angularVelocity);
      body2.SetAngularVelocity(angularVelocity);
      body1.SynchronizeFixtures();
      body2.SynchronizeFixtures();
      return body2;
   }
   b2Body.prototype.Merge = function (other) {
      var f;
      for (f = other.m_fixtureList;
      f;) {
         var next = f.m_next;
         other.m_fixtureCount--;
         f.m_next = this.m_fixtureList;
         this.m_fixtureList = f;
         this.m_fixtureCount++;
         f.m_body = body2;
         f = next;
      }
      body1.m_fixtureCount = 0;
      var body1 = this;
      var body2 = other;
      var center1 = body1.GetWorldCenter();
      var center2 = body2.GetWorldCenter();
      var velocity1 = body1.GetLinearVelocity().Copy();
      var velocity2 = body2.GetLinearVelocity().Copy();
      var angular1 = body1.GetAngularVelocity();
      var angular = body2.GetAngularVelocity();
      body1.ResetMassData();
      this.SynchronizeFixtures();
   }
   b2Body.prototype.GetMass = function () {
      return this.m_mass;
   }
   b2Body.prototype.GetInertia = function () {
      return this.m_I;
   }
   b2Body.prototype.GetMassData = function (data) {
      data.mass = this.m_mass;
      data.I = this.m_I;
      data.center.SetV(this.m_sweep.localCenter);
   }
   b2Body.prototype.SetMassData = function (massData) {
      b2Settings.b2Assert(this.m_world.IsLocked() == false);
      if (this.m_world.IsLocked() == true) {
         return;
      }
      if (this.m_type != b2Body.b2_dynamicBody) {
         return;
      }
      this.m_invMass = 0.0;
      this.m_I = 0.0;
      this.m_invI = 0.0;
      this.m_mass = massData.mass;
      if (this.m_mass <= 0.0) {
         this.m_mass = 1.0;
      }
      this.m_invMass = 1.0 / this.m_mass;
      if (massData.I > 0.0 && (this.m_flags & b2Body.e_fixedRotationFlag) == 0) {
         this.m_I = massData.I - this.m_mass * (massData.center.x * massData.center.x + massData.center.y * massData.center.y);
         this.m_invI = 1.0 / this.m_I;
      }
      var oldCenter = this.m_sweep.c.Copy();
      this.m_sweep.localCenter.SetV(massData.center);
      this.m_sweep.c0.SetV(b2Math.MulX(this.m_xf, this.m_sweep.localCenter));
      this.m_sweep.c.SetV(this.m_sweep.c0);
      this.m_linearVelocity.x += this.m_angularVelocity * (-(this.m_sweep.c.y - oldCenter.y));
      this.m_linearVelocity.y += this.m_angularVelocity * (+(this.m_sweep.c.x - oldCenter.x));
   }
   b2Body.prototype.ResetMassData = function () {
      this.m_mass = 0.0;
      this.m_invMass = 0.0;
      this.m_I = 0.0;
      this.m_invI = 0.0;
      this.m_sweep.localCenter.SetZero();
      if (this.m_type == b2Body.b2_staticBody || this.m_type == b2Body.b2_kinematicBody) {
         return;
      }
      var center = b2Vec2.Make(0, 0);
      for (var f = this.m_fixtureList; f; f = f.m_next) {
         if (f.m_density == 0.0) {
            continue;
         }
         var massData = f.GetMassData();
         this.m_mass += massData.mass;
         center.x += massData.center.x * massData.mass;
         center.y += massData.center.y * massData.mass;
         this.m_I += massData.I;
      }
      if (this.m_mass > 0.0) {
         this.m_invMass = 1.0 / this.m_mass;
         center.x *= this.m_invMass;
         center.y *= this.m_invMass;
      }
      else {
         this.m_mass = 1.0;
         this.m_invMass = 1.0;
      }
      if (this.m_I > 0.0 && (this.m_flags & b2Body.e_fixedRotationFlag) == 0) {
         this.m_I -= this.m_mass * (center.x * center.x + center.y * center.y);
         this.m_I *= this.m_inertiaScale;
         b2Settings.b2Assert(this.m_I > 0);
         this.m_invI = 1.0 / this.m_I;
      }
      else {
         this.m_I = 0.0;
         this.m_invI = 0.0;
      }
      var oldCenter = this.m_sweep.c.Copy();
      this.m_sweep.localCenter.SetV(center);
      this.m_sweep.c0.SetV(b2Math.MulX(this.m_xf, this.m_sweep.localCenter));
      this.m_sweep.c.SetV(this.m_sweep.c0);
      this.m_linearVelocity.x += this.m_angularVelocity * (-(this.m_sweep.c.y - oldCenter.y));
      this.m_linearVelocity.y += this.m_angularVelocity * (+(this.m_sweep.c.x - oldCenter.x));
   }
   b2Body.prototype.GetWorldPoint = function (localPoint) {
      var A = this.m_xf.R;
      var u = new b2Vec2(A.col1.x * localPoint.x + A.col2.x * localPoint.y, A.col1.y * localPoint.x + A.col2.y * localPoint.y);
      u.x += this.m_xf.position.x;
      u.y += this.m_xf.position.y;
      return u;
   }
   b2Body.prototype.GetWorldVector = function (localVector) {
      return b2Math.MulMV(this.m_xf.R, localVector);
   }
   b2Body.prototype.GetLocalPoint = function (worldPoint) {
      return b2Math.MulXT(this.m_xf, worldPoint);
   }
   b2Body.prototype.GetLocalVector = function (worldVector) {
      return b2Math.MulTMV(this.m_xf.R, worldVector);
   }
   b2Body.prototype.GetLinearVelocityFromWorldPoint = function (worldPoint) {
      return new b2Vec2(this.m_linearVelocity.x - this.m_angularVelocity * (worldPoint.y - this.m_sweep.c.y), this.m_linearVelocity.y + this.m_angularVelocity * (worldPoint.x - this.m_sweep.c.x));
   }
   b2Body.prototype.GetLinearVelocityFromLocalPoint = function (localPoint) {
      var A = this.m_xf.R;
      var worldPoint = new b2Vec2(A.col1.x * localPoint.x + A.col2.x * localPoint.y, A.col1.y * localPoint.x + A.col2.y * localPoint.y);
      worldPoint.x += this.m_xf.position.x;
      worldPoint.y += this.m_xf.position.y;
      return new b2Vec2(this.m_linearVelocity.x - this.m_angularVelocity * (worldPoint.y - this.m_sweep.c.y), this.m_linearVelocity.y + this.m_angularVelocity * (worldPoint.x - this.m_sweep.c.x));
   }
   b2Body.prototype.GetLinearDamping = function () {
      return this.m_linearDamping;
   }
   b2Body.prototype.SetLinearDamping = function (linearDamping) {
      if (linearDamping === undefined) linearDamping = 0;
      this.m_linearDamping = linearDamping;
   }
   b2Body.prototype.GetAngularDamping = function () {
      return this.m_angularDamping;
   }
   b2Body.prototype.SetAngularDamping = function (angularDamping) {
      if (angularDamping === undefined) angularDamping = 0;
      this.m_angularDamping = angularDamping;
   }
   b2Body.prototype.SetType = function (type) {
      if (type === undefined) type = 0;
      if (this.m_type == type) {
         return;
      }
      this.m_type = type;
      this.ResetMassData();
      if (this.m_type == b2Body.b2_staticBody) {
         this.m_linearVelocity.SetZero();
         this.m_angularVelocity = 0.0;
      }
      this.SetAwake(true);
      this.m_force.SetZero();
      this.m_torque = 0.0;
      for (var ce = this.m_contactList; ce; ce = ce.next) {
         ce.contact.FlagForFiltering();
      }
   }
   b2Body.prototype.GetType = function () {
      return this.m_type;
   }
   b2Body.prototype.SetBullet = function (flag) {
      if (flag) {
         this.m_flags |= b2Body.e_bulletFlag;
      }
      else {
         this.m_flags &= ~b2Body.e_bulletFlag;
      }
   }
   b2Body.prototype.IsBullet = function () {
      return (this.m_flags & b2Body.e_bulletFlag) == b2Body.e_bulletFlag;
   }
   b2Body.prototype.SetSleepingAllowed = function (flag) {
      if (flag) {
         this.m_flags |= b2Body.e_allowSleepFlag;
      }
      else {
         this.m_flags &= ~b2Body.e_allowSleepFlag;
         this.SetAwake(true);
      }
   }
   b2Body.prototype.SetAwake = function (flag) {
      if (flag) {
         this.m_flags |= b2Body.e_awakeFlag;
         this.m_sleepTime = 0.0;
      }
      else {
         this.m_flags &= ~b2Body.e_awakeFlag;
         this.m_sleepTime = 0.0;
         this.m_linearVelocity.SetZero();
         this.m_angularVelocity = 0.0;
         this.m_force.SetZero();
         this.m_torque = 0.0;
      }
   }
   b2Body.prototype.IsAwake = function () {
      return (this.m_flags & b2Body.e_awakeFlag) == b2Body.e_awakeFlag;
   }
   b2Body.prototype.SetFixedRotation = function (fixed) {
      if (fixed) {
         this.m_flags |= b2Body.e_fixedRotationFlag;
      }
      else {
         this.m_flags &= ~b2Body.e_fixedRotationFlag;
      }
      this.ResetMassData();
   }
   b2Body.prototype.IsFixedRotation = function () {
      return (this.m_flags & b2Body.e_fixedRotationFlag) == b2Body.e_fixedRotationFlag;
   }
   b2Body.prototype.SetActive = function (flag) {
      if (flag == this.IsActive()) {
         return;
      }
      var broadPhase;
      var f;
      if (flag) {
         this.m_flags |= b2Body.e_activeFlag;
         broadPhase = this.m_world.m_contactManager.m_broadPhase;
         for (f = this.m_fixtureList;
         f; f = f.m_next) {
            f.CreateProxy(broadPhase, this.m_xf);
         }
      }
      else {
         this.m_flags &= ~b2Body.e_activeFlag;
         broadPhase = this.m_world.m_contactManager.m_broadPhase;
         for (f = this.m_fixtureList;
         f; f = f.m_next) {
            f.DestroyProxy(broadPhase);
         }
         var ce = this.m_contactList;
         while (ce) {
            var ce0 = ce;
            ce = ce.next;
            this.m_world.m_contactManager.Destroy(ce0.contact);
         }
         this.m_contactList = null;
      }
   }
   b2Body.prototype.IsActive = function () {
      return (this.m_flags & b2Body.e_activeFlag) == b2Body.e_activeFlag;
   }
   b2Body.prototype.IsSleepingAllowed = function () {
      return (this.m_flags & b2Body.e_allowSleepFlag) == b2Body.e_allowSleepFlag;
   }
   b2Body.prototype.GetFixtureList = function () {
      return this.m_fixtureList;
   }
   b2Body.prototype.GetJointList = function () {
      return this.m_jointList;
   }
   b2Body.prototype.GetControllerList = function () {
      return this.m_controllerList;
   }
   b2Body.prototype.GetContactList = function () {
      return this.m_contactList;
   }
   b2Body.prototype.GetNext = function () {
      return this.m_next;
   }
   b2Body.prototype.GetUserData = function () {
      return this.m_userData;
   }
   b2Body.prototype.SetUserData = function (data) {
      this.m_userData = data;
   }
   b2Body.prototype.GetWorld = function () {
      return this.m_world;
   }
   b2Body.prototype.b2Body = function (bd, world) {
      this.m_flags = 0;
      if (bd.bullet) {
         this.m_flags |= b2Body.e_bulletFlag;
      }
      if (bd.fixedRotation) {
         this.m_flags |= b2Body.e_fixedRotationFlag;
      }
      if (bd.allowSleep) {
         this.m_flags |= b2Body.e_allowSleepFlag;
      }
      if (bd.awake) {
         this.m_flags |= b2Body.e_awakeFlag;
      }
      if (bd.active) {
         this.m_flags |= b2Body.e_activeFlag;
      }
      this.m_world = world;
      this.m_xf.position.SetV(bd.position);
      this.m_xf.R.Set(bd.angle);
      this.m_sweep.localCenter.SetZero();
      this.m_sweep.t0 = 1.0;
      this.m_sweep.a0 = this.m_sweep.a = bd.angle;
      var tMat = this.m_xf.R;
      var tVec = this.m_sweep.localCenter;
      this.m_sweep.c.x = (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      this.m_sweep.c.y = (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      this.m_sweep.c.x += this.m_xf.position.x;
      this.m_sweep.c.y += this.m_xf.position.y;
      this.m_sweep.c0.SetV(this.m_sweep.c);
      this.m_jointList = null;
      this.m_controllerList = null;
      this.m_contactList = null;
      this.m_controllerCount = 0;
      this.m_prev = null;
      this.m_next = null;
      this.m_linearVelocity.SetV(bd.linearVelocity);
      this.m_angularVelocity = bd.angularVelocity;
      this.m_linearDamping = bd.linearDamping;
      this.m_angularDamping = bd.angularDamping;
      this.m_force.Set(0.0, 0.0);
      this.m_torque = 0.0;
      this.m_sleepTime = 0.0;
      this.m_type = bd.type;
      if (this.m_type == b2Body.b2_dynamicBody) {
         this.m_mass = 1.0;
         this.m_invMass = 1.0;
      }
      else {
         this.m_mass = 0.0;
         this.m_invMass = 0.0;
      }
      this.m_I = 0.0;
      this.m_invI = 0.0;
      this.m_inertiaScale = bd.inertiaScale;
      this.m_userData = bd.userData;
      this.m_fixtureList = null;
      this.m_fixtureCount = 0;
   }
   b2Body.prototype.SynchronizeFixtures = function () {
      var xf1 = b2Body.s_xf1;
      xf1.R.Set(this.m_sweep.a0);
      var tMat = xf1.R;
      var tVec = this.m_sweep.localCenter;
      xf1.position.x = this.m_sweep.c0.x - (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      xf1.position.y = this.m_sweep.c0.y - (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      var f;
      var broadPhase = this.m_world.m_contactManager.m_broadPhase;
      for (f = this.m_fixtureList;
      f; f = f.m_next) {
         f.Synchronize(broadPhase, xf1, this.m_xf);
      }
   }
   b2Body.prototype.SynchronizeTransform = function () {
      this.m_xf.R.Set(this.m_sweep.a);
      var tMat = this.m_xf.R;
      var tVec = this.m_sweep.localCenter;
      this.m_xf.position.x = this.m_sweep.c.x - (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      this.m_xf.position.y = this.m_sweep.c.y - (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
   }
   b2Body.prototype.ShouldCollide = function (other) {
      if (this.m_type != b2Body.b2_dynamicBody && other.m_type != b2Body.b2_dynamicBody) {
         return false;
      }
      for (var jn = this.m_jointList; jn; jn = jn.next) {
         if (jn.other == other) if (jn.joint.m_collideConnected == false) {
            return false;
         }
      }
      return true;
   }
   b2Body.prototype.Advance = function (t) {
      if (t === undefined) t = 0;
      this.m_sweep.Advance(t);
      this.m_sweep.c.SetV(this.m_sweep.c0);
      this.m_sweep.a = this.m_sweep.a0;
      this.SynchronizeTransform();
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.b2Body.s_xf1 = new b2Transform();
      Box2D.Dynamics.b2Body.e_islandFlag = 0x0001;
      Box2D.Dynamics.b2Body.e_awakeFlag = 0x0002;
      Box2D.Dynamics.b2Body.e_allowSleepFlag = 0x0004;
      Box2D.Dynamics.b2Body.e_bulletFlag = 0x0008;
      Box2D.Dynamics.b2Body.e_fixedRotationFlag = 0x0010;
      Box2D.Dynamics.b2Body.e_activeFlag = 0x0020;
      Box2D.Dynamics.b2Body.b2_staticBody = 0;
      Box2D.Dynamics.b2Body.b2_kinematicBody = 1;
      Box2D.Dynamics.b2Body.b2_dynamicBody = 2;
   });
   b2BodyDef.b2BodyDef = function () {
      this.position = new b2Vec2();
      this.linearVelocity = new b2Vec2();
   };
   b2BodyDef.prototype.b2BodyDef = function () {
      this.userData = null;
      this.position.Set(0.0, 0.0);
      this.angle = 0.0;
      this.linearVelocity.Set(0, 0);
      this.angularVelocity = 0.0;
      this.linearDamping = 0.0;
      this.angularDamping = 0.0;
      this.allowSleep = true;
      this.awake = true;
      this.fixedRotation = false;
      this.bullet = false;
      this.type = b2Body.b2_staticBody;
      this.active = true;
      this.inertiaScale = 1.0;
   }
   b2ContactFilter.b2ContactFilter = function () {};
   b2ContactFilter.prototype.ShouldCollide = function (fixtureA, fixtureB) {
      var filter1 = fixtureA.GetFilterData();
      var filter2 = fixtureB.GetFilterData();
      if (filter1.groupIndex == filter2.groupIndex && filter1.groupIndex != 0) {
         return filter1.groupIndex > 0;
      }
      var collide = (filter1.maskBits & filter2.categoryBits) != 0 && (filter1.categoryBits & filter2.maskBits) != 0;
      return collide;
   }
   b2ContactFilter.prototype.RayCollide = function (userData, fixture) {
      if (!userData) return true;
      return this.ShouldCollide((userData instanceof b2Fixture ? userData : null), fixture);
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.b2ContactFilter.b2_defaultFilter = new b2ContactFilter();
   });
   b2ContactImpulse.b2ContactImpulse = function () {
      this.normalImpulses = new Vector_a2j_Number(b2Settings.b2_maxManifoldPoints);
      this.tangentImpulses = new Vector_a2j_Number(b2Settings.b2_maxManifoldPoints);
   };
   b2ContactListener.b2ContactListener = function () {};
   b2ContactListener.prototype.BeginContact = function (contact) {}
   b2ContactListener.prototype.EndContact = function (contact) {}
   b2ContactListener.prototype.PreSolve = function (contact, oldManifold) {}
   b2ContactListener.prototype.PostSolve = function (contact, impulse) {}
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.b2ContactListener.b2_defaultListener = new b2ContactListener();
   });
   b2ContactManager.b2ContactManager = function () {};
   b2ContactManager.prototype.b2ContactManager = function () {
      this.m_world = null;
      this.m_contactCount = 0;
      this.m_contactFilter = b2ContactFilter.b2_defaultFilter;
      this.m_contactListener = b2ContactListener.b2_defaultListener;
      this.m_contactFactory = new b2ContactFactory(this.m_allocator);
      this.m_broadPhase = new b2DynamicTreeBroadPhase();
   }
   b2ContactManager.prototype.AddPair = function (proxyUserDataA, proxyUserDataB) {
      var fixtureA = (proxyUserDataA instanceof b2Fixture ? proxyUserDataA : null);
      var fixtureB = (proxyUserDataB instanceof b2Fixture ? proxyUserDataB : null);
      var bodyA = fixtureA.GetBody();
      var bodyB = fixtureB.GetBody();
      if (bodyA == bodyB) return;
      var edge = bodyB.GetContactList();
      while (edge) {
         if (edge.other == bodyA) {
            var fA = edge.contact.GetFixtureA();
            var fB = edge.contact.GetFixtureB();
            if (fA == fixtureA && fB == fixtureB) return;
            if (fA == fixtureB && fB == fixtureA) return;
         }
         edge = edge.next;
      }
      if (bodyB.ShouldCollide(bodyA) == false) {
         return;
      }
      if (this.m_contactFilter.ShouldCollide(fixtureA, fixtureB) == false) {
         return;
      }
      var c = this.m_contactFactory.Create(fixtureA, fixtureB);
      fixtureA = c.GetFixtureA();
      fixtureB = c.GetFixtureB();
      bodyA = fixtureA.m_body;
      bodyB = fixtureB.m_body;
      c.m_prev = null;
      c.m_next = this.m_world.m_contactList;
      if (this.m_world.m_contactList != null) {
         this.m_world.m_contactList.m_prev = c;
      }
      this.m_world.m_contactList = c;
      c.m_nodeA.contact = c;
      c.m_nodeA.other = bodyB;
      c.m_nodeA.prev = null;
      c.m_nodeA.next = bodyA.m_contactList;
      if (bodyA.m_contactList != null) {
         bodyA.m_contactList.prev = c.m_nodeA;
      }
      bodyA.m_contactList = c.m_nodeA;
      c.m_nodeB.contact = c;
      c.m_nodeB.other = bodyA;
      c.m_nodeB.prev = null;
      c.m_nodeB.next = bodyB.m_contactList;
      if (bodyB.m_contactList != null) {
         bodyB.m_contactList.prev = c.m_nodeB;
      }
      bodyB.m_contactList = c.m_nodeB;
      ++this.m_world.m_contactCount;
      return;
   }
   b2ContactManager.prototype.FindNewContacts = function () {
      this.m_broadPhase.UpdatePairs(Box2D.generateCallback(this, this.AddPair));
   }
   b2ContactManager.prototype.Destroy = function (c) {
      var fixtureA = c.GetFixtureA();
      var fixtureB = c.GetFixtureB();
      var bodyA = fixtureA.GetBody();
      var bodyB = fixtureB.GetBody();
      if (c.IsTouching()) {
         this.m_contactListener.EndContact(c);
      }
      if (c.m_prev) {
         c.m_prev.m_next = c.m_next;
      }
      if (c.m_next) {
         c.m_next.m_prev = c.m_prev;
      }
      if (c == this.m_world.m_contactList) {
         this.m_world.m_contactList = c.m_next;
      }
      if (c.m_nodeA.prev) {
         c.m_nodeA.prev.next = c.m_nodeA.next;
      }
      if (c.m_nodeA.next) {
         c.m_nodeA.next.prev = c.m_nodeA.prev;
      }
      if (c.m_nodeA == bodyA.m_contactList) {
         bodyA.m_contactList = c.m_nodeA.next;
      }
      if (c.m_nodeB.prev) {
         c.m_nodeB.prev.next = c.m_nodeB.next;
      }
      if (c.m_nodeB.next) {
         c.m_nodeB.next.prev = c.m_nodeB.prev;
      }
      if (c.m_nodeB == bodyB.m_contactList) {
         bodyB.m_contactList = c.m_nodeB.next;
      }
      this.m_contactFactory.Destroy(c);
      --this.m_contactCount;
   }
   b2ContactManager.prototype.Collide = function () {
      var c = this.m_world.m_contactList;
      while (c) {
         var fixtureA = c.GetFixtureA();
         var fixtureB = c.GetFixtureB();
         var bodyA = fixtureA.GetBody();
         var bodyB = fixtureB.GetBody();
         if (bodyA.IsAwake() == false && bodyB.IsAwake() == false) {
            c = c.GetNext();
            continue;
         }
         if (c.m_flags & b2Contact.e_filterFlag) {
            if (bodyB.ShouldCollide(bodyA) == false) {
               var cNuke = c;
               c = cNuke.GetNext();
               this.Destroy(cNuke);
               continue;
            }
            if (this.m_contactFilter.ShouldCollide(fixtureA, fixtureB) == false) {
               cNuke = c;
               c = cNuke.GetNext();
               this.Destroy(cNuke);
               continue;
            }
            c.m_flags &= ~b2Contact.e_filterFlag;
         }
         var proxyA = fixtureA.m_proxy;
         var proxyB = fixtureB.m_proxy;
         var overlap = this.m_broadPhase.TestOverlap(proxyA, proxyB);
         if (overlap == false) {
            cNuke = c;
            c = cNuke.GetNext();
            this.Destroy(cNuke);
            continue;
         }
         c.Update(this.m_contactListener);
         c = c.GetNext();
      }
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.b2ContactManager.s_evalCP = new b2ContactPoint();
   });
   b2DebugDraw.b2DebugDraw = function () {};
   b2DebugDraw.prototype.b2DebugDraw = function () {}
   b2DebugDraw.prototype.SetFlags = function (flags) {
      if (flags === undefined) flags = 0;
   }
   b2DebugDraw.prototype.GetFlags = function () {}
   b2DebugDraw.prototype.AppendFlags = function (flags) {
      if (flags === undefined) flags = 0;
   }
   b2DebugDraw.prototype.ClearFlags = function (flags) {
      if (flags === undefined) flags = 0;
   }
   b2DebugDraw.prototype.SetSprite = function (sprite) {}
   b2DebugDraw.prototype.GetSprite = function () {}
   b2DebugDraw.prototype.SetDrawScale = function (drawScale) {
      if (drawScale === undefined) drawScale = 0;
   }
   b2DebugDraw.prototype.GetDrawScale = function () {}
   b2DebugDraw.prototype.SetLineThickness = function (lineThickness) {
      if (lineThickness === undefined) lineThickness = 0;
   }
   b2DebugDraw.prototype.GetLineThickness = function () {}
   b2DebugDraw.prototype.SetAlpha = function (alpha) {
      if (alpha === undefined) alpha = 0;
   }
   b2DebugDraw.prototype.GetAlpha = function () {}
   b2DebugDraw.prototype.SetFillAlpha = function (alpha) {
      if (alpha === undefined) alpha = 0;
   }
   b2DebugDraw.prototype.GetFillAlpha = function () {}
   b2DebugDraw.prototype.SetXFormScale = function (xformScale) {
      if (xformScale === undefined) xformScale = 0;
   }
   b2DebugDraw.prototype.GetXFormScale = function () {}
   b2DebugDraw.prototype.DrawPolygon = function (vertices, vertexCount, color) {
      if (vertexCount === undefined) vertexCount = 0;
   }
   b2DebugDraw.prototype.DrawSolidPolygon = function (vertices, vertexCount, color) {
      if (vertexCount === undefined) vertexCount = 0;
   }
   b2DebugDraw.prototype.DrawCircle = function (center, radius, color) {
      if (radius === undefined) radius = 0;
   }
   b2DebugDraw.prototype.DrawSolidCircle = function (center, radius, axis, color) {
      if (radius === undefined) radius = 0;
   }
   b2DebugDraw.prototype.DrawSegment = function (p1, p2, color) {}
   b2DebugDraw.prototype.DrawTransform = function (xf) {}
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.b2DebugDraw.e_shapeBit = 0x0001;
      Box2D.Dynamics.b2DebugDraw.e_jointBit = 0x0002;
      Box2D.Dynamics.b2DebugDraw.e_aabbBit = 0x0004;
      Box2D.Dynamics.b2DebugDraw.e_pairBit = 0x0008;
      Box2D.Dynamics.b2DebugDraw.e_centerOfMassBit = 0x0010;
      Box2D.Dynamics.b2DebugDraw.e_controllerBit = 0x0020;
   });
   b2DestructionListener.b2DestructionListener = function () {};
   b2DestructionListener.prototype.SayGoodbyeJoint = function (joint) {}
   b2DestructionListener.prototype.SayGoodbyeFixture = function (fixture) {}
   b2FilterData.b2FilterData = function () {
      this.categoryBits = 0x0001;
      this.maskBits = 0xFFFF;
      this.groupIndex = 0;
   };
   b2FilterData.prototype.Copy = function () {
      var copy = new b2FilterData();
      copy.categoryBits = this.categoryBits;
      copy.maskBits = this.maskBits;
      copy.groupIndex = this.groupIndex;
      return copy;
   }
   b2Fixture.b2Fixture = function () {
      this.m_filter = new b2FilterData();
   };
   b2Fixture.prototype.GetType = function () {
      return this.m_shape.GetType();
   }
   b2Fixture.prototype.GetShape = function () {
      return this.m_shape;
   }
   b2Fixture.prototype.SetSensor = function (sensor) {
      if (this.m_isSensor == sensor) return;
      this.m_isSensor = sensor;
      if (this.m_body == null) return;
      var edge = this.m_body.GetContactList();
      while (edge) {
         var contact = edge.contact;
         var fixtureA = contact.GetFixtureA();
         var fixtureB = contact.GetFixtureB();
         if (fixtureA == this || fixtureB == this) contact.SetSensor(fixtureA.IsSensor() || fixtureB.IsSensor());
         edge = edge.next;
      }
   }
   b2Fixture.prototype.IsSensor = function () {
      return this.m_isSensor;
   }
   b2Fixture.prototype.SetFilterData = function (filter) {
      this.m_filter = filter.Copy();
      if (this.m_body) return;
      var edge = this.m_body.GetContactList();
      while (edge) {
         var contact = edge.contact;
         var fixtureA = contact.GetFixtureA();
         var fixtureB = contact.GetFixtureB();
         if (fixtureA == this || fixtureB == this) contact.FlagForFiltering();
         edge = edge.next;
      }
   }
   b2Fixture.prototype.GetFilterData = function () {
      return this.m_filter.Copy();
   }
   b2Fixture.prototype.GetBody = function () {
      return this.m_body;
   }
   b2Fixture.prototype.GetNext = function () {
      return this.m_next;
   }
   b2Fixture.prototype.GetUserData = function () {
      return this.m_userData;
   }
   b2Fixture.prototype.SetUserData = function (data) {
      this.m_userData = data;
   }
   b2Fixture.prototype.TestPoint = function (p) {
      return this.m_shape.TestPoint(this.m_body.GetTransform(), p);
   }
   b2Fixture.prototype.RayCast = function (output, input) {
      return this.m_shape.RayCast(output, input, this.m_body.GetTransform());
   }
   b2Fixture.prototype.GetMassData = function (massData) {
      if (massData === undefined) massData = null;
      if (massData == null) {
         massData = new b2MassData();
      }
      this.m_shape.ComputeMass(massData, this.m_density);
      return massData;
   }
   b2Fixture.prototype.SetDensity = function (density) {
      if (density === undefined) density = 0;
      this.m_density = density;
   }
   b2Fixture.prototype.GetDensity = function () {
      return this.m_density;
   }
   b2Fixture.prototype.GetFriction = function () {
      return this.m_friction;
   }
   b2Fixture.prototype.SetFriction = function (friction) {
      if (friction === undefined) friction = 0;
      this.m_friction = friction;
   }
   b2Fixture.prototype.GetRestitution = function () {
      return this.m_restitution;
   }
   b2Fixture.prototype.SetRestitution = function (restitution) {
      if (restitution === undefined) restitution = 0;
      this.m_restitution = restitution;
   }
   b2Fixture.prototype.GetAABB = function () {
      return this.m_aabb;
   }
   b2Fixture.prototype.b2Fixture = function () {
      this.m_aabb = new b2AABB();
      this.m_userData = null;
      this.m_body = null;
      this.m_next = null;
      this.m_shape = null;
      this.m_density = 0.0;
      this.m_friction = 0.0;
      this.m_restitution = 0.0;
   }
   b2Fixture.prototype.Create = function (body, xf, def) {
      this.m_userData = def.userData;
      this.m_friction = def.friction;
      this.m_restitution = def.restitution;
      this.m_body = body;
      this.m_next = null;
      this.m_filter = def.filter.Copy();
      this.m_isSensor = def.isSensor;
      this.m_shape = def.shape.Copy();
      this.m_density = def.density;
   }
   b2Fixture.prototype.Destroy = function () {
      this.m_shape = null;
   }
   b2Fixture.prototype.CreateProxy = function (broadPhase, xf) {
      this.m_shape.ComputeAABB(this.m_aabb, xf);
      this.m_proxy = broadPhase.CreateProxy(this.m_aabb, this);
   }
   b2Fixture.prototype.DestroyProxy = function (broadPhase) {
      if (this.m_proxy == null) {
         return;
      }
      broadPhase.DestroyProxy(this.m_proxy);
      this.m_proxy = null;
   }
   b2Fixture.prototype.Synchronize = function (broadPhase, transform1, transform2) {
      if (!this.m_proxy) return;
      var aabb1 = new b2AABB();
      var aabb2 = new b2AABB();
      this.m_shape.ComputeAABB(aabb1, transform1);
      this.m_shape.ComputeAABB(aabb2, transform2);
      this.m_aabb.Combine(aabb1, aabb2);
      var displacement = b2Math.SubtractVV(transform2.position, transform1.position);
      broadPhase.MoveProxy(this.m_proxy, this.m_aabb, displacement);
   }
   b2FixtureDef.b2FixtureDef = function () {
      this.filter = new b2FilterData();
   };
   b2FixtureDef.prototype.b2FixtureDef = function () {
      this.shape = null;
      this.userData = null;
      this.friction = 0.2;
      this.restitution = 0.0;
      this.density = 0.0;
      this.filter.categoryBits = 0x0001;
      this.filter.maskBits = 0xFFFF;
      this.filter.groupIndex = 0;
      this.isSensor = false;
   }
   b2Island.b2Island = function () {};
   b2Island.prototype.b2Island = function () {
      this.m_bodies = new Vector();
      this.m_contacts = new Vector();
      this.m_joints = new Vector();
   }
   b2Island.prototype.Initialize = function (bodyCapacity, contactCapacity, jointCapacity, allocator, listener, contactSolver) {
      if (bodyCapacity === undefined) bodyCapacity = 0;
      if (contactCapacity === undefined) contactCapacity = 0;
      if (jointCapacity === undefined) jointCapacity = 0;
      var i = 0;
      this.m_bodyCapacity = bodyCapacity;
      this.m_contactCapacity = contactCapacity;
      this.m_jointCapacity = jointCapacity;
      this.m_bodyCount = 0;
      this.m_contactCount = 0;
      this.m_jointCount = 0;
      this.m_allocator = allocator;
      this.m_listener = listener;
      this.m_contactSolver = contactSolver;
      for (i = this.m_bodies.length;
      i < bodyCapacity; i++)
      this.m_bodies[i] = null;
      for (i = this.m_contacts.length;
      i < contactCapacity; i++)
      this.m_contacts[i] = null;
      for (i = this.m_joints.length;
      i < jointCapacity; i++)
      this.m_joints[i] = null;
   }
   b2Island.prototype.Clear = function () {
      this.m_bodyCount = 0;
      this.m_contactCount = 0;
      this.m_jointCount = 0;
   }
   b2Island.prototype.Solve = function (step, gravity, allowSleep) {
      var i = 0;
      var j = 0;
      var b;
      var joint;
      for (i = 0;
      i < this.m_bodyCount; ++i) {
         b = this.m_bodies[i];
         if (b.GetType() != b2Body.b2_dynamicBody) continue;
         b.m_linearVelocity.x += step.dt * (gravity.x + b.m_invMass * b.m_force.x);
         b.m_linearVelocity.y += step.dt * (gravity.y + b.m_invMass * b.m_force.y);
         b.m_angularVelocity += step.dt * b.m_invI * b.m_torque;
         b.m_linearVelocity.Multiply(b2Math.Clamp(1.0 - step.dt * b.m_linearDamping, 0.0, 1.0));
         b.m_angularVelocity *= b2Math.Clamp(1.0 - step.dt * b.m_angularDamping, 0.0, 1.0);
      }
      this.m_contactSolver.Initialize(step, this.m_contacts, this.m_contactCount, this.m_allocator);
      var contactSolver = this.m_contactSolver;
      contactSolver.InitVelocityConstraints(step);
      for (i = 0;
      i < this.m_jointCount; ++i) {
         joint = this.m_joints[i];
         joint.InitVelocityConstraints(step);
      }
      for (i = 0;
      i < step.velocityIterations; ++i) {
         for (j = 0;
         j < this.m_jointCount; ++j) {
            joint = this.m_joints[j];
            joint.SolveVelocityConstraints(step);
         }
         contactSolver.SolveVelocityConstraints();
      }
      for (i = 0;
      i < this.m_jointCount; ++i) {
         joint = this.m_joints[i];
         joint.FinalizeVelocityConstraints();
      }
      contactSolver.FinalizeVelocityConstraints();
      for (i = 0;
      i < this.m_bodyCount; ++i) {
         b = this.m_bodies[i];
         if (b.GetType() == b2Body.b2_staticBody) continue;
         var translationX = step.dt * b.m_linearVelocity.x;
         var translationY = step.dt * b.m_linearVelocity.y;
         if ((translationX * translationX + translationY * translationY) > b2Settings.b2_maxTranslationSquared) {
            b.m_linearVelocity.Normalize();
            b.m_linearVelocity.x *= b2Settings.b2_maxTranslation * step.inv_dt;
            b.m_linearVelocity.y *= b2Settings.b2_maxTranslation * step.inv_dt;
         }
         var rotation = step.dt * b.m_angularVelocity;
         if (rotation * rotation > b2Settings.b2_maxRotationSquared) {
            if (b.m_angularVelocity < 0.0) {
               b.m_angularVelocity = (-b2Settings.b2_maxRotation * step.inv_dt);
            }
            else {
               b.m_angularVelocity = b2Settings.b2_maxRotation * step.inv_dt;
            }
         }
         b.m_sweep.c0.SetV(b.m_sweep.c);
         b.m_sweep.a0 = b.m_sweep.a;
         b.m_sweep.c.x += step.dt * b.m_linearVelocity.x;
         b.m_sweep.c.y += step.dt * b.m_linearVelocity.y;
         b.m_sweep.a += step.dt * b.m_angularVelocity;
         b.SynchronizeTransform();
      }
      for (i = 0;
      i < step.positionIterations; ++i) {
         var contactsOkay = contactSolver.SolvePositionConstraints(b2Settings.b2_contactBaumgarte);
         var jointsOkay = true;
         for (j = 0;
         j < this.m_jointCount; ++j) {
            joint = this.m_joints[j];
            var jointOkay = joint.SolvePositionConstraints(b2Settings.b2_contactBaumgarte);
            jointsOkay = jointsOkay && jointOkay;
         }
         if (contactsOkay && jointsOkay) {
            break;
         }
      }
      this.Report(contactSolver.m_constraints);
      if (allowSleep) {
         var minSleepTime = Number.MAX_VALUE;
         var linTolSqr = b2Settings.b2_linearSleepTolerance * b2Settings.b2_linearSleepTolerance;
         var angTolSqr = b2Settings.b2_angularSleepTolerance * b2Settings.b2_angularSleepTolerance;
         for (i = 0;
         i < this.m_bodyCount; ++i) {
            b = this.m_bodies[i];
            if (b.GetType() == b2Body.b2_staticBody) {
               continue;
            }
            if ((b.m_flags & b2Body.e_allowSleepFlag) == 0) {
               b.m_sleepTime = 0.0;
               minSleepTime = 0.0;
            }
            if ((b.m_flags & b2Body.e_allowSleepFlag) == 0 || b.m_angularVelocity * b.m_angularVelocity > angTolSqr || b2Math.Dot(b.m_linearVelocity, b.m_linearVelocity) > linTolSqr) {
               b.m_sleepTime = 0.0;
               minSleepTime = 0.0;
            }
            else {
               b.m_sleepTime += step.dt;
               minSleepTime = b2Math.Min(minSleepTime, b.m_sleepTime);
            }
         }
         if (minSleepTime >= b2Settings.b2_timeToSleep) {
            for (i = 0;
            i < this.m_bodyCount; ++i) {
               b = this.m_bodies[i];
               b.SetAwake(false);
            }
         }
      }
   }
   b2Island.prototype.SolveTOI = function (subStep) {
      var i = 0;
      var j = 0;
      this.m_contactSolver.Initialize(subStep, this.m_contacts, this.m_contactCount, this.m_allocator);
      var contactSolver = this.m_contactSolver;
      for (i = 0;
      i < this.m_jointCount; ++i) {
         this.m_joints[i].InitVelocityConstraints(subStep);
      }
      for (i = 0;
      i < subStep.velocityIterations; ++i) {
         contactSolver.SolveVelocityConstraints();
         for (j = 0;
         j < this.m_jointCount; ++j) {
            this.m_joints[j].SolveVelocityConstraints(subStep);
         }
      }
      for (i = 0;
      i < this.m_bodyCount; ++i) {
         var b = this.m_bodies[i];
         if (b.GetType() == b2Body.b2_staticBody) continue;
         var translationX = subStep.dt * b.m_linearVelocity.x;
         var translationY = subStep.dt * b.m_linearVelocity.y;
         if ((translationX * translationX + translationY * translationY) > b2Settings.b2_maxTranslationSquared) {
            b.m_linearVelocity.Normalize();
            b.m_linearVelocity.x *= b2Settings.b2_maxTranslation * subStep.inv_dt;
            b.m_linearVelocity.y *= b2Settings.b2_maxTranslation * subStep.inv_dt;
         }
         var rotation = subStep.dt * b.m_angularVelocity;
         if (rotation * rotation > b2Settings.b2_maxRotationSquared) {
            if (b.m_angularVelocity < 0.0) {
               b.m_angularVelocity = (-b2Settings.b2_maxRotation * subStep.inv_dt);
            }
            else {
               b.m_angularVelocity = b2Settings.b2_maxRotation * subStep.inv_dt;
            }
         }
         b.m_sweep.c0.SetV(b.m_sweep.c);
         b.m_sweep.a0 = b.m_sweep.a;
         b.m_sweep.c.x += subStep.dt * b.m_linearVelocity.x;
         b.m_sweep.c.y += subStep.dt * b.m_linearVelocity.y;
         b.m_sweep.a += subStep.dt * b.m_angularVelocity;
         b.SynchronizeTransform();
      }
      var k_toiBaumgarte = 0.75;
      for (i = 0;
      i < subStep.positionIterations; ++i) {
         var contactsOkay = contactSolver.SolvePositionConstraints(k_toiBaumgarte);
         var jointsOkay = true;
         for (j = 0;
         j < this.m_jointCount; ++j) {
            var jointOkay = this.m_joints[j].SolvePositionConstraints(b2Settings.b2_contactBaumgarte);
            jointsOkay = jointsOkay && jointOkay;
         }
         if (contactsOkay && jointsOkay) {
            break;
         }
      }
      this.Report(contactSolver.m_constraints);
   }
   b2Island.prototype.Report = function (constraints) {
      if (this.m_listener == null) {
         return;
      }
      for (var i = 0; i < this.m_contactCount; ++i) {
         var c = this.m_contacts[i];
         var cc = constraints[i];
         for (var j = 0; j < cc.pointCount; ++j) {
            b2Island.s_impulse.normalImpulses[j] = cc.points[j].normalImpulse;
            b2Island.s_impulse.tangentImpulses[j] = cc.points[j].tangentImpulse;
         }
         this.m_listener.PostSolve(c, b2Island.s_impulse);
      }
   }
   b2Island.prototype.AddBody = function (body) {
      body.m_islandIndex = this.m_bodyCount;
      this.m_bodies[this.m_bodyCount++] = body;
   }
   b2Island.prototype.AddContact = function (contact) {
      this.m_contacts[this.m_contactCount++] = contact;
   }
   b2Island.prototype.AddJoint = function (joint) {
      this.m_joints[this.m_jointCount++] = joint;
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.b2Island.s_impulse = new b2ContactImpulse();
   });
   b2TimeStep.b2TimeStep = function () {};
   b2TimeStep.prototype.Set = function (step) {
      this.dt = step.dt;
      this.inv_dt = step.inv_dt;
      this.positionIterations = step.positionIterations;
      this.velocityIterations = step.velocityIterations;
      this.warmStarting = step.warmStarting;
   }
   b2World.b2World = function () {
      this.s_stack = new Vector();
      this.m_contactManager = new b2ContactManager();
      this.m_contactSolver = new b2ContactSolver();
      this.m_island = new b2Island();
   };
   b2World.prototype.b2World = function (gravity, doSleep) {
      this.m_destructionListener = null;
      this.m_debugDraw = null;
      this.m_bodyList = null;
      this.m_contactList = null;
      this.m_jointList = null;
      this.m_controllerList = null;
      this.m_bodyCount = 0;
      this.m_contactCount = 0;
      this.m_jointCount = 0;
      this.m_controllerCount = 0;
      b2World.m_warmStarting = true;
      b2World.m_continuousPhysics = true;
      this.m_allowSleep = doSleep;
      this.m_gravity = gravity;
      this.m_inv_dt0 = 0.0;
      this.m_contactManager.m_world = this;
      var bd = new b2BodyDef();
      this.m_groundBody = this.CreateBody(bd);
   }
   b2World.prototype.SetDestructionListener = function (listener) {
      this.m_destructionListener = listener;
   }
   b2World.prototype.SetContactFilter = function (filter) {
      this.m_contactManager.m_contactFilter = filter;
   }
   b2World.prototype.SetContactListener = function (listener) {
      this.m_contactManager.m_contactListener = listener;
   }
   b2World.prototype.SetDebugDraw = function (debugDraw) {
      this.m_debugDraw = debugDraw;
   }
   b2World.prototype.SetBroadPhase = function (broadPhase) {
      var oldBroadPhase = this.m_contactManager.m_broadPhase;
      this.m_contactManager.m_broadPhase = broadPhase;
      for (var b = this.m_bodyList; b; b = b.m_next) {
         for (var f = b.m_fixtureList; f; f = f.m_next) {
            f.m_proxy = broadPhase.CreateProxy(oldBroadPhase.GetFatAABB(f.m_proxy), f);
         }
      }
   }
   b2World.prototype.Validate = function () {
      this.m_contactManager.m_broadPhase.Validate();
   }
   b2World.prototype.GetProxyCount = function () {
      return this.m_contactManager.m_broadPhase.GetProxyCount();
   }
   b2World.prototype.CreateBody = function (def) {
      if (this.IsLocked() == true) {
         return null;
      }
      var b = new b2Body(def, this);
      b.m_prev = null;
      b.m_next = this.m_bodyList;
      if (this.m_bodyList) {
         this.m_bodyList.m_prev = b;
      }
      this.m_bodyList = b;
      ++this.m_bodyCount;
      return b;
   }
   b2World.prototype.DestroyBody = function (b) {
      if (this.IsLocked() == true) {
         return;
      }
      var jn = b.m_jointList;
      while (jn) {
         var jn0 = jn;
         jn = jn.next;
         if (this.m_destructionListener) {
            this.m_destructionListener.SayGoodbyeJoint(jn0.joint);
         }
         this.DestroyJoint(jn0.joint);
      }
      var coe = b.m_controllerList;
      while (coe) {
         var coe0 = coe;
         coe = coe.nextController;
         coe0.controller.RemoveBody(b);
      }
      var ce = b.m_contactList;
      while (ce) {
         var ce0 = ce;
         ce = ce.next;
         this.m_contactManager.Destroy(ce0.contact);
      }
      b.m_contactList = null;
      var f = b.m_fixtureList;
      while (f) {
         var f0 = f;
         f = f.m_next;
         if (this.m_destructionListener) {
            this.m_destructionListener.SayGoodbyeFixture(f0);
         }
         f0.DestroyProxy(this.m_contactManager.m_broadPhase);
         f0.Destroy();
      }
      b.m_fixtureList = null;
      b.m_fixtureCount = 0;
      if (b.m_prev) {
         b.m_prev.m_next = b.m_next;
      }
      if (b.m_next) {
         b.m_next.m_prev = b.m_prev;
      }
      if (b == this.m_bodyList) {
         this.m_bodyList = b.m_next;
      }--this.m_bodyCount;
   }
   b2World.prototype.CreateJoint = function (def) {
      var j = b2Joint.Create(def, null);
      j.m_prev = null;
      j.m_next = this.m_jointList;
      if (this.m_jointList) {
         this.m_jointList.m_prev = j;
      }
      this.m_jointList = j;
      ++this.m_jointCount;
      j.m_edgeA.joint = j;
      j.m_edgeA.other = j.m_bodyB;
      j.m_edgeA.prev = null;
      j.m_edgeA.next = j.m_bodyA.m_jointList;
      if (j.m_bodyA.m_jointList) j.m_bodyA.m_jointList.prev = j.m_edgeA;
      j.m_bodyA.m_jointList = j.m_edgeA;
      j.m_edgeB.joint = j;
      j.m_edgeB.other = j.m_bodyA;
      j.m_edgeB.prev = null;
      j.m_edgeB.next = j.m_bodyB.m_jointList;
      if (j.m_bodyB.m_jointList) j.m_bodyB.m_jointList.prev = j.m_edgeB;
      j.m_bodyB.m_jointList = j.m_edgeB;
      var bodyA = def.bodyA;
      var bodyB = def.bodyB;
      if (def.collideConnected == false) {
         var edge = bodyB.GetContactList();
         while (edge) {
            if (edge.other == bodyA) {
               edge.contact.FlagForFiltering();
            }
            edge = edge.next;
         }
      }
      return j;
   }
   b2World.prototype.DestroyJoint = function (j) {
      var collideConnected = j.m_collideConnected;
      if (j.m_prev) {
         j.m_prev.m_next = j.m_next;
      }
      if (j.m_next) {
         j.m_next.m_prev = j.m_prev;
      }
      if (j == this.m_jointList) {
         this.m_jointList = j.m_next;
      }
      var bodyA = j.m_bodyA;
      var bodyB = j.m_bodyB;
      bodyA.SetAwake(true);
      bodyB.SetAwake(true);
      if (j.m_edgeA.prev) {
         j.m_edgeA.prev.next = j.m_edgeA.next;
      }
      if (j.m_edgeA.next) {
         j.m_edgeA.next.prev = j.m_edgeA.prev;
      }
      if (j.m_edgeA == bodyA.m_jointList) {
         bodyA.m_jointList = j.m_edgeA.next;
      }
      j.m_edgeA.prev = null;
      j.m_edgeA.next = null;
      if (j.m_edgeB.prev) {
         j.m_edgeB.prev.next = j.m_edgeB.next;
      }
      if (j.m_edgeB.next) {
         j.m_edgeB.next.prev = j.m_edgeB.prev;
      }
      if (j.m_edgeB == bodyB.m_jointList) {
         bodyB.m_jointList = j.m_edgeB.next;
      }
      j.m_edgeB.prev = null;
      j.m_edgeB.next = null;
      b2Joint.Destroy(j, null);
      --this.m_jointCount;
      if (collideConnected == false) {
         var edge = bodyB.GetContactList();
         while (edge) {
            if (edge.other == bodyA) {
               edge.contact.FlagForFiltering();
            }
            edge = edge.next;
         }
      }
   }
   b2World.prototype.AddController = function (c) {
      c.m_next = this.m_controllerList;
      c.m_prev = null;
      this.m_controllerList = c;
      c.m_world = this;
      this.m_controllerCount++;
      return c;
   }
   b2World.prototype.RemoveController = function (c) {
      if (c.m_prev) c.m_prev.m_next = c.m_next;
      if (c.m_next) c.m_next.m_prev = c.m_prev;
      if (this.m_controllerList == c) this.m_controllerList = c.m_next;
      this.m_controllerCount--;
   }
   b2World.prototype.CreateController = function (controller) {
      if (controller.m_world != this) throw new Error("Controller can only be a member of one world");
      controller.m_next = this.m_controllerList;
      controller.m_prev = null;
      if (this.m_controllerList) this.m_controllerList.m_prev = controller;
      this.m_controllerList = controller;
      ++this.m_controllerCount;
      controller.m_world = this;
      return controller;
   }
   b2World.prototype.DestroyController = function (controller) {
      controller.Clear();
      if (controller.m_next) controller.m_next.m_prev = controller.m_prev;
      if (controller.m_prev) controller.m_prev.m_next = controller.m_next;
      if (controller == this.m_controllerList) this.m_controllerList = controller.m_next;
      --this.m_controllerCount;
   }
   b2World.prototype.SetWarmStarting = function (flag) {
      b2World.m_warmStarting = flag;
   }
   b2World.prototype.SetContinuousPhysics = function (flag) {
      b2World.m_continuousPhysics = flag;
   }
   b2World.prototype.GetBodyCount = function () {
      return this.m_bodyCount;
   }
   b2World.prototype.GetJointCount = function () {
      return this.m_jointCount;
   }
   b2World.prototype.GetContactCount = function () {
      return this.m_contactCount;
   }
   b2World.prototype.SetGravity = function (gravity) {
      this.m_gravity = gravity;
   }
   b2World.prototype.GetGravity = function () {
      return this.m_gravity;
   }
   b2World.prototype.GetGroundBody = function () {
      return this.m_groundBody;
   }
   b2World.prototype.Step = function (dt, velocityIterations, positionIterations) {
      if (dt === undefined) dt = 0;
      if (velocityIterations === undefined) velocityIterations = 0;
      if (positionIterations === undefined) positionIterations = 0;
      if (this.m_flags & b2World.e_newFixture) {
         this.m_contactManager.FindNewContacts();
         this.m_flags &= ~b2World.e_newFixture;
      }
      this.m_flags |= b2World.e_locked;
      var step = b2World.s_timestep2;
      step.dt = dt;
      step.velocityIterations = velocityIterations;
      step.positionIterations = positionIterations;
      if (dt > 0.0) {
         step.inv_dt = 1.0 / dt;
      }
      else {
         step.inv_dt = 0.0;
      }
      step.dtRatio = this.m_inv_dt0 * dt;
      step.warmStarting = b2World.m_warmStarting;
      this.m_contactManager.Collide();
      if (step.dt > 0.0) {
         this.Solve(step);
      }
      if (b2World.m_continuousPhysics && step.dt > 0.0) {
         this.SolveTOI(step);
      }
      if (step.dt > 0.0) {
         this.m_inv_dt0 = step.inv_dt;
      }
      this.m_flags &= ~b2World.e_locked;
   }
   b2World.prototype.ClearForces = function () {
      for (var body = this.m_bodyList; body; body = body.m_next) {
         body.m_force.SetZero();
         body.m_torque = 0.0;
      }
   }
   b2World.prototype.DrawDebugData = function () {
      if (this.m_debugDraw == null) {
         return;
      }
      this.m_debugDraw.m_sprite.graphics.clear();
      var flags = this.m_debugDraw.GetFlags();
      var i = 0;
      var b;
      var f;
      var s;
      var j;
      var bp;
      var invQ = new b2Vec2;
      var x1 = new b2Vec2;
      var x2 = new b2Vec2;
      var xf;
      var b1 = new b2AABB();
      var b2 = new b2AABB();
      var vs = [new b2Vec2(), new b2Vec2(), new b2Vec2(), new b2Vec2()];
      var color = new b2Color(0, 0, 0);
      if (flags & b2DebugDraw.e_shapeBit) {
         for (b = this.m_bodyList;
         b; b = b.m_next) {
            xf = b.m_xf;
            for (f = b.GetFixtureList();
            f; f = f.m_next) {
               s = f.GetShape();
               if (b.IsActive() == false) {
                  color.Set(0.5, 0.5, 0.3);
                  this.DrawShape(s, xf, color);
               }
               else if (b.GetType() == b2Body.b2_staticBody) {
                  color.Set(0.5, 0.9, 0.5);
                  this.DrawShape(s, xf, color);
               }
               else if (b.GetType() == b2Body.b2_kinematicBody) {
                  color.Set(0.5, 0.5, 0.9);
                  this.DrawShape(s, xf, color);
               }
               else if (b.IsAwake() == false) {
                  color.Set(0.6, 0.6, 0.6);
                  this.DrawShape(s, xf, color);
               }
               else {
                  color.Set(0.9, 0.7, 0.7);
                  this.DrawShape(s, xf, color);
               }
            }
         }
      }
      if (flags & b2DebugDraw.e_jointBit) {
         for (j = this.m_jointList;
         j; j = j.m_next) {
            this.DrawJoint(j);
         }
      }
      if (flags & b2DebugDraw.e_controllerBit) {
         for (var c = this.m_controllerList; c; c = c.m_next) {
            c.Draw(this.m_debugDraw);
         }
      }
      if (flags & b2DebugDraw.e_pairBit) {
         color.Set(0.3, 0.9, 0.9);
         for (var contact = this.m_contactManager.m_contactList; contact; contact = contact.GetNext()) {
            var fixtureA = contact.GetFixtureA();
            var fixtureB = contact.GetFixtureB();
            var cA = fixtureA.GetAABB().GetCenter();
            var cB = fixtureB.GetAABB().GetCenter();
            this.m_debugDraw.DrawSegment(cA, cB, color);
         }
      }
      if (flags & b2DebugDraw.e_aabbBit) {
         bp = this.m_contactManager.m_broadPhase;
         vs = [new b2Vec2(), new b2Vec2(), new b2Vec2(), new b2Vec2()];
         for (b = this.m_bodyList;
         b; b = b.GetNext()) {
            if (b.IsActive() == false) {
               continue;
            }
            for (f = b.GetFixtureList();
            f; f = f.GetNext()) {
               var aabb = bp.GetFatAABB(f.m_proxy);
               vs[0].Set(aabb.lowerBound.x, aabb.lowerBound.y);
               vs[1].Set(aabb.upperBound.x, aabb.lowerBound.y);
               vs[2].Set(aabb.upperBound.x, aabb.upperBound.y);
               vs[3].Set(aabb.lowerBound.x, aabb.upperBound.y);
               this.m_debugDraw.DrawPolygon(vs, 4, color);
            }
         }
      }
      if (flags & b2DebugDraw.e_centerOfMassBit) {
         for (b = this.m_bodyList;
         b; b = b.m_next) {
            xf = b2World.s_xf;
            xf.R = b.m_xf.R;
            xf.position = b.GetWorldCenter();
            this.m_debugDraw.DrawTransform(xf);
         }
      }
   }
   b2World.prototype.QueryAABB = function (callback, aabb) {
      var __this = this;
      var broadPhase = __this.m_contactManager.m_broadPhase;

      function WorldQueryWrapper(proxy) {
         return callback(broadPhase.GetUserData(proxy));
      };
      broadPhase.Query(WorldQueryWrapper, aabb);
   }
   b2World.prototype.QueryShape = function (callback, shape, transform) {
      var __this = this;
      if (transform === undefined) transform = null;
      if (transform == null) {
         transform = new b2Transform();
         transform.SetIdentity();
      }
      var broadPhase = __this.m_contactManager.m_broadPhase;

      function WorldQueryWrapper(proxy) {
         var fixture = (broadPhase.GetUserData(proxy) instanceof b2Fixture ? broadPhase.GetUserData(proxy) : null);
         if (b2Shape.TestOverlap(shape, transform, fixture.GetShape(), fixture.GetBody().GetTransform())) return callback(fixture);
         return true;
      };
      var aabb = new b2AABB();
      shape.ComputeAABB(aabb, transform);
      broadPhase.Query(WorldQueryWrapper, aabb);
   }
   b2World.prototype.QueryPoint = function (callback, p) {
      var __this = this;
      var broadPhase = __this.m_contactManager.m_broadPhase;

      function WorldQueryWrapper(proxy) {
         var fixture = (broadPhase.GetUserData(proxy) instanceof b2Fixture ? broadPhase.GetUserData(proxy) : null);
         if (fixture.TestPoint(p)) return callback(fixture);
         return true;
      };
      var aabb = new b2AABB();
      aabb.lowerBound.Set(p.x - b2Settings.b2_linearSlop, p.y - b2Settings.b2_linearSlop);
      aabb.upperBound.Set(p.x + b2Settings.b2_linearSlop, p.y + b2Settings.b2_linearSlop);
      broadPhase.Query(WorldQueryWrapper, aabb);
   }
   b2World.prototype.RayCast = function (callback, point1, point2) {
      var __this = this;
      var broadPhase = __this.m_contactManager.m_broadPhase;
      var output = new b2RayCastOutput;

      function RayCastWrapper(input, proxy) {
         var userData = broadPhase.GetUserData(proxy);
         var fixture = (userData instanceof b2Fixture ? userData : null);
         var hit = fixture.RayCast(output, input);
         if (hit) {
            var fraction = output.fraction;
            var point = new b2Vec2((1.0 - fraction) * point1.x + fraction * point2.x, (1.0 - fraction) * point1.y + fraction * point2.y);
            return callback(fixture, point, output.normal, fraction);
         }
         return input.maxFraction;
      };
      var input = new b2RayCastInput(point1, point2);
      broadPhase.RayCast(RayCastWrapper, input);
   }
   b2World.prototype.RayCastOne = function (point1, point2) {
      var __this = this;
      var result;

      function RayCastOneWrapper(fixture, point, normal, fraction) {
         if (fraction === undefined) fraction = 0;
         result = fixture;
         return fraction;
      };
      __this.RayCast(RayCastOneWrapper, point1, point2);
      return result;
   }
   b2World.prototype.RayCastAll = function (point1, point2) {
      var __this = this;
      var result = new Vector();

      function RayCastAllWrapper(fixture, point, normal, fraction) {
         if (fraction === undefined) fraction = 0;
         result[result.length] = fixture;
         return 1;
      };
      __this.RayCast(RayCastAllWrapper, point1, point2);
      return result;
   }
   b2World.prototype.GetBodyList = function () {
      return this.m_bodyList;
   }
   b2World.prototype.GetJointList = function () {
      return this.m_jointList;
   }
   b2World.prototype.GetContactList = function () {
      return this.m_contactList;
   }
   b2World.prototype.IsLocked = function () {
      return (this.m_flags & b2World.e_locked) > 0;
   }
   b2World.prototype.Solve = function (step) {
      var b;
      for (var controller = this.m_controllerList; controller; controller = controller.m_next) {
         controller.Step(step);
      }
      var island = this.m_island;
      island.Initialize(this.m_bodyCount, this.m_contactCount, this.m_jointCount, null, this.m_contactManager.m_contactListener, this.m_contactSolver);
      for (b = this.m_bodyList;
      b; b = b.m_next) {
         b.m_flags &= ~b2Body.e_islandFlag;
      }
      for (var c = this.m_contactList; c; c = c.m_next) {
         c.m_flags &= ~b2Contact.e_islandFlag;
      }
      for (var j = this.m_jointList; j; j = j.m_next) {
         j.m_islandFlag = false;
      }
      var stackSize = parseInt(this.m_bodyCount);
      var stack = this.s_stack;
      for (var seed = this.m_bodyList; seed; seed = seed.m_next) {
         if (seed.m_flags & b2Body.e_islandFlag) {
            continue;
         }
         if (seed.IsAwake() == false || seed.IsActive() == false) {
            continue;
         }
         if (seed.GetType() == b2Body.b2_staticBody) {
            continue;
         }
         island.Clear();
         var stackCount = 0;
         stack[stackCount++] = seed;
         seed.m_flags |= b2Body.e_islandFlag;
         while (stackCount > 0) {
            b = stack[--stackCount];
            island.AddBody(b);
            if (b.IsAwake() == false) {
               b.SetAwake(true);
            }
            if (b.GetType() == b2Body.b2_staticBody) {
               continue;
            }
            var other;
            for (var ce = b.m_contactList; ce; ce = ce.next) {
               if (ce.contact.m_flags & b2Contact.e_islandFlag) {
                  continue;
               }
               if (ce.contact.IsSensor() == true || ce.contact.IsEnabled() == false || ce.contact.IsTouching() == false) {
                  continue;
               }
               island.AddContact(ce.contact);
               ce.contact.m_flags |= b2Contact.e_islandFlag;
               other = ce.other;
               if (other.m_flags & b2Body.e_islandFlag) {
                  continue;
               }
               stack[stackCount++] = other;
               other.m_flags |= b2Body.e_islandFlag;
            }
            for (var jn = b.m_jointList; jn; jn = jn.next) {
               if (jn.joint.m_islandFlag == true) {
                  continue;
               }
               other = jn.other;
               if (other.IsActive() == false) {
                  continue;
               }
               island.AddJoint(jn.joint);
               jn.joint.m_islandFlag = true;
               if (other.m_flags & b2Body.e_islandFlag) {
                  continue;
               }
               stack[stackCount++] = other;
               other.m_flags |= b2Body.e_islandFlag;
            }
         }
         island.Solve(step, this.m_gravity, this.m_allowSleep);
         for (var i = 0; i < island.m_bodyCount; ++i) {
            b = island.m_bodies[i];
            if (b.GetType() == b2Body.b2_staticBody) {
               b.m_flags &= ~b2Body.e_islandFlag;
            }
         }
      }
      for (i = 0;
      i < stack.length; ++i) {
         if (!stack[i]) break;
         stack[i] = null;
      }
      for (b = this.m_bodyList;
      b; b = b.m_next) {
         if (b.IsAwake() == false || b.IsActive() == false) {
            continue;
         }
         if (b.GetType() == b2Body.b2_staticBody) {
            continue;
         }
         b.SynchronizeFixtures();
      }
      this.m_contactManager.FindNewContacts();
   }
   b2World.prototype.SolveTOI = function (step) {
      var b;
      var fA;
      var fB;
      var bA;
      var bB;
      var cEdge;
      var j;
      var island = this.m_island;
      island.Initialize(this.m_bodyCount, b2Settings.b2_maxTOIContactsPerIsland, b2Settings.b2_maxTOIJointsPerIsland, null, this.m_contactManager.m_contactListener, this.m_contactSolver);
      var queue = b2World.s_queue;
      for (b = this.m_bodyList;
      b; b = b.m_next) {
         b.m_flags &= ~b2Body.e_islandFlag;
         b.m_sweep.t0 = 0.0;
      }
      var c;
      for (c = this.m_contactList;
      c; c = c.m_next) {
         c.m_flags &= ~ (b2Contact.e_toiFlag | b2Contact.e_islandFlag);
      }
      for (j = this.m_jointList;
      j; j = j.m_next) {
         j.m_islandFlag = false;
      }
      for (;;) {
         var minContact = null;
         var minTOI = 1.0;
         for (c = this.m_contactList;
         c; c = c.m_next) {
            if (c.IsSensor() == true || c.IsEnabled() == false || c.IsContinuous() == false) {
               continue;
            }
            var toi = 1.0;
            if (c.m_flags & b2Contact.e_toiFlag) {
               toi = c.m_toi;
            }
            else {
               fA = c.m_fixtureA;
               fB = c.m_fixtureB;
               bA = fA.m_body;
               bB = fB.m_body;
               if ((bA.GetType() != b2Body.b2_dynamicBody || bA.IsAwake() == false) && (bB.GetType() != b2Body.b2_dynamicBody || bB.IsAwake() == false)) {
                  continue;
               }
               var t0 = bA.m_sweep.t0;
               if (bA.m_sweep.t0 < bB.m_sweep.t0) {
                  t0 = bB.m_sweep.t0;
                  bA.m_sweep.Advance(t0);
               }
               else if (bB.m_sweep.t0 < bA.m_sweep.t0) {
                  t0 = bA.m_sweep.t0;
                  bB.m_sweep.Advance(t0);
               }
               toi = c.ComputeTOI(bA.m_sweep, bB.m_sweep);
               b2Settings.b2Assert(0.0 <= toi && toi <= 1.0);
               if (toi > 0.0 && toi < 1.0) {
                  toi = (1.0 - toi) * t0 + toi;
                  if (toi > 1) toi = 1;
               }
               c.m_toi = toi;
               c.m_flags |= b2Contact.e_toiFlag;
            }
            if (Number.MIN_VALUE < toi && toi < minTOI) {
               minContact = c;
               minTOI = toi;
            }
         }
         if (minContact == null || 1.0 - 100.0 * Number.MIN_VALUE < minTOI) {
            break;
         }
         fA = minContact.m_fixtureA;
         fB = minContact.m_fixtureB;
         bA = fA.m_body;
         bB = fB.m_body;
         b2World.s_backupA.Set(bA.m_sweep);
         b2World.s_backupB.Set(bB.m_sweep);
         bA.Advance(minTOI);
         bB.Advance(minTOI);
         minContact.Update(this.m_contactManager.m_contactListener);
         minContact.m_flags &= ~b2Contact.e_toiFlag;
         if (minContact.IsSensor() == true || minContact.IsEnabled() == false) {
            bA.m_sweep.Set(b2World.s_backupA);
            bB.m_sweep.Set(b2World.s_backupB);
            bA.SynchronizeTransform();
            bB.SynchronizeTransform();
            continue;
         }
         if (minContact.IsTouching() == false) {
            continue;
         }
         var seed = bA;
         if (seed.GetType() != b2Body.b2_dynamicBody) {
            seed = bB;
         }
         island.Clear();
         var queueStart = 0;
         var queueSize = 0;
         queue[queueStart + queueSize++] = seed;
         seed.m_flags |= b2Body.e_islandFlag;
         while (queueSize > 0) {
            b = queue[queueStart++];
            --queueSize;
            island.AddBody(b);
            if (b.IsAwake() == false) {
               b.SetAwake(true);
            }
            if (b.GetType() != b2Body.b2_dynamicBody) {
               continue;
            }
            for (cEdge = b.m_contactList;
            cEdge; cEdge = cEdge.next) {
               if (island.m_contactCount == island.m_contactCapacity) {
                  break;
               }
               if (cEdge.contact.m_flags & b2Contact.e_islandFlag) {
                  continue;
               }
               if (cEdge.contact.IsSensor() == true || cEdge.contact.IsEnabled() == false || cEdge.contact.IsTouching() == false) {
                  continue;
               }
               island.AddContact(cEdge.contact);
               cEdge.contact.m_flags |= b2Contact.e_islandFlag;
               var other = cEdge.other;
               if (other.m_flags & b2Body.e_islandFlag) {
                  continue;
               }
               if (other.GetType() != b2Body.b2_staticBody) {
                  other.Advance(minTOI);
                  other.SetAwake(true);
               }
               queue[queueStart + queueSize] = other;
               ++queueSize;
               other.m_flags |= b2Body.e_islandFlag;
            }
            for (var jEdge = b.m_jointList; jEdge; jEdge = jEdge.next) {
               if (island.m_jointCount == island.m_jointCapacity) continue;
               if (jEdge.joint.m_islandFlag == true) continue;
               other = jEdge.other;
               if (other.IsActive() == false) {
                  continue;
               }
               island.AddJoint(jEdge.joint);
               jEdge.joint.m_islandFlag = true;
               if (other.m_flags & b2Body.e_islandFlag) continue;
               if (other.GetType() != b2Body.b2_staticBody) {
                  other.Advance(minTOI);
                  other.SetAwake(true);
               }
               queue[queueStart + queueSize] = other;
               ++queueSize;
               other.m_flags |= b2Body.e_islandFlag;
            }
         }
         var subStep = b2World.s_timestep;
         subStep.warmStarting = false;
         subStep.dt = (1.0 - minTOI) * step.dt;
         subStep.inv_dt = 1.0 / subStep.dt;
         subStep.dtRatio = 0.0;
         subStep.velocityIterations = step.velocityIterations;
         subStep.positionIterations = step.positionIterations;
         island.SolveTOI(subStep);
         var i = 0;
         for (i = 0;
         i < island.m_bodyCount; ++i) {
            b = island.m_bodies[i];
            b.m_flags &= ~b2Body.e_islandFlag;
            if (b.IsAwake() == false) {
               continue;
            }
            if (b.GetType() != b2Body.b2_dynamicBody) {
               continue;
            }
            b.SynchronizeFixtures();
            for (cEdge = b.m_contactList;
            cEdge; cEdge = cEdge.next) {
               cEdge.contact.m_flags &= ~b2Contact.e_toiFlag;
            }
         }
         for (i = 0;
         i < island.m_contactCount; ++i) {
            c = island.m_contacts[i];
            c.m_flags &= ~ (b2Contact.e_toiFlag | b2Contact.e_islandFlag);
         }
         for (i = 0;
         i < island.m_jointCount; ++i) {
            j = island.m_joints[i];
            j.m_islandFlag = false;
         }
         this.m_contactManager.FindNewContacts();
      }
   }
   b2World.prototype.DrawJoint = function (joint) {
      var b1 = joint.GetBodyA();
      var b2 = joint.GetBodyB();
      var xf1 = b1.m_xf;
      var xf2 = b2.m_xf;
      var x1 = xf1.position;
      var x2 = xf2.position;
      var p1 = joint.GetAnchorA();
      var p2 = joint.GetAnchorB();
      var color = b2World.s_jointColor;
      switch (joint.m_type) {
      case b2Joint.e_distanceJoint:
         this.m_debugDraw.DrawSegment(p1, p2, color);
         break;
      case b2Joint.e_pulleyJoint:
         {
            var pulley = ((joint instanceof b2PulleyJoint ? joint : null));
            var s1 = pulley.GetGroundAnchorA();
            var s2 = pulley.GetGroundAnchorB();
            this.m_debugDraw.DrawSegment(s1, p1, color);
            this.m_debugDraw.DrawSegment(s2, p2, color);
            this.m_debugDraw.DrawSegment(s1, s2, color);
         }
         break;
      case b2Joint.e_mouseJoint:
         this.m_debugDraw.DrawSegment(p1, p2, color);
         break;
      default:
         if (b1 != this.m_groundBody) this.m_debugDraw.DrawSegment(x1, p1, color);
         this.m_debugDraw.DrawSegment(p1, p2, color);
         if (b2 != this.m_groundBody) this.m_debugDraw.DrawSegment(x2, p2, color);
      }
   }
   b2World.prototype.DrawShape = function (shape, xf, color) {
      switch (shape.m_type) {
      case b2Shape.e_circleShape:
         {
            var circle = ((shape instanceof b2CircleShape ? shape : null));
            var center = b2Math.MulX(xf, circle.m_p);
            var radius = circle.m_radius;
            var axis = xf.R.col1;
            this.m_debugDraw.DrawSolidCircle(center, radius, axis, color);
         }
         break;
      case b2Shape.e_polygonShape:
         {
            var i = 0;
            var poly = ((shape instanceof b2PolygonShape ? shape : null));
            var vertexCount = parseInt(poly.GetVertexCount());
            var localVertices = poly.GetVertices();
            var vertices = new Vector(vertexCount);
            for (i = 0;
            i < vertexCount; ++i) {
               vertices[i] = b2Math.MulX(xf, localVertices[i]);
            }
            this.m_debugDraw.DrawSolidPolygon(vertices, vertexCount, color);
         }
         break;
      case b2Shape.e_edgeShape:
         {
            var edge = (shape instanceof b2EdgeShape ? shape : null);
            this.m_debugDraw.DrawSegment(b2Math.MulX(xf, edge.GetVertex1()), b2Math.MulX(xf, edge.GetVertex2()), color);
         }
         break;
      }
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.b2World.s_timestep2 = new b2TimeStep();
      Box2D.Dynamics.b2World.s_xf = new b2Transform();
      Box2D.Dynamics.b2World.s_backupA = new b2Sweep();
      Box2D.Dynamics.b2World.s_backupB = new b2Sweep();
      Box2D.Dynamics.b2World.s_timestep = new b2TimeStep();
      Box2D.Dynamics.b2World.s_queue = new Vector();
      Box2D.Dynamics.b2World.s_jointColor = new b2Color(0.5, 0.8, 0.8);
      Box2D.Dynamics.b2World.e_newFixture = 0x0001;
      Box2D.Dynamics.b2World.e_locked = 0x0002;
   });
})();
(function () {
   var b2CircleShape = Box2D.Collision.Shapes.b2CircleShape,
      b2EdgeChainDef = Box2D.Collision.Shapes.b2EdgeChainDef,
      b2EdgeShape = Box2D.Collision.Shapes.b2EdgeShape,
      b2MassData = Box2D.Collision.Shapes.b2MassData,
      b2PolygonShape = Box2D.Collision.Shapes.b2PolygonShape,
      b2Shape = Box2D.Collision.Shapes.b2Shape,
      b2CircleContact = Box2D.Dynamics.Contacts.b2CircleContact,
      b2Contact = Box2D.Dynamics.Contacts.b2Contact,
      b2ContactConstraint = Box2D.Dynamics.Contacts.b2ContactConstraint,
      b2ContactConstraintPoint = Box2D.Dynamics.Contacts.b2ContactConstraintPoint,
      b2ContactEdge = Box2D.Dynamics.Contacts.b2ContactEdge,
      b2ContactFactory = Box2D.Dynamics.Contacts.b2ContactFactory,
      b2ContactRegister = Box2D.Dynamics.Contacts.b2ContactRegister,
      b2ContactResult = Box2D.Dynamics.Contacts.b2ContactResult,
      b2ContactSolver = Box2D.Dynamics.Contacts.b2ContactSolver,
      b2EdgeAndCircleContact = Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,
      b2NullContact = Box2D.Dynamics.Contacts.b2NullContact,
      b2PolyAndCircleContact = Box2D.Dynamics.Contacts.b2PolyAndCircleContact,
      b2PolyAndEdgeContact = Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,
      b2PolygonContact = Box2D.Dynamics.Contacts.b2PolygonContact,
      b2PositionSolverManifold = Box2D.Dynamics.Contacts.b2PositionSolverManifold,
      b2Body = Box2D.Dynamics.b2Body,
      b2BodyDef = Box2D.Dynamics.b2BodyDef,
      b2ContactFilter = Box2D.Dynamics.b2ContactFilter,
      b2ContactImpulse = Box2D.Dynamics.b2ContactImpulse,
      b2ContactListener = Box2D.Dynamics.b2ContactListener,
      b2ContactManager = Box2D.Dynamics.b2ContactManager,
      b2DebugDraw = Box2D.Dynamics.b2DebugDraw,
      b2DestructionListener = Box2D.Dynamics.b2DestructionListener,
      b2FilterData = Box2D.Dynamics.b2FilterData,
      b2Fixture = Box2D.Dynamics.b2Fixture,
      b2FixtureDef = Box2D.Dynamics.b2FixtureDef,
      b2Island = Box2D.Dynamics.b2Island,
      b2TimeStep = Box2D.Dynamics.b2TimeStep,
      b2World = Box2D.Dynamics.b2World,
      b2Color = Box2D.Common.b2Color,
      b2internal = Box2D.Common.b2internal,
      b2Settings = Box2D.Common.b2Settings,
      b2Mat22 = Box2D.Common.Math.b2Mat22,
      b2Mat33 = Box2D.Common.Math.b2Mat33,
      b2Math = Box2D.Common.Math.b2Math,
      b2Sweep = Box2D.Common.Math.b2Sweep,
      b2Transform = Box2D.Common.Math.b2Transform,
      b2Vec2 = Box2D.Common.Math.b2Vec2,
      b2Vec3 = Box2D.Common.Math.b2Vec3,
      b2AABB = Box2D.Collision.b2AABB,
      b2Bound = Box2D.Collision.b2Bound,
      b2BoundValues = Box2D.Collision.b2BoundValues,
      b2Collision = Box2D.Collision.b2Collision,
      b2ContactID = Box2D.Collision.b2ContactID,
      b2ContactPoint = Box2D.Collision.b2ContactPoint,
      b2Distance = Box2D.Collision.b2Distance,
      b2DistanceInput = Box2D.Collision.b2DistanceInput,
      b2DistanceOutput = Box2D.Collision.b2DistanceOutput,
      b2DistanceProxy = Box2D.Collision.b2DistanceProxy,
      b2DynamicTree = Box2D.Collision.b2DynamicTree,
      b2DynamicTreeBroadPhase = Box2D.Collision.b2DynamicTreeBroadPhase,
      b2DynamicTreeNode = Box2D.Collision.b2DynamicTreeNode,
      b2DynamicTreePair = Box2D.Collision.b2DynamicTreePair,
      b2Manifold = Box2D.Collision.b2Manifold,
      b2ManifoldPoint = Box2D.Collision.b2ManifoldPoint,
      b2Point = Box2D.Collision.b2Point,
      b2RayCastInput = Box2D.Collision.b2RayCastInput,
      b2RayCastOutput = Box2D.Collision.b2RayCastOutput,
      b2Segment = Box2D.Collision.b2Segment,
      b2SeparationFunction = Box2D.Collision.b2SeparationFunction,
      b2Simplex = Box2D.Collision.b2Simplex,
      b2SimplexCache = Box2D.Collision.b2SimplexCache,
      b2SimplexVertex = Box2D.Collision.b2SimplexVertex,
      b2TimeOfImpact = Box2D.Collision.b2TimeOfImpact,
      b2TOIInput = Box2D.Collision.b2TOIInput,
      b2WorldManifold = Box2D.Collision.b2WorldManifold,
      ClipVertex = Box2D.Collision.ClipVertex,
      Features = Box2D.Collision.Features,
      IBroadPhase = Box2D.Collision.IBroadPhase;

   Box2D.inherit(b2CircleContact, Box2D.Dynamics.Contacts.b2Contact);
   b2CircleContact.prototype.__super = Box2D.Dynamics.Contacts.b2Contact.prototype;
   b2CircleContact.b2CircleContact = function () {
      Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this, arguments);
   };
   b2CircleContact.Create = function (allocator) {
      return new b2CircleContact();
   }
   b2CircleContact.Destroy = function (contact, allocator) {}
   b2CircleContact.prototype.Reset = function (fixtureA, fixtureB) {
      this.__super.Reset.call(this, fixtureA, fixtureB);
   }
   b2CircleContact.prototype.Evaluate = function () {
      var bA = this.m_fixtureA.GetBody();
      var bB = this.m_fixtureB.GetBody();
      b2Collision.CollideCircles(this.m_manifold, (this.m_fixtureA.GetShape() instanceof b2CircleShape ? this.m_fixtureA.GetShape() : null), bA.m_xf, (this.m_fixtureB.GetShape() instanceof b2CircleShape ? this.m_fixtureB.GetShape() : null), bB.m_xf);
   }
   b2Contact.b2Contact = function () {
      this.m_nodeA = new b2ContactEdge();
      this.m_nodeB = new b2ContactEdge();
      this.m_manifold = new b2Manifold();
      this.m_oldManifold = new b2Manifold();
   };
   b2Contact.prototype.GetManifold = function () {
      return this.m_manifold;
   }
   b2Contact.prototype.GetWorldManifold = function (worldManifold) {
      var bodyA = this.m_fixtureA.GetBody();
      var bodyB = this.m_fixtureB.GetBody();
      var shapeA = this.m_fixtureA.GetShape();
      var shapeB = this.m_fixtureB.GetShape();
      worldManifold.Initialize(this.m_manifold, bodyA.GetTransform(), shapeA.m_radius, bodyB.GetTransform(), shapeB.m_radius);
   }
   b2Contact.prototype.IsTouching = function () {
      return (this.m_flags & b2Contact.e_touchingFlag) == b2Contact.e_touchingFlag;
   }
   b2Contact.prototype.IsContinuous = function () {
      return (this.m_flags & b2Contact.e_continuousFlag) == b2Contact.e_continuousFlag;
   }
   b2Contact.prototype.SetSensor = function (sensor) {
      if (sensor) {
         this.m_flags |= b2Contact.e_sensorFlag;
      }
      else {
         this.m_flags &= ~b2Contact.e_sensorFlag;
      }
   }
   b2Contact.prototype.IsSensor = function () {
      return (this.m_flags & b2Contact.e_sensorFlag) == b2Contact.e_sensorFlag;
   }
   b2Contact.prototype.SetEnabled = function (flag) {
      if (flag) {
         this.m_flags |= b2Contact.e_enabledFlag;
      }
      else {
         this.m_flags &= ~b2Contact.e_enabledFlag;
      }
   }
   b2Contact.prototype.IsEnabled = function () {
      return (this.m_flags & b2Contact.e_enabledFlag) == b2Contact.e_enabledFlag;
   }
   b2Contact.prototype.GetNext = function () {
      return this.m_next;
   }
   b2Contact.prototype.GetFixtureA = function () {
      return this.m_fixtureA;
   }
   b2Contact.prototype.GetFixtureB = function () {
      return this.m_fixtureB;
   }
   b2Contact.prototype.FlagForFiltering = function () {
      this.m_flags |= b2Contact.e_filterFlag;
   }
   b2Contact.prototype.b2Contact = function () {}
   b2Contact.prototype.Reset = function (fixtureA, fixtureB) {
      if (fixtureA === undefined) fixtureA = null;
      if (fixtureB === undefined) fixtureB = null;
      this.m_flags = b2Contact.e_enabledFlag;
      if (!fixtureA || !fixtureB) {
         this.m_fixtureA = null;
         this.m_fixtureB = null;
         return;
      }
      if (fixtureA.IsSensor() || fixtureB.IsSensor()) {
         this.m_flags |= b2Contact.e_sensorFlag;
      }
      var bodyA = fixtureA.GetBody();
      var bodyB = fixtureB.GetBody();
      if (bodyA.GetType() != b2Body.b2_dynamicBody || bodyA.IsBullet() || bodyB.GetType() != b2Body.b2_dynamicBody || bodyB.IsBullet()) {
         this.m_flags |= b2Contact.e_continuousFlag;
      }
      this.m_fixtureA = fixtureA;
      this.m_fixtureB = fixtureB;
      this.m_manifold.m_pointCount = 0;
      this.m_prev = null;
      this.m_next = null;
      this.m_nodeA.contact = null;
      this.m_nodeA.prev = null;
      this.m_nodeA.next = null;
      this.m_nodeA.other = null;
      this.m_nodeB.contact = null;
      this.m_nodeB.prev = null;
      this.m_nodeB.next = null;
      this.m_nodeB.other = null;
   }
   b2Contact.prototype.Update = function (listener) {
      var tManifold = this.m_oldManifold;
      this.m_oldManifold = this.m_manifold;
      this.m_manifold = tManifold;
      this.m_flags |= b2Contact.e_enabledFlag;
      var touching = false;
      var wasTouching = (this.m_flags & b2Contact.e_touchingFlag) == b2Contact.e_touchingFlag;
      var bodyA = this.m_fixtureA.m_body;
      var bodyB = this.m_fixtureB.m_body;
      var aabbOverlap = this.m_fixtureA.m_aabb.TestOverlap(this.m_fixtureB.m_aabb);
      if (this.m_flags & b2Contact.e_sensorFlag) {
         if (aabbOverlap) {
            var shapeA = this.m_fixtureA.GetShape();
            var shapeB = this.m_fixtureB.GetShape();
            var xfA = bodyA.GetTransform();
            var xfB = bodyB.GetTransform();
            touching = b2Shape.TestOverlap(shapeA, xfA, shapeB, xfB);
         }
         this.m_manifold.m_pointCount = 0;
      }
      else {
         if (bodyA.GetType() != b2Body.b2_dynamicBody || bodyA.IsBullet() || bodyB.GetType() != b2Body.b2_dynamicBody || bodyB.IsBullet()) {
            this.m_flags |= b2Contact.e_continuousFlag;
         }
         else {
            this.m_flags &= ~b2Contact.e_continuousFlag;
         }
         if (aabbOverlap) {
            this.Evaluate();
            touching = this.m_manifold.m_pointCount > 0;
            for (var i = 0; i < this.m_manifold.m_pointCount; ++i) {
               var mp2 = this.m_manifold.m_points[i];
               mp2.m_normalImpulse = 0.0;
               mp2.m_tangentImpulse = 0.0;
               var id2 = mp2.m_id;
               for (var j = 0; j < this.m_oldManifold.m_pointCount; ++j) {
                  var mp1 = this.m_oldManifold.m_points[j];
                  if (mp1.m_id.key == id2.key) {
                     mp2.m_normalImpulse = mp1.m_normalImpulse;
                     mp2.m_tangentImpulse = mp1.m_tangentImpulse;
                     break;
                  }
               }
            }
         }
         else {
            this.m_manifold.m_pointCount = 0;
         }
         if (touching != wasTouching) {
            bodyA.SetAwake(true);
            bodyB.SetAwake(true);
         }
      }
      if (touching) {
         this.m_flags |= b2Contact.e_touchingFlag;
      }
      else {
         this.m_flags &= ~b2Contact.e_touchingFlag;
      }
      if (wasTouching == false && touching == true) {
         listener.BeginContact(this);
      }
      if (wasTouching == true && touching == false) {
         listener.EndContact(this);
      }
      if ((this.m_flags & b2Contact.e_sensorFlag) == 0) {
         listener.PreSolve(this, this.m_oldManifold);
      }
   }
   b2Contact.prototype.Evaluate = function () {}
   b2Contact.prototype.ComputeTOI = function (sweepA, sweepB) {
      b2Contact.s_input.proxyA.Set(this.m_fixtureA.GetShape());
      b2Contact.s_input.proxyB.Set(this.m_fixtureB.GetShape());
      b2Contact.s_input.sweepA = sweepA;
      b2Contact.s_input.sweepB = sweepB;
      b2Contact.s_input.tolerance = b2Settings.b2_linearSlop;
      return b2TimeOfImpact.TimeOfImpact(b2Contact.s_input);
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.Contacts.b2Contact.e_sensorFlag = 0x0001;
      Box2D.Dynamics.Contacts.b2Contact.e_continuousFlag = 0x0002;
      Box2D.Dynamics.Contacts.b2Contact.e_islandFlag = 0x0004;
      Box2D.Dynamics.Contacts.b2Contact.e_toiFlag = 0x0008;
      Box2D.Dynamics.Contacts.b2Contact.e_touchingFlag = 0x0010;
      Box2D.Dynamics.Contacts.b2Contact.e_enabledFlag = 0x0020;
      Box2D.Dynamics.Contacts.b2Contact.e_filterFlag = 0x0040;
      Box2D.Dynamics.Contacts.b2Contact.s_input = new b2TOIInput();
   });
   b2ContactConstraint.b2ContactConstraint = function () {
      this.localPlaneNormal = new b2Vec2();
      this.localPoint = new b2Vec2();
      this.normal = new b2Vec2();
      this.normalMass = new b2Mat22();
      this.K = new b2Mat22();
   };
   b2ContactConstraint.prototype.b2ContactConstraint = function () {
      this.points = new Vector(b2Settings.b2_maxManifoldPoints);
      for (var i = 0; i < b2Settings.b2_maxManifoldPoints; i++) {
         this.points[i] = new b2ContactConstraintPoint();
      }
   }
   b2ContactConstraintPoint.b2ContactConstraintPoint = function () {
      this.localPoint = new b2Vec2();
      this.rA = new b2Vec2();
      this.rB = new b2Vec2();
   };
   b2ContactEdge.b2ContactEdge = function () {};
   b2ContactFactory.b2ContactFactory = function () {};
   b2ContactFactory.prototype.b2ContactFactory = function (allocator) {
      this.m_allocator = allocator;
      this.InitializeRegisters();
   }
   b2ContactFactory.prototype.AddType = function (createFcn, destroyFcn, type1, type2) {
      if (type1 === undefined) type1 = 0;
      if (type2 === undefined) type2 = 0;
      this.m_registers[type1][type2].createFcn = createFcn;
      this.m_registers[type1][type2].destroyFcn = destroyFcn;
      this.m_registers[type1][type2].primary = true;
      if (type1 != type2) {
         this.m_registers[type2][type1].createFcn = createFcn;
         this.m_registers[type2][type1].destroyFcn = destroyFcn;
         this.m_registers[type2][type1].primary = false;
      }
   }
   b2ContactFactory.prototype.InitializeRegisters = function () {
      this.m_registers = new Vector(b2Shape.e_shapeTypeCount);
      for (var i = 0; i < b2Shape.e_shapeTypeCount; i++) {
         this.m_registers[i] = new Vector(b2Shape.e_shapeTypeCount);
         for (var j = 0; j < b2Shape.e_shapeTypeCount; j++) {
            this.m_registers[i][j] = new b2ContactRegister();
         }
      }
      this.AddType(b2CircleContact.Create, b2CircleContact.Destroy, b2Shape.e_circleShape, b2Shape.e_circleShape);
      this.AddType(b2PolyAndCircleContact.Create, b2PolyAndCircleContact.Destroy, b2Shape.e_polygonShape, b2Shape.e_circleShape);
      this.AddType(b2PolygonContact.Create, b2PolygonContact.Destroy, b2Shape.e_polygonShape, b2Shape.e_polygonShape);
      this.AddType(b2EdgeAndCircleContact.Create, b2EdgeAndCircleContact.Destroy, b2Shape.e_edgeShape, b2Shape.e_circleShape);
      this.AddType(b2PolyAndEdgeContact.Create, b2PolyAndEdgeContact.Destroy, b2Shape.e_polygonShape, b2Shape.e_edgeShape);
   }
   b2ContactFactory.prototype.Create = function (fixtureA, fixtureB) {
      var type1 = parseInt(fixtureA.GetType());
      var type2 = parseInt(fixtureB.GetType());
      var reg = this.m_registers[type1][type2];
      var c;
      if (reg.pool) {
         c = reg.pool;
         reg.pool = c.m_next;
         reg.poolCount--;
         c.Reset(fixtureA, fixtureB);
         return c;
      }
      var createFcn = reg.createFcn;
      if (createFcn != null) {
         if (reg.primary) {
            c = createFcn(this.m_allocator);
            c.Reset(fixtureA, fixtureB);
            return c;
         }
         else {
            c = createFcn(this.m_allocator);
            c.Reset(fixtureB, fixtureA);
            return c;
         }
      }
      else {
         return null;
      }
   }
   b2ContactFactory.prototype.Destroy = function (contact) {
      if (contact.m_manifold.m_pointCount > 0) {
         contact.m_fixtureA.m_body.SetAwake(true);
         contact.m_fixtureB.m_body.SetAwake(true);
      }
      var type1 = parseInt(contact.m_fixtureA.GetType());
      var type2 = parseInt(contact.m_fixtureB.GetType());
      var reg = this.m_registers[type1][type2];
      if (true) {
         reg.poolCount++;
         contact.m_next = reg.pool;
         reg.pool = contact;
      }
      var destroyFcn = reg.destroyFcn;
      destroyFcn(contact, this.m_allocator);
   }
   b2ContactRegister.b2ContactRegister = function () {};
   b2ContactResult.b2ContactResult = function () {
      this.position = new b2Vec2();
      this.normal = new b2Vec2();
      this.id = new b2ContactID();
   };
   b2ContactSolver.b2ContactSolver = function () {
      this.m_step = new b2TimeStep();
      this.m_constraints = new Vector();
   };
   b2ContactSolver.prototype.b2ContactSolver = function () {}
   b2ContactSolver.prototype.Initialize = function (step, contacts, contactCount, allocator) {
      if (contactCount === undefined) contactCount = 0;
      var contact;
      this.m_step.Set(step);
      this.m_allocator = allocator;
      var i = 0;
      var tVec;
      var tMat;
      this.m_constraintCount = contactCount;
      while (this.m_constraints.length < this.m_constraintCount) {
         this.m_constraints[this.m_constraints.length] = new b2ContactConstraint();
      }
      for (i = 0;
      i < contactCount; ++i) {
         contact = contacts[i];
         var fixtureA = contact.m_fixtureA;
         var fixtureB = contact.m_fixtureB;
         var shapeA = fixtureA.m_shape;
         var shapeB = fixtureB.m_shape;
         var radiusA = shapeA.m_radius;
         var radiusB = shapeB.m_radius;
         var bodyA = fixtureA.m_body;
         var bodyB = fixtureB.m_body;
         var manifold = contact.GetManifold();
         var friction = b2Settings.b2MixFriction(fixtureA.GetFriction(), fixtureB.GetFriction());
         var restitution = b2Settings.b2MixRestitution(fixtureA.GetRestitution(), fixtureB.GetRestitution());
         var vAX = bodyA.m_linearVelocity.x;
         var vAY = bodyA.m_linearVelocity.y;
         var vBX = bodyB.m_linearVelocity.x;
         var vBY = bodyB.m_linearVelocity.y;
         var wA = bodyA.m_angularVelocity;
         var wB = bodyB.m_angularVelocity;
         b2Settings.b2Assert(manifold.m_pointCount > 0);
         b2ContactSolver.s_worldManifold.Initialize(manifold, bodyA.m_xf, radiusA, bodyB.m_xf, radiusB);
         var normalX = b2ContactSolver.s_worldManifold.m_normal.x;
         var normalY = b2ContactSolver.s_worldManifold.m_normal.y;
         var cc = this.m_constraints[i];
         cc.bodyA = bodyA;
         cc.bodyB = bodyB;
         cc.manifold = manifold;
         cc.normal.x = normalX;
         cc.normal.y = normalY;
         cc.pointCount = manifold.m_pointCount;
         cc.friction = friction;
         cc.restitution = restitution;
         cc.localPlaneNormal.x = manifold.m_localPlaneNormal.x;
         cc.localPlaneNormal.y = manifold.m_localPlaneNormal.y;
         cc.localPoint.x = manifold.m_localPoint.x;
         cc.localPoint.y = manifold.m_localPoint.y;
         cc.radius = radiusA + radiusB;
         cc.type = manifold.m_type;
         for (var k = 0; k < cc.pointCount; ++k) {
            var cp = manifold.m_points[k];
            var ccp = cc.points[k];
            ccp.normalImpulse = cp.m_normalImpulse;
            ccp.tangentImpulse = cp.m_tangentImpulse;
            ccp.localPoint.SetV(cp.m_localPoint);
            var rAX = ccp.rA.x = b2ContactSolver.s_worldManifold.m_points[k].x - bodyA.m_sweep.c.x;
            var rAY = ccp.rA.y = b2ContactSolver.s_worldManifold.m_points[k].y - bodyA.m_sweep.c.y;
            var rBX = ccp.rB.x = b2ContactSolver.s_worldManifold.m_points[k].x - bodyB.m_sweep.c.x;
            var rBY = ccp.rB.y = b2ContactSolver.s_worldManifold.m_points[k].y - bodyB.m_sweep.c.y;
            var rnA = rAX * normalY - rAY * normalX;
            var rnB = rBX * normalY - rBY * normalX;
            rnA *= rnA;
            rnB *= rnB;
            var kNormal = bodyA.m_invMass + bodyB.m_invMass + bodyA.m_invI * rnA + bodyB.m_invI * rnB;
            ccp.normalMass = 1.0 / kNormal;
            var kEqualized = bodyA.m_mass * bodyA.m_invMass + bodyB.m_mass * bodyB.m_invMass;
            kEqualized += bodyA.m_mass * bodyA.m_invI * rnA + bodyB.m_mass * bodyB.m_invI * rnB;
            ccp.equalizedMass = 1.0 / kEqualized;
            var tangentX = normalY;
            var tangentY = (-normalX);
            var rtA = rAX * tangentY - rAY * tangentX;
            var rtB = rBX * tangentY - rBY * tangentX;
            rtA *= rtA;
            rtB *= rtB;
            var kTangent = bodyA.m_invMass + bodyB.m_invMass + bodyA.m_invI * rtA + bodyB.m_invI * rtB;
            ccp.tangentMass = 1.0 / kTangent;
            ccp.velocityBias = 0.0;
            var tX = vBX + ((-wB * rBY)) - vAX - ((-wA * rAY));
            var tY = vBY + (wB * rBX) - vAY - (wA * rAX);
            var vRel = cc.normal.x * tX + cc.normal.y * tY;
            if (vRel < (-b2Settings.b2_velocityThreshold)) {
               ccp.velocityBias += (-cc.restitution * vRel);
            }
         }
         if (cc.pointCount == 2) {
            var ccp1 = cc.points[0];
            var ccp2 = cc.points[1];
            var invMassA = bodyA.m_invMass;
            var invIA = bodyA.m_invI;
            var invMassB = bodyB.m_invMass;
            var invIB = bodyB.m_invI;
            var rn1A = ccp1.rA.x * normalY - ccp1.rA.y * normalX;
            var rn1B = ccp1.rB.x * normalY - ccp1.rB.y * normalX;
            var rn2A = ccp2.rA.x * normalY - ccp2.rA.y * normalX;
            var rn2B = ccp2.rB.x * normalY - ccp2.rB.y * normalX;
            var k11 = invMassA + invMassB + invIA * rn1A * rn1A + invIB * rn1B * rn1B;
            var k22 = invMassA + invMassB + invIA * rn2A * rn2A + invIB * rn2B * rn2B;
            var k12 = invMassA + invMassB + invIA * rn1A * rn2A + invIB * rn1B * rn2B;
            var k_maxConditionNumber = 100.0;
            if (k11 * k11 < k_maxConditionNumber * (k11 * k22 - k12 * k12)) {
               cc.K.col1.Set(k11, k12);
               cc.K.col2.Set(k12, k22);
               cc.K.GetInverse(cc.normalMass);
            }
            else {
               cc.pointCount = 1;
            }
         }
      }
   }
   b2ContactSolver.prototype.InitVelocityConstraints = function (step) {
      var tVec;
      var tVec2;
      var tMat;
      for (var i = 0; i < this.m_constraintCount; ++i) {
         var c = this.m_constraints[i];
         var bodyA = c.bodyA;
         var bodyB = c.bodyB;
         var invMassA = bodyA.m_invMass;
         var invIA = bodyA.m_invI;
         var invMassB = bodyB.m_invMass;
         var invIB = bodyB.m_invI;
         var normalX = c.normal.x;
         var normalY = c.normal.y;
         var tangentX = normalY;
         var tangentY = (-normalX);
         var tX = 0;
         var j = 0;
         var tCount = 0;
         if (step.warmStarting) {
            tCount = c.pointCount;
            for (j = 0;
            j < tCount; ++j) {
               var ccp = c.points[j];
               ccp.normalImpulse *= step.dtRatio;
               ccp.tangentImpulse *= step.dtRatio;
               var PX = ccp.normalImpulse * normalX + ccp.tangentImpulse * tangentX;
               var PY = ccp.normalImpulse * normalY + ccp.tangentImpulse * tangentY;
               bodyA.m_angularVelocity -= invIA * (ccp.rA.x * PY - ccp.rA.y * PX);
               bodyA.m_linearVelocity.x -= invMassA * PX;
               bodyA.m_linearVelocity.y -= invMassA * PY;
               bodyB.m_angularVelocity += invIB * (ccp.rB.x * PY - ccp.rB.y * PX);
               bodyB.m_linearVelocity.x += invMassB * PX;
               bodyB.m_linearVelocity.y += invMassB * PY;
            }
         }
         else {
            tCount = c.pointCount;
            for (j = 0;
            j < tCount; ++j) {
               var ccp2 = c.points[j];
               ccp2.normalImpulse = 0.0;
               ccp2.tangentImpulse = 0.0;
            }
         }
      }
   }
   b2ContactSolver.prototype.SolveVelocityConstraints = function () {
      var j = 0;
      var ccp;
      var rAX = 0;
      var rAY = 0;
      var rBX = 0;
      var rBY = 0;
      var dvX = 0;
      var dvY = 0;
      var vn = 0;
      var vt = 0;
      var lambda = 0;
      var maxFriction = 0;
      var newImpulse = 0;
      var PX = 0;
      var PY = 0;
      var dX = 0;
      var dY = 0;
      var P1X = 0;
      var P1Y = 0;
      var P2X = 0;
      var P2Y = 0;
      var tMat;
      var tVec;
      for (var i = 0; i < this.m_constraintCount; ++i) {
         var c = this.m_constraints[i];
         var bodyA = c.bodyA;
         var bodyB = c.bodyB;
         var wA = bodyA.m_angularVelocity;
         var wB = bodyB.m_angularVelocity;
         var vA = bodyA.m_linearVelocity;
         var vB = bodyB.m_linearVelocity;
         var invMassA = bodyA.m_invMass;
         var invIA = bodyA.m_invI;
         var invMassB = bodyB.m_invMass;
         var invIB = bodyB.m_invI;
         var normalX = c.normal.x;
         var normalY = c.normal.y;
         var tangentX = normalY;
         var tangentY = (-normalX);
         var friction = c.friction;
         var tX = 0;
         for (j = 0;
         j < c.pointCount; j++) {
            ccp = c.points[j];
            dvX = vB.x - wB * ccp.rB.y - vA.x + wA * ccp.rA.y;
            dvY = vB.y + wB * ccp.rB.x - vA.y - wA * ccp.rA.x;
            vt = dvX * tangentX + dvY * tangentY;
            lambda = ccp.tangentMass * (-vt);
            maxFriction = friction * ccp.normalImpulse;
            newImpulse = b2Math.Clamp(ccp.tangentImpulse + lambda, (-maxFriction), maxFriction);
            lambda = newImpulse - ccp.tangentImpulse;
            PX = lambda * tangentX;
            PY = lambda * tangentY;
            vA.x -= invMassA * PX;
            vA.y -= invMassA * PY;
            wA -= invIA * (ccp.rA.x * PY - ccp.rA.y * PX);
            vB.x += invMassB * PX;
            vB.y += invMassB * PY;
            wB += invIB * (ccp.rB.x * PY - ccp.rB.y * PX);
            ccp.tangentImpulse = newImpulse;
         }
         var tCount = parseInt(c.pointCount);
         if (c.pointCount == 1) {
            ccp = c.points[0];
            dvX = vB.x + ((-wB * ccp.rB.y)) - vA.x - ((-wA * ccp.rA.y));
            dvY = vB.y + (wB * ccp.rB.x) - vA.y - (wA * ccp.rA.x);
            vn = dvX * normalX + dvY * normalY;
            lambda = (-ccp.normalMass * (vn - ccp.velocityBias));
            newImpulse = ccp.normalImpulse + lambda;
            newImpulse = newImpulse > 0 ? newImpulse : 0.0;
            lambda = newImpulse - ccp.normalImpulse;
            PX = lambda * normalX;
            PY = lambda * normalY;
            vA.x -= invMassA * PX;
            vA.y -= invMassA * PY;
            wA -= invIA * (ccp.rA.x * PY - ccp.rA.y * PX);
            vB.x += invMassB * PX;
            vB.y += invMassB * PY;
            wB += invIB * (ccp.rB.x * PY - ccp.rB.y * PX);
            ccp.normalImpulse = newImpulse;
         }
         else {
            var cp1 = c.points[0];
            var cp2 = c.points[1];
            var aX = cp1.normalImpulse;
            var aY = cp2.normalImpulse;
            var dv1X = vB.x - wB * cp1.rB.y - vA.x + wA * cp1.rA.y;
            var dv1Y = vB.y + wB * cp1.rB.x - vA.y - wA * cp1.rA.x;
            var dv2X = vB.x - wB * cp2.rB.y - vA.x + wA * cp2.rA.y;
            var dv2Y = vB.y + wB * cp2.rB.x - vA.y - wA * cp2.rA.x;
            var vn1 = dv1X * normalX + dv1Y * normalY;
            var vn2 = dv2X * normalX + dv2Y * normalY;
            var bX = vn1 - cp1.velocityBias;
            var bY = vn2 - cp2.velocityBias;
            tMat = c.K;
            bX -= tMat.col1.x * aX + tMat.col2.x * aY;
            bY -= tMat.col1.y * aX + tMat.col2.y * aY;
            var k_errorTol = 0.001;
            for (;;) {
               tMat = c.normalMass;
               var xX = (-(tMat.col1.x * bX + tMat.col2.x * bY));
               var xY = (-(tMat.col1.y * bX + tMat.col2.y * bY));
               if (xX >= 0.0 && xY >= 0.0) {
                  dX = xX - aX;
                  dY = xY - aY;
                  P1X = dX * normalX;
                  P1Y = dX * normalY;
                  P2X = dY * normalX;
                  P2Y = dY * normalY;
                  vA.x -= invMassA * (P1X + P2X);
                  vA.y -= invMassA * (P1Y + P2Y);
                  wA -= invIA * (cp1.rA.x * P1Y - cp1.rA.y * P1X + cp2.rA.x * P2Y - cp2.rA.y * P2X);
                  vB.x += invMassB * (P1X + P2X);
                  vB.y += invMassB * (P1Y + P2Y);
                  wB += invIB * (cp1.rB.x * P1Y - cp1.rB.y * P1X + cp2.rB.x * P2Y - cp2.rB.y * P2X);
                  cp1.normalImpulse = xX;
                  cp2.normalImpulse = xY;
                  break;
               }
               xX = (-cp1.normalMass * bX);
               xY = 0.0;
               vn1 = 0.0;
               vn2 = c.K.col1.y * xX + bY;
               if (xX >= 0.0 && vn2 >= 0.0) {
                  dX = xX - aX;
                  dY = xY - aY;
                  P1X = dX * normalX;
                  P1Y = dX * normalY;
                  P2X = dY * normalX;
                  P2Y = dY * normalY;
                  vA.x -= invMassA * (P1X + P2X);
                  vA.y -= invMassA * (P1Y + P2Y);
                  wA -= invIA * (cp1.rA.x * P1Y - cp1.rA.y * P1X + cp2.rA.x * P2Y - cp2.rA.y * P2X);
                  vB.x += invMassB * (P1X + P2X);
                  vB.y += invMassB * (P1Y + P2Y);
                  wB += invIB * (cp1.rB.x * P1Y - cp1.rB.y * P1X + cp2.rB.x * P2Y - cp2.rB.y * P2X);
                  cp1.normalImpulse = xX;
                  cp2.normalImpulse = xY;
                  break;
               }
               xX = 0.0;
               xY = (-cp2.normalMass * bY);
               vn1 = c.K.col2.x * xY + bX;
               vn2 = 0.0;
               if (xY >= 0.0 && vn1 >= 0.0) {
                  dX = xX - aX;
                  dY = xY - aY;
                  P1X = dX * normalX;
                  P1Y = dX * normalY;
                  P2X = dY * normalX;
                  P2Y = dY * normalY;
                  vA.x -= invMassA * (P1X + P2X);
                  vA.y -= invMassA * (P1Y + P2Y);
                  wA -= invIA * (cp1.rA.x * P1Y - cp1.rA.y * P1X + cp2.rA.x * P2Y - cp2.rA.y * P2X);
                  vB.x += invMassB * (P1X + P2X);
                  vB.y += invMassB * (P1Y + P2Y);
                  wB += invIB * (cp1.rB.x * P1Y - cp1.rB.y * P1X + cp2.rB.x * P2Y - cp2.rB.y * P2X);
                  cp1.normalImpulse = xX;
                  cp2.normalImpulse = xY;
                  break;
               }
               xX = 0.0;
               xY = 0.0;
               vn1 = bX;
               vn2 = bY;
               if (vn1 >= 0.0 && vn2 >= 0.0) {
                  dX = xX - aX;
                  dY = xY - aY;
                  P1X = dX * normalX;
                  P1Y = dX * normalY;
                  P2X = dY * normalX;
                  P2Y = dY * normalY;
                  vA.x -= invMassA * (P1X + P2X);
                  vA.y -= invMassA * (P1Y + P2Y);
                  wA -= invIA * (cp1.rA.x * P1Y - cp1.rA.y * P1X + cp2.rA.x * P2Y - cp2.rA.y * P2X);
                  vB.x += invMassB * (P1X + P2X);
                  vB.y += invMassB * (P1Y + P2Y);
                  wB += invIB * (cp1.rB.x * P1Y - cp1.rB.y * P1X + cp2.rB.x * P2Y - cp2.rB.y * P2X);
                  cp1.normalImpulse = xX;
                  cp2.normalImpulse = xY;
                  break;
               }
               break;
            }
         }
         bodyA.m_angularVelocity = wA;
         bodyB.m_angularVelocity = wB;
      }
   }
   b2ContactSolver.prototype.FinalizeVelocityConstraints = function () {
      for (var i = 0; i < this.m_constraintCount; ++i) {
         var c = this.m_constraints[i];
         var m = c.manifold;
         for (var j = 0; j < c.pointCount; ++j) {
            var point1 = m.m_points[j];
            var point2 = c.points[j];
            point1.m_normalImpulse = point2.normalImpulse;
            point1.m_tangentImpulse = point2.tangentImpulse;
         }
      }
   }
   b2ContactSolver.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      var minSeparation = 0.0;
      for (var i = 0; i < this.m_constraintCount; i++) {
         var c = this.m_constraints[i];
         var bodyA = c.bodyA;
         var bodyB = c.bodyB;
         var invMassA = bodyA.m_mass * bodyA.m_invMass;
         var invIA = bodyA.m_mass * bodyA.m_invI;
         var invMassB = bodyB.m_mass * bodyB.m_invMass;
         var invIB = bodyB.m_mass * bodyB.m_invI;
         b2ContactSolver.s_psm.Initialize(c);
         var normal = b2ContactSolver.s_psm.m_normal;
         for (var j = 0; j < c.pointCount; j++) {
            var ccp = c.points[j];
            var point = b2ContactSolver.s_psm.m_points[j];
            var separation = b2ContactSolver.s_psm.m_separations[j];
            var rAX = point.x - bodyA.m_sweep.c.x;
            var rAY = point.y - bodyA.m_sweep.c.y;
            var rBX = point.x - bodyB.m_sweep.c.x;
            var rBY = point.y - bodyB.m_sweep.c.y;
            minSeparation = minSeparation < separation ? minSeparation : separation;
            var C = b2Math.Clamp(baumgarte * (separation + b2Settings.b2_linearSlop), (-b2Settings.b2_maxLinearCorrection), 0.0);
            var impulse = (-ccp.equalizedMass * C);
            var PX = impulse * normal.x;
            var PY = impulse * normal.y;bodyA.m_sweep.c.x -= invMassA * PX;
            bodyA.m_sweep.c.y -= invMassA * PY;
            bodyA.m_sweep.a -= invIA * (rAX * PY - rAY * PX);
            bodyA.SynchronizeTransform();
            bodyB.m_sweep.c.x += invMassB * PX;
            bodyB.m_sweep.c.y += invMassB * PY;
            bodyB.m_sweep.a += invIB * (rBX * PY - rBY * PX);
            bodyB.SynchronizeTransform();
         }
      }
      return minSeparation > (-1.5 * b2Settings.b2_linearSlop);
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.Contacts.b2ContactSolver.s_worldManifold = new b2WorldManifold();
      Box2D.Dynamics.Contacts.b2ContactSolver.s_psm = new b2PositionSolverManifold();
   });
   Box2D.inherit(b2EdgeAndCircleContact, Box2D.Dynamics.Contacts.b2Contact);
   b2EdgeAndCircleContact.prototype.__super = Box2D.Dynamics.Contacts.b2Contact.prototype;
   b2EdgeAndCircleContact.b2EdgeAndCircleContact = function () {
      Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this, arguments);
   };
   b2EdgeAndCircleContact.Create = function (allocator) {
      return new b2EdgeAndCircleContact();
   }
   b2EdgeAndCircleContact.Destroy = function (contact, allocator) {}
   b2EdgeAndCircleContact.prototype.Reset = function (fixtureA, fixtureB) {
      this.__super.Reset.call(this, fixtureA, fixtureB);
   }
   b2EdgeAndCircleContact.prototype.Evaluate = function () {
      var bA = this.m_fixtureA.GetBody();
      var bB = this.m_fixtureB.GetBody();
      this.b2CollideEdgeAndCircle(this.m_manifold, (this.m_fixtureA.GetShape() instanceof b2EdgeShape ? this.m_fixtureA.GetShape() : null), bA.m_xf, (this.m_fixtureB.GetShape() instanceof b2CircleShape ? this.m_fixtureB.GetShape() : null), bB.m_xf);
   }
   b2EdgeAndCircleContact.prototype.b2CollideEdgeAndCircle = function (manifold, edge, xf1, circle, xf2) {}
   Box2D.inherit(b2NullContact, Box2D.Dynamics.Contacts.b2Contact);
   b2NullContact.prototype.__super = Box2D.Dynamics.Contacts.b2Contact.prototype;
   b2NullContact.b2NullContact = function () {
      Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this, arguments);
   };
   b2NullContact.prototype.b2NullContact = function () {
      this.__super.b2Contact.call(this);
   }
   b2NullContact.prototype.Evaluate = function () {}
   Box2D.inherit(b2PolyAndCircleContact, Box2D.Dynamics.Contacts.b2Contact);
   b2PolyAndCircleContact.prototype.__super = Box2D.Dynamics.Contacts.b2Contact.prototype;
   b2PolyAndCircleContact.b2PolyAndCircleContact = function () {
      Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this, arguments);
   };
   b2PolyAndCircleContact.Create = function (allocator) {
      return new b2PolyAndCircleContact();
   }
   b2PolyAndCircleContact.Destroy = function (contact, allocator) {}
   b2PolyAndCircleContact.prototype.Reset = function (fixtureA, fixtureB) {
      this.__super.Reset.call(this, fixtureA, fixtureB);
      b2Settings.b2Assert(fixtureA.GetType() == b2Shape.e_polygonShape);
      b2Settings.b2Assert(fixtureB.GetType() == b2Shape.e_circleShape);
   }
   b2PolyAndCircleContact.prototype.Evaluate = function () {
      var bA = this.m_fixtureA.m_body;
      var bB = this.m_fixtureB.m_body;
      b2Collision.CollidePolygonAndCircle(this.m_manifold, (this.m_fixtureA.GetShape() instanceof b2PolygonShape ? this.m_fixtureA.GetShape() : null), bA.m_xf, (this.m_fixtureB.GetShape() instanceof b2CircleShape ? this.m_fixtureB.GetShape() : null), bB.m_xf);
   }
   Box2D.inherit(b2PolyAndEdgeContact, Box2D.Dynamics.Contacts.b2Contact);
   b2PolyAndEdgeContact.prototype.__super = Box2D.Dynamics.Contacts.b2Contact.prototype;
   b2PolyAndEdgeContact.b2PolyAndEdgeContact = function () {
      Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this, arguments);
   };
   b2PolyAndEdgeContact.Create = function (allocator) {
      return new b2PolyAndEdgeContact();
   }
   b2PolyAndEdgeContact.Destroy = function (contact, allocator) {}
   b2PolyAndEdgeContact.prototype.Reset = function (fixtureA, fixtureB) {
      this.__super.Reset.call(this, fixtureA, fixtureB);
      b2Settings.b2Assert(fixtureA.GetType() == b2Shape.e_polygonShape);
      b2Settings.b2Assert(fixtureB.GetType() == b2Shape.e_edgeShape);
   }
   b2PolyAndEdgeContact.prototype.Evaluate = function () {
      var bA = this.m_fixtureA.GetBody();
      var bB = this.m_fixtureB.GetBody();
      this.b2CollidePolyAndEdge(this.m_manifold, (this.m_fixtureA.GetShape() instanceof b2PolygonShape ? this.m_fixtureA.GetShape() : null), bA.m_xf, (this.m_fixtureB.GetShape() instanceof b2EdgeShape ? this.m_fixtureB.GetShape() : null), bB.m_xf);
   }
   b2PolyAndEdgeContact.prototype.b2CollidePolyAndEdge = function (manifold, polygon, xf1, edge, xf2) {}
   Box2D.inherit(b2PolygonContact, Box2D.Dynamics.Contacts.b2Contact);
   b2PolygonContact.prototype.__super = Box2D.Dynamics.Contacts.b2Contact.prototype;
   b2PolygonContact.b2PolygonContact = function () {
      Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this, arguments);
   };
   b2PolygonContact.Create = function (allocator) {
      return new b2PolygonContact();
   }
   b2PolygonContact.Destroy = function (contact, allocator) {}
   b2PolygonContact.prototype.Reset = function (fixtureA, fixtureB) {
      this.__super.Reset.call(this, fixtureA, fixtureB);
   }
   b2PolygonContact.prototype.Evaluate = function () {
      var bA = this.m_fixtureA.GetBody();
      var bB = this.m_fixtureB.GetBody();
      b2Collision.CollidePolygons(this.m_manifold, (this.m_fixtureA.GetShape() instanceof b2PolygonShape ? this.m_fixtureA.GetShape() : null), bA.m_xf, (this.m_fixtureB.GetShape() instanceof b2PolygonShape ? this.m_fixtureB.GetShape() : null), bB.m_xf);
   }
   b2PositionSolverManifold.b2PositionSolverManifold = function () {};
   b2PositionSolverManifold.prototype.b2PositionSolverManifold = function () {
      this.m_normal = new b2Vec2();
      this.m_separations = new Vector_a2j_Number(b2Settings.b2_maxManifoldPoints);
      this.m_points = new Vector(b2Settings.b2_maxManifoldPoints);
      for (var i = 0; i < b2Settings.b2_maxManifoldPoints; i++) {
         this.m_points[i] = new b2Vec2();
      }
   }
   b2PositionSolverManifold.prototype.Initialize = function (cc) {
      b2Settings.b2Assert(cc.pointCount > 0);
      var i = 0;
      var clipPointX = 0;
      var clipPointY = 0;
      var tMat;
      var tVec;
      var planePointX = 0;
      var planePointY = 0;
      switch (cc.type) {
      case b2Manifold.e_circles:
         {
            tMat = cc.bodyA.m_xf.R;
            tVec = cc.localPoint;
            var pointAX = cc.bodyA.m_xf.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
            var pointAY = cc.bodyA.m_xf.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
            tMat = cc.bodyB.m_xf.R;
            tVec = cc.points[0].localPoint;
            var pointBX = cc.bodyB.m_xf.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
            var pointBY = cc.bodyB.m_xf.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
            var dX = pointBX - pointAX;
            var dY = pointBY - pointAY;
            var d2 = dX * dX + dY * dY;
            if (d2 > Number.MIN_VALUE * Number.MIN_VALUE) {
               var d = Math.sqrt(d2);
               this.m_normal.x = dX / d;
               this.m_normal.y = dY / d;
            }
            else {
               this.m_normal.x = 1.0;
               this.m_normal.y = 0.0;
            }
            this.m_points[0].x = 0.5 * (pointAX + pointBX);
            this.m_points[0].y = 0.5 * (pointAY + pointBY);
            this.m_separations[0] = dX * this.m_normal.x + dY * this.m_normal.y - cc.radius;
         }
         break;
      case b2Manifold.e_faceA:
         {
            tMat = cc.bodyA.m_xf.R;
            tVec = cc.localPlaneNormal;
            this.m_normal.x = tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
            this.m_normal.y = tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
            tMat = cc.bodyA.m_xf.R;
            tVec = cc.localPoint;
            planePointX = cc.bodyA.m_xf.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
            planePointY = cc.bodyA.m_xf.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
            tMat = cc.bodyB.m_xf.R;
            for (i = 0;
            i < cc.pointCount; ++i) {
               tVec = cc.points[i].localPoint;
               clipPointX = cc.bodyB.m_xf.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
               clipPointY = cc.bodyB.m_xf.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
               this.m_separations[i] = (clipPointX - planePointX) * this.m_normal.x + (clipPointY - planePointY) * this.m_normal.y - cc.radius;
               this.m_points[i].x = clipPointX;
               this.m_points[i].y = clipPointY;
            }
         }
         break;
      case b2Manifold.e_faceB:
         {
            tMat = cc.bodyB.m_xf.R;
            tVec = cc.localPlaneNormal;
            this.m_normal.x = tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
            this.m_normal.y = tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
            tMat = cc.bodyB.m_xf.R;
            tVec = cc.localPoint;
            planePointX = cc.bodyB.m_xf.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
            planePointY = cc.bodyB.m_xf.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
            tMat = cc.bodyA.m_xf.R;
            for (i = 0;
            i < cc.pointCount; ++i) {
               tVec = cc.points[i].localPoint;
               clipPointX = cc.bodyA.m_xf.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
               clipPointY = cc.bodyA.m_xf.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
               this.m_separations[i] = (clipPointX - planePointX) * this.m_normal.x + (clipPointY - planePointY) * this.m_normal.y - cc.radius;
               this.m_points[i].Set(clipPointX, clipPointY);
            }
            this.m_normal.x *= (-1);
            this.m_normal.y *= (-1);
         }
         break;
      }
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointA = new b2Vec2();
      Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointB = new b2Vec2();
   });
})();
(function () {
   var b2Body = Box2D.Dynamics.b2Body,
      b2BodyDef = Box2D.Dynamics.b2BodyDef,
      b2ContactFilter = Box2D.Dynamics.b2ContactFilter,
      b2ContactImpulse = Box2D.Dynamics.b2ContactImpulse,
      b2ContactListener = Box2D.Dynamics.b2ContactListener,
      b2ContactManager = Box2D.Dynamics.b2ContactManager,
      b2DebugDraw = Box2D.Dynamics.b2DebugDraw,
      b2DestructionListener = Box2D.Dynamics.b2DestructionListener,
      b2FilterData = Box2D.Dynamics.b2FilterData,
      b2Fixture = Box2D.Dynamics.b2Fixture,
      b2FixtureDef = Box2D.Dynamics.b2FixtureDef,
      b2Island = Box2D.Dynamics.b2Island,
      b2TimeStep = Box2D.Dynamics.b2TimeStep,
      b2World = Box2D.Dynamics.b2World,
      b2Mat22 = Box2D.Common.Math.b2Mat22,
      b2Mat33 = Box2D.Common.Math.b2Mat33,
      b2Math = Box2D.Common.Math.b2Math,
      b2Sweep = Box2D.Common.Math.b2Sweep,
      b2Transform = Box2D.Common.Math.b2Transform,
      b2Vec2 = Box2D.Common.Math.b2Vec2,
      b2Vec3 = Box2D.Common.Math.b2Vec3,
      b2Color = Box2D.Common.b2Color,
      b2internal = Box2D.Common.b2internal,
      b2Settings = Box2D.Common.b2Settings,
      b2CircleShape = Box2D.Collision.Shapes.b2CircleShape,
      b2EdgeChainDef = Box2D.Collision.Shapes.b2EdgeChainDef,
      b2EdgeShape = Box2D.Collision.Shapes.b2EdgeShape,
      b2MassData = Box2D.Collision.Shapes.b2MassData,
      b2PolygonShape = Box2D.Collision.Shapes.b2PolygonShape,
      b2Shape = Box2D.Collision.Shapes.b2Shape,
      b2BuoyancyController = Box2D.Dynamics.Controllers.b2BuoyancyController,
      b2ConstantAccelController = Box2D.Dynamics.Controllers.b2ConstantAccelController,
      b2ConstantForceController = Box2D.Dynamics.Controllers.b2ConstantForceController,
      b2Controller = Box2D.Dynamics.Controllers.b2Controller,
      b2ControllerEdge = Box2D.Dynamics.Controllers.b2ControllerEdge,
      b2GravityController = Box2D.Dynamics.Controllers.b2GravityController,
      b2TensorDampingController = Box2D.Dynamics.Controllers.b2TensorDampingController;

   Box2D.inherit(b2BuoyancyController, Box2D.Dynamics.Controllers.b2Controller);
   b2BuoyancyController.prototype.__super = Box2D.Dynamics.Controllers.b2Controller.prototype;
   b2BuoyancyController.b2BuoyancyController = function () {
      Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this, arguments);
      this.normal = new b2Vec2(0, (-1));
      this.offset = 0;
      this.density = 0;
      this.velocity = new b2Vec2(0, 0);
      this.linearDrag = 2;
      this.angularDrag = 1;
      this.useDensity = false;
      this.useWorldGravity = true;
      this.gravity = null;
   };
   b2BuoyancyController.prototype.Step = function (step) {
      if (!this.m_bodyList) return;
      if (this.useWorldGravity) {
         this.gravity = this.GetWorld().GetGravity().Copy();
      }
      for (var i = this.m_bodyList; i; i = i.nextBody) {
         var body = i.body;
         if (body.IsAwake() == false) {
            continue;
         }
         var areac = new b2Vec2();
         var massc = new b2Vec2();
         var area = 0.0;
         var mass = 0.0;
         for (var fixture = body.GetFixtureList(); fixture; fixture = fixture.GetNext()) {
            var sc = new b2Vec2();
            var sarea = fixture.GetShape().ComputeSubmergedArea(this.normal, this.offset, body.GetTransform(), sc);
            area += sarea;
            areac.x += sarea * sc.x;
            areac.y += sarea * sc.y;
            var shapeDensity = 0;
            if (this.useDensity) {
               shapeDensity = 1;
            }
            else {
               shapeDensity = 1;
            }
            mass += sarea * shapeDensity;
            massc.x += sarea * sc.x * shapeDensity;
            massc.y += sarea * sc.y * shapeDensity;
         }
         areac.x /= area;
         areac.y /= area;
         massc.x /= mass;
         massc.y /= mass;
         if (area < Number.MIN_VALUE) continue;
         var buoyancyForce = this.gravity.GetNegative();
         buoyancyForce.Multiply(this.density * area);
         body.ApplyForce(buoyancyForce, massc);
         var dragForce = body.GetLinearVelocityFromWorldPoint(areac);
         dragForce.Subtract(this.velocity);
         dragForce.Multiply((-this.linearDrag * area));
         body.ApplyForce(dragForce, areac);
         body.ApplyTorque((-body.GetInertia() / body.GetMass() * area * body.GetAngularVelocity() * this.angularDrag));
      }
   }
   b2BuoyancyController.prototype.Draw = function (debugDraw) {
      var r = 1000;
      var p1 = new b2Vec2();
      var p2 = new b2Vec2();
      p1.x = this.normal.x * this.offset + this.normal.y * r;
      p1.y = this.normal.y * this.offset - this.normal.x * r;
      p2.x = this.normal.x * this.offset - this.normal.y * r;
      p2.y = this.normal.y * this.offset + this.normal.x * r;
      var color = new b2Color(0, 0, 1);
      debugDraw.DrawSegment(p1, p2, color);
   }
   Box2D.inherit(b2ConstantAccelController, Box2D.Dynamics.Controllers.b2Controller);
   b2ConstantAccelController.prototype.__super = Box2D.Dynamics.Controllers.b2Controller.prototype;
   b2ConstantAccelController.b2ConstantAccelController = function () {
      Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this, arguments);
      this.A = new b2Vec2(0, 0);
   };
   b2ConstantAccelController.prototype.Step = function (step) {
      var smallA = new b2Vec2(this.A.x * step.dt, this.A.y * step.dt);
      for (var i = this.m_bodyList; i; i = i.nextBody) {
         var body = i.body;
         if (!body.IsAwake()) continue;
         body.SetLinearVelocity(new b2Vec2(body.GetLinearVelocity().x + smallA.x, body.GetLinearVelocity().y + smallA.y));
      }
   }
   Box2D.inherit(b2ConstantForceController, Box2D.Dynamics.Controllers.b2Controller);
   b2ConstantForceController.prototype.__super = Box2D.Dynamics.Controllers.b2Controller.prototype;
   b2ConstantForceController.b2ConstantForceController = function () {
      Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this, arguments);
      this.F = new b2Vec2(0, 0);
   };
   b2ConstantForceController.prototype.Step = function (step) {
      for (var i = this.m_bodyList; i; i = i.nextBody) {
         var body = i.body;
         if (!body.IsAwake()) continue;
         body.ApplyForce(this.F, body.GetWorldCenter());
      }
   }
   b2Controller.b2Controller = function () {};
   b2Controller.prototype.Step = function (step) {}
   b2Controller.prototype.Draw = function (debugDraw) {}
   b2Controller.prototype.AddBody = function (body) {
      var edge = new b2ControllerEdge();
      edge.controller = this;
      edge.body = body;
      edge.nextBody = this.m_bodyList;
      edge.prevBody = null;
      this.m_bodyList = edge;
      if (edge.nextBody) edge.nextBody.prevBody = edge;
      this.m_bodyCount++;
      edge.nextController = body.m_controllerList;
      edge.prevController = null;
      body.m_controllerList = edge;
      if (edge.nextController) edge.nextController.prevController = edge;
      body.m_controllerCount++;
   }
   b2Controller.prototype.RemoveBody = function (body) {
      var edge = body.m_controllerList;
      while (edge && edge.controller != this)
      edge = edge.nextController;
      if (edge.prevBody) edge.prevBody.nextBody = edge.nextBody;
      if (edge.nextBody) edge.nextBody.prevBody = edge.prevBody;
      if (edge.nextController) edge.nextController.prevController = edge.prevController;
      if (edge.prevController) edge.prevController.nextController = edge.nextController;
      if (this.m_bodyList == edge) this.m_bodyList = edge.nextBody;
      if (body.m_controllerList == edge) body.m_controllerList = edge.nextController;
      body.m_controllerCount--;
      this.m_bodyCount--;
   }
   b2Controller.prototype.Clear = function () {
      while (this.m_bodyList)
      this.RemoveBody(this.m_bodyList.body);
   }
   b2Controller.prototype.GetNext = function () {
      return this.m_next;
   }
   b2Controller.prototype.GetWorld = function () {
      return this.m_world;
   }
   b2Controller.prototype.GetBodyList = function () {
      return this.m_bodyList;
   }
   b2ControllerEdge.b2ControllerEdge = function () {};
   Box2D.inherit(b2GravityController, Box2D.Dynamics.Controllers.b2Controller);
   b2GravityController.prototype.__super = Box2D.Dynamics.Controllers.b2Controller.prototype;
   b2GravityController.b2GravityController = function () {
      Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this, arguments);
      this.G = 1;
      this.invSqr = true;
   };
   b2GravityController.prototype.Step = function (step) {
      var i = null;
      var body1 = null;
      var p1 = null;
      var mass1 = 0;
      var j = null;
      var body2 = null;
      var p2 = null;
      var dx = 0;
      var dy = 0;
      var r2 = 0;
      var f = null;
      if (this.invSqr) {
         for (i = this.m_bodyList;
         i; i = i.nextBody) {
            body1 = i.body;
            p1 = body1.GetWorldCenter();
            mass1 = body1.GetMass();
            for (j = this.m_bodyList;
            j != i; j = j.nextBody) {
               body2 = j.body;
               p2 = body2.GetWorldCenter();
               dx = p2.x - p1.x;
               dy = p2.y - p1.y;
               r2 = dx * dx + dy * dy;
               if (r2 < Number.MIN_VALUE) continue;
               f = new b2Vec2(dx, dy);
               f.Multiply(this.G / r2 / Math.sqrt(r2) * mass1 * body2.GetMass());
               if (body1.IsAwake()) body1.ApplyForce(f, p1);
               f.Multiply((-1));
               if (body2.IsAwake()) body2.ApplyForce(f, p2);
            }
         }
      }
      else {
         for (i = this.m_bodyList;
         i; i = i.nextBody) {
            body1 = i.body;
            p1 = body1.GetWorldCenter();
            mass1 = body1.GetMass();
            for (j = this.m_bodyList;
            j != i; j = j.nextBody) {
               body2 = j.body;
               p2 = body2.GetWorldCenter();
               dx = p2.x - p1.x;
               dy = p2.y - p1.y;
               r2 = dx * dx + dy * dy;
               if (r2 < Number.MIN_VALUE) continue;
               f = new b2Vec2(dx, dy);
               f.Multiply(this.G / r2 * mass1 * body2.GetMass());
               if (body1.IsAwake()) body1.ApplyForce(f, p1);
               f.Multiply((-1));
               if (body2.IsAwake()) body2.ApplyForce(f, p2);
            }
         }
      }
   }
   Box2D.inherit(b2TensorDampingController, Box2D.Dynamics.Controllers.b2Controller);
   b2TensorDampingController.prototype.__super = Box2D.Dynamics.Controllers.b2Controller.prototype;
   b2TensorDampingController.b2TensorDampingController = function () {
      Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this, arguments);
      this.T = new b2Mat22();
      this.maxTimestep = 0;
   };
   b2TensorDampingController.prototype.SetAxisAligned = function (xDamping, yDamping) {
      if (xDamping === undefined) xDamping = 0;
      if (yDamping === undefined) yDamping = 0;
      this.T.col1.x = (-xDamping);
      this.T.col1.y = 0;
      this.T.col2.x = 0;
      this.T.col2.y = (-yDamping);
      if (xDamping > 0 || yDamping > 0) {
         this.maxTimestep = 1 / Math.max(xDamping, yDamping);
      }
      else {
         this.maxTimestep = 0;
      }
   }
   b2TensorDampingController.prototype.Step = function (step) {
      var timestep = step.dt;
      if (timestep <= Number.MIN_VALUE) return;
      if (timestep > this.maxTimestep && this.maxTimestep > 0) timestep = this.maxTimestep;
      for (var i = this.m_bodyList; i; i = i.nextBody) {
         var body = i.body;
         if (!body.IsAwake()) {
            continue;
         }
         var damping = body.GetWorldVector(b2Math.MulMV(this.T, body.GetLocalVector(body.GetLinearVelocity())));
         body.SetLinearVelocity(new b2Vec2(body.GetLinearVelocity().x + damping.x * timestep, body.GetLinearVelocity().y + damping.y * timestep));
      }
   }
})();
(function () {
   var b2Color = Box2D.Common.b2Color,
      b2internal = Box2D.Common.b2internal,
      b2Settings = Box2D.Common.b2Settings,
      b2Mat22 = Box2D.Common.Math.b2Mat22,
      b2Mat33 = Box2D.Common.Math.b2Mat33,
      b2Math = Box2D.Common.Math.b2Math,
      b2Sweep = Box2D.Common.Math.b2Sweep,
      b2Transform = Box2D.Common.Math.b2Transform,
      b2Vec2 = Box2D.Common.Math.b2Vec2,
      b2Vec3 = Box2D.Common.Math.b2Vec3,
      b2DistanceJoint = Box2D.Dynamics.Joints.b2DistanceJoint,
      b2DistanceJointDef = Box2D.Dynamics.Joints.b2DistanceJointDef,
      b2FrictionJoint = Box2D.Dynamics.Joints.b2FrictionJoint,
      b2FrictionJointDef = Box2D.Dynamics.Joints.b2FrictionJointDef,
      b2GearJoint = Box2D.Dynamics.Joints.b2GearJoint,
      b2GearJointDef = Box2D.Dynamics.Joints.b2GearJointDef,
      b2Jacobian = Box2D.Dynamics.Joints.b2Jacobian,
      b2Joint = Box2D.Dynamics.Joints.b2Joint,
      b2JointDef = Box2D.Dynamics.Joints.b2JointDef,
      b2JointEdge = Box2D.Dynamics.Joints.b2JointEdge,
      b2LineJoint = Box2D.Dynamics.Joints.b2LineJoint,
      b2LineJointDef = Box2D.Dynamics.Joints.b2LineJointDef,
      b2MouseJoint = Box2D.Dynamics.Joints.b2MouseJoint,
      b2MouseJointDef = Box2D.Dynamics.Joints.b2MouseJointDef,
      b2PrismaticJoint = Box2D.Dynamics.Joints.b2PrismaticJoint,
      b2PrismaticJointDef = Box2D.Dynamics.Joints.b2PrismaticJointDef,
      b2PulleyJoint = Box2D.Dynamics.Joints.b2PulleyJoint,
      b2PulleyJointDef = Box2D.Dynamics.Joints.b2PulleyJointDef,
      b2RevoluteJoint = Box2D.Dynamics.Joints.b2RevoluteJoint,
      b2RevoluteJointDef = Box2D.Dynamics.Joints.b2RevoluteJointDef,
      b2WeldJoint = Box2D.Dynamics.Joints.b2WeldJoint,
      b2WeldJointDef = Box2D.Dynamics.Joints.b2WeldJointDef,
      b2Body = Box2D.Dynamics.b2Body,
      b2BodyDef = Box2D.Dynamics.b2BodyDef,
      b2ContactFilter = Box2D.Dynamics.b2ContactFilter,
      b2ContactImpulse = Box2D.Dynamics.b2ContactImpulse,
      b2ContactListener = Box2D.Dynamics.b2ContactListener,
      b2ContactManager = Box2D.Dynamics.b2ContactManager,
      b2DebugDraw = Box2D.Dynamics.b2DebugDraw,
      b2DestructionListener = Box2D.Dynamics.b2DestructionListener,
      b2FilterData = Box2D.Dynamics.b2FilterData,
      b2Fixture = Box2D.Dynamics.b2Fixture,
      b2FixtureDef = Box2D.Dynamics.b2FixtureDef,
      b2Island = Box2D.Dynamics.b2Island,
      b2TimeStep = Box2D.Dynamics.b2TimeStep,
      b2World = Box2D.Dynamics.b2World;

   Box2D.inherit(b2DistanceJoint, Box2D.Dynamics.Joints.b2Joint);
   b2DistanceJoint.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype;
   b2DistanceJoint.b2DistanceJoint = function () {
      Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments);
      this.m_localAnchor1 = new b2Vec2();
      this.m_localAnchor2 = new b2Vec2();
      this.m_u = new b2Vec2();
   };
   b2DistanceJoint.prototype.GetAnchorA = function () {
      return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
   }
   b2DistanceJoint.prototype.GetAnchorB = function () {
      return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
   }
   b2DistanceJoint.prototype.GetReactionForce = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return new b2Vec2(inv_dt * this.m_impulse * this.m_u.x, inv_dt * this.m_impulse * this.m_u.y);
   }
   b2DistanceJoint.prototype.GetReactionTorque = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return 0.0;
   }
   b2DistanceJoint.prototype.GetLength = function () {
      return this.m_length;
   }
   b2DistanceJoint.prototype.SetLength = function (length) {
      if (length === undefined) length = 0;
      this.m_length = length;
   }
   b2DistanceJoint.prototype.GetFrequency = function () {
      return this.m_frequencyHz;
   }
   b2DistanceJoint.prototype.SetFrequency = function (hz) {
      if (hz === undefined) hz = 0;
      this.m_frequencyHz = hz;
   }
   b2DistanceJoint.prototype.GetDampingRatio = function () {
      return this.m_dampingRatio;
   }
   b2DistanceJoint.prototype.SetDampingRatio = function (ratio) {
      if (ratio === undefined) ratio = 0;
      this.m_dampingRatio = ratio;
   }
   b2DistanceJoint.prototype.b2DistanceJoint = function (def) {
      this.__super.b2Joint.call(this, def);
      var tMat;
      var tX = 0;
      var tY = 0;
      this.m_localAnchor1.SetV(def.localAnchorA);
      this.m_localAnchor2.SetV(def.localAnchorB);
      this.m_length = def.length;
      this.m_frequencyHz = def.frequencyHz;
      this.m_dampingRatio = def.dampingRatio;
      this.m_impulse = 0.0;
      this.m_gamma = 0.0;
      this.m_bias = 0.0;
   }
   b2DistanceJoint.prototype.InitVelocityConstraints = function (step) {
      var tMat;
      var tX = 0;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      tMat = bA.m_xf.R;
      var r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
      var r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
      tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = bB.m_xf.R;
      var r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
      var r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      this.m_u.x = bB.m_sweep.c.x + r2X - bA.m_sweep.c.x - r1X;
      this.m_u.y = bB.m_sweep.c.y + r2Y - bA.m_sweep.c.y - r1Y;
      var length = Math.sqrt(this.m_u.x * this.m_u.x + this.m_u.y * this.m_u.y);
      if (length > b2Settings.b2_linearSlop) {
         this.m_u.Multiply(1.0 / length);
      }
      else {
         this.m_u.SetZero();
      }
      var cr1u = (r1X * this.m_u.y - r1Y * this.m_u.x);
      var cr2u = (r2X * this.m_u.y - r2Y * this.m_u.x);
      var invMass = bA.m_invMass + bA.m_invI * cr1u * cr1u + bB.m_invMass + bB.m_invI * cr2u * cr2u;
      this.m_mass = invMass != 0.0 ? 1.0 / invMass : 0.0;
      if (this.m_frequencyHz > 0.0) {
         var C = length - this.m_length;
         var omega = 2.0 * Math.PI * this.m_frequencyHz;
         var d = 2.0 * this.m_mass * this.m_dampingRatio * omega;
         var k = this.m_mass * omega * omega;
         this.m_gamma = step.dt * (d + step.dt * k);
         this.m_gamma = this.m_gamma != 0.0 ? 1 / this.m_gamma : 0.0;
         this.m_bias = C * step.dt * k * this.m_gamma;
         this.m_mass = invMass + this.m_gamma;
         this.m_mass = this.m_mass != 0.0 ? 1.0 / this.m_mass : 0.0;
      }
      if (step.warmStarting) {
         this.m_impulse *= step.dtRatio;
         var PX = this.m_impulse * this.m_u.x;
         var PY = this.m_impulse * this.m_u.y;
         bA.m_linearVelocity.x -= bA.m_invMass * PX;
         bA.m_linearVelocity.y -= bA.m_invMass * PY;
         bA.m_angularVelocity -= bA.m_invI * (r1X * PY - r1Y * PX);
         bB.m_linearVelocity.x += bB.m_invMass * PX;
         bB.m_linearVelocity.y += bB.m_invMass * PY;
         bB.m_angularVelocity += bB.m_invI * (r2X * PY - r2Y * PX);
      }
      else {
         this.m_impulse = 0.0;
      }
   }
   b2DistanceJoint.prototype.SolveVelocityConstraints = function (step) {
      var tMat;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      tMat = bA.m_xf.R;
      var r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
      var r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
      var tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = bB.m_xf.R;
      var r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
      var r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var v1X = bA.m_linearVelocity.x + ((-bA.m_angularVelocity * r1Y));
      var v1Y = bA.m_linearVelocity.y + (bA.m_angularVelocity * r1X);
      var v2X = bB.m_linearVelocity.x + ((-bB.m_angularVelocity * r2Y));
      var v2Y = bB.m_linearVelocity.y + (bB.m_angularVelocity * r2X);
      var Cdot = (this.m_u.x * (v2X - v1X) + this.m_u.y * (v2Y - v1Y));
      var impulse = (-this.m_mass * (Cdot + this.m_bias + this.m_gamma * this.m_impulse));
      this.m_impulse += impulse;
      var PX = impulse * this.m_u.x;
      var PY = impulse * this.m_u.y;
      bA.m_linearVelocity.x -= bA.m_invMass * PX;
      bA.m_linearVelocity.y -= bA.m_invMass * PY;
      bA.m_angularVelocity -= bA.m_invI * (r1X * PY - r1Y * PX);
      bB.m_linearVelocity.x += bB.m_invMass * PX;
      bB.m_linearVelocity.y += bB.m_invMass * PY;
      bB.m_angularVelocity += bB.m_invI * (r2X * PY - r2Y * PX);
   }
   b2DistanceJoint.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      var tMat;
      if (this.m_frequencyHz > 0.0) {
         return true;
      }
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      tMat = bA.m_xf.R;
      var r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
      var r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
      var tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = bB.m_xf.R;
      var r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
      var r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var dX = bB.m_sweep.c.x + r2X - bA.m_sweep.c.x - r1X;
      var dY = bB.m_sweep.c.y + r2Y - bA.m_sweep.c.y - r1Y;
      var length = Math.sqrt(dX * dX + dY * dY);
      dX /= length;
      dY /= length;
      var C = length - this.m_length;
      C = b2Math.Clamp(C, (-b2Settings.b2_maxLinearCorrection), b2Settings.b2_maxLinearCorrection);
      var impulse = (-this.m_mass * C);
      this.m_u.Set(dX, dY);
      var PX = impulse * this.m_u.x;
      var PY = impulse * this.m_u.y;
      bA.m_sweep.c.x -= bA.m_invMass * PX;
      bA.m_sweep.c.y -= bA.m_invMass * PY;
      bA.m_sweep.a -= bA.m_invI * (r1X * PY - r1Y * PX);
      bB.m_sweep.c.x += bB.m_invMass * PX;
      bB.m_sweep.c.y += bB.m_invMass * PY;
      bB.m_sweep.a += bB.m_invI * (r2X * PY - r2Y * PX);
      bA.SynchronizeTransform();
      bB.SynchronizeTransform();
      return b2Math.Abs(C) < b2Settings.b2_linearSlop;
   }
   Box2D.inherit(b2DistanceJointDef, Box2D.Dynamics.Joints.b2JointDef);
   b2DistanceJointDef.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype;
   b2DistanceJointDef.b2DistanceJointDef = function () {
      Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments);
      this.localAnchorA = new b2Vec2();
      this.localAnchorB = new b2Vec2();
   };
   b2DistanceJointDef.prototype.b2DistanceJointDef = function () {
      this.__super.b2JointDef.call(this);
      this.type = b2Joint.e_distanceJoint;
      this.length = 1.0;
      this.frequencyHz = 0.0;
      this.dampingRatio = 0.0;
   }
   b2DistanceJointDef.prototype.Initialize = function (bA, bB, anchorA, anchorB) {
      this.bodyA = bA;
      this.bodyB = bB;
      this.localAnchorA.SetV(this.bodyA.GetLocalPoint(anchorA));
      this.localAnchorB.SetV(this.bodyB.GetLocalPoint(anchorB));
      var dX = anchorB.x - anchorA.x;
      var dY = anchorB.y - anchorA.y;
      this.length = Math.sqrt(dX * dX + dY * dY);
      this.frequencyHz = 0.0;
      this.dampingRatio = 0.0;
   }
   Box2D.inherit(b2FrictionJoint, Box2D.Dynamics.Joints.b2Joint);
   b2FrictionJoint.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype;
   b2FrictionJoint.b2FrictionJoint = function () {
      Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments);
      this.m_localAnchorA = new b2Vec2();
      this.m_localAnchorB = new b2Vec2();
      this.m_linearMass = new b2Mat22();
      this.m_linearImpulse = new b2Vec2();
   };
   b2FrictionJoint.prototype.GetAnchorA = function () {
      return this.m_bodyA.GetWorldPoint(this.m_localAnchorA);
   }
   b2FrictionJoint.prototype.GetAnchorB = function () {
      return this.m_bodyB.GetWorldPoint(this.m_localAnchorB);
   }
   b2FrictionJoint.prototype.GetReactionForce = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return new b2Vec2(inv_dt * this.m_linearImpulse.x, inv_dt * this.m_linearImpulse.y);
   }
   b2FrictionJoint.prototype.GetReactionTorque = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return inv_dt * this.m_angularImpulse;
   }
   b2FrictionJoint.prototype.SetMaxForce = function (force) {
      if (force === undefined) force = 0;
      this.m_maxForce = force;
   }
   b2FrictionJoint.prototype.GetMaxForce = function () {
      return this.m_maxForce;
   }
   b2FrictionJoint.prototype.SetMaxTorque = function (torque) {
      if (torque === undefined) torque = 0;
      this.m_maxTorque = torque;
   }
   b2FrictionJoint.prototype.GetMaxTorque = function () {
      return this.m_maxTorque;
   }
   b2FrictionJoint.prototype.b2FrictionJoint = function (def) {
      this.__super.b2Joint.call(this, def);
      this.m_localAnchorA.SetV(def.localAnchorA);
      this.m_localAnchorB.SetV(def.localAnchorB);
      this.m_linearMass.SetZero();
      this.m_angularMass = 0.0;
      this.m_linearImpulse.SetZero();
      this.m_angularImpulse = 0.0;
      this.m_maxForce = def.maxForce;
      this.m_maxTorque = def.maxTorque;
   }
   b2FrictionJoint.prototype.InitVelocityConstraints = function (step) {
      var tMat;
      var tX = 0;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      tMat = bA.m_xf.R;
      var rAX = this.m_localAnchorA.x - bA.m_sweep.localCenter.x;
      var rAY = this.m_localAnchorA.y - bA.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rAX + tMat.col2.x * rAY);
      rAY = (tMat.col1.y * rAX + tMat.col2.y * rAY);
      rAX = tX;
      tMat = bB.m_xf.R;
      var rBX = this.m_localAnchorB.x - bB.m_sweep.localCenter.x;
      var rBY = this.m_localAnchorB.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rBX + tMat.col2.x * rBY);
      rBY = (tMat.col1.y * rBX + tMat.col2.y * rBY);
      rBX = tX;
      var mA = bA.m_invMass;
      var mB = bB.m_invMass;
      var iA = bA.m_invI;
      var iB = bB.m_invI;
      var K = new b2Mat22();
      K.col1.x = mA + mB;
      K.col2.x = 0.0;
      K.col1.y = 0.0;
      K.col2.y = mA + mB;
      K.col1.x += iA * rAY * rAY;
      K.col2.x += (-iA * rAX * rAY);
      K.col1.y += (-iA * rAX * rAY);
      K.col2.y += iA * rAX * rAX;
      K.col1.x += iB * rBY * rBY;
      K.col2.x += (-iB * rBX * rBY);
      K.col1.y += (-iB * rBX * rBY);
      K.col2.y += iB * rBX * rBX;
      K.GetInverse(this.m_linearMass);
      this.m_angularMass = iA + iB;
      if (this.m_angularMass > 0.0) {
         this.m_angularMass = 1.0 / this.m_angularMass;
      }
      if (step.warmStarting) {
         this.m_linearImpulse.x *= step.dtRatio;
         this.m_linearImpulse.y *= step.dtRatio;
         this.m_angularImpulse *= step.dtRatio;
         var P = this.m_linearImpulse;
         bA.m_linearVelocity.x -= mA * P.x;
         bA.m_linearVelocity.y -= mA * P.y;
         bA.m_angularVelocity -= iA * (rAX * P.y - rAY * P.x + this.m_angularImpulse);
         bB.m_linearVelocity.x += mB * P.x;
         bB.m_linearVelocity.y += mB * P.y;
         bB.m_angularVelocity += iB * (rBX * P.y - rBY * P.x + this.m_angularImpulse);
      }
      else {
         this.m_linearImpulse.SetZero();
         this.m_angularImpulse = 0.0;
      }
   }
   b2FrictionJoint.prototype.SolveVelocityConstraints = function (step) {
      var tMat;
      var tX = 0;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var vA = bA.m_linearVelocity;
      var wA = bA.m_angularVelocity;
      var vB = bB.m_linearVelocity;
      var wB = bB.m_angularVelocity;
      var mA = bA.m_invMass;
      var mB = bB.m_invMass;
      var iA = bA.m_invI;
      var iB = bB.m_invI;
      tMat = bA.m_xf.R;
      var rAX = this.m_localAnchorA.x - bA.m_sweep.localCenter.x;
      var rAY = this.m_localAnchorA.y - bA.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rAX + tMat.col2.x * rAY);
      rAY = (tMat.col1.y * rAX + tMat.col2.y * rAY);
      rAX = tX;
      tMat = bB.m_xf.R;
      var rBX = this.m_localAnchorB.x - bB.m_sweep.localCenter.x;
      var rBY = this.m_localAnchorB.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rBX + tMat.col2.x * rBY);
      rBY = (tMat.col1.y * rBX + tMat.col2.y * rBY);
      rBX = tX;
      var maxImpulse = 0; {
         var Cdot = wB - wA;
         var impulse = (-this.m_angularMass * Cdot);
         var oldImpulse = this.m_angularImpulse;
         maxImpulse = step.dt * this.m_maxTorque;
         this.m_angularImpulse = b2Math.Clamp(this.m_angularImpulse + impulse, (-maxImpulse), maxImpulse);
         impulse = this.m_angularImpulse - oldImpulse;
         wA -= iA * impulse;
         wB += iB * impulse;
      } {
         var CdotX = vB.x - wB * rBY - vA.x + wA * rAY;
         var CdotY = vB.y + wB * rBX - vA.y - wA * rAX;
         var impulseV = b2Math.MulMV(this.m_linearMass, new b2Vec2((-CdotX), (-CdotY)));
         var oldImpulseV = this.m_linearImpulse.Copy();
         this.m_linearImpulse.Add(impulseV);
         maxImpulse = step.dt * this.m_maxForce;
         if (this.m_linearImpulse.LengthSquared() > maxImpulse * maxImpulse) {
            this.m_linearImpulse.Normalize();
            this.m_linearImpulse.Multiply(maxImpulse);
         }
         impulseV = b2Math.SubtractVV(this.m_linearImpulse, oldImpulseV);
         vA.x -= mA * impulseV.x;
         vA.y -= mA * impulseV.y;
         wA -= iA * (rAX * impulseV.y - rAY * impulseV.x);
         vB.x += mB * impulseV.x;
         vB.y += mB * impulseV.y;
         wB += iB * (rBX * impulseV.y - rBY * impulseV.x);
      }
      bA.m_angularVelocity = wA;
      bB.m_angularVelocity = wB;
   }
   b2FrictionJoint.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      return true;
   }
   Box2D.inherit(b2FrictionJointDef, Box2D.Dynamics.Joints.b2JointDef);
   b2FrictionJointDef.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype;
   b2FrictionJointDef.b2FrictionJointDef = function () {
      Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments);
      this.localAnchorA = new b2Vec2();
      this.localAnchorB = new b2Vec2();
   };
   b2FrictionJointDef.prototype.b2FrictionJointDef = function () {
      this.__super.b2JointDef.call(this);
      this.type = b2Joint.e_frictionJoint;
      this.maxForce = 0.0;
      this.maxTorque = 0.0;
   }
   b2FrictionJointDef.prototype.Initialize = function (bA, bB, anchor) {
      this.bodyA = bA;
      this.bodyB = bB;
      this.localAnchorA.SetV(this.bodyA.GetLocalPoint(anchor));
      this.localAnchorB.SetV(this.bodyB.GetLocalPoint(anchor));
   }
   Box2D.inherit(b2GearJoint, Box2D.Dynamics.Joints.b2Joint);
   b2GearJoint.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype;
   b2GearJoint.b2GearJoint = function () {
      Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments);
      this.m_groundAnchor1 = new b2Vec2();
      this.m_groundAnchor2 = new b2Vec2();
      this.m_localAnchor1 = new b2Vec2();
      this.m_localAnchor2 = new b2Vec2();
      this.m_J = new b2Jacobian();
   };
   b2GearJoint.prototype.GetAnchorA = function () {
      return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
   }
   b2GearJoint.prototype.GetAnchorB = function () {
      return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
   }
   b2GearJoint.prototype.GetReactionForce = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return new b2Vec2(inv_dt * this.m_impulse * this.m_J.linearB.x, inv_dt * this.m_impulse * this.m_J.linearB.y);
   }
   b2GearJoint.prototype.GetReactionTorque = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      var tMat = this.m_bodyB.m_xf.R;
      var rX = this.m_localAnchor1.x - this.m_bodyB.m_sweep.localCenter.x;
      var rY = this.m_localAnchor1.y - this.m_bodyB.m_sweep.localCenter.y;
      var tX = tMat.col1.x * rX + tMat.col2.x * rY;
      rY = tMat.col1.y * rX + tMat.col2.y * rY;
      rX = tX;
      var PX = this.m_impulse * this.m_J.linearB.x;
      var PY = this.m_impulse * this.m_J.linearB.y;
      return inv_dt * (this.m_impulse * this.m_J.angularB - rX * PY + rY * PX);
   }
   b2GearJoint.prototype.GetRatio = function () {
      return this.m_ratio;
   }
   b2GearJoint.prototype.SetRatio = function (ratio) {
      if (ratio === undefined) ratio = 0;
      this.m_ratio = ratio;
   }
   b2GearJoint.prototype.b2GearJoint = function (def) {
      this.__super.b2Joint.call(this, def);
      var type1 = parseInt(def.joint1.m_type);
      var type2 = parseInt(def.joint2.m_type);
      this.m_revolute1 = null;
      this.m_prismatic1 = null;
      this.m_revolute2 = null;
      this.m_prismatic2 = null;
      var coordinate1 = 0;
      var coordinate2 = 0;
      this.m_ground1 = def.joint1.GetBodyA();
      this.m_bodyA = def.joint1.GetBodyB();
      if (type1 == b2Joint.e_revoluteJoint) {
         this.m_revolute1 = (def.joint1 instanceof b2RevoluteJoint ? def.joint1 : null);
         this.m_groundAnchor1.SetV(this.m_revolute1.m_localAnchor1);
         this.m_localAnchor1.SetV(this.m_revolute1.m_localAnchor2);
         coordinate1 = this.m_revolute1.GetJointAngle();
      }
      else {
         this.m_prismatic1 = (def.joint1 instanceof b2PrismaticJoint ? def.joint1 : null);
         this.m_groundAnchor1.SetV(this.m_prismatic1.m_localAnchor1);
         this.m_localAnchor1.SetV(this.m_prismatic1.m_localAnchor2);
         coordinate1 = this.m_prismatic1.GetJointTranslation();
      }
      this.m_ground2 = def.joint2.GetBodyA();
      this.m_bodyB = def.joint2.GetBodyB();
      if (type2 == b2Joint.e_revoluteJoint) {
         this.m_revolute2 = (def.joint2 instanceof b2RevoluteJoint ? def.joint2 : null);
         this.m_groundAnchor2.SetV(this.m_revolute2.m_localAnchor1);
         this.m_localAnchor2.SetV(this.m_revolute2.m_localAnchor2);
         coordinate2 = this.m_revolute2.GetJointAngle();
      }
      else {
         this.m_prismatic2 = (def.joint2 instanceof b2PrismaticJoint ? def.joint2 : null);
         this.m_groundAnchor2.SetV(this.m_prismatic2.m_localAnchor1);
         this.m_localAnchor2.SetV(this.m_prismatic2.m_localAnchor2);
         coordinate2 = this.m_prismatic2.GetJointTranslation();
      }
      this.m_ratio = def.ratio;
      this.m_constant = coordinate1 + this.m_ratio * coordinate2;
      this.m_impulse = 0.0;
   }
   b2GearJoint.prototype.InitVelocityConstraints = function (step) {
      var g1 = this.m_ground1;
      var g2 = this.m_ground2;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var ugX = 0;
      var ugY = 0;
      var rX = 0;
      var rY = 0;
      var tMat;
      var tVec;
      var crug = 0;
      var tX = 0;
      var K = 0.0;
      this.m_J.SetZero();
      if (this.m_revolute1) {
         this.m_J.angularA = (-1.0);
         K += bA.m_invI;
      }
      else {
         tMat = g1.m_xf.R;
         tVec = this.m_prismatic1.m_localXAxis1;
         ugX = tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
         ugY = tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
         tMat = bA.m_xf.R;
         rX = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
         rY = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
         tX = tMat.col1.x * rX + tMat.col2.x * rY;
         rY = tMat.col1.y * rX + tMat.col2.y * rY;
         rX = tX;
         crug = rX * ugY - rY * ugX;
         this.m_J.linearA.Set((-ugX), (-ugY));
         this.m_J.angularA = (-crug);
         K += bA.m_invMass + bA.m_invI * crug * crug;
      }
      if (this.m_revolute2) {
         this.m_J.angularB = (-this.m_ratio);
         K += this.m_ratio * this.m_ratio * bB.m_invI;
      }
      else {
         tMat = g2.m_xf.R;
         tVec = this.m_prismatic2.m_localXAxis1;
         ugX = tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
         ugY = tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
         tMat = bB.m_xf.R;
         rX = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
         rY = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
         tX = tMat.col1.x * rX + tMat.col2.x * rY;
         rY = tMat.col1.y * rX + tMat.col2.y * rY;
         rX = tX;
         crug = rX * ugY - rY * ugX;
         this.m_J.linearB.Set((-this.m_ratio * ugX), (-this.m_ratio * ugY));
         this.m_J.angularB = (-this.m_ratio * crug);
         K += this.m_ratio * this.m_ratio * (bB.m_invMass + bB.m_invI * crug * crug);
      }
      this.m_mass = K > 0.0 ? 1.0 / K : 0.0;
      if (step.warmStarting) {
         bA.m_linearVelocity.x += bA.m_invMass * this.m_impulse * this.m_J.linearA.x;
         bA.m_linearVelocity.y += bA.m_invMass * this.m_impulse * this.m_J.linearA.y;
         bA.m_angularVelocity += bA.m_invI * this.m_impulse * this.m_J.angularA;
         bB.m_linearVelocity.x += bB.m_invMass * this.m_impulse * this.m_J.linearB.x;
         bB.m_linearVelocity.y += bB.m_invMass * this.m_impulse * this.m_J.linearB.y;
         bB.m_angularVelocity += bB.m_invI * this.m_impulse * this.m_J.angularB;
      }
      else {
         this.m_impulse = 0.0;
      }
   }
   b2GearJoint.prototype.SolveVelocityConstraints = function (step) {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var Cdot = this.m_J.Compute(bA.m_linearVelocity, bA.m_angularVelocity, bB.m_linearVelocity, bB.m_angularVelocity);
      var impulse = (-this.m_mass * Cdot);
      this.m_impulse += impulse;
      bA.m_linearVelocity.x += bA.m_invMass * impulse * this.m_J.linearA.x;
      bA.m_linearVelocity.y += bA.m_invMass * impulse * this.m_J.linearA.y;
      bA.m_angularVelocity += bA.m_invI * impulse * this.m_J.angularA;
      bB.m_linearVelocity.x += bB.m_invMass * impulse * this.m_J.linearB.x;
      bB.m_linearVelocity.y += bB.m_invMass * impulse * this.m_J.linearB.y;
      bB.m_angularVelocity += bB.m_invI * impulse * this.m_J.angularB;
   }
   b2GearJoint.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      var linearError = 0.0;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var coordinate1 = 0;
      var coordinate2 = 0;
      if (this.m_revolute1) {
         coordinate1 = this.m_revolute1.GetJointAngle();
      }
      else {
         coordinate1 = this.m_prismatic1.GetJointTranslation();
      }
      if (this.m_revolute2) {
         coordinate2 = this.m_revolute2.GetJointAngle();
      }
      else {
         coordinate2 = this.m_prismatic2.GetJointTranslation();
      }
      var C = this.m_constant - (coordinate1 + this.m_ratio * coordinate2);
      var impulse = (-this.m_mass * C);
      bA.m_sweep.c.x += bA.m_invMass * impulse * this.m_J.linearA.x;
      bA.m_sweep.c.y += bA.m_invMass * impulse * this.m_J.linearA.y;
      bA.m_sweep.a += bA.m_invI * impulse * this.m_J.angularA;
      bB.m_sweep.c.x += bB.m_invMass * impulse * this.m_J.linearB.x;
      bB.m_sweep.c.y += bB.m_invMass * impulse * this.m_J.linearB.y;
      bB.m_sweep.a += bB.m_invI * impulse * this.m_J.angularB;
      bA.SynchronizeTransform();
      bB.SynchronizeTransform();
      return linearError < b2Settings.b2_linearSlop;
   }
   Box2D.inherit(b2GearJointDef, Box2D.Dynamics.Joints.b2JointDef);
   b2GearJointDef.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype;
   b2GearJointDef.b2GearJointDef = function () {
      Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments);
   };
   b2GearJointDef.prototype.b2GearJointDef = function () {
      this.__super.b2JointDef.call(this);
      this.type = b2Joint.e_gearJoint;
      this.joint1 = null;
      this.joint2 = null;
      this.ratio = 1.0;
   }
   b2Jacobian.b2Jacobian = function () {
      this.linearA = new b2Vec2();
      this.linearB = new b2Vec2();
   };
   b2Jacobian.prototype.SetZero = function () {
      this.linearA.SetZero();
      this.angularA = 0.0;
      this.linearB.SetZero();
      this.angularB = 0.0;
   }
   b2Jacobian.prototype.Set = function (x1, a1, x2, a2) {
      if (a1 === undefined) a1 = 0;
      if (a2 === undefined) a2 = 0;
      this.linearA.SetV(x1);
      this.angularA = a1;
      this.linearB.SetV(x2);
      this.angularB = a2;
   }
   b2Jacobian.prototype.Compute = function (x1, a1, x2, a2) {
      if (a1 === undefined) a1 = 0;
      if (a2 === undefined) a2 = 0;
      return (this.linearA.x * x1.x + this.linearA.y * x1.y) + this.angularA * a1 + (this.linearB.x * x2.x + this.linearB.y * x2.y) + this.angularB * a2;
   }
   b2Joint.b2Joint = function () {
      this.m_edgeA = new b2JointEdge();
      this.m_edgeB = new b2JointEdge();
      this.m_localCenterA = new b2Vec2();
      this.m_localCenterB = new b2Vec2();
   };
   b2Joint.prototype.GetType = function () {
      return this.m_type;
   }
   b2Joint.prototype.GetAnchorA = function () {
      return null;
   }
   b2Joint.prototype.GetAnchorB = function () {
      return null;
   }
   b2Joint.prototype.GetReactionForce = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return null;
   }
   b2Joint.prototype.GetReactionTorque = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return 0.0;
   }
   b2Joint.prototype.GetBodyA = function () {
      return this.m_bodyA;
   }
   b2Joint.prototype.GetBodyB = function () {
      return this.m_bodyB;
   }
   b2Joint.prototype.GetNext = function () {
      return this.m_next;
   }
   b2Joint.prototype.GetUserData = function () {
      return this.m_userData;
   }
   b2Joint.prototype.SetUserData = function (data) {
      this.m_userData = data;
   }
   b2Joint.prototype.IsActive = function () {
      return this.m_bodyA.IsActive() && this.m_bodyB.IsActive();
   }
   b2Joint.Create = function (def, allocator) {
      var joint = null;
      switch (def.type) {
      case b2Joint.e_distanceJoint:
         {
            joint = new b2DistanceJoint((def instanceof b2DistanceJointDef ? def : null));
         }
         break;
      case b2Joint.e_mouseJoint:
         {
            joint = new b2MouseJoint((def instanceof b2MouseJointDef ? def : null));
         }
         break;
      case b2Joint.e_prismaticJoint:
         {
            joint = new b2PrismaticJoint((def instanceof b2PrismaticJointDef ? def : null));
         }
         break;
      case b2Joint.e_revoluteJoint:
         {
            joint = new b2RevoluteJoint((def instanceof b2RevoluteJointDef ? def : null));
         }
         break;
      case b2Joint.e_pulleyJoint:
         {
            joint = new b2PulleyJoint((def instanceof b2PulleyJointDef ? def : null));
         }
         break;
      case b2Joint.e_gearJoint:
         {
            joint = new b2GearJoint((def instanceof b2GearJointDef ? def : null));
         }
         break;
      case b2Joint.e_lineJoint:
         {
            joint = new b2LineJoint((def instanceof b2LineJointDef ? def : null));
         }
         break;
      case b2Joint.e_weldJoint:
         {
            joint = new b2WeldJoint((def instanceof b2WeldJointDef ? def : null));
         }
         break;
      case b2Joint.e_frictionJoint:
         {
            joint = new b2FrictionJoint((def instanceof b2FrictionJointDef ? def : null));
         }
         break;
      default:
         break;
      }
      return joint;
   }
   b2Joint.Destroy = function (joint, allocator) {}
   b2Joint.prototype.b2Joint = function (def) {
      b2Settings.b2Assert(def.bodyA != def.bodyB);
      this.m_type = def.type;
      this.m_prev = null;
      this.m_next = null;
      this.m_bodyA = def.bodyA;
      this.m_bodyB = def.bodyB;
      this.m_collideConnected = def.collideConnected;
      this.m_islandFlag = false;
      this.m_userData = def.userData;
   }
   b2Joint.prototype.InitVelocityConstraints = function (step) {}
   b2Joint.prototype.SolveVelocityConstraints = function (step) {}
   b2Joint.prototype.FinalizeVelocityConstraints = function () {}
   b2Joint.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      return false;
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.Joints.b2Joint.e_unknownJoint = 0;
      Box2D.Dynamics.Joints.b2Joint.e_revoluteJoint = 1;
      Box2D.Dynamics.Joints.b2Joint.e_prismaticJoint = 2;
      Box2D.Dynamics.Joints.b2Joint.e_distanceJoint = 3;
      Box2D.Dynamics.Joints.b2Joint.e_pulleyJoint = 4;
      Box2D.Dynamics.Joints.b2Joint.e_mouseJoint = 5;
      Box2D.Dynamics.Joints.b2Joint.e_gearJoint = 6;
      Box2D.Dynamics.Joints.b2Joint.e_lineJoint = 7;
      Box2D.Dynamics.Joints.b2Joint.e_weldJoint = 8;
      Box2D.Dynamics.Joints.b2Joint.e_frictionJoint = 9;
      Box2D.Dynamics.Joints.b2Joint.e_inactiveLimit = 0;
      Box2D.Dynamics.Joints.b2Joint.e_atLowerLimit = 1;
      Box2D.Dynamics.Joints.b2Joint.e_atUpperLimit = 2;
      Box2D.Dynamics.Joints.b2Joint.e_equalLimits = 3;
   });
   b2JointDef.b2JointDef = function () {};
   b2JointDef.prototype.b2JointDef = function () {
      this.type = b2Joint.e_unknownJoint;
      this.userData = null;
      this.bodyA = null;
      this.bodyB = null;
      this.collideConnected = false;
   }
   b2JointEdge.b2JointEdge = function () {};
   Box2D.inherit(b2LineJoint, Box2D.Dynamics.Joints.b2Joint);
   b2LineJoint.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype;
   b2LineJoint.b2LineJoint = function () {
      Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments);
      this.m_localAnchor1 = new b2Vec2();
      this.m_localAnchor2 = new b2Vec2();
      this.m_localXAxis1 = new b2Vec2();
      this.m_localYAxis1 = new b2Vec2();
      this.m_axis = new b2Vec2();
      this.m_perp = new b2Vec2();
      this.m_K = new b2Mat22();
      this.m_impulse = new b2Vec2();
   };
   b2LineJoint.prototype.GetAnchorA = function () {
      return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
   }
   b2LineJoint.prototype.GetAnchorB = function () {
      return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
   }
   b2LineJoint.prototype.GetReactionForce = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return new b2Vec2(inv_dt * (this.m_impulse.x * this.m_perp.x + (this.m_motorImpulse + this.m_impulse.y) * this.m_axis.x), inv_dt * (this.m_impulse.x * this.m_perp.y + (this.m_motorImpulse + this.m_impulse.y) * this.m_axis.y));
   }
   b2LineJoint.prototype.GetReactionTorque = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return inv_dt * this.m_impulse.y;
   }
   b2LineJoint.prototype.GetJointTranslation = function () {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      var p1 = bA.GetWorldPoint(this.m_localAnchor1);
      var p2 = bB.GetWorldPoint(this.m_localAnchor2);
      var dX = p2.x - p1.x;
      var dY = p2.y - p1.y;
      var axis = bA.GetWorldVector(this.m_localXAxis1);
      var translation = axis.x * dX + axis.y * dY;
      return translation;
   }
   b2LineJoint.prototype.GetJointSpeed = function () {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      tMat = bA.m_xf.R;
      var r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
      var r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
      var tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = bB.m_xf.R;
      var r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
      var r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var p1X = bA.m_sweep.c.x + r1X;
      var p1Y = bA.m_sweep.c.y + r1Y;
      var p2X = bB.m_sweep.c.x + r2X;
      var p2Y = bB.m_sweep.c.y + r2Y;
      var dX = p2X - p1X;
      var dY = p2Y - p1Y;
      var axis = bA.GetWorldVector(this.m_localXAxis1);
      var v1 = bA.m_linearVelocity;
      var v2 = bB.m_linearVelocity;
      var w1 = bA.m_angularVelocity;
      var w2 = bB.m_angularVelocity;
      var speed = (dX * ((-w1 * axis.y)) + dY * (w1 * axis.x)) + (axis.x * (((v2.x + ((-w2 * r2Y))) - v1.x) - ((-w1 * r1Y))) + axis.y * (((v2.y + (w2 * r2X)) - v1.y) - (w1 * r1X)));
      return speed;
   }
   b2LineJoint.prototype.IsLimitEnabled = function () {
      return this.m_enableLimit;
   }
   b2LineJoint.prototype.EnableLimit = function (flag) {
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_enableLimit = flag;
   }
   b2LineJoint.prototype.GetLowerLimit = function () {
      return this.m_lowerTranslation;
   }
   b2LineJoint.prototype.GetUpperLimit = function () {
      return this.m_upperTranslation;
   }
   b2LineJoint.prototype.SetLimits = function (lower, upper) {
      if (lower === undefined) lower = 0;
      if (upper === undefined) upper = 0;
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_lowerTranslation = lower;
      this.m_upperTranslation = upper;
   }
   b2LineJoint.prototype.IsMotorEnabled = function () {
      return this.m_enableMotor;
   }
   b2LineJoint.prototype.EnableMotor = function (flag) {
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_enableMotor = flag;
   }
   b2LineJoint.prototype.SetMotorSpeed = function (speed) {
      if (speed === undefined) speed = 0;
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_motorSpeed = speed;
   }
   b2LineJoint.prototype.GetMotorSpeed = function () {
      return this.m_motorSpeed;
   }
   b2LineJoint.prototype.SetMaxMotorForce = function (force) {
      if (force === undefined) force = 0;
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_maxMotorForce = force;
   }
   b2LineJoint.prototype.GetMaxMotorForce = function () {
      return this.m_maxMotorForce;
   }
   b2LineJoint.prototype.GetMotorForce = function () {
      return this.m_motorImpulse;
   }
   b2LineJoint.prototype.b2LineJoint = function (def) {
      this.__super.b2Joint.call(this, def);
      var tMat;
      var tX = 0;
      var tY = 0;
      this.m_localAnchor1.SetV(def.localAnchorA);
      this.m_localAnchor2.SetV(def.localAnchorB);
      this.m_localXAxis1.SetV(def.localAxisA);
      this.m_localYAxis1.x = (-this.m_localXAxis1.y);
      this.m_localYAxis1.y = this.m_localXAxis1.x;
      this.m_impulse.SetZero();
      this.m_motorMass = 0.0;
      this.m_motorImpulse = 0.0;
      this.m_lowerTranslation = def.lowerTranslation;
      this.m_upperTranslation = def.upperTranslation;
      this.m_maxMotorForce = def.maxMotorForce;
      this.m_motorSpeed = def.motorSpeed;
      this.m_enableLimit = def.enableLimit;
      this.m_enableMotor = def.enableMotor;
      this.m_limitState = b2Joint.e_inactiveLimit;
      this.m_axis.SetZero();
      this.m_perp.SetZero();
   }
   b2LineJoint.prototype.InitVelocityConstraints = function (step) {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      var tX = 0;
      this.m_localCenterA.SetV(bA.GetLocalCenter());
      this.m_localCenterB.SetV(bB.GetLocalCenter());
      var xf1 = bA.GetTransform();
      var xf2 = bB.GetTransform();
      tMat = bA.m_xf.R;
      var r1X = this.m_localAnchor1.x - this.m_localCenterA.x;
      var r1Y = this.m_localAnchor1.y - this.m_localCenterA.y;
      tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = bB.m_xf.R;
      var r2X = this.m_localAnchor2.x - this.m_localCenterB.x;
      var r2Y = this.m_localAnchor2.y - this.m_localCenterB.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var dX = bB.m_sweep.c.x + r2X - bA.m_sweep.c.x - r1X;
      var dY = bB.m_sweep.c.y + r2Y - bA.m_sweep.c.y - r1Y;
      this.m_invMassA = bA.m_invMass;
      this.m_invMassB = bB.m_invMass;
      this.m_invIA = bA.m_invI;
      this.m_invIB = bB.m_invI; {
         this.m_axis.SetV(b2Math.MulMV(xf1.R, this.m_localXAxis1));
         this.m_a1 = (dX + r1X) * this.m_axis.y - (dY + r1Y) * this.m_axis.x;
         this.m_a2 = r2X * this.m_axis.y - r2Y * this.m_axis.x;
         this.m_motorMass = this.m_invMassA + this.m_invMassB + this.m_invIA * this.m_a1 * this.m_a1 + this.m_invIB * this.m_a2 * this.m_a2;
         this.m_motorMass = this.m_motorMass > Number.MIN_VALUE ? 1.0 / this.m_motorMass : 0.0;
      } {
         this.m_perp.SetV(b2Math.MulMV(xf1.R, this.m_localYAxis1));
         this.m_s1 = (dX + r1X) * this.m_perp.y - (dY + r1Y) * this.m_perp.x;
         this.m_s2 = r2X * this.m_perp.y - r2Y * this.m_perp.x;
         var m1 = this.m_invMassA;
         var m2 = this.m_invMassB;
         var i1 = this.m_invIA;
         var i2 = this.m_invIB;
         this.m_K.col1.x = m1 + m2 + i1 * this.m_s1 * this.m_s1 + i2 * this.m_s2 * this.m_s2;
         this.m_K.col1.y = i1 * this.m_s1 * this.m_a1 + i2 * this.m_s2 * this.m_a2;
         this.m_K.col2.x = this.m_K.col1.y;
         this.m_K.col2.y = m1 + m2 + i1 * this.m_a1 * this.m_a1 + i2 * this.m_a2 * this.m_a2;
      }
      if (this.m_enableLimit) {
         var jointTransition = this.m_axis.x * dX + this.m_axis.y * dY;
         if (b2Math.Abs(this.m_upperTranslation - this.m_lowerTranslation) < 2.0 * b2Settings.b2_linearSlop) {
            this.m_limitState = b2Joint.e_equalLimits;
         }
         else if (jointTransition <= this.m_lowerTranslation) {
            if (this.m_limitState != b2Joint.e_atLowerLimit) {
               this.m_limitState = b2Joint.e_atLowerLimit;
               this.m_impulse.y = 0.0;
            }
         }
         else if (jointTransition >= this.m_upperTranslation) {
            if (this.m_limitState != b2Joint.e_atUpperLimit) {
               this.m_limitState = b2Joint.e_atUpperLimit;
               this.m_impulse.y = 0.0;
            }
         }
         else {
            this.m_limitState = b2Joint.e_inactiveLimit;
            this.m_impulse.y = 0.0;
         }
      }
      else {
         this.m_limitState = b2Joint.e_inactiveLimit;
      }
      if (this.m_enableMotor == false) {
         this.m_motorImpulse = 0.0;
      }
      if (step.warmStarting) {
         this.m_impulse.x *= step.dtRatio;
         this.m_impulse.y *= step.dtRatio;
         this.m_motorImpulse *= step.dtRatio;
         var PX = this.m_impulse.x * this.m_perp.x + (this.m_motorImpulse + this.m_impulse.y) * this.m_axis.x;
         var PY = this.m_impulse.x * this.m_perp.y + (this.m_motorImpulse + this.m_impulse.y) * this.m_axis.y;
         var L1 = this.m_impulse.x * this.m_s1 + (this.m_motorImpulse + this.m_impulse.y) * this.m_a1;
         var L2 = this.m_impulse.x * this.m_s2 + (this.m_motorImpulse + this.m_impulse.y) * this.m_a2;
         bA.m_linearVelocity.x -= this.m_invMassA * PX;
         bA.m_linearVelocity.y -= this.m_invMassA * PY;
         bA.m_angularVelocity -= this.m_invIA * L1;
         bB.m_linearVelocity.x += this.m_invMassB * PX;
         bB.m_linearVelocity.y += this.m_invMassB * PY;
         bB.m_angularVelocity += this.m_invIB * L2;
      }
      else {
         this.m_impulse.SetZero();
         this.m_motorImpulse = 0.0;
      }
   }
   b2LineJoint.prototype.SolveVelocityConstraints = function (step) {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var v1 = bA.m_linearVelocity;
      var w1 = bA.m_angularVelocity;
      var v2 = bB.m_linearVelocity;
      var w2 = bB.m_angularVelocity;
      var PX = 0;
      var PY = 0;
      var L1 = 0;
      var L2 = 0;
      if (this.m_enableMotor && this.m_limitState != b2Joint.e_equalLimits) {
         var Cdot = this.m_axis.x * (v2.x - v1.x) + this.m_axis.y * (v2.y - v1.y) + this.m_a2 * w2 - this.m_a1 * w1;
         var impulse = this.m_motorMass * (this.m_motorSpeed - Cdot);
         var oldImpulse = this.m_motorImpulse;
         var maxImpulse = step.dt * this.m_maxMotorForce;
         this.m_motorImpulse = b2Math.Clamp(this.m_motorImpulse + impulse, (-maxImpulse), maxImpulse);
         impulse = this.m_motorImpulse - oldImpulse;
         PX = impulse * this.m_axis.x;
         PY = impulse * this.m_axis.y;
         L1 = impulse * this.m_a1;
         L2 = impulse * this.m_a2;
         v1.x -= this.m_invMassA * PX;
         v1.y -= this.m_invMassA * PY;
         w1 -= this.m_invIA * L1;
         v2.x += this.m_invMassB * PX;
         v2.y += this.m_invMassB * PY;
         w2 += this.m_invIB * L2;
      }
      var Cdot1 = this.m_perp.x * (v2.x - v1.x) + this.m_perp.y * (v2.y - v1.y) + this.m_s2 * w2 - this.m_s1 * w1;
      if (this.m_enableLimit && this.m_limitState != b2Joint.e_inactiveLimit) {
         var Cdot2 = this.m_axis.x * (v2.x - v1.x) + this.m_axis.y * (v2.y - v1.y) + this.m_a2 * w2 - this.m_a1 * w1;
         var f1 = this.m_impulse.Copy();
         var df = this.m_K.Solve(new b2Vec2(), (-Cdot1), (-Cdot2));
         this.m_impulse.Add(df);
         if (this.m_limitState == b2Joint.e_atLowerLimit) {
            this.m_impulse.y = b2Math.Max(this.m_impulse.y, 0.0);
         }
         else if (this.m_limitState == b2Joint.e_atUpperLimit) {
            this.m_impulse.y = b2Math.Min(this.m_impulse.y, 0.0);
         }
         var b = (-Cdot1) - (this.m_impulse.y - f1.y) * this.m_K.col2.x;
         var f2r = 0;
         if (this.m_K.col1.x != 0.0) {
            f2r = b / this.m_K.col1.x + f1.x;
         }
         else {
            f2r = f1.x;
         }
         this.m_impulse.x = f2r;
         df.x = this.m_impulse.x - f1.x;
         df.y = this.m_impulse.y - f1.y;
         PX = df.x * this.m_perp.x + df.y * this.m_axis.x;
         PY = df.x * this.m_perp.y + df.y * this.m_axis.y;
         L1 = df.x * this.m_s1 + df.y * this.m_a1;
         L2 = df.x * this.m_s2 + df.y * this.m_a2;
         v1.x -= this.m_invMassA * PX;
         v1.y -= this.m_invMassA * PY;
         w1 -= this.m_invIA * L1;
         v2.x += this.m_invMassB * PX;
         v2.y += this.m_invMassB * PY;
         w2 += this.m_invIB * L2;
      }
      else {
         var df2 = 0;
         if (this.m_K.col1.x != 0.0) {
            df2 = ((-Cdot1)) / this.m_K.col1.x;
         }
         else {
            df2 = 0.0;
         }
         this.m_impulse.x += df2;
         PX = df2 * this.m_perp.x;
         PY = df2 * this.m_perp.y;
         L1 = df2 * this.m_s1;
         L2 = df2 * this.m_s2;
         v1.x -= this.m_invMassA * PX;
         v1.y -= this.m_invMassA * PY;
         w1 -= this.m_invIA * L1;
         v2.x += this.m_invMassB * PX;
         v2.y += this.m_invMassB * PY;
         w2 += this.m_invIB * L2;
      }
      bA.m_linearVelocity.SetV(v1);
      bA.m_angularVelocity = w1;
      bB.m_linearVelocity.SetV(v2);
      bB.m_angularVelocity = w2;
   }
   b2LineJoint.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      var limitC = 0;
      var oldLimitImpulse = 0;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var c1 = bA.m_sweep.c;
      var a1 = bA.m_sweep.a;
      var c2 = bB.m_sweep.c;
      var a2 = bB.m_sweep.a;
      var tMat;
      var tX = 0;
      var m1 = 0;
      var m2 = 0;
      var i1 = 0;
      var i2 = 0;
      var linearError = 0.0;
      var angularError = 0.0;
      var active = false;
      var C2 = 0.0;
      var R1 = b2Mat22.FromAngle(a1);
      var R2 = b2Mat22.FromAngle(a2);
      tMat = R1;
      var r1X = this.m_localAnchor1.x - this.m_localCenterA.x;
      var r1Y = this.m_localAnchor1.y - this.m_localCenterA.y;
      tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = R2;
      var r2X = this.m_localAnchor2.x - this.m_localCenterB.x;
      var r2Y = this.m_localAnchor2.y - this.m_localCenterB.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var dX = c2.x + r2X - c1.x - r1X;
      var dY = c2.y + r2Y - c1.y - r1Y;
      if (this.m_enableLimit) {
         this.m_axis = b2Math.MulMV(R1, this.m_localXAxis1);
         this.m_a1 = (dX + r1X) * this.m_axis.y - (dY + r1Y) * this.m_axis.x;
         this.m_a2 = r2X * this.m_axis.y - r2Y * this.m_axis.x;
         var translation = this.m_axis.x * dX + this.m_axis.y * dY;
         if (b2Math.Abs(this.m_upperTranslation - this.m_lowerTranslation) < 2.0 * b2Settings.b2_linearSlop) {
            C2 = b2Math.Clamp(translation, (-b2Settings.b2_maxLinearCorrection), b2Settings.b2_maxLinearCorrection);
            linearError = b2Math.Abs(translation);
            active = true;
         }
         else if (translation <= this.m_lowerTranslation) {
            C2 = b2Math.Clamp(translation - this.m_lowerTranslation + b2Settings.b2_linearSlop, (-b2Settings.b2_maxLinearCorrection), 0.0);
            linearError = this.m_lowerTranslation - translation;
            active = true;
         }
         else if (translation >= this.m_upperTranslation) {
            C2 = b2Math.Clamp(translation - this.m_upperTranslation + b2Settings.b2_linearSlop, 0.0, b2Settings.b2_maxLinearCorrection);
            linearError = translation - this.m_upperTranslation;
            active = true;
         }
      }
      this.m_perp = b2Math.MulMV(R1, this.m_localYAxis1);
      this.m_s1 = (dX + r1X) * this.m_perp.y - (dY + r1Y) * this.m_perp.x;
      this.m_s2 = r2X * this.m_perp.y - r2Y * this.m_perp.x;
      var impulse = new b2Vec2();
      var C1 = this.m_perp.x * dX + this.m_perp.y * dY;
      linearError = b2Math.Max(linearError, b2Math.Abs(C1));
      angularError = 0.0;
      if (active) {
         m1 = this.m_invMassA;
         m2 = this.m_invMassB;
         i1 = this.m_invIA;
         i2 = this.m_invIB;
         this.m_K.col1.x = m1 + m2 + i1 * this.m_s1 * this.m_s1 + i2 * this.m_s2 * this.m_s2;
         this.m_K.col1.y = i1 * this.m_s1 * this.m_a1 + i2 * this.m_s2 * this.m_a2;
         this.m_K.col2.x = this.m_K.col1.y;
         this.m_K.col2.y = m1 + m2 + i1 * this.m_a1 * this.m_a1 + i2 * this.m_a2 * this.m_a2;
         this.m_K.Solve(impulse, (-C1), (-C2));
      }
      else {
         m1 = this.m_invMassA;
         m2 = this.m_invMassB;
         i1 = this.m_invIA;
         i2 = this.m_invIB;
         var k11 = m1 + m2 + i1 * this.m_s1 * this.m_s1 + i2 * this.m_s2 * this.m_s2;
         var impulse1 = 0;
         if (k11 != 0.0) {
            impulse1 = ((-C1)) / k11;
         }
         else {
            impulse1 = 0.0;
         }
         impulse.x = impulse1;
         impulse.y = 0.0;
      }
      var PX = impulse.x * this.m_perp.x + impulse.y * this.m_axis.x;
      var PY = impulse.x * this.m_perp.y + impulse.y * this.m_axis.y;
      var L1 = impulse.x * this.m_s1 + impulse.y * this.m_a1;
      var L2 = impulse.x * this.m_s2 + impulse.y * this.m_a2;
      c1.x -= this.m_invMassA * PX;
      c1.y -= this.m_invMassA * PY;
      a1 -= this.m_invIA * L1;
      c2.x += this.m_invMassB * PX;
      c2.y += this.m_invMassB * PY;
      a2 += this.m_invIB * L2;
      bA.m_sweep.a = a1;
      bB.m_sweep.a = a2;
      bA.SynchronizeTransform();
      bB.SynchronizeTransform();
      return linearError <= b2Settings.b2_linearSlop && angularError <= b2Settings.b2_angularSlop;
   }
   Box2D.inherit(b2LineJointDef, Box2D.Dynamics.Joints.b2JointDef);
   b2LineJointDef.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype;
   b2LineJointDef.b2LineJointDef = function () {
      Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments);
      this.localAnchorA = new b2Vec2();
      this.localAnchorB = new b2Vec2();
      this.localAxisA = new b2Vec2();
   };
   b2LineJointDef.prototype.b2LineJointDef = function () {
      this.__super.b2JointDef.call(this);
      this.type = b2Joint.e_lineJoint;
      this.localAxisA.Set(1.0, 0.0);
      this.enableLimit = false;
      this.lowerTranslation = 0.0;
      this.upperTranslation = 0.0;
      this.enableMotor = false;
      this.maxMotorForce = 0.0;
      this.motorSpeed = 0.0;
   }
   b2LineJointDef.prototype.Initialize = function (bA, bB, anchor, axis) {
      this.bodyA = bA;
      this.bodyB = bB;
      this.localAnchorA = this.bodyA.GetLocalPoint(anchor);
      this.localAnchorB = this.bodyB.GetLocalPoint(anchor);
      this.localAxisA = this.bodyA.GetLocalVector(axis);
   }
   Box2D.inherit(b2MouseJoint, Box2D.Dynamics.Joints.b2Joint);
   b2MouseJoint.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype;
   b2MouseJoint.b2MouseJoint = function () {
      Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments);
      this.K = new b2Mat22();
      this.K1 = new b2Mat22();
      this.K2 = new b2Mat22();
      this.m_localAnchor = new b2Vec2();
      this.m_target = new b2Vec2();
      this.m_impulse = new b2Vec2();
      this.m_mass = new b2Mat22();
      this.m_C = new b2Vec2();
   };
   b2MouseJoint.prototype.GetAnchorA = function () {
      return this.m_target;
   }
   b2MouseJoint.prototype.GetAnchorB = function () {
      return this.m_bodyB.GetWorldPoint(this.m_localAnchor);
   }
   b2MouseJoint.prototype.GetReactionForce = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return new b2Vec2(inv_dt * this.m_impulse.x, inv_dt * this.m_impulse.y);
   }
   b2MouseJoint.prototype.GetReactionTorque = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return 0.0;
   }
   b2MouseJoint.prototype.GetTarget = function () {
      return this.m_target;
   }
   b2MouseJoint.prototype.SetTarget = function (target) {
      if (this.m_bodyB.IsAwake() == false) {
         this.m_bodyB.SetAwake(true);
      }
      this.m_target = target;
   }
   b2MouseJoint.prototype.GetMaxForce = function () {
      return this.m_maxForce;
   }
   b2MouseJoint.prototype.SetMaxForce = function (maxForce) {
      if (maxForce === undefined) maxForce = 0;
      this.m_maxForce = maxForce;
   }
   b2MouseJoint.prototype.GetFrequency = function () {
      return this.m_frequencyHz;
   }
   b2MouseJoint.prototype.SetFrequency = function (hz) {
      if (hz === undefined) hz = 0;
      this.m_frequencyHz = hz;
   }
   b2MouseJoint.prototype.GetDampingRatio = function () {
      return this.m_dampingRatio;
   }
   b2MouseJoint.prototype.SetDampingRatio = function (ratio) {
      if (ratio === undefined) ratio = 0;
      this.m_dampingRatio = ratio;
   }
   b2MouseJoint.prototype.b2MouseJoint = function (def) {
      this.__super.b2Joint.call(this, def);
      this.m_target.SetV(def.target);
      var tX = this.m_target.x - this.m_bodyB.m_xf.position.x;
      var tY = this.m_target.y - this.m_bodyB.m_xf.position.y;
      var tMat = this.m_bodyB.m_xf.R;
      this.m_localAnchor.x = (tX * tMat.col1.x + tY * tMat.col1.y);
      this.m_localAnchor.y = (tX * tMat.col2.x + tY * tMat.col2.y);
      this.m_maxForce = def.maxForce;
      this.m_impulse.SetZero();
      this.m_frequencyHz = def.frequencyHz;
      this.m_dampingRatio = def.dampingRatio;
      this.m_beta = 0.0;
      this.m_gamma = 0.0;
   }
   b2MouseJoint.prototype.InitVelocityConstraints = function (step) {
      var b = this.m_bodyB;
      var mass = b.GetMass();
      var omega = 2.0 * Math.PI * this.m_frequencyHz;
      var d = 2.0 * mass * this.m_dampingRatio * omega;
      var k = mass * omega * omega;
      this.m_gamma = step.dt * (d + step.dt * k);
      this.m_gamma = this.m_gamma != 0 ? 1 / this.m_gamma : 0.0;
      this.m_beta = step.dt * k * this.m_gamma;
      var tMat;tMat = b.m_xf.R;
      var rX = this.m_localAnchor.x - b.m_sweep.localCenter.x;
      var rY = this.m_localAnchor.y - b.m_sweep.localCenter.y;
      var tX = (tMat.col1.x * rX + tMat.col2.x * rY);rY = (tMat.col1.y * rX + tMat.col2.y * rY);
      rX = tX;
      var invMass = b.m_invMass;
      var invI = b.m_invI;this.K1.col1.x = invMass;
      this.K1.col2.x = 0.0;
      this.K1.col1.y = 0.0;
      this.K1.col2.y = invMass;
      this.K2.col1.x = invI * rY * rY;
      this.K2.col2.x = (-invI * rX * rY);
      this.K2.col1.y = (-invI * rX * rY);
      this.K2.col2.y = invI * rX * rX;
      this.K.SetM(this.K1);
      this.K.AddM(this.K2);
      this.K.col1.x += this.m_gamma;
      this.K.col2.y += this.m_gamma;
      this.K.GetInverse(this.m_mass);
      this.m_C.x = b.m_sweep.c.x + rX - this.m_target.x;
      this.m_C.y = b.m_sweep.c.y + rY - this.m_target.y;
      b.m_angularVelocity *= 0.98;
      this.m_impulse.x *= step.dtRatio;
      this.m_impulse.y *= step.dtRatio;
      b.m_linearVelocity.x += invMass * this.m_impulse.x;
      b.m_linearVelocity.y += invMass * this.m_impulse.y;
      b.m_angularVelocity += invI * (rX * this.m_impulse.y - rY * this.m_impulse.x);
   }
   b2MouseJoint.prototype.SolveVelocityConstraints = function (step) {
      var b = this.m_bodyB;
      var tMat;
      var tX = 0;
      var tY = 0;
      tMat = b.m_xf.R;
      var rX = this.m_localAnchor.x - b.m_sweep.localCenter.x;
      var rY = this.m_localAnchor.y - b.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rX + tMat.col2.x * rY);
      rY = (tMat.col1.y * rX + tMat.col2.y * rY);
      rX = tX;
      var CdotX = b.m_linearVelocity.x + ((-b.m_angularVelocity * rY));
      var CdotY = b.m_linearVelocity.y + (b.m_angularVelocity * rX);
      tMat = this.m_mass;
      tX = CdotX + this.m_beta * this.m_C.x + this.m_gamma * this.m_impulse.x;
      tY = CdotY + this.m_beta * this.m_C.y + this.m_gamma * this.m_impulse.y;
      var impulseX = (-(tMat.col1.x * tX + tMat.col2.x * tY));
      var impulseY = (-(tMat.col1.y * tX + tMat.col2.y * tY));
      var oldImpulseX = this.m_impulse.x;
      var oldImpulseY = this.m_impulse.y;
      this.m_impulse.x += impulseX;
      this.m_impulse.y += impulseY;
      var maxImpulse = step.dt * this.m_maxForce;
      if (this.m_impulse.LengthSquared() > maxImpulse * maxImpulse) {
         this.m_impulse.Multiply(maxImpulse / this.m_impulse.Length());
      }
      impulseX = this.m_impulse.x - oldImpulseX;
      impulseY = this.m_impulse.y - oldImpulseY;
      b.m_linearVelocity.x += b.m_invMass * impulseX;
      b.m_linearVelocity.y += b.m_invMass * impulseY;
      b.m_angularVelocity += b.m_invI * (rX * impulseY - rY * impulseX);
   }
   b2MouseJoint.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      return true;
   }
   Box2D.inherit(b2MouseJointDef, Box2D.Dynamics.Joints.b2JointDef);
   b2MouseJointDef.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype;
   b2MouseJointDef.b2MouseJointDef = function () {
      Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments);
      this.target = new b2Vec2();
   };
   b2MouseJointDef.prototype.b2MouseJointDef = function () {
      this.__super.b2JointDef.call(this);
      this.type = b2Joint.e_mouseJoint;
      this.maxForce = 0.0;
      this.frequencyHz = 5.0;
      this.dampingRatio = 0.7;
   }
   Box2D.inherit(b2PrismaticJoint, Box2D.Dynamics.Joints.b2Joint);
   b2PrismaticJoint.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype;
   b2PrismaticJoint.b2PrismaticJoint = function () {
      Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments);
      this.m_localAnchor1 = new b2Vec2();
      this.m_localAnchor2 = new b2Vec2();
      this.m_localXAxis1 = new b2Vec2();
      this.m_localYAxis1 = new b2Vec2();
      this.m_axis = new b2Vec2();
      this.m_perp = new b2Vec2();
      this.m_K = new b2Mat33();
      this.m_impulse = new b2Vec3();
   };
   b2PrismaticJoint.prototype.GetAnchorA = function () {
      return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
   }
   b2PrismaticJoint.prototype.GetAnchorB = function () {
      return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
   }
   b2PrismaticJoint.prototype.GetReactionForce = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return new b2Vec2(inv_dt * (this.m_impulse.x * this.m_perp.x + (this.m_motorImpulse + this.m_impulse.z) * this.m_axis.x), inv_dt * (this.m_impulse.x * this.m_perp.y + (this.m_motorImpulse + this.m_impulse.z) * this.m_axis.y));
   }
   b2PrismaticJoint.prototype.GetReactionTorque = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return inv_dt * this.m_impulse.y;
   }
   b2PrismaticJoint.prototype.GetJointTranslation = function () {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      var p1 = bA.GetWorldPoint(this.m_localAnchor1);
      var p2 = bB.GetWorldPoint(this.m_localAnchor2);
      var dX = p2.x - p1.x;
      var dY = p2.y - p1.y;
      var axis = bA.GetWorldVector(this.m_localXAxis1);
      var translation = axis.x * dX + axis.y * dY;
      return translation;
   }
   b2PrismaticJoint.prototype.GetJointSpeed = function () {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      tMat = bA.m_xf.R;
      var r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
      var r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
      var tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = bB.m_xf.R;
      var r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
      var r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var p1X = bA.m_sweep.c.x + r1X;
      var p1Y = bA.m_sweep.c.y + r1Y;
      var p2X = bB.m_sweep.c.x + r2X;
      var p2Y = bB.m_sweep.c.y + r2Y;
      var dX = p2X - p1X;
      var dY = p2Y - p1Y;
      var axis = bA.GetWorldVector(this.m_localXAxis1);
      var v1 = bA.m_linearVelocity;
      var v2 = bB.m_linearVelocity;
      var w1 = bA.m_angularVelocity;
      var w2 = bB.m_angularVelocity;
      var speed = (dX * ((-w1 * axis.y)) + dY * (w1 * axis.x)) + (axis.x * (((v2.x + ((-w2 * r2Y))) - v1.x) - ((-w1 * r1Y))) + axis.y * (((v2.y + (w2 * r2X)) - v1.y) - (w1 * r1X)));
      return speed;
   }
   b2PrismaticJoint.prototype.IsLimitEnabled = function () {
      return this.m_enableLimit;
   }
   b2PrismaticJoint.prototype.EnableLimit = function (flag) {
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_enableLimit = flag;
   }
   b2PrismaticJoint.prototype.GetLowerLimit = function () {
      return this.m_lowerTranslation;
   }
   b2PrismaticJoint.prototype.GetUpperLimit = function () {
      return this.m_upperTranslation;
   }
   b2PrismaticJoint.prototype.SetLimits = function (lower, upper) {
      if (lower === undefined) lower = 0;
      if (upper === undefined) upper = 0;
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_lowerTranslation = lower;
      this.m_upperTranslation = upper;
   }
   b2PrismaticJoint.prototype.IsMotorEnabled = function () {
      return this.m_enableMotor;
   }
   b2PrismaticJoint.prototype.EnableMotor = function (flag) {
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_enableMotor = flag;
   }
   b2PrismaticJoint.prototype.SetMotorSpeed = function (speed) {
      if (speed === undefined) speed = 0;
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_motorSpeed = speed;
   }
   b2PrismaticJoint.prototype.GetMotorSpeed = function () {
      return this.m_motorSpeed;
   }
   b2PrismaticJoint.prototype.SetMaxMotorForce = function (force) {
      if (force === undefined) force = 0;
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_maxMotorForce = force;
   }
   b2PrismaticJoint.prototype.GetMotorForce = function () {
      return this.m_motorImpulse;
   }
   b2PrismaticJoint.prototype.b2PrismaticJoint = function (def) {
      this.__super.b2Joint.call(this, def);
      var tMat;
      var tX = 0;
      var tY = 0;
      this.m_localAnchor1.SetV(def.localAnchorA);
      this.m_localAnchor2.SetV(def.localAnchorB);
      this.m_localXAxis1.SetV(def.localAxisA);
      this.m_localYAxis1.x = (-this.m_localXAxis1.y);
      this.m_localYAxis1.y = this.m_localXAxis1.x;
      this.m_refAngle = def.referenceAngle;
      this.m_impulse.SetZero();
      this.m_motorMass = 0.0;
      this.m_motorImpulse = 0.0;
      this.m_lowerTranslation = def.lowerTranslation;
      this.m_upperTranslation = def.upperTranslation;
      this.m_maxMotorForce = def.maxMotorForce;
      this.m_motorSpeed = def.motorSpeed;
      this.m_enableLimit = def.enableLimit;
      this.m_enableMotor = def.enableMotor;
      this.m_limitState = b2Joint.e_inactiveLimit;
      this.m_axis.SetZero();
      this.m_perp.SetZero();
   }
   b2PrismaticJoint.prototype.InitVelocityConstraints = function (step) {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      var tX = 0;
      this.m_localCenterA.SetV(bA.GetLocalCenter());
      this.m_localCenterB.SetV(bB.GetLocalCenter());
      var xf1 = bA.GetTransform();
      var xf2 = bB.GetTransform();
      tMat = bA.m_xf.R;
      var r1X = this.m_localAnchor1.x - this.m_localCenterA.x;
      var r1Y = this.m_localAnchor1.y - this.m_localCenterA.y;
      tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = bB.m_xf.R;
      var r2X = this.m_localAnchor2.x - this.m_localCenterB.x;
      var r2Y = this.m_localAnchor2.y - this.m_localCenterB.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var dX = bB.m_sweep.c.x + r2X - bA.m_sweep.c.x - r1X;
      var dY = bB.m_sweep.c.y + r2Y - bA.m_sweep.c.y - r1Y;
      this.m_invMassA = bA.m_invMass;
      this.m_invMassB = bB.m_invMass;
      this.m_invIA = bA.m_invI;
      this.m_invIB = bB.m_invI; {
         this.m_axis.SetV(b2Math.MulMV(xf1.R, this.m_localXAxis1));
         this.m_a1 = (dX + r1X) * this.m_axis.y - (dY + r1Y) * this.m_axis.x;
         this.m_a2 = r2X * this.m_axis.y - r2Y * this.m_axis.x;
         this.m_motorMass = this.m_invMassA + this.m_invMassB + this.m_invIA * this.m_a1 * this.m_a1 + this.m_invIB * this.m_a2 * this.m_a2;
         if (this.m_motorMass > Number.MIN_VALUE) this.m_motorMass = 1.0 / this.m_motorMass;
      } {
         this.m_perp.SetV(b2Math.MulMV(xf1.R, this.m_localYAxis1));
         this.m_s1 = (dX + r1X) * this.m_perp.y - (dY + r1Y) * this.m_perp.x;
         this.m_s2 = r2X * this.m_perp.y - r2Y * this.m_perp.x;
         var m1 = this.m_invMassA;
         var m2 = this.m_invMassB;
         var i1 = this.m_invIA;
         var i2 = this.m_invIB;
         this.m_K.col1.x = m1 + m2 + i1 * this.m_s1 * this.m_s1 + i2 * this.m_s2 * this.m_s2;
         this.m_K.col1.y = i1 * this.m_s1 + i2 * this.m_s2;
         this.m_K.col1.z = i1 * this.m_s1 * this.m_a1 + i2 * this.m_s2 * this.m_a2;
         this.m_K.col2.x = this.m_K.col1.y;
         this.m_K.col2.y = i1 + i2;
         this.m_K.col2.z = i1 * this.m_a1 + i2 * this.m_a2;
         this.m_K.col3.x = this.m_K.col1.z;
         this.m_K.col3.y = this.m_K.col2.z;
         this.m_K.col3.z = m1 + m2 + i1 * this.m_a1 * this.m_a1 + i2 * this.m_a2 * this.m_a2;
      }
      if (this.m_enableLimit) {
         var jointTransition = this.m_axis.x * dX + this.m_axis.y * dY;
         if (b2Math.Abs(this.m_upperTranslation - this.m_lowerTranslation) < 2.0 * b2Settings.b2_linearSlop) {
            this.m_limitState = b2Joint.e_equalLimits;
         }
         else if (jointTransition <= this.m_lowerTranslation) {
            if (this.m_limitState != b2Joint.e_atLowerLimit) {
               this.m_limitState = b2Joint.e_atLowerLimit;
               this.m_impulse.z = 0.0;
            }
         }
         else if (jointTransition >= this.m_upperTranslation) {
            if (this.m_limitState != b2Joint.e_atUpperLimit) {
               this.m_limitState = b2Joint.e_atUpperLimit;
               this.m_impulse.z = 0.0;
            }
         }
         else {
            this.m_limitState = b2Joint.e_inactiveLimit;
            this.m_impulse.z = 0.0;
         }
      }
      else {
         this.m_limitState = b2Joint.e_inactiveLimit;
      }
      if (this.m_enableMotor == false) {
         this.m_motorImpulse = 0.0;
      }
      if (step.warmStarting) {
         this.m_impulse.x *= step.dtRatio;
         this.m_impulse.y *= step.dtRatio;
         this.m_motorImpulse *= step.dtRatio;
         var PX = this.m_impulse.x * this.m_perp.x + (this.m_motorImpulse + this.m_impulse.z) * this.m_axis.x;
         var PY = this.m_impulse.x * this.m_perp.y + (this.m_motorImpulse + this.m_impulse.z) * this.m_axis.y;
         var L1 = this.m_impulse.x * this.m_s1 + this.m_impulse.y + (this.m_motorImpulse + this.m_impulse.z) * this.m_a1;
         var L2 = this.m_impulse.x * this.m_s2 + this.m_impulse.y + (this.m_motorImpulse + this.m_impulse.z) * this.m_a2;
         bA.m_linearVelocity.x -= this.m_invMassA * PX;
         bA.m_linearVelocity.y -= this.m_invMassA * PY;
         bA.m_angularVelocity -= this.m_invIA * L1;
         bB.m_linearVelocity.x += this.m_invMassB * PX;
         bB.m_linearVelocity.y += this.m_invMassB * PY;
         bB.m_angularVelocity += this.m_invIB * L2;
      }
      else {
         this.m_impulse.SetZero();
         this.m_motorImpulse = 0.0;
      }
   }
   b2PrismaticJoint.prototype.SolveVelocityConstraints = function (step) {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var v1 = bA.m_linearVelocity;
      var w1 = bA.m_angularVelocity;
      var v2 = bB.m_linearVelocity;
      var w2 = bB.m_angularVelocity;
      var PX = 0;
      var PY = 0;
      var L1 = 0;
      var L2 = 0;
      if (this.m_enableMotor && this.m_limitState != b2Joint.e_equalLimits) {
         var Cdot = this.m_axis.x * (v2.x - v1.x) + this.m_axis.y * (v2.y - v1.y) + this.m_a2 * w2 - this.m_a1 * w1;
         var impulse = this.m_motorMass * (this.m_motorSpeed - Cdot);
         var oldImpulse = this.m_motorImpulse;
         var maxImpulse = step.dt * this.m_maxMotorForce;
         this.m_motorImpulse = b2Math.Clamp(this.m_motorImpulse + impulse, (-maxImpulse), maxImpulse);
         impulse = this.m_motorImpulse - oldImpulse;
         PX = impulse * this.m_axis.x;
         PY = impulse * this.m_axis.y;
         L1 = impulse * this.m_a1;
         L2 = impulse * this.m_a2;
         v1.x -= this.m_invMassA * PX;
         v1.y -= this.m_invMassA * PY;
         w1 -= this.m_invIA * L1;
         v2.x += this.m_invMassB * PX;
         v2.y += this.m_invMassB * PY;
         w2 += this.m_invIB * L2;
      }
      var Cdot1X = this.m_perp.x * (v2.x - v1.x) + this.m_perp.y * (v2.y - v1.y) + this.m_s2 * w2 - this.m_s1 * w1;
      var Cdot1Y = w2 - w1;
      if (this.m_enableLimit && this.m_limitState != b2Joint.e_inactiveLimit) {
         var Cdot2 = this.m_axis.x * (v2.x - v1.x) + this.m_axis.y * (v2.y - v1.y) + this.m_a2 * w2 - this.m_a1 * w1;
         var f1 = this.m_impulse.Copy();
         var df = this.m_K.Solve33(new b2Vec3(), (-Cdot1X), (-Cdot1Y), (-Cdot2));
         this.m_impulse.Add(df);
         if (this.m_limitState == b2Joint.e_atLowerLimit) {
            this.m_impulse.z = b2Math.Max(this.m_impulse.z, 0.0);
         }
         else if (this.m_limitState == b2Joint.e_atUpperLimit) {
            this.m_impulse.z = b2Math.Min(this.m_impulse.z, 0.0);
         }
         var bX = (-Cdot1X) - (this.m_impulse.z - f1.z) * this.m_K.col3.x;
         var bY = (-Cdot1Y) - (this.m_impulse.z - f1.z) * this.m_K.col3.y;
         var f2r = this.m_K.Solve22(new b2Vec2(), bX, bY);
         f2r.x += f1.x;
         f2r.y += f1.y;
         this.m_impulse.x = f2r.x;
         this.m_impulse.y = f2r.y;
         df.x = this.m_impulse.x - f1.x;
         df.y = this.m_impulse.y - f1.y;
         df.z = this.m_impulse.z - f1.z;
         PX = df.x * this.m_perp.x + df.z * this.m_axis.x;
         PY = df.x * this.m_perp.y + df.z * this.m_axis.y;
         L1 = df.x * this.m_s1 + df.y + df.z * this.m_a1;
         L2 = df.x * this.m_s2 + df.y + df.z * this.m_a2;
         v1.x -= this.m_invMassA * PX;
         v1.y -= this.m_invMassA * PY;
         w1 -= this.m_invIA * L1;
         v2.x += this.m_invMassB * PX;
         v2.y += this.m_invMassB * PY;
         w2 += this.m_invIB * L2;
      }
      else {
         var df2 = this.m_K.Solve22(new b2Vec2(), (-Cdot1X), (-Cdot1Y));
         this.m_impulse.x += df2.x;
         this.m_impulse.y += df2.y;
         PX = df2.x * this.m_perp.x;
         PY = df2.x * this.m_perp.y;
         L1 = df2.x * this.m_s1 + df2.y;
         L2 = df2.x * this.m_s2 + df2.y;
         v1.x -= this.m_invMassA * PX;
         v1.y -= this.m_invMassA * PY;
         w1 -= this.m_invIA * L1;
         v2.x += this.m_invMassB * PX;
         v2.y += this.m_invMassB * PY;
         w2 += this.m_invIB * L2;
      }
      bA.m_linearVelocity.SetV(v1);
      bA.m_angularVelocity = w1;
      bB.m_linearVelocity.SetV(v2);
      bB.m_angularVelocity = w2;
   }
   b2PrismaticJoint.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      var limitC = 0;
      var oldLimitImpulse = 0;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var c1 = bA.m_sweep.c;
      var a1 = bA.m_sweep.a;
      var c2 = bB.m_sweep.c;
      var a2 = bB.m_sweep.a;
      var tMat;
      var tX = 0;
      var m1 = 0;
      var m2 = 0;
      var i1 = 0;
      var i2 = 0;
      var linearError = 0.0;
      var angularError = 0.0;
      var active = false;
      var C2 = 0.0;
      var R1 = b2Mat22.FromAngle(a1);
      var R2 = b2Mat22.FromAngle(a2);
      tMat = R1;
      var r1X = this.m_localAnchor1.x - this.m_localCenterA.x;
      var r1Y = this.m_localAnchor1.y - this.m_localCenterA.y;
      tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = R2;
      var r2X = this.m_localAnchor2.x - this.m_localCenterB.x;
      var r2Y = this.m_localAnchor2.y - this.m_localCenterB.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var dX = c2.x + r2X - c1.x - r1X;
      var dY = c2.y + r2Y - c1.y - r1Y;
      if (this.m_enableLimit) {
         this.m_axis = b2Math.MulMV(R1, this.m_localXAxis1);
         this.m_a1 = (dX + r1X) * this.m_axis.y - (dY + r1Y) * this.m_axis.x;
         this.m_a2 = r2X * this.m_axis.y - r2Y * this.m_axis.x;
         var translation = this.m_axis.x * dX + this.m_axis.y * dY;
         if (b2Math.Abs(this.m_upperTranslation - this.m_lowerTranslation) < 2.0 * b2Settings.b2_linearSlop) {
            C2 = b2Math.Clamp(translation, (-b2Settings.b2_maxLinearCorrection), b2Settings.b2_maxLinearCorrection);
            linearError = b2Math.Abs(translation);
            active = true;
         }
         else if (translation <= this.m_lowerTranslation) {
            C2 = b2Math.Clamp(translation - this.m_lowerTranslation + b2Settings.b2_linearSlop, (-b2Settings.b2_maxLinearCorrection), 0.0);
            linearError = this.m_lowerTranslation - translation;
            active = true;
         }
         else if (translation >= this.m_upperTranslation) {
            C2 = b2Math.Clamp(translation - this.m_upperTranslation + b2Settings.b2_linearSlop, 0.0, b2Settings.b2_maxLinearCorrection);
            linearError = translation - this.m_upperTranslation;
            active = true;
         }
      }
      this.m_perp = b2Math.MulMV(R1, this.m_localYAxis1);
      this.m_s1 = (dX + r1X) * this.m_perp.y - (dY + r1Y) * this.m_perp.x;
      this.m_s2 = r2X * this.m_perp.y - r2Y * this.m_perp.x;
      var impulse = new b2Vec3();
      var C1X = this.m_perp.x * dX + this.m_perp.y * dY;
      var C1Y = a2 - a1 - this.m_refAngle;
      linearError = b2Math.Max(linearError, b2Math.Abs(C1X));
      angularError = b2Math.Abs(C1Y);
      if (active) {
         m1 = this.m_invMassA;
         m2 = this.m_invMassB;
         i1 = this.m_invIA;
         i2 = this.m_invIB;
         this.m_K.col1.x = m1 + m2 + i1 * this.m_s1 * this.m_s1 + i2 * this.m_s2 * this.m_s2;
         this.m_K.col1.y = i1 * this.m_s1 + i2 * this.m_s2;
         this.m_K.col1.z = i1 * this.m_s1 * this.m_a1 + i2 * this.m_s2 * this.m_a2;
         this.m_K.col2.x = this.m_K.col1.y;
         this.m_K.col2.y = i1 + i2;
         this.m_K.col2.z = i1 * this.m_a1 + i2 * this.m_a2;
         this.m_K.col3.x = this.m_K.col1.z;
         this.m_K.col3.y = this.m_K.col2.z;
         this.m_K.col3.z = m1 + m2 + i1 * this.m_a1 * this.m_a1 + i2 * this.m_a2 * this.m_a2;
         this.m_K.Solve33(impulse, (-C1X), (-C1Y), (-C2));
      }
      else {
         m1 = this.m_invMassA;
         m2 = this.m_invMassB;
         i1 = this.m_invIA;
         i2 = this.m_invIB;
         var k11 = m1 + m2 + i1 * this.m_s1 * this.m_s1 + i2 * this.m_s2 * this.m_s2;
         var k12 = i1 * this.m_s1 + i2 * this.m_s2;
         var k22 = i1 + i2;
         this.m_K.col1.Set(k11, k12, 0.0);
         this.m_K.col2.Set(k12, k22, 0.0);
         var impulse1 = this.m_K.Solve22(new b2Vec2(), (-C1X), (-C1Y));
         impulse.x = impulse1.x;
         impulse.y = impulse1.y;
         impulse.z = 0.0;
      }
      var PX = impulse.x * this.m_perp.x + impulse.z * this.m_axis.x;
      var PY = impulse.x * this.m_perp.y + impulse.z * this.m_axis.y;
      var L1 = impulse.x * this.m_s1 + impulse.y + impulse.z * this.m_a1;
      var L2 = impulse.x * this.m_s2 + impulse.y + impulse.z * this.m_a2;
      c1.x -= this.m_invMassA * PX;
      c1.y -= this.m_invMassA * PY;
      a1 -= this.m_invIA * L1;
      c2.x += this.m_invMassB * PX;
      c2.y += this.m_invMassB * PY;
      a2 += this.m_invIB * L2;
      bA.m_sweep.a = a1;
      bB.m_sweep.a = a2;
      bA.SynchronizeTransform();
      bB.SynchronizeTransform();
      return linearError <= b2Settings.b2_linearSlop && angularError <= b2Settings.b2_angularSlop;
   }
   Box2D.inherit(b2PrismaticJointDef, Box2D.Dynamics.Joints.b2JointDef);
   b2PrismaticJointDef.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype;
   b2PrismaticJointDef.b2PrismaticJointDef = function () {
      Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments);
      this.localAnchorA = new b2Vec2();
      this.localAnchorB = new b2Vec2();
      this.localAxisA = new b2Vec2();
   };
   b2PrismaticJointDef.prototype.b2PrismaticJointDef = function () {
      this.__super.b2JointDef.call(this);
      this.type = b2Joint.e_prismaticJoint;
      this.localAxisA.Set(1.0, 0.0);
      this.referenceAngle = 0.0;
      this.enableLimit = false;
      this.lowerTranslation = 0.0;
      this.upperTranslation = 0.0;
      this.enableMotor = false;
      this.maxMotorForce = 0.0;
      this.motorSpeed = 0.0;
   }
   b2PrismaticJointDef.prototype.Initialize = function (bA, bB, anchor, axis) {
      this.bodyA = bA;
      this.bodyB = bB;
      this.localAnchorA = this.bodyA.GetLocalPoint(anchor);
      this.localAnchorB = this.bodyB.GetLocalPoint(anchor);
      this.localAxisA = this.bodyA.GetLocalVector(axis);
      this.referenceAngle = this.bodyB.GetAngle() - this.bodyA.GetAngle();
   }
   Box2D.inherit(b2PulleyJoint, Box2D.Dynamics.Joints.b2Joint);
   b2PulleyJoint.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype;
   b2PulleyJoint.b2PulleyJoint = function () {
      Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments);
      this.m_groundAnchor1 = new b2Vec2();
      this.m_groundAnchor2 = new b2Vec2();
      this.m_localAnchor1 = new b2Vec2();
      this.m_localAnchor2 = new b2Vec2();
      this.m_u1 = new b2Vec2();
      this.m_u2 = new b2Vec2();
   };
   b2PulleyJoint.prototype.GetAnchorA = function () {
      return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
   }
   b2PulleyJoint.prototype.GetAnchorB = function () {
      return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
   }
   b2PulleyJoint.prototype.GetReactionForce = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return new b2Vec2(inv_dt * this.m_impulse * this.m_u2.x, inv_dt * this.m_impulse * this.m_u2.y);
   }
   b2PulleyJoint.prototype.GetReactionTorque = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return 0.0;
   }
   b2PulleyJoint.prototype.GetGroundAnchorA = function () {
      var a = this.m_ground.m_xf.position.Copy();
      a.Add(this.m_groundAnchor1);
      return a;
   }
   b2PulleyJoint.prototype.GetGroundAnchorB = function () {
      var a = this.m_ground.m_xf.position.Copy();
      a.Add(this.m_groundAnchor2);
      return a;
   }
   b2PulleyJoint.prototype.GetLength1 = function () {
      var p = this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
      var sX = this.m_ground.m_xf.position.x + this.m_groundAnchor1.x;
      var sY = this.m_ground.m_xf.position.y + this.m_groundAnchor1.y;
      var dX = p.x - sX;
      var dY = p.y - sY;
      return Math.sqrt(dX * dX + dY * dY);
   }
   b2PulleyJoint.prototype.GetLength2 = function () {
      var p = this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
      var sX = this.m_ground.m_xf.position.x + this.m_groundAnchor2.x;
      var sY = this.m_ground.m_xf.position.y + this.m_groundAnchor2.y;
      var dX = p.x - sX;
      var dY = p.y - sY;
      return Math.sqrt(dX * dX + dY * dY);
   }
   b2PulleyJoint.prototype.GetRatio = function () {
      return this.m_ratio;
   }
   b2PulleyJoint.prototype.b2PulleyJoint = function (def) {
      this.__super.b2Joint.call(this, def);
      var tMat;
      var tX = 0;
      var tY = 0;
      this.m_ground = this.m_bodyA.m_world.m_groundBody;
      this.m_groundAnchor1.x = def.groundAnchorA.x - this.m_ground.m_xf.position.x;
      this.m_groundAnchor1.y = def.groundAnchorA.y - this.m_ground.m_xf.position.y;
      this.m_groundAnchor2.x = def.groundAnchorB.x - this.m_ground.m_xf.position.x;
      this.m_groundAnchor2.y = def.groundAnchorB.y - this.m_ground.m_xf.position.y;
      this.m_localAnchor1.SetV(def.localAnchorA);
      this.m_localAnchor2.SetV(def.localAnchorB);
      this.m_ratio = def.ratio;
      this.m_constant = def.lengthA + this.m_ratio * def.lengthB;
      this.m_maxLength1 = b2Math.Min(def.maxLengthA, this.m_constant - this.m_ratio * b2PulleyJoint.b2_minPulleyLength);
      this.m_maxLength2 = b2Math.Min(def.maxLengthB, (this.m_constant - b2PulleyJoint.b2_minPulleyLength) / this.m_ratio);
      this.m_impulse = 0.0;
      this.m_limitImpulse1 = 0.0;
      this.m_limitImpulse2 = 0.0;
   }
   b2PulleyJoint.prototype.InitVelocityConstraints = function (step) {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      tMat = bA.m_xf.R;
      var r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
      var r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
      var tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = bB.m_xf.R;
      var r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
      var r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var p1X = bA.m_sweep.c.x + r1X;
      var p1Y = bA.m_sweep.c.y + r1Y;
      var p2X = bB.m_sweep.c.x + r2X;
      var p2Y = bB.m_sweep.c.y + r2Y;
      var s1X = this.m_ground.m_xf.position.x + this.m_groundAnchor1.x;
      var s1Y = this.m_ground.m_xf.position.y + this.m_groundAnchor1.y;
      var s2X = this.m_ground.m_xf.position.x + this.m_groundAnchor2.x;
      var s2Y = this.m_ground.m_xf.position.y + this.m_groundAnchor2.y;
      this.m_u1.Set(p1X - s1X, p1Y - s1Y);
      this.m_u2.Set(p2X - s2X, p2Y - s2Y);
      var length1 = this.m_u1.Length();
      var length2 = this.m_u2.Length();
      if (length1 > b2Settings.b2_linearSlop) {
         this.m_u1.Multiply(1.0 / length1);
      }
      else {
         this.m_u1.SetZero();
      }
      if (length2 > b2Settings.b2_linearSlop) {
         this.m_u2.Multiply(1.0 / length2);
      }
      else {
         this.m_u2.SetZero();
      }
      var C = this.m_constant - length1 - this.m_ratio * length2;
      if (C > 0.0) {
         this.m_state = b2Joint.e_inactiveLimit;
         this.m_impulse = 0.0;
      }
      else {
         this.m_state = b2Joint.e_atUpperLimit;
      }
      if (length1 < this.m_maxLength1) {
         this.m_limitState1 = b2Joint.e_inactiveLimit;
         this.m_limitImpulse1 = 0.0;
      }
      else {
         this.m_limitState1 = b2Joint.e_atUpperLimit;
      }
      if (length2 < this.m_maxLength2) {
         this.m_limitState2 = b2Joint.e_inactiveLimit;
         this.m_limitImpulse2 = 0.0;
      }
      else {
         this.m_limitState2 = b2Joint.e_atUpperLimit;
      }
      var cr1u1 = r1X * this.m_u1.y - r1Y * this.m_u1.x;
      var cr2u2 = r2X * this.m_u2.y - r2Y * this.m_u2.x;
      this.m_limitMass1 = bA.m_invMass + bA.m_invI * cr1u1 * cr1u1;
      this.m_limitMass2 = bB.m_invMass + bB.m_invI * cr2u2 * cr2u2;
      this.m_pulleyMass = this.m_limitMass1 + this.m_ratio * this.m_ratio * this.m_limitMass2;
      this.m_limitMass1 = 1.0 / this.m_limitMass1;
      this.m_limitMass2 = 1.0 / this.m_limitMass2;
      this.m_pulleyMass = 1.0 / this.m_pulleyMass;
      if (step.warmStarting) {
         this.m_impulse *= step.dtRatio;
         this.m_limitImpulse1 *= step.dtRatio;
         this.m_limitImpulse2 *= step.dtRatio;
         var P1X = ((-this.m_impulse) - this.m_limitImpulse1) * this.m_u1.x;
         var P1Y = ((-this.m_impulse) - this.m_limitImpulse1) * this.m_u1.y;
         var P2X = ((-this.m_ratio * this.m_impulse) - this.m_limitImpulse2) * this.m_u2.x;
         var P2Y = ((-this.m_ratio * this.m_impulse) - this.m_limitImpulse2) * this.m_u2.y;
         bA.m_linearVelocity.x += bA.m_invMass * P1X;
         bA.m_linearVelocity.y += bA.m_invMass * P1Y;
         bA.m_angularVelocity += bA.m_invI * (r1X * P1Y - r1Y * P1X);
         bB.m_linearVelocity.x += bB.m_invMass * P2X;
         bB.m_linearVelocity.y += bB.m_invMass * P2Y;
         bB.m_angularVelocity += bB.m_invI * (r2X * P2Y - r2Y * P2X);
      }
      else {
         this.m_impulse = 0.0;
         this.m_limitImpulse1 = 0.0;
         this.m_limitImpulse2 = 0.0;
      }
   }
   b2PulleyJoint.prototype.SolveVelocityConstraints = function (step) {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      tMat = bA.m_xf.R;
      var r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
      var r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
      var tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = bB.m_xf.R;
      var r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
      var r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var v1X = 0;
      var v1Y = 0;
      var v2X = 0;
      var v2Y = 0;
      var P1X = 0;
      var P1Y = 0;
      var P2X = 0;
      var P2Y = 0;
      var Cdot = 0;
      var impulse = 0;
      var oldImpulse = 0;
      if (this.m_state == b2Joint.e_atUpperLimit) {
         v1X = bA.m_linearVelocity.x + ((-bA.m_angularVelocity * r1Y));
         v1Y = bA.m_linearVelocity.y + (bA.m_angularVelocity * r1X);
         v2X = bB.m_linearVelocity.x + ((-bB.m_angularVelocity * r2Y));
         v2Y = bB.m_linearVelocity.y + (bB.m_angularVelocity * r2X);
         Cdot = (-(this.m_u1.x * v1X + this.m_u1.y * v1Y)) - this.m_ratio * (this.m_u2.x * v2X + this.m_u2.y * v2Y);
         impulse = this.m_pulleyMass * ((-Cdot));
         oldImpulse = this.m_impulse;
         this.m_impulse = b2Math.Max(0.0, this.m_impulse + impulse);
         impulse = this.m_impulse - oldImpulse;
         P1X = (-impulse * this.m_u1.x);
         P1Y = (-impulse * this.m_u1.y);
         P2X = (-this.m_ratio * impulse * this.m_u2.x);
         P2Y = (-this.m_ratio * impulse * this.m_u2.y);
         bA.m_linearVelocity.x += bA.m_invMass * P1X;
         bA.m_linearVelocity.y += bA.m_invMass * P1Y;
         bA.m_angularVelocity += bA.m_invI * (r1X * P1Y - r1Y * P1X);
         bB.m_linearVelocity.x += bB.m_invMass * P2X;
         bB.m_linearVelocity.y += bB.m_invMass * P2Y;
         bB.m_angularVelocity += bB.m_invI * (r2X * P2Y - r2Y * P2X);
      }
      if (this.m_limitState1 == b2Joint.e_atUpperLimit) {
         v1X = bA.m_linearVelocity.x + ((-bA.m_angularVelocity * r1Y));
         v1Y = bA.m_linearVelocity.y + (bA.m_angularVelocity * r1X);
         Cdot = (-(this.m_u1.x * v1X + this.m_u1.y * v1Y));
         impulse = (-this.m_limitMass1 * Cdot);
         oldImpulse = this.m_limitImpulse1;
         this.m_limitImpulse1 = b2Math.Max(0.0, this.m_limitImpulse1 + impulse);
         impulse = this.m_limitImpulse1 - oldImpulse;
         P1X = (-impulse * this.m_u1.x);
         P1Y = (-impulse * this.m_u1.y);
         bA.m_linearVelocity.x += bA.m_invMass * P1X;
         bA.m_linearVelocity.y += bA.m_invMass * P1Y;
         bA.m_angularVelocity += bA.m_invI * (r1X * P1Y - r1Y * P1X);
      }
      if (this.m_limitState2 == b2Joint.e_atUpperLimit) {
         v2X = bB.m_linearVelocity.x + ((-bB.m_angularVelocity * r2Y));
         v2Y = bB.m_linearVelocity.y + (bB.m_angularVelocity * r2X);
         Cdot = (-(this.m_u2.x * v2X + this.m_u2.y * v2Y));
         impulse = (-this.m_limitMass2 * Cdot);
         oldImpulse = this.m_limitImpulse2;
         this.m_limitImpulse2 = b2Math.Max(0.0, this.m_limitImpulse2 + impulse);
         impulse = this.m_limitImpulse2 - oldImpulse;
         P2X = (-impulse * this.m_u2.x);
         P2Y = (-impulse * this.m_u2.y);
         bB.m_linearVelocity.x += bB.m_invMass * P2X;
         bB.m_linearVelocity.y += bB.m_invMass * P2Y;
         bB.m_angularVelocity += bB.m_invI * (r2X * P2Y - r2Y * P2X);
      }
   }
   b2PulleyJoint.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      var s1X = this.m_ground.m_xf.position.x + this.m_groundAnchor1.x;
      var s1Y = this.m_ground.m_xf.position.y + this.m_groundAnchor1.y;
      var s2X = this.m_ground.m_xf.position.x + this.m_groundAnchor2.x;
      var s2Y = this.m_ground.m_xf.position.y + this.m_groundAnchor2.y;
      var r1X = 0;
      var r1Y = 0;
      var r2X = 0;
      var r2Y = 0;
      var p1X = 0;
      var p1Y = 0;
      var p2X = 0;
      var p2Y = 0;
      var length1 = 0;
      var length2 = 0;
      var C = 0;
      var impulse = 0;
      var oldImpulse = 0;
      var oldLimitPositionImpulse = 0;
      var tX = 0;
      var linearError = 0.0;
      if (this.m_state == b2Joint.e_atUpperLimit) {
         tMat = bA.m_xf.R;
         r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
         r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
         tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
         r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
         r1X = tX;
         tMat = bB.m_xf.R;
         r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
         r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
         tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
         r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
         r2X = tX;
         p1X = bA.m_sweep.c.x + r1X;
         p1Y = bA.m_sweep.c.y + r1Y;
         p2X = bB.m_sweep.c.x + r2X;
         p2Y = bB.m_sweep.c.y + r2Y;
         this.m_u1.Set(p1X - s1X, p1Y - s1Y);
         this.m_u2.Set(p2X - s2X, p2Y - s2Y);
         length1 = this.m_u1.Length();
         length2 = this.m_u2.Length();
         if (length1 > b2Settings.b2_linearSlop) {
            this.m_u1.Multiply(1.0 / length1);
         }
         else {
            this.m_u1.SetZero();
         }
         if (length2 > b2Settings.b2_linearSlop) {
            this.m_u2.Multiply(1.0 / length2);
         }
         else {
            this.m_u2.SetZero();
         }
         C = this.m_constant - length1 - this.m_ratio * length2;
         linearError = b2Math.Max(linearError, (-C));
         C = b2Math.Clamp(C + b2Settings.b2_linearSlop, (-b2Settings.b2_maxLinearCorrection), 0.0);
         impulse = (-this.m_pulleyMass * C);
         p1X = (-impulse * this.m_u1.x);
         p1Y = (-impulse * this.m_u1.y);
         p2X = (-this.m_ratio * impulse * this.m_u2.x);
         p2Y = (-this.m_ratio * impulse * this.m_u2.y);
         bA.m_sweep.c.x += bA.m_invMass * p1X;
         bA.m_sweep.c.y += bA.m_invMass * p1Y;
         bA.m_sweep.a += bA.m_invI * (r1X * p1Y - r1Y * p1X);
         bB.m_sweep.c.x += bB.m_invMass * p2X;
         bB.m_sweep.c.y += bB.m_invMass * p2Y;
         bB.m_sweep.a += bB.m_invI * (r2X * p2Y - r2Y * p2X);
         bA.SynchronizeTransform();
         bB.SynchronizeTransform();
      }
      if (this.m_limitState1 == b2Joint.e_atUpperLimit) {
         tMat = bA.m_xf.R;
         r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
         r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
         tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
         r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
         r1X = tX;
         p1X = bA.m_sweep.c.x + r1X;
         p1Y = bA.m_sweep.c.y + r1Y;
         this.m_u1.Set(p1X - s1X, p1Y - s1Y);
         length1 = this.m_u1.Length();
         if (length1 > b2Settings.b2_linearSlop) {
            this.m_u1.x *= 1.0 / length1;
            this.m_u1.y *= 1.0 / length1;
         }
         else {
            this.m_u1.SetZero();
         }
         C = this.m_maxLength1 - length1;
         linearError = b2Math.Max(linearError, (-C));
         C = b2Math.Clamp(C + b2Settings.b2_linearSlop, (-b2Settings.b2_maxLinearCorrection), 0.0);
         impulse = (-this.m_limitMass1 * C);
         p1X = (-impulse * this.m_u1.x);
         p1Y = (-impulse * this.m_u1.y);
         bA.m_sweep.c.x += bA.m_invMass * p1X;
         bA.m_sweep.c.y += bA.m_invMass * p1Y;
         bA.m_sweep.a += bA.m_invI * (r1X * p1Y - r1Y * p1X);
         bA.SynchronizeTransform();
      }
      if (this.m_limitState2 == b2Joint.e_atUpperLimit) {
         tMat = bB.m_xf.R;
         r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
         r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
         tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
         r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
         r2X = tX;
         p2X = bB.m_sweep.c.x + r2X;
         p2Y = bB.m_sweep.c.y + r2Y;
         this.m_u2.Set(p2X - s2X, p2Y - s2Y);
         length2 = this.m_u2.Length();
         if (length2 > b2Settings.b2_linearSlop) {
            this.m_u2.x *= 1.0 / length2;
            this.m_u2.y *= 1.0 / length2;
         }
         else {
            this.m_u2.SetZero();
         }
         C = this.m_maxLength2 - length2;
         linearError = b2Math.Max(linearError, (-C));
         C = b2Math.Clamp(C + b2Settings.b2_linearSlop, (-b2Settings.b2_maxLinearCorrection), 0.0);
         impulse = (-this.m_limitMass2 * C);
         p2X = (-impulse * this.m_u2.x);
         p2Y = (-impulse * this.m_u2.y);
         bB.m_sweep.c.x += bB.m_invMass * p2X;
         bB.m_sweep.c.y += bB.m_invMass * p2Y;
         bB.m_sweep.a += bB.m_invI * (r2X * p2Y - r2Y * p2X);
         bB.SynchronizeTransform();
      }
      return linearError < b2Settings.b2_linearSlop;
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.Joints.b2PulleyJoint.b2_minPulleyLength = 2.0;
   });
   Box2D.inherit(b2PulleyJointDef, Box2D.Dynamics.Joints.b2JointDef);
   b2PulleyJointDef.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype;
   b2PulleyJointDef.b2PulleyJointDef = function () {
      Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments);
      this.groundAnchorA = new b2Vec2();
      this.groundAnchorB = new b2Vec2();
      this.localAnchorA = new b2Vec2();
      this.localAnchorB = new b2Vec2();
   };
   b2PulleyJointDef.prototype.b2PulleyJointDef = function () {
      this.__super.b2JointDef.call(this);
      this.type = b2Joint.e_pulleyJoint;
      this.groundAnchorA.Set((-1.0), 1.0);
      this.groundAnchorB.Set(1.0, 1.0);
      this.localAnchorA.Set((-1.0), 0.0);
      this.localAnchorB.Set(1.0, 0.0);
      this.lengthA = 0.0;
      this.maxLengthA = 0.0;
      this.lengthB = 0.0;
      this.maxLengthB = 0.0;
      this.ratio = 1.0;
      this.collideConnected = true;
   }
   b2PulleyJointDef.prototype.Initialize = function (bA, bB, gaA, gaB, anchorA, anchorB, r) {
      if (r === undefined) r = 0;
      this.bodyA = bA;
      this.bodyB = bB;
      this.groundAnchorA.SetV(gaA);
      this.groundAnchorB.SetV(gaB);
      this.localAnchorA = this.bodyA.GetLocalPoint(anchorA);
      this.localAnchorB = this.bodyB.GetLocalPoint(anchorB);
      var d1X = anchorA.x - gaA.x;
      var d1Y = anchorA.y - gaA.y;
      this.lengthA = Math.sqrt(d1X * d1X + d1Y * d1Y);
      var d2X = anchorB.x - gaB.x;
      var d2Y = anchorB.y - gaB.y;
      this.lengthB = Math.sqrt(d2X * d2X + d2Y * d2Y);
      this.ratio = r;
      var C = this.lengthA + this.ratio * this.lengthB;
      this.maxLengthA = C - this.ratio * b2PulleyJoint.b2_minPulleyLength;
      this.maxLengthB = (C - b2PulleyJoint.b2_minPulleyLength) / this.ratio;
   }
   Box2D.inherit(b2RevoluteJoint, Box2D.Dynamics.Joints.b2Joint);
   b2RevoluteJoint.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype;
   b2RevoluteJoint.b2RevoluteJoint = function () {
      Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments);
      this.K = new b2Mat22();
      this.K1 = new b2Mat22();
      this.K2 = new b2Mat22();
      this.K3 = new b2Mat22();
      this.impulse3 = new b2Vec3();
      this.impulse2 = new b2Vec2();
      this.reduced = new b2Vec2();
      this.m_localAnchor1 = new b2Vec2();
      this.m_localAnchor2 = new b2Vec2();
      this.m_impulse = new b2Vec3();
      this.m_mass = new b2Mat33();
   };
   b2RevoluteJoint.prototype.GetAnchorA = function () {
      return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
   }
   b2RevoluteJoint.prototype.GetAnchorB = function () {
      return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
   }
   b2RevoluteJoint.prototype.GetReactionForce = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return new b2Vec2(inv_dt * this.m_impulse.x, inv_dt * this.m_impulse.y);
   }
   b2RevoluteJoint.prototype.GetReactionTorque = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return inv_dt * this.m_impulse.z;
   }
   b2RevoluteJoint.prototype.GetJointAngle = function () {
      return this.m_bodyB.m_sweep.a - this.m_bodyA.m_sweep.a - this.m_referenceAngle;
   }
   b2RevoluteJoint.prototype.GetJointSpeed = function () {
      return this.m_bodyB.m_angularVelocity - this.m_bodyA.m_angularVelocity;
   }
   b2RevoluteJoint.prototype.IsLimitEnabled = function () {
      return this.m_enableLimit;
   }
   b2RevoluteJoint.prototype.EnableLimit = function (flag) {
      this.m_enableLimit = flag;
   }
   b2RevoluteJoint.prototype.GetLowerLimit = function () {
      return this.m_lowerAngle;
   }
   b2RevoluteJoint.prototype.GetUpperLimit = function () {
      return this.m_upperAngle;
   }
   b2RevoluteJoint.prototype.SetLimits = function (lower, upper) {
      if (lower === undefined) lower = 0;
      if (upper === undefined) upper = 0;
      this.m_lowerAngle = lower;
      this.m_upperAngle = upper;
   }
   b2RevoluteJoint.prototype.IsMotorEnabled = function () {
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      return this.m_enableMotor;
   }
   b2RevoluteJoint.prototype.EnableMotor = function (flag) {
      this.m_enableMotor = flag;
   }
   b2RevoluteJoint.prototype.SetMotorSpeed = function (speed) {
      if (speed === undefined) speed = 0;
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_motorSpeed = speed;
   }
   b2RevoluteJoint.prototype.GetMotorSpeed = function () {
      return this.m_motorSpeed;
   }
   b2RevoluteJoint.prototype.SetMaxMotorTorque = function (torque) {
      if (torque === undefined) torque = 0;
      this.m_maxMotorTorque = torque;
   }
   b2RevoluteJoint.prototype.GetMotorTorque = function () {
      return this.m_maxMotorTorque;
   }
   b2RevoluteJoint.prototype.b2RevoluteJoint = function (def) {
      this.__super.b2Joint.call(this, def);
      this.m_localAnchor1.SetV(def.localAnchorA);
      this.m_localAnchor2.SetV(def.localAnchorB);
      this.m_referenceAngle = def.referenceAngle;
      this.m_impulse.SetZero();
      this.m_motorImpulse = 0.0;
      this.m_lowerAngle = def.lowerAngle;
      this.m_upperAngle = def.upperAngle;
      this.m_maxMotorTorque = def.maxMotorTorque;
      this.m_motorSpeed = def.motorSpeed;
      this.m_enableLimit = def.enableLimit;
      this.m_enableMotor = def.enableMotor;
      this.m_limitState = b2Joint.e_inactiveLimit;
   }
   b2RevoluteJoint.prototype.InitVelocityConstraints = function (step) {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      var tX = 0;
      if (this.m_enableMotor || this.m_enableLimit) {}
      tMat = bA.m_xf.R;
      var r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
      var r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
      tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = bB.m_xf.R;
      var r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
      var r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var m1 = bA.m_invMass;
      var m2 = bB.m_invMass;
      var i1 = bA.m_invI;
      var i2 = bB.m_invI;
      this.m_mass.col1.x = m1 + m2 + r1Y * r1Y * i1 + r2Y * r2Y * i2;
      this.m_mass.col2.x = (-r1Y * r1X * i1) - r2Y * r2X * i2;
      this.m_mass.col3.x = (-r1Y * i1) - r2Y * i2;
      this.m_mass.col1.y = this.m_mass.col2.x;
      this.m_mass.col2.y = m1 + m2 + r1X * r1X * i1 + r2X * r2X * i2;
      this.m_mass.col3.y = r1X * i1 + r2X * i2;
      this.m_mass.col1.z = this.m_mass.col3.x;
      this.m_mass.col2.z = this.m_mass.col3.y;
      this.m_mass.col3.z = i1 + i2;
      this.m_motorMass = 1.0 / (i1 + i2);
      if (this.m_enableMotor == false) {
         this.m_motorImpulse = 0.0;
      }
      if (this.m_enableLimit) {
         var jointAngle = bB.m_sweep.a - bA.m_sweep.a - this.m_referenceAngle;
         if (b2Math.Abs(this.m_upperAngle - this.m_lowerAngle) < 2.0 * b2Settings.b2_angularSlop) {
            this.m_limitState = b2Joint.e_equalLimits;
         }
         else if (jointAngle <= this.m_lowerAngle) {
            if (this.m_limitState != b2Joint.e_atLowerLimit) {
               this.m_impulse.z = 0.0;
            }
            this.m_limitState = b2Joint.e_atLowerLimit;
         }
         else if (jointAngle >= this.m_upperAngle) {
            if (this.m_limitState != b2Joint.e_atUpperLimit) {
               this.m_impulse.z = 0.0;
            }
            this.m_limitState = b2Joint.e_atUpperLimit;
         }
         else {
            this.m_limitState = b2Joint.e_inactiveLimit;
            this.m_impulse.z = 0.0;
         }
      }
      else {
         this.m_limitState = b2Joint.e_inactiveLimit;
      }
      if (step.warmStarting) {
         this.m_impulse.x *= step.dtRatio;
         this.m_impulse.y *= step.dtRatio;
         this.m_motorImpulse *= step.dtRatio;
         var PX = this.m_impulse.x;
         var PY = this.m_impulse.y;
         bA.m_linearVelocity.x -= m1 * PX;
         bA.m_linearVelocity.y -= m1 * PY;
         bA.m_angularVelocity -= i1 * ((r1X * PY - r1Y * PX) + this.m_motorImpulse + this.m_impulse.z);
         bB.m_linearVelocity.x += m2 * PX;
         bB.m_linearVelocity.y += m2 * PY;
         bB.m_angularVelocity += i2 * ((r2X * PY - r2Y * PX) + this.m_motorImpulse + this.m_impulse.z);
      }
      else {
         this.m_impulse.SetZero();
         this.m_motorImpulse = 0.0;
      }
   }
   b2RevoluteJoint.prototype.SolveVelocityConstraints = function (step) {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      var tX = 0;
      var newImpulse = 0;
      var r1X = 0;
      var r1Y = 0;
      var r2X = 0;
      var r2Y = 0;
      var v1 = bA.m_linearVelocity;
      var w1 = bA.m_angularVelocity;
      var v2 = bB.m_linearVelocity;
      var w2 = bB.m_angularVelocity;
      var m1 = bA.m_invMass;
      var m2 = bB.m_invMass;
      var i1 = bA.m_invI;
      var i2 = bB.m_invI;
      if (this.m_enableMotor && this.m_limitState != b2Joint.e_equalLimits) {
         var Cdot = w2 - w1 - this.m_motorSpeed;
         var impulse = this.m_motorMass * ((-Cdot));
         var oldImpulse = this.m_motorImpulse;
         var maxImpulse = step.dt * this.m_maxMotorTorque;
         this.m_motorImpulse = b2Math.Clamp(this.m_motorImpulse + impulse, (-maxImpulse), maxImpulse);
         impulse = this.m_motorImpulse - oldImpulse;
         w1 -= i1 * impulse;
         w2 += i2 * impulse;
      }
      if (this.m_enableLimit && this.m_limitState != b2Joint.e_inactiveLimit) {
         tMat = bA.m_xf.R;
         r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
         r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
         tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
         r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
         r1X = tX;
         tMat = bB.m_xf.R;
         r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
         r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
         tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
         r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
         r2X = tX;
         var Cdot1X = v2.x + ((-w2 * r2Y)) - v1.x - ((-w1 * r1Y));
         var Cdot1Y = v2.y + (w2 * r2X) - v1.y - (w1 * r1X);
         var Cdot2 = w2 - w1;
         this.m_mass.Solve33(this.impulse3, (-Cdot1X), (-Cdot1Y), (-Cdot2));
         if (this.m_limitState == b2Joint.e_equalLimits) {
            this.m_impulse.Add(this.impulse3);
         }
         else if (this.m_limitState == b2Joint.e_atLowerLimit) {
            newImpulse = this.m_impulse.z + this.impulse3.z;
            if (newImpulse < 0.0) {
               this.m_mass.Solve22(this.reduced, (-Cdot1X), (-Cdot1Y));
               this.impulse3.x = this.reduced.x;
               this.impulse3.y = this.reduced.y;
               this.impulse3.z = (-this.m_impulse.z);
               this.m_impulse.x += this.reduced.x;
               this.m_impulse.y += this.reduced.y;
               this.m_impulse.z = 0.0;
            }
         }
         else if (this.m_limitState == b2Joint.e_atUpperLimit) {
            newImpulse = this.m_impulse.z + this.impulse3.z;
            if (newImpulse > 0.0) {
               this.m_mass.Solve22(this.reduced, (-Cdot1X), (-Cdot1Y));
               this.impulse3.x = this.reduced.x;
               this.impulse3.y = this.reduced.y;
               this.impulse3.z = (-this.m_impulse.z);
               this.m_impulse.x += this.reduced.x;
               this.m_impulse.y += this.reduced.y;
               this.m_impulse.z = 0.0;
            }
         }
         v1.x -= m1 * this.impulse3.x;
         v1.y -= m1 * this.impulse3.y;
         w1 -= i1 * (r1X * this.impulse3.y - r1Y * this.impulse3.x + this.impulse3.z);
         v2.x += m2 * this.impulse3.x;
         v2.y += m2 * this.impulse3.y;
         w2 += i2 * (r2X * this.impulse3.y - r2Y * this.impulse3.x + this.impulse3.z);
      }
      else {
         tMat = bA.m_xf.R;
         r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
         r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
         tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
         r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
         r1X = tX;
         tMat = bB.m_xf.R;
         r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
         r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
         tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
         r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
         r2X = tX;
         var CdotX = v2.x + ((-w2 * r2Y)) - v1.x - ((-w1 * r1Y));
         var CdotY = v2.y + (w2 * r2X) - v1.y - (w1 * r1X);
         this.m_mass.Solve22(this.impulse2, (-CdotX), (-CdotY));
         this.m_impulse.x += this.impulse2.x;
         this.m_impulse.y += this.impulse2.y;
         v1.x -= m1 * this.impulse2.x;
         v1.y -= m1 * this.impulse2.y;
         w1 -= i1 * (r1X * this.impulse2.y - r1Y * this.impulse2.x);
         v2.x += m2 * this.impulse2.x;
         v2.y += m2 * this.impulse2.y;
         w2 += i2 * (r2X * this.impulse2.y - r2Y * this.impulse2.x);
      }
      bA.m_linearVelocity.SetV(v1);
      bA.m_angularVelocity = w1;
      bB.m_linearVelocity.SetV(v2);
      bB.m_angularVelocity = w2;
   }
   b2RevoluteJoint.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      var oldLimitImpulse = 0;
      var C = 0;
      var tMat;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var angularError = 0.0;
      var positionError = 0.0;
      var tX = 0;
      var impulseX = 0;
      var impulseY = 0;
      if (this.m_enableLimit && this.m_limitState != b2Joint.e_inactiveLimit) {
         var angle = bB.m_sweep.a - bA.m_sweep.a - this.m_referenceAngle;
         var limitImpulse = 0.0;
         if (this.m_limitState == b2Joint.e_equalLimits) {
            C = b2Math.Clamp(angle - this.m_lowerAngle, (-b2Settings.b2_maxAngularCorrection), b2Settings.b2_maxAngularCorrection);
            limitImpulse = (-this.m_motorMass * C);
            angularError = b2Math.Abs(C);
         }
         else if (this.m_limitState == b2Joint.e_atLowerLimit) {
            C = angle - this.m_lowerAngle;
            angularError = (-C);
            C = b2Math.Clamp(C + b2Settings.b2_angularSlop, (-b2Settings.b2_maxAngularCorrection), 0.0);
            limitImpulse = (-this.m_motorMass * C);
         }
         else if (this.m_limitState == b2Joint.e_atUpperLimit) {
            C = angle - this.m_upperAngle;
            angularError = C;
            C = b2Math.Clamp(C - b2Settings.b2_angularSlop, 0.0, b2Settings.b2_maxAngularCorrection);
            limitImpulse = (-this.m_motorMass * C);
         }
         bA.m_sweep.a -= bA.m_invI * limitImpulse;
         bB.m_sweep.a += bB.m_invI * limitImpulse;
         bA.SynchronizeTransform();
         bB.SynchronizeTransform();
      } {
         tMat = bA.m_xf.R;
         var r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
         var r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
         tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
         r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
         r1X = tX;
         tMat = bB.m_xf.R;
         var r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
         var r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
         tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
         r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
         r2X = tX;
         var CX = bB.m_sweep.c.x + r2X - bA.m_sweep.c.x - r1X;
         var CY = bB.m_sweep.c.y + r2Y - bA.m_sweep.c.y - r1Y;
         var CLengthSquared = CX * CX + CY * CY;
         var CLength = Math.sqrt(CLengthSquared);
         positionError = CLength;
         var invMass1 = bA.m_invMass;
         var invMass2 = bB.m_invMass;
         var invI1 = bA.m_invI;
         var invI2 = bB.m_invI;
         var k_allowedStretch = 10.0 * b2Settings.b2_linearSlop;
         if (CLengthSquared > k_allowedStretch * k_allowedStretch) {
            var uX = CX / CLength;
            var uY = CY / CLength;
            var k = invMass1 + invMass2;
            var m = 1.0 / k;
            impulseX = m * ((-CX));
            impulseY = m * ((-CY));
            var k_beta = 0.5;
            bA.m_sweep.c.x -= k_beta * invMass1 * impulseX;
            bA.m_sweep.c.y -= k_beta * invMass1 * impulseY;
            bB.m_sweep.c.x += k_beta * invMass2 * impulseX;
            bB.m_sweep.c.y += k_beta * invMass2 * impulseY;
            CX = bB.m_sweep.c.x + r2X - bA.m_sweep.c.x - r1X;
            CY = bB.m_sweep.c.y + r2Y - bA.m_sweep.c.y - r1Y;
         }
         this.K1.col1.x = invMass1 + invMass2;
         this.K1.col2.x = 0.0;
         this.K1.col1.y = 0.0;
         this.K1.col2.y = invMass1 + invMass2;
         this.K2.col1.x = invI1 * r1Y * r1Y;
         this.K2.col2.x = (-invI1 * r1X * r1Y);
         this.K2.col1.y = (-invI1 * r1X * r1Y);
         this.K2.col2.y = invI1 * r1X * r1X;
         this.K3.col1.x = invI2 * r2Y * r2Y;
         this.K3.col2.x = (-invI2 * r2X * r2Y);
         this.K3.col1.y = (-invI2 * r2X * r2Y);
         this.K3.col2.y = invI2 * r2X * r2X;
         this.K.SetM(this.K1);
         this.K.AddM(this.K2);
         this.K.AddM(this.K3);
         this.K.Solve(b2RevoluteJoint.tImpulse, (-CX), (-CY));
         impulseX = b2RevoluteJoint.tImpulse.x;
         impulseY = b2RevoluteJoint.tImpulse.y;
         bA.m_sweep.c.x -= bA.m_invMass * impulseX;
         bA.m_sweep.c.y -= bA.m_invMass * impulseY;
         bA.m_sweep.a -= bA.m_invI * (r1X * impulseY - r1Y * impulseX);
         bB.m_sweep.c.x += bB.m_invMass * impulseX;
         bB.m_sweep.c.y += bB.m_invMass * impulseY;
         bB.m_sweep.a += bB.m_invI * (r2X * impulseY - r2Y * impulseX);
         bA.SynchronizeTransform();
         bB.SynchronizeTransform();
      }
      return positionError <= b2Settings.b2_linearSlop && angularError <= b2Settings.b2_angularSlop;
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.Joints.b2RevoluteJoint.tImpulse = new b2Vec2();
   });
   Box2D.inherit(b2RevoluteJointDef, Box2D.Dynamics.Joints.b2JointDef);
   b2RevoluteJointDef.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype;
   b2RevoluteJointDef.b2RevoluteJointDef = function () {
      Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments);
      this.localAnchorA = new b2Vec2();
      this.localAnchorB = new b2Vec2();
   };
   b2RevoluteJointDef.prototype.b2RevoluteJointDef = function () {
      this.__super.b2JointDef.call(this);
      this.type = b2Joint.e_revoluteJoint;
      this.localAnchorA.Set(0.0, 0.0);
      this.localAnchorB.Set(0.0, 0.0);
      this.referenceAngle = 0.0;
      this.lowerAngle = 0.0;
      this.upperAngle = 0.0;
      this.maxMotorTorque = 0.0;
      this.motorSpeed = 0.0;
      this.enableLimit = false;
      this.enableMotor = false;
   }
   b2RevoluteJointDef.prototype.Initialize = function (bA, bB, anchor) {
      this.bodyA = bA;
      this.bodyB = bB;
      this.localAnchorA = this.bodyA.GetLocalPoint(anchor);
      this.localAnchorB = this.bodyB.GetLocalPoint(anchor);
      this.referenceAngle = this.bodyB.GetAngle() - this.bodyA.GetAngle();
   }
   Box2D.inherit(b2WeldJoint, Box2D.Dynamics.Joints.b2Joint);
   b2WeldJoint.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype;
   b2WeldJoint.b2WeldJoint = function () {
      Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments);
      this.m_localAnchorA = new b2Vec2();
      this.m_localAnchorB = new b2Vec2();
      this.m_impulse = new b2Vec3();
      this.m_mass = new b2Mat33();
   };
   b2WeldJoint.prototype.GetAnchorA = function () {
      return this.m_bodyA.GetWorldPoint(this.m_localAnchorA);
   }
   b2WeldJoint.prototype.GetAnchorB = function () {
      return this.m_bodyB.GetWorldPoint(this.m_localAnchorB);
   }
   b2WeldJoint.prototype.GetReactionForce = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return new b2Vec2(inv_dt * this.m_impulse.x, inv_dt * this.m_impulse.y);
   }
   b2WeldJoint.prototype.GetReactionTorque = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return inv_dt * this.m_impulse.z;
   }
   b2WeldJoint.prototype.b2WeldJoint = function (def) {
      this.__super.b2Joint.call(this, def);
      this.m_localAnchorA.SetV(def.localAnchorA);
      this.m_localAnchorB.SetV(def.localAnchorB);
      this.m_referenceAngle = def.referenceAngle;
      this.m_impulse.SetZero();
      this.m_mass = new b2Mat33();
   }
   b2WeldJoint.prototype.InitVelocityConstraints = function (step) {
      var tMat;
      var tX = 0;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      tMat = bA.m_xf.R;
      var rAX = this.m_localAnchorA.x - bA.m_sweep.localCenter.x;
      var rAY = this.m_localAnchorA.y - bA.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rAX + tMat.col2.x * rAY);
      rAY = (tMat.col1.y * rAX + tMat.col2.y * rAY);
      rAX = tX;
      tMat = bB.m_xf.R;
      var rBX = this.m_localAnchorB.x - bB.m_sweep.localCenter.x;
      var rBY = this.m_localAnchorB.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rBX + tMat.col2.x * rBY);
      rBY = (tMat.col1.y * rBX + tMat.col2.y * rBY);
      rBX = tX;
      var mA = bA.m_invMass;
      var mB = bB.m_invMass;
      var iA = bA.m_invI;
      var iB = bB.m_invI;
      this.m_mass.col1.x = mA + mB + rAY * rAY * iA + rBY * rBY * iB;
      this.m_mass.col2.x = (-rAY * rAX * iA) - rBY * rBX * iB;
      this.m_mass.col3.x = (-rAY * iA) - rBY * iB;
      this.m_mass.col1.y = this.m_mass.col2.x;
      this.m_mass.col2.y = mA + mB + rAX * rAX * iA + rBX * rBX * iB;
      this.m_mass.col3.y = rAX * iA + rBX * iB;
      this.m_mass.col1.z = this.m_mass.col3.x;
      this.m_mass.col2.z = this.m_mass.col3.y;
      this.m_mass.col3.z = iA + iB;
      if (step.warmStarting) {
         this.m_impulse.x *= step.dtRatio;
         this.m_impulse.y *= step.dtRatio;
         this.m_impulse.z *= step.dtRatio;
         bA.m_linearVelocity.x -= mA * this.m_impulse.x;
         bA.m_linearVelocity.y -= mA * this.m_impulse.y;
         bA.m_angularVelocity -= iA * (rAX * this.m_impulse.y - rAY * this.m_impulse.x + this.m_impulse.z);
         bB.m_linearVelocity.x += mB * this.m_impulse.x;
         bB.m_linearVelocity.y += mB * this.m_impulse.y;
         bB.m_angularVelocity += iB * (rBX * this.m_impulse.y - rBY * this.m_impulse.x + this.m_impulse.z);
      }
      else {
         this.m_impulse.SetZero();
      }
   }
   b2WeldJoint.prototype.SolveVelocityConstraints = function (step) {
      var tMat;
      var tX = 0;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var vA = bA.m_linearVelocity;
      var wA = bA.m_angularVelocity;
      var vB = bB.m_linearVelocity;
      var wB = bB.m_angularVelocity;
      var mA = bA.m_invMass;
      var mB = bB.m_invMass;
      var iA = bA.m_invI;
      var iB = bB.m_invI;
      tMat = bA.m_xf.R;
      var rAX = this.m_localAnchorA.x - bA.m_sweep.localCenter.x;
      var rAY = this.m_localAnchorA.y - bA.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rAX + tMat.col2.x * rAY);
      rAY = (tMat.col1.y * rAX + tMat.col2.y * rAY);
      rAX = tX;
      tMat = bB.m_xf.R;
      var rBX = this.m_localAnchorB.x - bB.m_sweep.localCenter.x;
      var rBY = this.m_localAnchorB.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rBX + tMat.col2.x * rBY);
      rBY = (tMat.col1.y * rBX + tMat.col2.y * rBY);
      rBX = tX;
      var Cdot1X = vB.x - wB * rBY - vA.x + wA * rAY;
      var Cdot1Y = vB.y + wB * rBX - vA.y - wA * rAX;
      var Cdot2 = wB - wA;
      var impulse = new b2Vec3();
      this.m_mass.Solve33(impulse, (-Cdot1X), (-Cdot1Y), (-Cdot2));
      this.m_impulse.Add(impulse);
      vA.x -= mA * impulse.x;
      vA.y -= mA * impulse.y;
      wA -= iA * (rAX * impulse.y - rAY * impulse.x + impulse.z);
      vB.x += mB * impulse.x;
      vB.y += mB * impulse.y;
      wB += iB * (rBX * impulse.y - rBY * impulse.x + impulse.z);
      bA.m_angularVelocity = wA;
      bB.m_angularVelocity = wB;
   }
   b2WeldJoint.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      var tMat;
      var tX = 0;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      tMat = bA.m_xf.R;
      var rAX = this.m_localAnchorA.x - bA.m_sweep.localCenter.x;
      var rAY = this.m_localAnchorA.y - bA.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rAX + tMat.col2.x * rAY);
      rAY = (tMat.col1.y * rAX + tMat.col2.y * rAY);
      rAX = tX;
      tMat = bB.m_xf.R;
      var rBX = this.m_localAnchorB.x - bB.m_sweep.localCenter.x;
      var rBY = this.m_localAnchorB.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rBX + tMat.col2.x * rBY);
      rBY = (tMat.col1.y * rBX + tMat.col2.y * rBY);
      rBX = tX;
      var mA = bA.m_invMass;
      var mB = bB.m_invMass;
      var iA = bA.m_invI;
      var iB = bB.m_invI;
      var C1X = bB.m_sweep.c.x + rBX - bA.m_sweep.c.x - rAX;
      var C1Y = bB.m_sweep.c.y + rBY - bA.m_sweep.c.y - rAY;
      var C2 = bB.m_sweep.a - bA.m_sweep.a - this.m_referenceAngle;
      var k_allowedStretch = 10.0 * b2Settings.b2_linearSlop;
      var positionError = Math.sqrt(C1X * C1X + C1Y * C1Y);
      var angularError = b2Math.Abs(C2);
      if (positionError > k_allowedStretch) {
         iA *= 1.0;
         iB *= 1.0;
      }
      this.m_mass.col1.x = mA + mB + rAY * rAY * iA + rBY * rBY * iB;
      this.m_mass.col2.x = (-rAY * rAX * iA) - rBY * rBX * iB;
      this.m_mass.col3.x = (-rAY * iA) - rBY * iB;
      this.m_mass.col1.y = this.m_mass.col2.x;
      this.m_mass.col2.y = mA + mB + rAX * rAX * iA + rBX * rBX * iB;
      this.m_mass.col3.y = rAX * iA + rBX * iB;
      this.m_mass.col1.z = this.m_mass.col3.x;
      this.m_mass.col2.z = this.m_mass.col3.y;
      this.m_mass.col3.z = iA + iB;
      var impulse = new b2Vec3();
      this.m_mass.Solve33(impulse, (-C1X), (-C1Y), (-C2));
      bA.m_sweep.c.x -= mA * impulse.x;
      bA.m_sweep.c.y -= mA * impulse.y;
      bA.m_sweep.a -= iA * (rAX * impulse.y - rAY * impulse.x + impulse.z);
      bB.m_sweep.c.x += mB * impulse.x;
      bB.m_sweep.c.y += mB * impulse.y;
      bB.m_sweep.a += iB * (rBX * impulse.y - rBY * impulse.x + impulse.z);
      bA.SynchronizeTransform();
      bB.SynchronizeTransform();
      return positionError <= b2Settings.b2_linearSlop && angularError <= b2Settings.b2_angularSlop;
   }
   Box2D.inherit(b2WeldJointDef, Box2D.Dynamics.Joints.b2JointDef);
   b2WeldJointDef.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype;
   b2WeldJointDef.b2WeldJointDef = function () {
      Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments);
      this.localAnchorA = new b2Vec2();
      this.localAnchorB = new b2Vec2();
   };
   b2WeldJointDef.prototype.b2WeldJointDef = function () {
      this.__super.b2JointDef.call(this);
      this.type = b2Joint.e_weldJoint;
      this.referenceAngle = 0.0;
   }
   b2WeldJointDef.prototype.Initialize = function (bA, bB, anchor) {
      this.bodyA = bA;
      this.bodyB = bB;
      this.localAnchorA.SetV(this.bodyA.GetLocalPoint(anchor));
      this.localAnchorB.SetV(this.bodyB.GetLocalPoint(anchor));
      this.referenceAngle = this.bodyB.GetAngle() - this.bodyA.GetAngle();
   }
})();
(function () {
   var b2DebugDraw = Box2D.Dynamics.b2DebugDraw;
   b2DebugDraw.b2DebugDraw = function () {
      this.m_drawScale = 1.0;
      this.m_lineThickness = 1.0;
      this.m_alpha = 1.0;
      this.m_fillAlpha = 1.0;
      this.m_xformScale = 1.0;
      var __this = this;
      //#WORKAROUND
      this.m_sprite = {
         graphics: {
            clear: function () {
               __this.m_ctx.clearRect(0, 0, __this.m_ctx.canvas.width, __this.m_ctx.canvas.height)
            }
         }
      };
   };
   b2DebugDraw.prototype._color = function (color, alpha) {
      return "rgba(" + ((color & 0xFF0000) >> 16) + "," + ((color & 0xFF00) >> 8) + "," + (color & 0xFF) + "," + alpha + ")";
   };
   b2DebugDraw.prototype.b2DebugDraw = function () {
      this.m_drawFlags = 0;
   };
   b2DebugDraw.prototype.SetFlags = function (flags) {
      if (flags === undefined) flags = 0;
      this.m_drawFlags = flags;
   };
   b2DebugDraw.prototype.GetFlags = function () {
      return this.m_drawFlags;
   };
   b2DebugDraw.prototype.AppendFlags = function (flags) {
      if (flags === undefined) flags = 0;
      this.m_drawFlags |= flags;
   };
   b2DebugDraw.prototype.ClearFlags = function (flags) {
      if (flags === undefined) flags = 0;
      this.m_drawFlags &= ~flags;
   };
   b2DebugDraw.prototype.SetSprite = function (sprite) {
      this.m_ctx = sprite;
   };
   b2DebugDraw.prototype.GetSprite = function () {
      return this.m_ctx;
   };
   b2DebugDraw.prototype.SetDrawScale = function (drawScale) {
      if (drawScale === undefined) drawScale = 0;
      this.m_drawScale = drawScale;
   };
   b2DebugDraw.prototype.GetDrawScale = function () {
      return this.m_drawScale;
   };
   b2DebugDraw.prototype.SetLineThickness = function (lineThickness) {
      if (lineThickness === undefined) lineThickness = 0;
      this.m_lineThickness = lineThickness;
      this.m_ctx.strokeWidth = lineThickness;
   };
   b2DebugDraw.prototype.GetLineThickness = function () {
      return this.m_lineThickness;
   };
   b2DebugDraw.prototype.SetAlpha = function (alpha) {
      if (alpha === undefined) alpha = 0;
      this.m_alpha = alpha;
   };
   b2DebugDraw.prototype.GetAlpha = function () {
      return this.m_alpha;
   };
   b2DebugDraw.prototype.SetFillAlpha = function (alpha) {
      if (alpha === undefined) alpha = 0;
      this.m_fillAlpha = alpha;
   };
   b2DebugDraw.prototype.GetFillAlpha = function () {
      return this.m_fillAlpha;
   };
   b2DebugDraw.prototype.SetXFormScale = function (xformScale) {
      if (xformScale === undefined) xformScale = 0;
      this.m_xformScale = xformScale;
   };
   b2DebugDraw.prototype.GetXFormScale = function () {
      return this.m_xformScale;
   };
   b2DebugDraw.prototype.DrawPolygon = function (vertices, vertexCount, color) {
      if (!vertexCount) return;
      var s = this.m_ctx;
      var drawScale = this.m_drawScale;
      s.beginPath();
      s.strokeStyle = this._color(color.color, this.m_alpha);
      s.moveTo(vertices[0].x * drawScale, vertices[0].y * drawScale);
      for (var i = 1; i < vertexCount; i++) {
         s.lineTo(vertices[i].x * drawScale, vertices[i].y * drawScale);
      }
      s.lineTo(vertices[0].x * drawScale, vertices[0].y * drawScale);
      s.closePath();
      s.stroke();
   };
   b2DebugDraw.prototype.DrawSolidPolygon = function (vertices, vertexCount, color) {
      if (!vertexCount) return;
      var s = this.m_ctx;
      var drawScale = this.m_drawScale;
      s.beginPath();
      s.strokeStyle = this._color(color.color, this.m_alpha);
      s.fillStyle = this._color(color.color, this.m_fillAlpha);
      s.moveTo(vertices[0].x * drawScale, vertices[0].y * drawScale);
      for (var i = 1; i < vertexCount; i++) {
         s.lineTo(vertices[i].x * drawScale, vertices[i].y * drawScale);
      }
      s.lineTo(vertices[0].x * drawScale, vertices[0].y * drawScale);
      s.closePath();
      s.fill();
      s.stroke();
   };
   b2DebugDraw.prototype.DrawCircle = function (center, radius, color) {
      if (!radius) return;
      var s = this.m_ctx;
      var drawScale = this.m_drawScale;
      s.beginPath();
      s.strokeStyle = this._color(color.color, this.m_alpha);
      s.arc(center.x * drawScale, center.y * drawScale, radius * drawScale, 0, Math.PI * 2, true);
      s.closePath();
      s.stroke();
   };
   b2DebugDraw.prototype.DrawSolidCircle = function (center, radius, axis, color) {
      if (!radius) return;
      var s = this.m_ctx,
         drawScale = this.m_drawScale,
         cx = center.x * drawScale,
         cy = center.y * drawScale;
      s.moveTo(0, 0);
      s.beginPath();
      s.strokeStyle = this._color(color.color, this.m_alpha);
      s.fillStyle = this._color(color.color, this.m_fillAlpha);
      s.arc(cx, cy, radius * drawScale, 0, Math.PI * 2, true);
      s.moveTo(cx, cy);
      s.lineTo((center.x + axis.x * radius) * drawScale, (center.y + axis.y * radius) * drawScale);
      s.closePath();
      s.fill();
      s.stroke();
   };
   b2DebugDraw.prototype.DrawSegment = function (p1, p2, color) {
      var s = this.m_ctx,
         drawScale = this.m_drawScale;
      s.strokeStyle = this._color(color.color, this.m_alpha);
      s.beginPath();
      s.moveTo(p1.x * drawScale, p1.y * drawScale);
      s.lineTo(p2.x * drawScale, p2.y * drawScale);
      s.closePath();
      s.stroke();
   };
   b2DebugDraw.prototype.DrawTransform = function (xf) {
      var s = this.m_ctx,
         drawScale = this.m_drawScale;
      s.beginPath();
      s.strokeStyle = this._color(0xff0000, this.m_alpha);
      s.moveTo(xf.position.x * drawScale, xf.position.y * drawScale);
      s.lineTo((xf.position.x + this.m_xformScale * xf.R.col1.x) * drawScale, (xf.position.y + this.m_xformScale * xf.R.col1.y) * drawScale);

      s.strokeStyle = this._color(0xff00, this.m_alpha);
      s.moveTo(xf.position.x * drawScale, xf.position.y * drawScale);
      s.lineTo((xf.position.x + this.m_xformScale * xf.R.col2.x) * drawScale, (xf.position.y + this.m_xformScale * xf.R.col2.y) * drawScale);
      s.closePath();
      s.stroke();
   };
})();
var i;
for (i = 0; i < Box2D.postDefs.length; ++i) Box2D.postDefs[i]();

module.exports = Box2D
},{}]},{},[29])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3Vzci9saWIvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsIkIyZC5qcyIsIkNvbmZpZy5qcyIsIkNvbnRyb2xsZXJzL0FudENvbnRyb2xsZXIuanMiLCJDb250cm9sbGVycy9Bc3NldENvbnRyb2xsZXIuanMiLCJDb250cm9sbGVycy9FbmVteUNvbnRyb2xsZXIuanMiLCJDb250cm9sbGVycy9HYW1lQ29udHJvbGxlci5qcyIsIkNvbnRyb2xsZXJzL0dyYXBoaWNzQ29udHJvbGxlci5qcyIsIkNvbnRyb2xsZXJzL0luaXRDb250cm9sbGVyLmpzIiwiQ29udHJvbGxlcnMvS2V5Ym9hcmRDb250cm9sbGVyLmpzIiwiQ29udHJvbGxlcnMvUGh5c2ljc0NvbnRyb2xsZXIuanMiLCJDb250cm9sbGVycy9QbGF5ZXJDb250cm9sbGVyLmpzIiwiQ29udHJvbGxlcnMvVGVycmFpbkNvbnRyb2xsZXIuanMiLCJDb250cm9sbGVycy9UZXJyYWluU2xpY2VDb250cm9sbGVyLmpzIiwiQ29udHJvbGxlcnMvVGVzdENvbnRyb2xsZXIuanMiLCJDb250cm9sbGVycy9Xb3JsZENvbnRyb2xsZXIuanMiLCJHYW1lVXRpbGl0eS5qcyIsIkluY2x1ZGVzLmpzIiwiTW9kZWxzL0FudE1vZGVsLmpzIiwiTW9kZWxzL0Fzc2V0TW9kZWwuanMiLCJNb2RlbHMvR2FtZU1vZGVsLmpzIiwiTW9kZWxzL0dyYXBoaWNzTW9kZWwuanMiLCJNb2RlbHMvS2V5Ym9hcmRNb2RlbC5qcyIsIk1vZGVscy9QaHlzaWNzTW9kZWwuanMiLCJNb2RlbHMvUGxheWVyTW9kZWwuanMiLCJNb2RlbHMvVGVycmFpbk1vZGVsLmpzIiwiTW9kZWxzL1RlcnJhaW5TbGljZU1vZGVsLmpzIiwiTW9kZWxzL1Rlc3RNb2RlbC5qcyIsIk1vZGVscy9Xb3JsZE1vZGVsLmpzIiwibWFpbi5qcyIsIm5vZGVfbW9kdWxlcy9ib3gyZHdlYi9ib3gyZC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xVQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaEZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN2hCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbklBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaEdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4Q0E7O0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdklBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDUEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ05BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ05BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLy8gVGhpcyBmaWxlIGNvbnRhaW5zIHNob3J0Y3V0cyBmb3IgdGhlIG1ldGhvZHMgb2YgdGhlIEJveDJEIGxpYnJhcnkgdGhhdCBhcmUgdXNlZFxuLy8gdG9vIG9mdGVuIHRvIHR5cGUgdGhlaXIgbG9uZyBuYW1lc1xuXG52YXIgQjJkID0gZnVuY3Rpb24oKXtcblxufTtcblxuQjJkLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKXtcblx0aW5jbHVkZSgpO1xuXG5cdHRoaXMuYjJWZWMyID0gQm94MkQuQ29tbW9uLk1hdGguYjJWZWMyO1xuXHR0aGlzLmIyQm9keURlZiA9IEJveDJELkR5bmFtaWNzLmIyQm9keURlZjtcblx0dGhpcy5iMkJvZHkgPSBCb3gyRC5EeW5hbWljcy5iMkJvZHk7XG5cdHRoaXMuYjJGaXh0dXJlRGVmID0gQm94MkQuRHluYW1pY3MuYjJGaXh0dXJlRGVmO1xuXHR0aGlzLmIyRml4dHVyZSA9IEJveDJELkR5bmFtaWNzLmIyRml4dHVyZTtcblx0dGhpcy5iMldvcmxkID0gQm94MkQuRHluYW1pY3MuYjJXb3JsZDtcblx0dGhpcy5iMk1hc3NEYXRhID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMk1hc3NEYXRhO1xuXHR0aGlzLmIyUG9seWdvblNoYXBlID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlBvbHlnb25TaGFwZTtcblx0dGhpcy5iMkNpcmNsZVNoYXBlID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMkNpcmNsZVNoYXBlO1xuXHR0aGlzLmIyRGVidWdEcmF3ID0gQm94MkQuRHluYW1pY3MuYjJEZWJ1Z0RyYXc7IFxuXHR0aGlzLmIyQ29udGFjdExpc3RlbmVyID0gQm94MkQuRHluYW1pY3MuYjJDb250YWN0TGlzdGVuZXI7XG5cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbmV3IEIyZDtcblxudmFyIEluY2x1ZGVzID0gcmVxdWlyZShcIi4vSW5jbHVkZXMuanNcIik7IHZhciBpbmNsdWRlX2RhdGEgPSBJbmNsdWRlcy5nZXRfaW5jbHVkZV9kYXRhKHtcblx0Y3VycmVudF9tb2R1bGU6IFwiQjJkXCIsIFxuXHRpbmNsdWRlX29wdGlvbnM6IEluY2x1ZGVzLmNob2ljZXMuT1RIRVJfU1RVRkZcbn0pOyBldmFsKGluY2x1ZGVfZGF0YS5uYW1lX3N0YXRlbWVudHMpOyB2YXIgaW5jbHVkZSA9IGZ1bmN0aW9uKCl7ZXZhbChpbmNsdWRlX2RhdGEubW9kdWxlX3N0YXRlbWVudHMpO31cblxuIiwidmFyIENvbmZpZyA9IGZ1bmN0aW9uKCl7XG5cdHRoaXMuU0NSRUVOX1cgPSAwOyAvLyBzZXQgdXAgd2hlbiB0aGUgcGFnZSBpcyBsb2FkZWQgKHRvIDk1JSBvZiB3aWR0aCBvZiBjb250YWluaW5nIGVsZW1lbnQpIFxuXHR0aGlzLlNDUkVFTl9IID0gNjAwO1xuXG5cdHRoaXMuTUFJTl9DQU5WQVNfTkFNRSA9IFwiZGlzcGxheV9jYW52YXNcIjtcblx0dGhpcy5ERUJVR19DQU5WQVNfTkFNRSA9IFwiZGVidWdfY2FudmFzXCI7XG5cblx0Ly8gRnJhbWVzIFBlciBTZWNvbmQuIEVzc2VudGlhbGx5LCBmcmVxdWVuY3kgb2YgY3JlYXRlanMuVGlja2VyIFxuXHQvLyBXYXJuaW5nISBGcmVxdWVuY3kgb2YgdGhlIEJveDJEIHBoeXNpY3MgdXBkYXRlcyBtYXkgYmUgZGlmZmVyZW50XG5cdC8vIChDdXJyZW50bHkgbm90IGltcGxlbWVudGVkKVxuXHR0aGlzLkZQUyA9IDMwOyBcblxuXHQvLyBCb3gyRCBzdHVmZiA+Pj5cblx0dGhpcy5CMkQgPSB7XG5cdFx0U0NBTEU6IDMwLFxuXHRcdFNQUzogNjAsIFx0XHRcdC8vIFN0ZXBzIFBlciBTZWNvbmRcblx0XHRWRUxPQ0lUWV9JVFI6IDgsXHQvLyB2ZWxvY2l0eSBpdGVyYXRpb25zXG5cdFx0UE9TSVRJT05fSVRSOiAzLFx0Ly8gcG9zaXRpb24gaXRlcmF0aW9uc1xuXHRcdGRlYnVnX2RyYXc6IGZhbHNlXG5cdH07XG5cblx0dGhpcy5UZXJyYWluU2xpY2UgPSB7XG5cdFx0Z3JpZF9yb3dzOiAyMCxcblx0XHRncmlkX2NvbHVtbnM6IDIwLFxuXHRcdGNlbGxfdzogMSwgLy8gaW4gbWV0ZXJzXG5cblx0XHQvLyBpcyBhdXRvbWF0aWNhbGx5IGluY3JlbWVudGVkIGVhY2ggdGltZSBuZXcgVGVycmFpblNsaWNlTW9kZWwgaXMgaW5zdGFudGlhdGVkOlxuXHRcdG5leHRfc2xpY2VfaWQ6IDAgXG5cdH07XG5cdFxuXHQvLyA8PDxcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbmV3IENvbmZpZztcbiIsIlxuLy9Db250cm9sbGVyIGNvbXBvbmVudChBSSBzY3JpcHQpXG52YXIgQW50Q29udHJvbGxlciA9IChmdW5jdGlvbigpIHtcblxuXHR2YXIgaW5pdCA9IGZ1bmN0aW9uKCkge1xuXHRcdGluY2x1ZGUoKTtcblx0XHQvL0FudE1vZGVsLmFudCA9IFBoeXNpY3NDb250cm9sbGVyLmdldF9yZWN0YW5ndWxhcl9ib2R5KDEsIDAuNSwgNjAwIC8gMzAgKyAoMi41IC8gMiksIDUxMCAvIDMwIC0gKDEuNSAvIDIpLCB0cnVlKTtcblx0XHRBbnRNb2RlbC5hbnQgPSBQaHlzaWNzQ29udHJvbGxlci5nZXRfcmVjdGFuZ3VsYXIoe3VzZXJEYXRhOiB7aWQ6IFwiYW50XCJ9fSwgXCJhbnRcIik7XG5cdFx0YW50ID0gQW50TW9kZWwuYW50O1xuXHRcdFBoeXNpY3NDb250cm9sbGVyLnNldHVwX2NvbGxpc2lvbl9saXN0ZW5lcih7QmVnaW5Db250YWN0OiBiZWdpbl9jb250YWN0LCBFbmRDb250YWN0OiBlbmRfY29udGFjdH0sIHttdXN0X2JlX2ludm9sdmVkOiBhbnR9KTtcblx0fTtcblxuXHR2YXIgY2hhbmdlX3N0YXRlID0gZnVuY3Rpb24ocHJvZ3Jlc3Nfc3RhdGUpIHtcblx0XHRBbnRNb2RlbC5BSV9zdGF0ZSA9IHByb2dyZXNzX3N0YXRlO1xuXG5cdH1cblxuXHQvLyAvLyAvL1NldCB1cCBDb2xsaXNpb24gaGFuZGxlclxuXHRcblx0XG5cdHZhciBiZWdpbl9jb250YWN0ID0gZnVuY3Rpb24oY29udGFjdCwgaW5mbylcblx0XHR7XG5cdFx0Ly9oYW5kbGUgY29sbGlzaW9ucyBoZXJlXG5cdFx0XG5cdFx0dmFyIG1lYW5faGVybztcblx0XHRpZihpbmZvLkEuYm9keV9pZCA9PSBcImhlcm9cIilcblx0XHR7XG5cdFx0XHRtZWFuX2hlcm8gPSBpbmZvLkE7XG5cdFx0XHRpZihtZWFuX2hlcm8uZml4dHVyZSAhPSBcImJvdHRvbSBzZW5zb3JcIiAmJiBBbnRNb2RlbC5jYW5fYXR0YWNrKVxuXHRcdFx0e1xuXHRcdFx0XHRhbnQubWVfaHVydF9oZXJvID0gdHJ1ZTtcblx0XHRcdFx0Y29uc29sZS5sb2coY29udGFjdCk7XG5cdFx0XHRcdGNvbnNvbGUubG9nKGluZm8pO1xuXHRcdFx0fVx0XG5cdFx0XHRlbHNlXG5cdFx0XHR7XG5cblx0XHRcdFx0QW50TW9kZWwuaGVyb19odXJ0X21lID0gdHJ1ZTtcblx0XHRcdFx0Y29uc29sZS5sb2coY29udGFjdCk7XG5cdFx0XHRcdGNvbnNvbGUubG9nKGluZm8pO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRlbHNlIGlmKGluZm8uQi5ib2R5X2lkID09IFwiaGVyb1wiKVxuXHRcdHtcblx0XHRcdG1lYW5faGVybyA9IGluZm8uQjtcblx0XHRcdGlmKG1lYW5faGVyby5maXh0dXJlICE9IFwiYm90dG9tIHNlbnNvclwiICYmIEFudE1vZGVsLmNhbl9hdHRhY2spXG5cdFx0XHR7XG5cdFx0XHRcdGFudC5tZV9odXJ0X2hlcm8gPSB0cnVlO1xuXHRcdFx0XHRjb25zb2xlLmxvZyhjb250YWN0KTtcblx0XHRcdFx0Y29uc29sZS5sb2coaW5mbyk7XG5cdFx0XHR9XHRcblx0XHRcdGVsc2Vcblx0XHRcdHtcblxuXHRcdFx0XHRBbnRNb2RlbC5oZXJvX2h1cnRfbWUgPSB0cnVlO1xuXHRcdFx0XHRjb25zb2xlLmxvZyhjb250YWN0KTtcblx0XHRcdFx0Y29uc29sZS5sb2coaW5mbyk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9O1xuXG5cdHZhciBlbmRfY29udGFjdCA9IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHRBbnRNb2RlbC5tZV9odXJ0X2hlcm8gPSBmYWxzZTtcblxuXHR9O1xuXHRcblx0XG5cdC8vYWRkIHRoZSBuZXcgbGlzdGVuZXIgdG8gdGhlIG1haW4gbGlzdGVuZXIgaW4gUGh5c2ljc0NvbnRyb2xsZXJcblxuXG5cdC8vZ2FtZUNvbnRyb2xsZXIgY2FsbHMgdXBkYXRlIGZvciBlYWNoIGluc3RhbmNlXG5cdHZhciBnZXRfYW50ID0gZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIEFudE1vZGVsLmFudDtcblx0fTtcblxuXHR2YXIgdXBkYXRlID0gZnVuY3Rpb24oKSB7XG5cdFx0Ly93cml0ZSB5b3VyIEFJIHNjcmlwdCBoZXJlXG5cdFx0Ly9EbyB5b3VyIG1haW50ZW5hbmNlIGhlcmVcblx0XHQvL2V4YW1wbGUgbWFpbnRlbmFuY2U6IGNoZWNrIGNvb2xkb3duXG5cblx0XHQvL2lmIGVuZW15IGlzIGRlYWQsIGRpZVxuXHRcdGlmIChBbnRNb2RlbC5ocCA9PSAxKSB7XG5cdFx0XHRcblx0XHRcdGlmIChBbnRNb2RlbC5oZXJvX2h1cnRfbWUpXG5cdFx0XHR7XG5cdFx0XHRcdEFudE1vZGVsLmhwLS07XG5cdFx0XHRcdEFudE1vZGVsLmhlcm9faHVydF9tZSA9IGZhbHNlO1xuXHRcdFx0fVxuXHRcdH0gXG5cdFx0ZWxzZSBpZiAoQW50TW9kZWwuaHAgPD0gMCAmJiBBbnRNb2RlbC5kZWF0aF90aWNrID09IDMwKSB7XG5cdFx0XHQvL0FudE1vZGVsLmFudC5EZXN0cm95Rml4dHVyZSgpO1xuXHRcdFx0QW50TW9kZWwuZGVhdGhfdGljaysrO1xuXHRcdH1cblx0XHRlbHNlIGlmIChBbnRNb2RlbC5ocCA8PSAwICYmIEFudE1vZGVsLmRlYXRoX3RpY2sgPiAzMCl7fVxuXHRcdGVsc2UgaWYgKEFudE1vZGVsLmhwIDw9IDApIHtcblx0XHRcdFxuXHRcdFx0Y2hhbmdlX3N0YXRlKFwiZGVhdGhcIik7XG5cdFx0XHRHcmFwaGljc0NvbnRyb2xsZXIuY2hhbmdlX2FudChcImRlYXRoXCIpO1xuXHRcdFx0Y29uc29sZS5sb2coXCJEZWF0aCBUcmlnZ2VyZWRcIik7XG5cdFx0XHRBbnRNb2RlbC5kZWF0aF90aWNrKys7XG5cdFx0fVxuXHRcdC8vZWxzZSBtb3ZlICYgYXR0YWNrXG5cdFxuXHRcdGVsc2Uge1xuXG5cdFx0XHRpZiAoQW50TW9kZWwuQUlfc3RhdGUgPT0gXCJ3YWxrXCIpIHtcblx0XHRcdFx0dmFyIEFudGJvZHkgPSBBbnRNb2RlbC5hbnQ7XG5cdFx0XHRcdHZhciB2ZWxvY2l0eSA9IEFudGJvZHkuR2V0TGluZWFyVmVsb2NpdHkoKTtcblx0XHRcdFx0dmVsb2NpdHkueCA9IC1BbnRNb2RlbC5zcGVlZDtcblx0XHRcdFx0QW50Ym9keS5TZXRMaW5lYXJWZWxvY2l0eSh2ZWxvY2l0eSk7IC8vIGJvZHkuU2V0TGluZWFyVmVsb2NpdHkobmV3IGIyVmVjMig1LCAwKSk7IHdvdWxkIHdvcmsgdG9vXG5cdFx0XHRcdEFudGJvZHkuU2V0QXdha2UodHJ1ZSk7XG5cdFx0XHR9XG5cdFx0XHRpZiAoQW50TW9kZWwuY2FuX2F0dGFjayAmJiBBbnRNb2RlbC5tZV9odXJ0X2hlcm8gJiYgbW9kZWwuQUlfc3RhdGUgPT0gXCJ3YWxrXCIpIFxuXHRcdFx0e1xuXG5cdFx0XHRcdFxuXHRcdFx0fVxuXHRcdFx0aWYgKEFudE1vZGVsLmhlcm9faHVydF9tZSlcblx0XHRcdHtcblx0XHRcdFx0QW50TW9kZWwuaHAtLTtcblx0XHRcdFx0QW50TW9kZWwuaGVyb19odXJ0X21lID0gZmFsc2U7XG5cdFx0XHRcdGNoYW5nZV9zdGF0ZShcInVwc2lkZV9kb3duXCIpO1xuXHRcdFx0XHRHcmFwaGljc0NvbnRyb2xsZXIuY2hhbmdlX2FudChcInVwc2lkZV9kb3duXCIpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cblx0cmV0dXJuIHtcblx0XHRpbml0OiBpbml0LFxuXHRcdHVwZGF0ZTogdXBkYXRlLFxuXHRcdGdldF9hbnQ6IGdldF9hbnRcblx0fTtcblxufSkoKTtcblxubW9kdWxlLmV4cG9ydHMgPSBBbnRDb250cm9sbGVyO1xuXG52YXIgSW5jbHVkZXMgPSByZXF1aXJlKFwiLi4vSW5jbHVkZXMuanNcIik7XG52YXIgaW5jbHVkZV9kYXRhID0gSW5jbHVkZXMuZ2V0X2luY2x1ZGVfZGF0YSh7XG5cdGN1cnJlbnRfbW9kdWxlOiBcIkFudENvbnRyb2xsZXJcIixcblx0aW5jbHVkZV9vcHRpb25zOiBJbmNsdWRlcy5jaG9pY2VzLkRFRkFVTFRcbn0pO1xuZXZhbChpbmNsdWRlX2RhdGEubmFtZV9zdGF0ZW1lbnRzKTtcbnZhciBpbmNsdWRlID0gZnVuY3Rpb24oKXtldmFsKGluY2x1ZGVfZGF0YS5tb2R1bGVfc3RhdGVtZW50cyk7fVxuIiwiXG52YXIgQXNzZXRDb250cm9sbGVyID0gKGZ1bmN0aW9uKCl7XG5cdC8qXG5cdCAgIEFzc2V0Q29udHJvbGxlciBpcyBpbiBjaGFyZ2Ugb2Ygc2V0dGluZyB1cCBhbGwgYml0bWFwcy9hbmltYXRpb25zL290aGVyIHJlc291cmNlc1xuXHQgICBmb3IgZXZlcnlvbmUgZWxzZS5cbiAgICovXG5cblx0Ly8gdXNlIEFzc2V0TW9kZWwubG9hZGVyLmdldFJlc3VsdChcImlkX29mX3RoZV9hc3NldFwiKTtcblxuXHR2YXIgaW5pdCA9IGZ1bmN0aW9uKGFzc2V0X3BhdGgpe1xuXHRcdGluY2x1ZGUoKTtcdFxuXG5cdFx0LyogVE9ETyBtYWtlIG1vZGVsIHdpdGggdGhlIGVhc2lseSBtYW5hZ2VkIHRhYmxlcyBvZiByZXNvdXJjZXMgd2hpY2ggd2lsbCBiZVxuXHRcdCAgIGFkZGVkIHRvIHRoZSBsb2FkZXIgYXV0b21hdGljYWxseVxuXHRcdCovXG5cblx0XHQvL2xvYWRlciA9IG5ldyBjcmVhdGVqcy5Mb2FkUXVldWUoZmFsc2UpOyAvLyBsb2FkaW5nIHJlc291cnNlcyB1c2luZyBwcmVsb2FkLmpzXG5cdFx0Ly9sb2FkZXIuYWRkRXZlbnRMaXN0ZW5lcihcImNvbXBsZXRlXCIsIGhhbmRsZUNvbXBsZXRlKTtcblx0XHR2YXIgbWFuaWZlc3QgPSBBc3NldE1vZGVsLm1hbmlmZXN0O1x0XG5cdFx0QXNzZXRNb2RlbC5sb2FkZXIubG9hZE1hbmlmZXN0KG1hbmlmZXN0LCB0cnVlLCBhc3NldF9wYXRoKTtcblx0XHRcblx0fTtcblxuXHR2YXIgcG9zdF9pbml0ID0gZnVuY3Rpb24oKXtcblx0XHQvKiB0aGlzIGZ1bmN0aW9uIHdpbGwgYmUgZG9uZSBkaWZmZXJlbnRseSBhdCBzb21lIHBvaW50XG5cdFx0ICogaXQnbGwgaGF2ZSBzb21ldGhpbmcgdG8gZG8gd2l0aCByZWZhY3RvcmluZyBJbml0Q29udHJvbGxlclxuXHRcdCAqL1xuXG5cdFx0Ly9Bc3NldE1vZGVsLmFuaW1hdGlvbnNbXCJhbnRcIl0gPSBuZXcgY3JlYXRlanMuU3ByaXRlU2hlZXQoe1xuXHRcdFx0Ly9cImZyYW1lcmF0ZVwiOiAwLjIsXG5cdFx0XHQvL1wiaW1hZ2VzXCI6IFtnZXRfYXNzZXQoXCJBbnQxXCIpLCBnZXRfYXNzZXQoXCJBbnQyXCIpLCBnZXRfYXNzZXQoXCJBbnQzXCIpXSxcblx0XHRcdC8vXCJmcmFtZXNcIjogeyBcInJlZ1hcIjogMywgXCJyZWdZXCI6IDYsIFwiaGVpZ2h0XCI6IDI1LCBcIndpZHRoXCI6IDUwLCBcImNvdW50XCI6IDZ9LFxuXHRcdFx0Ly9cImFuaW1hdGlvbnNcIjoge1xuXHRcdFx0XHQvL1wid2Fsa1wiOiBbMCwgMSwgXCJ3YWxrXCJdLFxuXHRcdFx0XHQvL1widXBzaWRlX2Rvd25cIjogWzIsIDMsIFwidXBzaWRlX2Rvd25cIl0sXG5cdFx0XHRcdC8vXCJkZWF0aFwiOiBbNCwgNSwgXCJkZWF0aFwiXVxuXHRcdFx0Ly99XG5cdFx0Ly99KVxuXG5cdH07XG5cdFxuXG5cdHZhciBnZXRfYXNzZXQgPSBmdW5jdGlvbihpZCl7XG5cblx0XHR2YXIgcmVzdWx0ID0gQXNzZXRNb2RlbC5sb2FkZXIuZ2V0UmVzdWx0KGlkKTtcblxuXHRcdGlmKCFyZXN1bHQpe1xuXHRcdFx0dGhyb3cgXCJFcnJvcjogYXNzZXQgd2l0aCBpZCBcIiArIGlkICsgXCIgY291bGQgbm90IGJlIGxvYWRlZC5cIiArXG5cdFx0XHRcdFwiIENoZWNrIHRoYXQgaWQgaXMgdmFsaWQgYW5kIHRoYXQgYXNzZXRzIHdlcmUgcHJvcGVybHkgbG9hZGVkXCI7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiByZXN1bHQ7XG5cdH07XG5cdFx0XG5cblxuXHRcblx0cmV0dXJuIHtcblx0XHRpbml0OiBpbml0LFxuXHRcdGdldF9hc3NldDogZ2V0X2Fzc2V0LFxuXHR9O1xuXG59KSgpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEFzc2V0Q29udHJvbGxlcjtcblxudmFyIEluY2x1ZGVzID0gcmVxdWlyZShcIi4uL0luY2x1ZGVzLmpzXCIpOyB2YXIgaW5jbHVkZV9kYXRhID0gSW5jbHVkZXMuZ2V0X2luY2x1ZGVfZGF0YSh7XG5cdGN1cnJlbnRfbW9kdWxlOiBcIkFzc2V0Q29udHJvbGxlclwiLCBcblx0aW5jbHVkZV9vcHRpb25zOiBJbmNsdWRlcy5jaG9pY2VzLkRFRkFVTFRcbn0pOyBldmFsKGluY2x1ZGVfZGF0YS5uYW1lX3N0YXRlbWVudHMpOyB2YXIgaW5jbHVkZSA9IGZ1bmN0aW9uKCl7ZXZhbChpbmNsdWRlX2RhdGEubW9kdWxlX3N0YXRlbWVudHMpO31cblxuIiwiXG52YXIgRW5lbXlDb250cm9sbGVyID0gKGZ1bmN0aW9uKCl7XG5cdHZhciBpbml0ID0gZnVuY3Rpb24oKXtcblx0XHRcblx0XHRpbmNsdWRlKCk7XG5cdH07XG5cdFxuXHR2YXIgbW92ZSA9IGZ1bmN0aW9uKG9mZnNldF94LCBvZmZzZXRfeSl7XG5cdFx0Ly8gbmVlZHMgdG8gY2hhbmdlIHRvIG5vdCB1c2UgZ2FtZW1vZGVsIGRpcmVjdGx5XG5cdFx0Ly9HYW1lTW9kZWwuY2hvbXBlci54ICs9IG9mZnNldF94O1xuXHRcdC8vR2FtZU1vZGVsLmNob21wZXIueSArPSBvZmZzZXRfeTtcblx0fTtcblxuXHRyZXR1cm4ge1xuXHRcdG1vdmU6IG1vdmUsXG5cdFx0aW5pdDogaW5pdCxcblx0fTtcbn0pKCk7XG5cbm1vZHVsZS5leHBvcnRzID0gRW5lbXlDb250cm9sbGVyO1xuXG52YXIgSW5jbHVkZXMgPSByZXF1aXJlKFwiLi4vSW5jbHVkZXMuanNcIik7IHZhciBpbmNsdWRlX2RhdGEgPSBJbmNsdWRlcy5nZXRfaW5jbHVkZV9kYXRhKHtcblx0Y3VycmVudF9tb2R1bGU6IFwiRW5lbXlDb250cm9sbGVyXCIsIFxuXHRpbmNsdWRlX29wdGlvbnM6IEluY2x1ZGVzLmNob2ljZXMuREVGQVVMVFxufSk7IGV2YWwoaW5jbHVkZV9kYXRhLm5hbWVfc3RhdGVtZW50cyk7IHZhciBpbmNsdWRlID0gZnVuY3Rpb24oKXtldmFsKGluY2x1ZGVfZGF0YS5tb2R1bGVfc3RhdGVtZW50cyk7fVxuXG4iLCJcblxudmFyIEdhbWVDb250cm9sbGVyID0gKGZ1bmN0aW9uKCl7XG5cblx0dmFyIGluaXQgPSBmdW5jdGlvbigpe1xuXHRcdGluY2x1ZGUoKTtcblx0fTtcblx0XHRcblxuXHR2YXIgdXBkYXRlX2FsbCA9IGZ1bmN0aW9uKGV2ZW50KXtcblx0XHQvKlxuXHRcdCAqIG1haW4gZnVuY3Rpb24gcHJldHR5IG11Y2hcblx0XHQgKiBldmVyeWdoaW5nIGVsc2UgaXMgY2FsbGVkIGZyb20gaGVyZSBldmVyeSB0aWNrXG5cdFx0ICovXG5cdFx0XG5cblx0XHR2YXIgZGVsdGEgPSBldmVudC5kZWx0YTtcblxuXHRcdC8vICEhISEgd29ybGQgc2ltdWxhdGlvbiBzdGVwIGdvZXMgc29tZXdoZXJlIHJpZ2h0IGhlcmVcblx0XHQvLyBhcyBwZXIgY3VycmVudCBkZXNpZ24sIHdpbGwgdGFrZSBkZWx0YSBhcyBhbiBhcmd1bWVudFxuXHRcdFxuXHRcdC8vVGVycmFpbkNvbnRyb2xsZXIuZ2VuZXJhdGVfdGVycmFpbigpOyBcblx0XHRQbGF5ZXJDb250cm9sbGVyLnVwZGF0ZSgpO1xuXHRcdFxuXHRcdFdvcmxkQ29udHJvbGxlci51cGRhdGUoZGVsdGEpO1xuXG5cdFx0VGVycmFpbkNvbnRyb2xsZXIudXBkYXRlKCk7XG5cblx0XHQvLyBTaG91bGQgYmUgY2FsbGVkIGFmdGVyIGFsbCBtb3ZlbWVudCBvZiBvYmplY3RzIGlzIGRvbmU6XG5cdFx0QW50Q29udHJvbGxlci51cGRhdGUoKTtcblx0XHRHcmFwaGljc0NvbnRyb2xsZXIudXBkYXRlKCk7XG5cdH07XG5cblxuXHRyZXR1cm4ge1xuXHRcdGluaXQ6IGluaXQsXG5cdFx0dXBkYXRlX2FsbDogdXBkYXRlX2FsbCxcblx0fTtcblxufSkoKTtcblxubW9kdWxlLmV4cG9ydHMgPSBHYW1lQ29udHJvbGxlcjtcblxudmFyIEluY2x1ZGVzID0gcmVxdWlyZShcIi4uL0luY2x1ZGVzLmpzXCIpOyB2YXIgaW5jbHVkZV9kYXRhID0gSW5jbHVkZXMuZ2V0X2luY2x1ZGVfZGF0YSh7XG5cdGN1cnJlbnRfbW9kdWxlOiBcIkdhbWVDb250cm9sbGVyXCIsIFxuXHRpbmNsdWRlX29wdGlvbnM6IEluY2x1ZGVzLmNob2ljZXMuREVGQVVMVFxufSk7IGV2YWwoaW5jbHVkZV9kYXRhLm5hbWVfc3RhdGVtZW50cyk7IHZhciBpbmNsdWRlID0gZnVuY3Rpb24oKXtldmFsKGluY2x1ZGVfZGF0YS5tb2R1bGVfc3RhdGVtZW50cyk7fVxuXG4iLCJcbnZhciBHcmFwaGljc0NvbnRyb2xsZXIgPSAoZnVuY3Rpb24oKXtcblx0LyogYWxsIHRoZSBncmFwaGljcyBzdHVmZi4gYW5kIHdoYXQgZGlkIHlvdSBleHBlY3Q/XG5cdCovXG5cblx0dmFyIGdldF9hc3NldDsgXG5cdHZhciBoZXJvLCBhbnQ7IC8vIGZvciBxdWlja2VyIGFjY2Vzc1xuXG5cdHZhciBpbml0ID0gZnVuY3Rpb24oKXtcblx0XHQvKiBpcyByYW4gZnJvbSB0aGUgSW5pdENvbnRyb2xsZXIgb25jZSB3aGVuIHRoZSBnYW1lIGlzIGxvYWRlZCAqL1xuXG5cdFx0aW5jbHVkZSgpOyAvLyBzYXRpc2Z5IHJlcXVpcmVtZW50c1xuXG5cdFx0Z2V0X2Fzc2V0ID0gQXNzZXRDb250cm9sbGVyLmdldF9hc3NldDsgLy8gZm9yIHF1aWNrZXIgYWNjZXNzXG5cblx0XHRpbml0X2FuaW1hdGlvbnMoKTtcblxuXG5cdFx0R3JhcGhpY3NNb2RlbC5zdGFnZSA9IG5ldyBjcmVhdGVqcy5TdGFnZShDb25maWcuTUFJTl9DQU5WQVNfTkFNRSk7XG5cdFx0R3JhcGhpY3NNb2RlbC5zdGFnZS5jYW52YXMud2lkdGggPSBDb25maWcuU0NSRUVOX1c7XG5cdFx0R3JhcGhpY3NNb2RlbC5zdGFnZS5jYW52YXMuaGVpZ2h0ID0gQ29uZmlnLlNDUkVFTl9IO1xuXG5cdFx0R3JhcGhpY3NNb2RlbC5oZXJvID0gcmVxdWVzdF9iaXRtYXAoXCJncmVla193YXJyaW9yXCIpO1xuXHRcdEdyYXBoaWNzTW9kZWwuYW50ID0gcmVxdWVzdF9hbmltYXRlZChcImFudFwiLCBcIndhbGtcIik7XG5cblx0XHRoZXJvID0gR3JhcGhpY3NNb2RlbC5oZXJvO1xuXG5cdFx0YW50ID0gR3JhcGhpY3NNb2RlbC5hbnQ7XG5cdFx0YW50LmdvdG9BbmRQbGF5KFwid2Fsa1wiKTtcblxuXHRcdHNldF9yZWdfcG9zaXRpb24oaGVybywgLTIwLCArMTApO1xuXHRcdFxuXHRcdHNldF9yZWdfcG9zaXRpb24oYW50LCAwLCAwKTtcblx0XHRcblx0XHRyZWdfZm9yX3JlbmRlcihHcmFwaGljc01vZGVsLmhlcm8sIFBsYXllckNvbnRyb2xsZXIuZ2V0X2hlcm8oKSk7XG5cdFx0cmVnX2Zvcl9yZW5kZXIoR3JhcGhpY3NNb2RlbC5hbnQsIEFudENvbnRyb2xsZXIuZ2V0X2FudCgpKTtcblxuXHRcdEdyYXBoaWNzTW9kZWwuY2FtZXJhLmZvbGxvd2luZyA9IGhlcm87XG4gICAgICAgIC8vUElaWkFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQVxuXHRcdEdyYXBoaWNzTW9kZWwuc2NvcmUgPSBuZXcgY3JlYXRlanMuVGV4dCgpO1xuXHRcdHJlZ19mb3JfcmVuZGVyKEdyYXBoaWNzTW9kZWwuc2NvcmUpO1xuXHRcdEdyYXBoaWNzTW9kZWwuaGVhbHRoID0gbmV3IGNyZWF0ZWpzLlRleHQoKTtcblx0XHRyZWdfZm9yX3JlbmRlcihHcmFwaGljc01vZGVsLmhlYWx0aCk7XG5cdFx0aHVkX3RlbXAoKTtcblxuXHR9O1xuICAgIFxuXHR2YXIgdXBkYXRlID0gZnVuY3Rpb24oZGVsdGEpe1xuXHRcdC8qIGlzIHJhbiBlYWNoIHRpY2sgZnJvbSB0aGUgR2FtZUNvbnRyb2xsZXIudXBkYXRlX2FsbCAqL1xuXG5cdCAgICB1cGRhdGVfY2FtZXJhKCk7IC8vIG5lZWRzIHRvIGJlIHVwZGF0ZWQgZmlyc3RcblxuXHRcdGNoZWNrX2Zvcl9uZXdfdGVycmFpbigpO1xuXG5cdFx0c3luY2hyb25pemVfdG9fcGh5c2ljYWxfYm9kaWVzKCk7XG5cblx0ICAgIC8vUElaWkFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQVxuXHRcdGh1ZF90ZW1wX3VwZGF0ZSgpO1xuXG5cdFx0YW50X3NwZWNpYWxfcmVuZGVyX3RlbXAoKTsgLy8gVEVNUE9SQVJZISEhISEhISEhISFcblxuXHRcdEdyYXBoaWNzTW9kZWwuc3RhZ2UudXBkYXRlKCk7XG5cdH07XG5cbiAgICAvL0RFTEVURSBNRSBQSVpaQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQVxuXHR2YXIgaHVkX3RlbXAgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICBHcmFwaGljc01vZGVsLmhlYWx0aC50ZXh0ID0gXCIxMDBcIjtcblx0ICAgIEdyYXBoaWNzTW9kZWwuaGVhbHRoLnggPSAxMDtcblx0ICAgIEdyYXBoaWNzTW9kZWwuaGVhbHRoLnkgPSAzMDtcblx0ICAgIEdyYXBoaWNzTW9kZWwuaGVhbHRoLmZvbnQgPSBcIjIwcHggQXJpYWxcIjtcblx0ICAgIEdyYXBoaWNzTW9kZWwuaGVhbHRoLmNvbG9yID0gXCIjZmYwMDAwXCI7XG5cdCAgICBHcmFwaGljc01vZGVsLnNjb3JlLnRleHQgPSBcIjEwXCI7XG5cdCAgICBHcmFwaGljc01vZGVsLnNjb3JlLnggPSAxMDtcblx0ICAgIEdyYXBoaWNzTW9kZWwuc2NvcmUueSA9IDEwO1xuXHQgICAgR3JhcGhpY3NNb2RlbC5zY29yZS5mb250ID0gXCIyMHB4IEFyaWFsXCI7XG5cdH1cblxuICAgIC8vREVMRVRFIE1FIFBJWlpBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBXG5cdHZhciBodWRfdGVtcF91cGRhdGUgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICB0ZW1wX3Njb3JlID0gcGFyc2VJbnQoR3JhcGhpY3NNb2RlbC5zY29yZS50ZXh0KTtcblx0ICAgIHRlbXBfc2NvcmUgKz0gMTtcblx0ICAgIEdyYXBoaWNzTW9kZWwuc2NvcmUudGV4dCA9IHRlbXBfc2NvcmUudG9TdHJpbmcoKTtcblx0fVxuXG5cdHZhciB1cGRhdGVfY2FtZXJhID0gZnVuY3Rpb24oKXtcblx0XHR2YXIgY2FtZXJhID0gR3JhcGhpY3NNb2RlbC5jYW1lcmE7XG5cdFx0dmFyIGNlbnRlciA9IGNhbWVyYS5jZW50ZXI7XG5cblx0XHRjZW50ZXIueCA9IENvbmZpZy5TQ1JFRU5fVy8yIC0gY2FtZXJhLm9mZnNldF9mcm9tX2ZvbGxvd2VkLng7XG5cdFx0Y2VudGVyLnkgPSBDb25maWcuU0NSRUVOX0gvMiAtIGNhbWVyYS5vZmZzZXRfZnJvbV9mb2xsb3dlZC55O1xuXG5cdFx0aWYoY2FtZXJhLmZvbGxvd2luZyAhPSBudWxsKXtcblx0XHRcdGNhbWVyYS5vZmZzZXQueCA9IGNlbnRlci54IC0gY2FtZXJhLmZvbGxvd2luZy5ib2R5LkdldFdvcmxkQ2VudGVyKCkueCAqIENvbmZpZy5CMkQuU0NBTEU7XG5cdFx0XHRjYW1lcmEub2Zmc2V0LnkgPSAgY2VudGVyLnkgLSBjYW1lcmEuZm9sbG93aW5nLmJvZHkuR2V0V29ybGRDZW50ZXIoKS55ICogQ29uZmlnLkIyRC5TQ0FMRTtcblx0XHR9XG5cblx0XHRhZGp1c3RfZGVidWdfZHJhdygpOyAvLyBnb2VzIGxhc3Rcblx0fTtcblxuXHQvLyoqKioqKioqKipURU1QT1JBUlkqKioqKioqKioqKioqKioqKlxuXHR2YXIgY2hhbmdlX2FudCA9IGZ1bmN0aW9uKHN0YXRlKXtcblx0XHRpZihzdGF0ZSA9PSBcImRlYXRoXCIpXG5cdFx0e1x0XG5cdFx0XHRjb25zb2xlLmxvZyhcIkFOVCBHT0VTIEhFUkVcIilcblx0XHRcdGFudC5nb3RvQW5kU3RvcChcImRlYXRoXCIpO1xuXHRcdH1cblx0XHRlbHNlIGlmKHN0YXRlID09IFwidXBzaWRlX2Rvd25cIilcblx0XHR7XG5cdFx0XHRjb25zb2xlLmxvZyhcIkFOVCBHT0VTIEhFUkVcIilcblx0XHRcdGFudC5nb3RvQW5kUGxheShcInVwc2lkZV9kb3duXCIpO1xuXHRcdH1cblx0XHRcblxuXG5cdH1cdFxuXG5cblx0Ly8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG5cdHZhciBhZGp1c3RfZGVidWdfZHJhdyA9IGZ1bmN0aW9uKCl7XG5cdFx0dmFyIGNhbWVyYSA9IEdyYXBoaWNzTW9kZWwuY2FtZXJhO1xuXHRcdFRlc3RDb250cm9sbGVyLnNldF9kZWJ1Z19vZmZzZXQoY2FtZXJhLm9mZnNldC54LCBjYW1lcmEub2Zmc2V0LnkpO1xuXHR9O1xuXG5cdHZhciBpbml0X2FuaW1hdGlvbnMgPSBmdW5jdGlvbigpe1xuXHRcdFxuXHRcdEdyYXBoaWNzTW9kZWwuc3ByaXRlc2hlZXRzW1wiYW50XCJdID0gbmV3IGNyZWF0ZWpzLlNwcml0ZVNoZWV0KHtcblx0XHRcdFwiZnJhbWVyYXRlXCI6IDEsXG5cdFx0XHRcImltYWdlc1wiOiBbZ2V0X2Fzc2V0KFwiQW50MVwiKSwgZ2V0X2Fzc2V0KFwiQW50MlwiKSwgZ2V0X2Fzc2V0KFwiQW50M1wiKV0sXG5cdFx0XHRcImZyYW1lc1wiOiB7IFwicmVnWFwiOiAzLCBcInJlZ1lcIjogNiwgXCJoZWlnaHRcIjogMjUsIFwid2lkdGhcIjogNTAsIFwiY291bnRcIjogNn0sXG5cdFx0XHRcImFuaW1hdGlvbnNcIjoge1xuXHRcdFx0XHRcIndhbGtcIjogWzAsIDEsIFwid2Fsa1wiXSxcblx0XHRcdFx0XCJ1cHNpZGVfZG93blwiOiBbMiwgMywgXCJ1cHNpZGVfZG93blwiXSxcblx0XHRcdFx0XCJkZWF0aFwiOiBbNCwgNSwgXCJkZWF0aFwiXVxuXHRcdFx0fVxuXHRcdH0pXG5cblx0fTtcblx0XG5cdHZhciByZXF1ZXN0X2JpdG1hcCA9IGZ1bmN0aW9uKGlkKXtcblx0XHQvLyBpZiBpZCBpcyBpbnZhbGlkLCB0aHJvdyBtZWFuaW5nZnVsIGV4Y2VwdGlvbj9cblx0XHR2YXIgYml0bWFwID0gbmV3IGNyZWF0ZWpzLkJpdG1hcChnZXRfYXNzZXQoaWQpKTtcblx0XHQvLyBtb3JlIGNvbXBsaWNhdGVkIHNldHRpbmcgZm9yIHJlZ2lzdHJhdGlvbiBwb3NpdGlvbiBtYXkgYmUgbmVlZGVkLCBkZXBlbmRpbmcgb24gdGhlIGJvZHkgYXR0YWNoZWRcblx0XHRpZiAoIShiaXRtYXAuaW1hZ2UpKXtcblx0XHRcdHRocm93IFwiRXJyb3I6IGltYWdlIHdhc24ndCBjb3JyZWN0bHkgbG9hZGVkIGZvciB0aGlzIGJpdG1hcFwiO1xuXHRcdH1cblx0XHRcblx0XHRiaXRtYXAucmVnWCA9IGJpdG1hcC5pbWFnZS53aWR0aC8yO1xuXHRcdGJpdG1hcC5yZWdZID0gYml0bWFwLmltYWdlLmhlaWdodC8yO1xuXG5cdFx0cmV0dXJuIGJpdG1hcDtcblx0XHQvLyBUT0RPIHJlc2VhcmNoIERpc3BsYXlPYmplY3QncyBjYWNoaW5nLiBhbmQgbWF5YmUgaW5jb3Jwb3JhdGVcblx0fTtcblxuXHR2YXIgcmVxdWVzdF9hbmltYXRlZCA9IGZ1bmN0aW9uKGlkLCBzdGFydF9mcmFtZSl7XG5cdFx0Ly8gdGhpcyBpbXBsZW1lbnRhdGlvbiBpcyB0ZW1wb3Jhcnlcblx0XHQvLyB1bnRpbCBJIHNldHVwIGVmZmljaWVudCBmYWNpbGl0eSBmb3IgZGVmaW5pbmcgc3ByaXRlc2hlZXRzXG5cdFx0Ly8gd2l0aGluIEdyYXBoaWNzQ29udHJvbGxlclxuXG5cdFx0aWYoIWlkIHx8ICFzdGFydF9mcmFtZSl7XG5cdFx0XHRpZighaWQpe1xuXHRcdFx0XHR0aHJvdyBcIndyb25nIGlkXCI7XG5cdFx0XHR9ZWxzZXtcblx0XHRcdFx0dGhyb3cgXCJ3cm9uZyBzdGFydF9mcmFtZVwiO1xuXHRcdFx0fVxuXHRcdH07XG5cblx0XHR2YXIgc3ByaXRlID0gbmV3IGNyZWF0ZWpzLlNwcml0ZShHcmFwaGljc01vZGVsLnNwcml0ZXNoZWV0c1tpZF0sIHN0YXJ0X2ZyYW1lKTtcblxuXHRcdHJldHVybiBzcHJpdGU7XG5cdH07XG5cblx0dmFyIGFudF9zcGVjaWFsX3JlbmRlcl90ZW1wID0gZnVuY3Rpb24oKXtcblx0XHQvKiBob3cgdG8gaGFuZGxlIHNwZWNpYWwgcmVuZGVyPyBURU1QT1JBUlkgKi9cblxuXHRcdHZhciBoZXJvX3BvcyA9IGhlcm8uYm9keS5HZXRXb3JsZENlbnRlcigpO1xuXHRcdHZhciBhbnRfcG9zID0gYW50LmJvZHkuR2V0V29ybGRDZW50ZXIoKTtcblxuXHRcdC8vaWYoYW50LmJvZHkudXNlcmRhdGEuc3RhdGUuYW50ID09IFwiZGVhdGhcIil7XG5cdFx0Ly9cdGFudC5nb3RvQW5kU3RvcChcImRlYXRoXCIpO1xuXHRcdC8vfVxuXG5cdFx0Ly9hbnQuZ290b0FuZFBsYXkoXCJ1cHNpZGVfZG93blwiKTtcblxuXHR9O1xuXHRcblx0XG5cdHZhciBzeW5jaHJvbml6ZV90b19waHlzaWNhbF9ib2RpZXMgPSBmdW5jdGlvbigpe1xuXG5cdFx0dmFyIHRpbGVzID0gR3JhcGhpY3NNb2RlbC5hbGxfcGh5c2ljYWw7XG5cblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgdGlsZXMubGVuZ3RoOyBpKyspe1xuXHRcdFx0dmFyIHRpbGUgPSB0aWxlc1tpXTtcblx0XHRcdHZhciBib2R5ID0gdGlsZS5ib2R5O1xuXG5cdFx0XHR2YXIgdGlsZV9wb3MgPSB0cmFuc194eShib2R5LkdldFdvcmxkQ2VudGVyKCkpO1xuXG5cdFx0XHR0aWxlLnggPSB0aWxlX3Bvcy54O1xuXHRcdFx0dGlsZS55ID0gdGlsZV9wb3MueTtcblx0XHR9XG5cblx0fTtcblx0XG5cblx0dmFyIGNoZWNrX2Zvcl9uZXdfdGVycmFpbiA9IGZ1bmN0aW9uKCl7XG5cdFx0LyogSWYgbmV3IHRlcnJhaW4gaGFzIGJlZW4gZ2VuZXJhdGVkLCByZW5kZXIgaXRcblx0XHQgKi9cblxuXHRcdHZhciBuZXdfc2xpY2VzID0gVGVycmFpbkNvbnRyb2xsZXIuR2V0TmV3VGVycmFpblNsaWNlcygpO1xuXHRcdHdoaWxlKG5ld19zbGljZXMubGVuZ3RoID4gMCl7XG5cblx0XHRcdHZhciBzbGljZSA9IG5ld19zbGljZXMucG9wKCk7XG5cblx0XHRcdGZvcih2YXIgaSA9IDA7IGkgPCBzbGljZS5ncmlkX3Jvd3M7IGkrKyl7XG5cdFx0XHRcdC8qIGdyYXBoaWNzIHBhc3MuIHNob3VsZCBiZSBwcm9iYWJseSBtb3ZlZCB0byB0aGUgZ3JhcGhpY3MgY29udHJvbGxlclxuXHRcdFx0XHQgKiBkaWRuJ3QgZGVjaWRlIG9uIGl0IHlldFxuXHRcdFx0XHQgKi9cblxuXG5cdFx0XHRcdHZhciBsdmwgPSBzbGljZS5ncmlkX3Jvd3MgLSBpOyAvLyBsZXZlbCBmcm9tIHRoZSBib3R0b21cblxuXHRcdFx0XHRmb3IodmFyIGogPSAwOyBqIDwgc2xpY2UuZ3JpZF9jb2x1bW5zOyBqKyspe1xuXHRcdFx0XHRcdHZhciBpZCA9IHNsaWNlLmdyaWRbaV1bal0uaWQ7XG5cdFx0XHRcdFx0aWYoaWQgIT0gMCl7XG5cdFx0XHRcdFx0XHQvLyBUT0RPOiBzaG91bGQgbWFrZSBwcm9wZXIgdGVycmFpbiBjb2xsZWN0aW9uIHRoaW5nIHRvIHB1bGwgZnJvbSBcblx0XHRcdFx0XHRcdHZhciB0aWxlX3RleHR1cmUgPSBbXCJncmFzc1wiLCBcIm1pZGRsZV90ZXJyYWluXCIsIFwiYm90dG9tX3RlcnJhaW5cIl1baWQtMV07XG5cdFx0XHRcdFx0XHR2YXIgdGlsZSA9IHJlcXVlc3RfYml0bWFwKHRpbGVfdGV4dHVyZSk7XG5cdFx0XHRcdFx0XHR2YXIgYm9keSA9IHNsaWNlLmdyaWRbaV1bal0uYm9keTtcblx0XHRcdFx0XHRcdHZhciBib2R5X3Bvc2l0aW9uID0gYm9keS5HZXRXb3JsZENlbnRlcigpO1xuXHRcdFx0XHRcdFx0dmFyIHRyYW5zX3BvcyA9IHRyYW5zX3h5KGJvZHlfcG9zaXRpb24pO1xuXHRcdFx0XHRcdFx0dGlsZS54ID0gdHJhbnNfcG9zLng7XG5cdFx0XHRcdFx0XHR0aWxlLnkgPSB0cmFuc19wb3MueTtcblx0XHRcdFx0XHRcdHJlZ19mb3JfcmVuZGVyKHRpbGUsIGJvZHkpO1xuXHRcdFx0XHRcdH0gLy8gZmlcblxuXG5cdFx0XHRcdH0gLy8gZW5kIGZvclxuXG5cdFx0XHR9Ly9lbmQgZm9yXG5cblx0XHR9IC8vIGVuZCB3aGlsZVxuXG5cdH07IC8vIGVuZCBjaGVja19mb3JfbmV3X3RlcnJhaW5cblxuXHR2YXIgdHJhbnNfeHkgPSBmdW5jdGlvbihwb3NpdGlvbl92ZWN0b3JfdW5zY2FsZWQpe1xuXHRcdC8vIHRha2VzIHBvc2l0aW9uIHZlY3RvciB3aXRoIHZhbHVlcyBpbiBtZXRlcnMsIHRyYW5zbGF0ZXNcblx0XHQvLyBpdCB0byBwaXhlbCBwb3NpdGlvbiB0YWtpbmcgdGhlIGNhbWVyYSBwb3NpdGlvbiBpbnRvIGFjY291bnRcblx0XHR2YXIgY2FtZXJhID0gR3JhcGhpY3NNb2RlbC5jYW1lcmE7XG5cblx0XHR2YXIgeCA9IChwb3NpdGlvbl92ZWN0b3JfdW5zY2FsZWQueCAqIENvbmZpZy5CMkQuU0NBTEUpICsgY2FtZXJhLm9mZnNldC54O1xuXHRcdHZhciB5ID0gKHBvc2l0aW9uX3ZlY3Rvcl91bnNjYWxlZC55ICogQ29uZmlnLkIyRC5TQ0FMRSkgKyBjYW1lcmEub2Zmc2V0Lnk7XG5cblx0XHRyZXR1cm4ge3g6IHgsIHk6IHl9O1x0XG5cdH07XG5cblx0dmFyIHNldF9yZWdfcG9zaXRpb24gPSBmdW5jdGlvbihlYXNlbGpzX29iaiwgb2Zmc2V0X3gsIG9mZnNldF95KXtcblx0XHQvLyBzZXRzIHJlZ2lzdHJhdGlvbiBwb3NpdGlvbiBvZiB0aGUgZWFzZWxqcyBvYmplY3Rcblx0XHQvLyByZWdpc3JhdGlvbiBwb3NpdGlvbiBpcyB0aGUgcmVsYXRpdmUgcG9pbnQgb2YgdGhlIG9iamVjdFxuXHRcdC8vIHRoYXQgeW91IG1vdmUgd2hlbiB5b3Ugc2V0IG9iamVjdCdzIHggYW5kIHkgY29vcmRpbmF0c1xuXHRcdC8vIGkuZS4gaWYgcmVnLiBwb3NpdGlvbiBvZiB0aGUgcGxheWVyIGlzIGhlYWQsIGFuZCB5b3Ugc2V0IHRoZWlyXG5cdFx0Ly8gcG9zaXRpb24gdG8gKDAsIDApLCB0aGVpciBoZWFkIHdpbGwgYmUgYXQgKDAsIDApXG5cdFx0Ly8gY3VycmVudGx5IHRoZSByZWdpc3RyYXRpb24gcG9zaXRpb24gaXMgc2V0IHRvIHRoZSBtaWRkbGUgb2YgdGhlIGJvZHlcblx0XHQvLyB0byBtYXRjaCB3aGF0IGJveDJkIGRvZXNcblx0XHQvLyBsYXN0IHR3byBhcmd1bWVudHMgYXJlIG9wdGlvbmFsIGFuZCBzZXQgUElYRUwgb2Zmc2V0IGZyb20gdGhlIG5vcm1hbCByZWdpc3RyYXRpb25cblx0XHQvLyBwb3NpdGlvblxuXHRcdFxuXHRcdC8vIHRoaXMgaWYgc3RhdGVtZW50IHNob3VsZCBiZSB0ZW1wb3Jhcnlcblx0XHRpZihlYXNlbGpzX29iai5pbWFnZSl7XG5cdFx0XHR2YXIgdyA9IGVhc2VsanNfb2JqLmltYWdlLndpZHRoO1x0XG5cdFx0XHR2YXIgaCA9IGVhc2VsanNfb2JqLmltYWdlLmhlaWdodDtcdFxuXHRcdH1lbHNle1xuXHRcdFx0dmFyIHcgPSBlYXNlbGpzX29iai5zcHJpdGVTaGVldC5fZnJhbWVXaWR0aDtcblx0XHRcdHZhciBoID0gZWFzZWxqc19vYmouc3ByaXRlU2hlZXQuX2ZyYW1lSGVpZ2h0O1xuXHRcdH07XG5cblx0XHR2YXIgb2Zmc2V0X3ggPSBvZmZzZXRfeCB8fCAwO1xuXHRcdHZhciBvZmZzZXRfeSA9IG9mZnNldF95IHx8IDA7XG5cblx0XHRlYXNlbGpzX29iai5yZWdYID0gdy8yICsgb2Zmc2V0X3g7XG5cdFx0ZWFzZWxqc19vYmoucmVnWSA9IGgvMiArIG9mZnNldF95O1xuXG5cdH07XG5cblx0dmFyIHJlZ19mb3JfcmVuZGVyID0gZnVuY3Rpb24oZWFzZWxqc19vYmosIHBoeXNpY2FsX2JvZHkpe1xuXHRcdC8vIHJlZ2lzdGVyZXMgb2JqZWN0IGZvciByZW5kZXJpbmcgd2l0aGluIGdyYXBoaWNzIGNvbnRyb2xsZXJcblx0XHQvLyBpZiAoT1BUSU9OQUwhKSBwaHlzaWNhbF9ib2R5IGlzIGdpdmVuLCBncmFwaGljcyBjb250cm9sbGVyIHdpbGwgYXV0b21hdGljYWxseVxuXHRcdC8vIHNldCB0aGUgZWFzZWxqc19vYmoncyBwb3NpdGlvbiB0byBwb3NpdGlvbiBvZiB0aGF0IGJvZHksIGVhY2ggdGljay5cblx0XHRcdFxuXHRcdGlmKHBoeXNpY2FsX2JvZHkpe1xuXG5cdFx0XHRlYXNlbGpzX29iai5ib2R5ID0gcGh5c2ljYWxfYm9keTtcblx0XHRcdEdyYXBoaWNzTW9kZWwuYWxsX3BoeXNpY2FsLnB1c2goZWFzZWxqc19vYmopO1xuXHRcdH1cblxuXG5cdFx0QWRkVG9TdGFnZShlYXNlbGpzX29iaik7XG5cdH07XG5cblx0dmFyIEFkZFRvU3RhZ2UgPSBmdW5jdGlvbihlbGVtZW50KXtcblx0XHQvLyBjYW4gYmUgdXBkYXRlZCBsYXRlciB0byBtYW5hZ2Ugei1pbmRleCBvciB3aGF0ZXZlclxuXHRcdEdyYXBoaWNzTW9kZWwuc3RhZ2UuYWRkQ2hpbGQoZWxlbWVudCk7XG5cdH07XG5cblx0dmFyIGdldF9zdGFnZSA9IGZ1bmN0aW9uKCl7XG5cdFx0cmV0dXJuIEdyYXBoaWNzTW9kZWwuc3RhZ2U7XG5cdH07XG5cblx0cmV0dXJuIHtcblx0XHQvLyBkZWNsYXJlIHB1YmxpY1xuXHRcdGluaXQ6IGluaXQsIFxuXHRcdHVwZGF0ZTogdXBkYXRlLFxuXHRcdGdldF9zdGFnZTogZ2V0X3N0YWdlLFxuXHRcdGNoYW5nZV9hbnQ6IGNoYW5nZV9hbnQsXG5cdH07XG59KSgpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEdyYXBoaWNzQ29udHJvbGxlcjtcblxudmFyIEluY2x1ZGVzID0gcmVxdWlyZShcIi4uL0luY2x1ZGVzLmpzXCIpOyB2YXIgaW5jbHVkZV9kYXRhID0gSW5jbHVkZXMuZ2V0X2luY2x1ZGVfZGF0YSh7XG5cdGN1cnJlbnRfbW9kdWxlOiBcIkdyYXBoaWNzQ29udHJvbGxlclwiLCBcblx0aW5jbHVkZV9vcHRpb25zOiBJbmNsdWRlcy5jaG9pY2VzLkRFRkFVTFRcbn0pOyBldmFsKGluY2x1ZGVfZGF0YS5uYW1lX3N0YXRlbWVudHMpOyB2YXIgaW5jbHVkZSA9IGZ1bmN0aW9uKCl7ZXZhbChpbmNsdWRlX2RhdGEubW9kdWxlX3N0YXRlbWVudHMpO31cblxuIiwidmFyIEluaXRDb250cm9sbGVyID0gKGZ1bmN0aW9uKCl7XG5cdC8vIHdoeSBkbyB5b3Ugd2FudCB0byBwdXQgaW5pdGlhbGl6YXRpb24gb2YgZXZlcnl0aGluZyBpbnRvIHRoZSBJbml0Q29udHJvbGxlcj9cblx0Ly8gQmVjYXVzZSBpZiBpbml0aWFsaXphdGlvbiBvZiBzbXRoIGRlcGVuZHMgb24gaW5pdGlhbGl6YXRpb24gb2Ygc210aCBlbHNlLFxuXHQvLyBpdCdzIGVhc2llciB0byBjb250cm9sIGhlcmVcblx0Ly9cblx0Ly8gZS5nLiBpZiB5b3UgdHJ5IHRvIGRvIHZhciBmb28gPSAkKCcjZm9vJyk7IHNvbWV3aGVyZSBpbiBvdGhlciBtb2R1bGUsXG5cdC8vIHlvdSBjYW4gZ2V0IGZvbyA9IG51bGw7IGFzIGNvZGUgb2YgdGhhdCBtb2R1bGUgY2FuIGV4ZWN1dGUgYmVmb3JlIHRoZSBodG1sIGRvY3VtZW50XG5cdC8vIHdhcyBmdWxseSBsb2FkZWQsIGJ1dCA+SW5pdENvbnRyb2xsZXIuaW5pdDwgaXMgY2FsbGVkIGFmdGVyIGRvY3VtZW50IHdhcyBsb2FkZWQsIHNvXG5cdC8vIC0xIHBvdGVudGlhbCBwcm9ibGVtLiBCdHcsIGF0IHRoaXMgbW9tZW50IGluIHRpbWUgdGhlIHRoZSBzdHVmZiBpcyBzZXQgdG8gd29yayB0aGF0IHdheVxuXHQvLyB1c2luZyBodG1sICg8Ym9keSBvbmxvYWQ9Li4uKTsgbWF5YmUgdXNpbmcgSlMgd291bGQgYmUgYmV0dGVyPyBJZGs7XG5cdFx0XG5cblx0dmFyIGluaXQgPSBmdW5jdGlvbihtb2RlKXtcblx0XHRpbmNsdWRlKCk7XG5cblx0XHRlbmFibGVfYXJyb3drZXlfc2Nyb2xsKGZhbHNlKTtcblx0XHRzZXR1cF9zY3JlZW4oKTtcblx0XHRzZXR1cF9ldmVudHMoKTtcblxuXHRcdGluaXRfYWxsX21vZHVsZXMobW9kZSk7IC8vIGNhbGwgLmluaXQgZnVuY3Rpb24gb2YgZXZlcnlvbmUuIGUuZy4gUGxheWVyQ29udHJvbGxlci5pbml0KCk7IGV0Yy5cblxuXHRcdFxuXHRcdC8vIE5vdGljZSB0aGF0IGFzc2V0IGRlcGVuZGVudCBzdHVmZiBkb2Vzbid0IChhbmQgbXVzdG4ndCkgc3RhcnQgdW50aWxcblx0XHQvLyBhbGwgYXNzZXRzIGFyZSBjb21wbGV0ZWx5IGxvYWRlZC4gVGhhdCBpbmNsdWRlcyB0aWNrZXIsIGkuZS4gbm8gdGlja3MgYXJlIHByb2Nlc3NlZFxuXHRcdC8vIHVudGlsIGV2ZXJ5dGhpbmcgaXMgbG9hZGVkLiBJZiB5b3Ugd2FudCBzb21ldGhpbmcgZGlmZmVyZW50LCBlLmcuIGRpc3BsYXkgc29tZSBzb3J0IG9mIGxvYWRpbmdcblx0XHQvLyBhbmltYXRpb24gLSBsZXQgbWUga25vdy5cblx0XHQvLyBMb29rIGludG8gdGhlIHNldHVwX2Fzc2V0X2RlcGVuZGVudCBmdW5jdGlvblxuXHRcdFx0QXNzZXRNb2RlbC5sb2FkZXIgPSBuZXcgY3JlYXRlanMuTG9hZFF1ZXVlKGZhbHNlKTsgLy8gbG9hZGluZyByZXNvdXJzZXMgdXNpbmcgcHJlbG9hZC5qc1xuXHRcdFx0QXNzZXRNb2RlbC5sb2FkZXIuYWRkRXZlbnRMaXN0ZW5lcihcImNvbXBsZXRlXCIsIHNldHVwX2Fzc2V0X2RlcGVuZGFudCk7XG5cblx0XHQvLyBpZiBtb3JlIHN0dWZmIG5lZWRzIHRvIGJlIGRvbmUgZm9yIHRoZSB0ZXN0IG1vZGUsIFxuXHRcdC8vIG9yIG1vcmUgdHlwZXMgb2YgaXQgbmVlZHMgdG8gYmUgYWRkZWRcblx0XHQvLyB5b3UgY2FuIHNhZmVseSBtYWtlIHRoZSBmb2xsb3dpbmcgYSBzZXBhcmF0ZSBmdW5jdGlvblxuXHRcdFx0dmFyIGFzc2V0X3BhdGggPSAobW9kZSA9PSBcInRlc3RcIikgPyBcIi4vYXNzZXRzL2FydC9cIiA6IFwiLi4vR2FtZUNvZGUvYXNzZXRzL2FydC9cIjtcblxuXHRcdEFzc2V0Q29udHJvbGxlci5pbml0KGFzc2V0X3BhdGgpO1xuXG5cdH07XG5cblx0dmFyIGluaXRfYWxsX21vZHVsZXMgPSBmdW5jdGlvbihtb2RlKXtcblx0XHQvLyBUT0RPOiBiZXR0ZXIgd2F5IHRvIGRvIHN0dWZmIGxpa2UgdGhhdCAoY2FsbCBjZXJ0YWluIGZ1bmN0aW9uXG5cdFx0Ly8gb2YgZXZlcnkgbW9kdWxlIGluIHRoZSBvcmRlci4gXG5cdFx0Ly8gQWxzbywgaW5pdCBhbmQgdXBkYXRlIGZ1bmN0aW9ucyBvZiBlYWNoIG1vZHVsZSBzaG91bGQgcHJvYmFibHlcblx0XHQvLyBhY2NlcHQgc29tZSBhcmd1bWVudC4gSSB0aGluayB0byBtYWtlIHRoaXMgYXJndW1lbnQgYW4gb2JqZWN0LFxuXHRcdC8vIHRoaXMgd2F5IHdlIGNhbiBhZGQgbW9yZSB0aGluZ3MgdG8gYmUgcGFzc2VkIHcvbyBhbnkgcHJvYmxlbSBhbmRcblx0XHQvLyB3ZSB3b24ndCBuZWVkIHRvIGNoYW5nZSBhbnl0aGluZ1xuXHRcdFxuXHRcdEIyZC5pbml0KCk7IC8vIGdvZXMgZmlyc3RcblxuXHRcdC8vQXNzZXRDb250cm9sbGVyLmluaXQoKTsgLy8gY2FsbGVkIGZyb20gdGhlIEluaXRDb250cm9sbGVyLmluaXQvLyBzdHVmZiBoYXMgdG8gY2hhbmdlXG5cdFx0R2FtZUNvbnRyb2xsZXIuaW5pdCgpO1xuXHRcdEtleWJvYXJkQ29udHJvbGxlci5pbml0KCk7XG5cdFx0UGh5c2ljc0NvbnRyb2xsZXIuaW5pdCgpO1xuXG5cdFx0VGVzdENvbnRyb2xsZXIuaW5pdChtb2RlKTtcblxuXHRcdFBsYXllckNvbnRyb2xsZXIuaW5pdCgpO1xuXHRcdFRlcnJhaW5Db250cm9sbGVyLmluaXQoKTtcblx0XHRUZXJyYWluU2xpY2VDb250cm9sbGVyLmluaXQoKTtcblx0XHRXb3JsZENvbnRyb2xsZXIuaW5pdCgpO1xuXG5cdFx0Ly8gV0FSTklORyEhISBHcmFwaGljc0NvbnRyb2xsZXIuaW5pdCBpcyBjYWxsZWQgZnJvbSB0aGVcblx0XHQvLyBzZXR1cF9hc3NldF9kZXBlbmRlbnQgZnVuY3Rpb24gYXMgaXQsIHdlbGwsIGRlcGVuZHMgb24gYXNzZXRzIGJlaW5nIGxvYWRlZFxuXG5cdH07XG5cblxuXHR2YXIgZW5hYmxlX2Fycm93a2V5X3Njcm9sbCA9IGZ1bmN0aW9uKGVuYWJsZV9zY3JvbGwpe1xuXHRcdGlmKGVuYWJsZV9zY3JvbGwgPT0gZmFsc2UpeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcblx0XHRcdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBmdW5jdGlvbihlKXsgLy8gLmdldEVsZW1lbnRCeUlkKFwiZGlzcGxheV9jYW52YXNcIilcblx0XHRcdFx0YXJyb3dzID0gWzM3LCAzOCwgMzksIDQwXTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcblx0XHRcdFx0aWYoYXJyb3dzLmluZGV4T2YoZS5rZXlDb2RlKSA+IC0xKXsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcblx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuXHRcdFx0XHR9ZWxzZXsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuXHRcdFx0XHRcdHJldHVybiB0cnVlICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcblx0XHRcdFx0fSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcblx0XHRcdH0pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuXHRcdH1cdFx0XG5cdH07XG5cdFxuXHR2YXIgc2V0dXBfc2NyZWVuID0gZnVuY3Rpb24oKXtcblxuXHRcdC8vIFNldHRpbmcgdXAgb3RoZXIgc3R1ZmY6XG5cdFx0Ly8gZS5nIHNldHVwIGNhbnZhcyBzaXplXG5cdFx0XG5cdFx0Ly8gVE9ETzogYWxsb3cgcmVzaXplcz9cblxuXHRcdENvbmZpZy5TQ1JFRU5fVyA9ICQoJyNjYW52YXNfY29udGFpbmVyJykud2lkdGgoKTsgLy8gaXMgZHluYW1pY2FsbHkgc2V0IHRvIHBpeGVsIHdpZHRoIG9mIHRoZSBjb250YWluaW5nIGVsZW1lbnRcblxuXHRcdC8vIHBvc3NpYmxlIHJlc2l6aW5nIHRlY2huaXF1ZTogXG5cdFx0Ly8gaHR0cDovL3d3dy5mYWJpb2Jpb25kaS5jb20vYmxvZy8yMDEyLzA4L2NyZWF0ZWpzLWFuZC1odG1sNS1jYW52YXMtcmVzaXplLWZ1bGxzY3JlZW4tYW5kLWxpcXVpZC1sYXlvdXRzL1xuXG5cdFx0XG5cdFx0Ly8kKCcjZGVidWdfY2FudmFzJykud2lkdGgoU3RyaW5nKFNDUkVFTl9XKSArIFwicHhcIik7XG5cdFx0Ly8kKCcjZGlzcGxheV9jYW52YXMnKS53aWR0aChTdHJpbmcoU0NSRUVOX1cpICsgXCJweFwiKTtcblxuXHRcdC8vJCgnI2RlYnVnX2NhbnZhcycpLmhlaWdodChTdHJpbmcoU0NSRUVOX0gpICsgXCJweFwiKTtcblx0XHQvLyQoJyNkaXNwbGF5X2NhbnZhcycpLmhlaWdodChTdHJpbmcoU0NSRUVOX0gpICsgXCJweFwiKTtcblx0XHRcblx0fTtcblxuXHR2YXIgc2V0dXBfdGlja2VyID0gZnVuY3Rpb24oKXtcblxuXHRcdGNyZWF0ZWpzLlRpY2tlci5zZXRGUFMoQ29uZmlnLkZQUyk7XG5cblx0XHQvLyB0aWNrZXI6IG9uIGVhY2ggdGljayBjYWxsIEdhbWVDb250cm9sbGVyLnVwZGF0ZV9hbGwoKTtcblx0XHRjcmVhdGVqcy5UaWNrZXIuYWRkRXZlbnRMaXN0ZW5lcihcInRpY2tcIiwgR2FtZUNvbnRyb2xsZXIudXBkYXRlX2FsbCk7XG5cblx0XG5cdH07XG5cblx0dmFyIHNldHVwX2V2ZW50cyA9IGZ1bmN0aW9uKCl7XG5cblxuXHRcdC8vIGtleWJvYXJkIGlucHV0IGV2ZW50OiBvbiBlYWNoIGtleWJvYXJkIGV2ZW50IGNhbGwgYXBwcm9wcmlhdGUgS2V5Ym9hcmRDb250cm9sbGVyIGZ1bmN0aW9uXG5cdFx0ZG9jdW1lbnQub25rZXlkb3duID0gS2V5Ym9hcmRDb250cm9sbGVyLmtleWRvd247XG5cdFx0ZG9jdW1lbnQub25rZXl1cCA9IEtleWJvYXJkQ29udHJvbGxlci5rZXl1cDtcblxuXHRcdFx0Ly8gb24gaW50ZXJydXB0IGV2ZW50OiBzdG9wL3BhdXNlIHRpY2tlciA/XG5cblx0fTtcblxuXHR2YXIgc2V0dXBfYXNzZXRfZGVwZW5kYW50ID0gZnVuY3Rpb24oKXtcblx0XHQvLyB0aGlzIG1heSBuZWVkIHRvIG1vdmUgdG8gZWl0aGVyIGxvYWRfZ2FtZSBvciBzb21lIHNvcnQgb2YgcmVzaXppbmcgZnVuY3Rpb25cblx0XHRcblx0XHRBbnRDb250cm9sbGVyLmluaXQoKTtcblx0XHRHcmFwaGljc0NvbnRyb2xsZXIuaW5pdCgpO1xuXG5cblx0XHRzZXR1cF90aWNrZXIoKTtcblxuXHRcdC8vVGVycmFpbkNvbnRyb2xsZXIuZ2VuZXJhdGVfdGVycmFpbigpOyAvLyBJbml0aWFsIHRlcnJhaW4gZ2VuZXJhdGlvbiAvLyBkZXByZWNhdGVkLCBnZW5lcmF0aW9uIHdpbGwgYmUgY2FsbGVkIGZyb20gdXBkYXRlIGVhY2ggdGlja1xuXHR9O1xuXG5cblx0cmV0dXJuIHtcblx0XHRpbml0OiBpbml0LFxuXHR9O1xufSkoKTtcblxubW9kdWxlLmV4cG9ydHMgPSBJbml0Q29udHJvbGxlcjtcblxudmFyIEluY2x1ZGVzID0gcmVxdWlyZShcIi4uL0luY2x1ZGVzLmpzXCIpOyB2YXIgaW5jbHVkZV9kYXRhID0gSW5jbHVkZXMuZ2V0X2luY2x1ZGVfZGF0YSh7XG5cdGN1cnJlbnRfbW9kdWxlOiBcIkluaXRDb250cm9sbGVyXCIsIFxuXHRpbmNsdWRlX29wdGlvbnM6IEluY2x1ZGVzLmNob2ljZXMuQUxMXG59KTsgZXZhbChpbmNsdWRlX2RhdGEubmFtZV9zdGF0ZW1lbnRzKTsgdmFyIGluY2x1ZGUgPSBmdW5jdGlvbigpe2V2YWwoaW5jbHVkZV9kYXRhLm1vZHVsZV9zdGF0ZW1lbnRzKTt9XG5cbiIsInZhciBLZXlib2FyZENvbnRyb2xsZXIgPSAoZnVuY3Rpb24oKVxue1xuXHQvLyBUT0RPOiBkb2VzIHRoaXMgc2VjdGlvbiBiZWxvbmcgaW50byB0aGUgY29udHJvbGxlcj8gPj4+XG5cdHZhciBrZXlzID0ge307XG5cblx0dmFyIFRSX1RBQkxFUyA9IC8vIHRyYW5zbGF0aW9uIHRhYmxlc1xuXHR7XG5cdFx0Y29kZV90b19uYW1lOiB7XG5cdFx0XHQzNzogXCJsZWZ0XCIsXG5cdFx0XHQzODogXCJ1cFwiLFxuXHRcdFx0Mzk6IFwicmlnaHRcIixcblx0XHRcdDQwOiBcImRvd25cIlxuXHRcdH1cblx0fVxuXG5cdC8vIDw8PCBlbmQgVE9ET1xuXG5cdHZhciBpbml0ID0gZnVuY3Rpb24oKXtcblx0XHRcblx0XHRpbmNsdWRlKCk7XG5cdH07XG5cdFxuXHR2YXIgZ2V0X2FjdGl2ZV9jb21tYW5kc19mdW5jdGlvbiA9IGZ1bmN0aW9uKHRhYmxlKXtcblx0XHQvLyBnZXQgYWxsIGNvbW1hbmRzIGFzc29jaWF0ZWQgd2l0aCBrZXlzIHRoYXQgYXJlIGRlZmluZWQgaW4gdGhlID50YWJsZTwsXG5cdFx0Ly8gYW5kIGFyZSBjdXJyZW50bHkgcHJlc3NlZFxuXHRcdC8vXG5cdFx0Ly8gcmV0dXJuczogYXJyYXkgb2YgY29tbWFuZHNcblx0XHRcblx0XHR2YXIgY29tbWFuZHMgPSBbXTtcblx0XHRcblx0XHQkLmVhY2godGFibGUsIGZ1bmN0aW9uKGtleSwgY21kKXtcblx0XHRcdGlmKGtleXNba2V5XSl7XG5cdFx0XHRcdGNvbW1hbmRzLnB1c2goY21kKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHZhciBnZXRfa2V5ID0gZnVuY3Rpb24oa2V5KXtcblx0XHRcdGlmKGNvbW1hbmRzLmluZGV4T2Yoa2V5KSA+IC0xKXtcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9ZWxzZXtcblx0XHRcdFx0cmV0dXJuIGZhbHNlXG5cdFx0XHR9O1xuXHRcdH07XG5cblx0XHRyZXR1cm4gZ2V0X2tleTtcblx0fTtcblxuXHQvLyBwdWJsaWM6XG5cdFxuXHR2YXIga2V5ZG93biA9IGZ1bmN0aW9uKGV2ZW50KXtcblx0XHRrZXlzW2V2ZW50LmtleUNvZGVdID0gdHJ1ZTtcblx0fTtcblxuXHR2YXIga2V5dXAgPSBmdW5jdGlvbihldmVudCl7XG5cdFx0ZGVsZXRlIGtleXNbZXZlbnQua2V5Q29kZV07XG5cdH07XG5cblxuXHR2YXIgbW92ZW1lbnRfY29tbWFuZHMgPSBmdW5jdGlvbigpe1xuXHRcdHJldHVybiBnZXRfYWN0aXZlX2NvbW1hbmRzX2Z1bmN0aW9uKFRSX1RBQkxFUy5jb2RlX3RvX25hbWUpO1xuXHR9O1xuXG5cblx0cmV0dXJuIHtcblx0XHRrZXlkb3duOiBrZXlkb3duLFxuXHRcdGtleXVwOiBrZXl1cCxcblxuXHRcdG1vdmVtZW50X2NvbW1hbmRzOiBtb3ZlbWVudF9jb21tYW5kcyxcblx0XHRpbml0OiBpbml0LFxuXHR9O1xuXG59KSgpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEtleWJvYXJkQ29udHJvbGxlcjtcblxudmFyIEluY2x1ZGVzID0gcmVxdWlyZShcIi4uL0luY2x1ZGVzLmpzXCIpOyB2YXIgaW5jbHVkZV9kYXRhID0gSW5jbHVkZXMuZ2V0X2luY2x1ZGVfZGF0YSh7XG5cdGN1cnJlbnRfbW9kdWxlOiBcIktleWJvYXJkQ29udHJvbGxlclwiLCBcblx0aW5jbHVkZV9vcHRpb25zOiBJbmNsdWRlcy5jaG9pY2VzLkRFRkFVTFRcbn0pOyBldmFsKGluY2x1ZGVfZGF0YS5uYW1lX3N0YXRlbWVudHMpOyB2YXIgaW5jbHVkZSA9IGZ1bmN0aW9uKCl7ZXZhbChpbmNsdWRlX2RhdGEubW9kdWxlX3N0YXRlbWVudHMpO31cblxuIiwiLy8gTm90ZXM6XG4vLyBub3RpY2UgdGhhdCB5b3UgY2FuIHJldXNlIGJvZHkgZGVmaW5pdGlvbnMgbXVsdGlwbGUgdGltZXMsIGl0IG1ha2VzIHNlbnNlIHRvIGhhdmVcbi8vIGNvbGxlY3Rpb24gb2YgYm9keSBkZWZpbml0aW9ucyB0aGF0IGFyZSBjb21tb25seSB1c2UgYW5kIG1heWJlIGFsbG93IHNvbWUgc29ydCBvZiBcbi8vIGluaGVyaXRhbmNlIChpLmUuIHlvdSBjYW4gbWFrZSBzb21lIGRlZmluaXRpb24gb24gdG9wIG9mIHRoZSBhbm90aGVyIGRlZmluaXRpb24pXG4vLyAvLyBib2RpZXMgYXJlIGFsbG93ZWQgdG8gaGF2ZSB1c2VyRGF0YSBvbiB0aGVtIHRoYXQgaXMganVzdCByZWZlcmVuY2UgdG8gc29tZSBvYmplY3QuXG4vLyBtYXkgYmUgdXNlZnVsIGluIHNvbWUgc2l0dWF0aW9uc1xuLy9cbi8vIFF1ZXN0aW9uOlxuLy8gZG9lcyBpdCBtYWtlIHNlbnNlIHRvIGFsbG93IHVzZXJzIHRvIHBhc3MgYW55IHByb3BlcnRpZXMgYXMgcGFydCBvZiBvYmplY3QgZGVmaW5pdGlvblxuLy8gYW5kIGp1c3QgYXBwbHkgdGhvc2UgcHJvcGVydGllcyBhdXRvbWF0aWNhbGx5IHRvIHRoZSB1c2VyRGF0YSBwcm9wZXJ0eSBvZiBib2R5P1xuXG52YXIgQjJkQ29uZmlnO1xuXG52YXIgUGh5c2ljc0NvbnRyb2xsZXIgPSAoZnVuY3Rpb24oKXtcblxuXHR2YXIgaW5pdCA9IGZ1bmN0aW9uKCl7XG5cdFx0aW5jbHVkZSgpO1xuXG5cdFx0QjJkQ29uZmlnID0gQ29uZmlnLkIyRDtcblxuXHRcdFBoeXNpY3NNb2RlbC5zY2FsZSA9IEIyZENvbmZpZy5TQ0FMRTtcblx0XHRQaHlzaWNzTW9kZWwuc3RlcF9hbW91bnQgPSAxLyhCMmRDb25maWcuU1BTKTtcblxuXHRcdFBoeXNpY3NNb2RlbC5ncmF2aXR5ID0gbmV3IEIyZC5iMlZlYzIoMCwyMCk7IC8vIGVhcnRoIGdyYXZpdHlcblx0XHRQaHlzaWNzTW9kZWwud29ybGQgPSBuZXcgQjJkLmIyV29ybGQoUGh5c2ljc01vZGVsLmdyYXZpdHksIHRydWUpO1xuXG5cdH07XG5cdFxuXHR2YXIgc3RlcCA9IGZ1bmN0aW9uIChkZWx0YV9tcykge1xuXHRcdC8vICE/IHNob3VsZCBJIHNldCB1cHBlciBsaW1pdCBvbiBkZWx0YSB0byBwcmV2ZW50IHdvcmxkIGZyb21cblx0XHQvLyBmYXN0IGZvcndhcmRpbmcgaWYgdGhlIHRpY2tlciB3YXMgcGF1c2VkPyBvciB0aGF0IGlzIG5vdCBhIHByb2JsZW0gaW4gb3VyIGNhc2U/XG5cdFx0Ly8gaW52ZXN0aWdhdGlvbiBpcyBuZWVkZWRcblxuXHRcdHZhciBkZWx0YSA9IGRlbHRhX21zLzEwMDA7XG5cblx0XHRQaHlzaWNzTW9kZWwudGltZVRvQ292ZXIgKz0gZGVsdGE7XG5cblx0XHR3aGlsZSAoUGh5c2ljc01vZGVsLnRpbWVUb0NvdmVyID4gUGh5c2ljc01vZGVsLnN0ZXBfYW1vdW50KSB7XG5cdFx0XHRQaHlzaWNzTW9kZWwudGltZVRvQ292ZXIgLT0gUGh5c2ljc01vZGVsLnN0ZXBfYW1vdW50O1xuXHRcdFx0UGh5c2ljc01vZGVsLndvcmxkLlN0ZXAoXG5cdFx0XHRcdFBoeXNpY3NNb2RlbC5zdGVwX2Ftb3VudCxcblx0XHRcdFx0QjJkQ29uZmlnLlBPU0lUSU9OX0lUUiwgLy8gdmVsb2NpdHkgaXRlcmF0aW9uc1xuXHRcdFx0XHRCMmRDb25maWcuVkVMT0NJVFlfSVRSIC8vIHBvc2l0aW9uIGl0ZXJhdGlvbnNcblx0XHRcdCk7XG5cdFx0fVxuXHR9OyAgLy8gZW5kIHN0ZXAgXG5cblx0dmFyIGRyYXdfZGVidWcgPSBmdW5jdGlvbigpe1xuXHRcdGlmIChCMmRDb25maWcuZGVidWdfZHJhdykge1xuXHRcdFx0UGh5c2ljc01vZGVsLndvcmxkLkRyYXdEZWJ1Z0RhdGEoKTtcblx0XHR9XG5cdH07XG5cblx0dmFyIGdldF9wYXJlbnRfY2hhaW4gPSBmdW5jdGlvbih0ZW1wbGF0ZSwgZGVmYXVsdF9kZWYpe1xuXHRcdHZhciBuZXh0ID0gdGVtcGxhdGU7XG5cdFx0dmFyIGFuY2VzdG9ycyA9IFtdO1xuXG5cdFx0d2hpbGUobmV4dCAhPSBudWxsKXtcblx0XHRcdGFuY2VzdG9ycy5wdXNoKG5leHQpO1xuXHRcdFx0bmV4dCA9IG5leHRbXCJwYXJlbnRcIl07XG5cdFx0fVxuXG5cdFx0aWYoZGVmYXVsdF9kZWYpe1xuXHRcdFx0YW5jZXN0b3JzLnB1c2goZGVmYXVsdF9kZWYpO1xuXHRcdH1cblxuXHRcdHJldHVybiBhbmNlc3RvcnM7XG5cdFx0XG5cdH07XG5cblx0dmFyIGFwcGx5X3BhcmVudHMgPSBmdW5jdGlvbih0ZW1wbGF0ZV9uYW1lLCB0ZW1wbGF0ZV9jb2xsZWN0aW9uKXtcblx0XHQvLyBUT0RPOiByZWZhY3RvciB0aGUgY29kZSBzbyB0aGlzIHRoaW5nIGlzIGRvbmUgb25seSBvbmNlXG5cdFx0Ly8gYXQgdGhlIGxvYWQgdGltXG5cdFx0Ly8gdGhhdCBjb3VsZCBwcm9iYWJseSBiZSBkb25lIGV2ZW4gZm9yIG90aGVyIHRoaW5ncy5cblx0XHQvLyBpZGVhOiBzdG9yZSBjb21waWxlZCBib2R5L2ZpeHR1cmUgZXRjLiB0b2dldGhlciB3aXRoIHRoZVxuXHRcdC8vIHRlbXBsYXRlLiB0aGlzIHdheSB5b3UnbGwgaGF2ZSBlYXN5IGFjY2VzcyB0byB0aGUgYWxsIGRlZmluZWRcblx0XHQvLyBvcHRpb25zIGZvciBkZWJ1Z2dpbmc7XG5cdFx0XG5cdFx0dmFyIGRlZmF1bHRfdG1wbGF0ZSA9IHRlbXBsYXRlX2NvbGxlY3Rpb25bXCJkZWZhdWx0XCJdO1xuXG5cdFx0dmFyIGNoYWluID0gZ2V0X3BhcmVudF9jaGFpbih0ZW1wbGF0ZV9jb2xsZWN0aW9uW3RlbXBsYXRlX25hbWVdLCBkZWZhdWx0X3RtcGxhdGUpO1xuXG5cdFx0dmFyIGZpbmFsX2RlZmluaXRpb24gPSB7fTtcblxuXHRcdGZvcih2YXIgaSA9IGNoYWluLmxlbmd0aCAtIDE7IGkgPj0gMCA7IGktLSl7XG5cdFx0XHQvLyBtYXkgYmUgbmVlZGVkIHRvIGJlIG1hZGUgbW9yZSBlZmZpY2llbnQgYnkgbW92aW5nIHRoZSBvdGhlciB3YXlcblx0XHRcdC8vIGFuZCBub3QgY29uc2lkZXJpbmcgb3B0aW9ucyB0aGF0IHdlcmUgYWxyZWFkeSBlbmNvdW50ZXJlZCBpbiBjaGlsZHJlblxuXHRcdFx0dmFyIGN1cnJlbnQgPSBjaGFpbltpXTtcblxuXG5cdFx0XHRmb3IodmFyIHByb3AgaW4gY3VycmVudCl7XG5cdFx0XHRcdGZpbmFsX2RlZmluaXRpb25bcHJvcF0gPSBjdXJyZW50W3Byb3BdO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiBmaW5hbF9kZWZpbml0aW9uO1xuXHR9OyAvLyBlbmQgYXBwbHlfcGFyZW50c1xuXHRcdFxuXHR2YXIgdGFyZ2V0X3Byb3BzID0ge1xuXHRcdGJvZHlfZGVmOiBbXG5cdFx0XHRcImFjdGl2ZVwiLFxuXHRcdFx0XCJhbGxvd1NsZWVwXCIsXG5cdFx0XHRcImFuZ2xlXCIsXG5cdFx0XHRcImFuZ3VsYXJEYW1waW5nXCIsXG5cdFx0XHRcImFuZ3VsYXJWZWxvY2l0eVwiLFxuXHRcdFx0XCJhd2FrZVwiLFxuXHRcdFx0XCJidWxsZXRcIixcblx0XHRcdFwiZml4ZWRSb3RhdGlvblwiLFxuXHRcdFx0XCJpbmVydGlhU2NhbGVcIixcblx0XHRcdFwibGluZWFyRGFtcGluZ1wiLFxuXHRcdFx0XCJsaW5lYXJWZWxvY2l0eVwiLFxuXHRcdFx0XCJwb3NpdGlvblwiLFxuXHRcdFx0XCJ0eXBlXCIsXG5cdFx0XHRcInVzZXJEYXRhXCJcblx0XHRdLFxuXHRcdGZpeHR1cmVfZGVmOiBbXG5cdFx0XHRcImRlbnNpdHlcIixcblx0XHRcdC8vXCJmaWx0ZXJcIiwgaW1wbGVtZW50IGxhdGVyIGlmIG5lZWRlZFxuXHRcdFx0XCJmcmljdGlvblwiLFxuXHRcdFx0XCJpc1NlbnNvclwiLFxuXHRcdFx0XCJyZXN0aXR1dGlvblwiLFxuXHRcdFx0XCJzaGFwZVwiLFxuXHRcdFx0XCJ1c2VyRGF0YVwiXG5cdFx0XVxuXHR9O1xuXG5cdHZhciBhcHBseV9wcm9wZXJ0eV9saXN0ID0gZnVuY3Rpb24oc291cmNlLCBkZXN0aW5hdGlvbiwgbGlzdCl7XG5cdFx0LyoqXG5cdFx0ICogdGFrZXMgdHdvIG9iamVjdHMgYW5kIHRoZSBsaXN0IG9mIHN0cmluZ3Ncblx0XHQgKiBjb3BpZXMgYWxsIHByb3BlcnRpZXMgd2l0aCBuYW1lcyBmb3VuZCBpbiB0aGUgbGlzdFxuXHRcdCAqIGZyb20gc291cmNlIHRvIGRlc3RpbmF0aW9uXG5cdFx0ICogc2NpcHMgcHJvcGVydGllcyB3aGljaCBhcmUgbnVsbC91bmRlZmluZWRcblx0XHQgKi9cblxuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKXtcblx0XHRcdHZhciBwcm9wID0gbGlzdFtpXTtcblx0XHRcdGlmKHNvdXJjZVtwcm9wXSAhPSBudWxsKXtcblx0XHRcdFx0ZGVzdGluYXRpb25bcHJvcF0gPSBzb3VyY2VbcHJvcF07XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGRlc3RpbmF0aW9uO1xuXHR9O1xuXG5cdHZhciBQcm9wZXJ0eVVuZGVmaW5lZCA9IGZ1bmN0aW9uIFByb3BlcnR5VW5kZWZpbmVkKHByb3BlcnR5X25hbWUpe1xuXHRcdHRoaXMubmFtZSA9IFwiUHJvcGVydHlVbmRlZmluZWRcIjtcblx0XHR0aGlzLm1lc3NhZ2UgPSBcIkVycm9yOiBcIiArIHByb3BlcnR5X25hbWUgKyBcIiBpcyBub3QgZGVmaW5lZFwiO1xuXHR9O1xuXHRQcm9wZXJ0eVVuZGVmaW5lZC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEVycm9yLnByb3RvdHlwZSk7XG5cdFByb3BlcnR5VW5kZWZpbmVkLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFByb3BlcnR5VW5kZWZpbmVkO1xuXG5cdHZhciBnZXRfZm9ybWFsX2JvZHlfZGVmID0gZnVuY3Rpb24obm9uX2Zvcm1hbF9kZWYpe1xuXHRcdC8qKlxuXHRcdCAqIHR1cm4gbm9uIGZvcm1hbCBkZWZpbml0aW9uIGludG8gdGhlIGZvcm1hbCBvbmVcblx0XHQgKiBub24tZm9ybWFsIGRlZmluaXRpb24gaXMgYW4gb2JqZWN0IHRoYXQgY29udGFpbnNcblx0XHQgKiBwcm9wZXJ0aWVzIFNPTUUgb2Ygd2hpY2ggYXJlIGJveDJkIHByb3BlcnRpZXMgb3IgYXJlIFxuXHRcdCAqIGludGVuZGVkIHRvIGJlIHRyYW5zZm9ybWVkIGludG8gc3VjaC4gRS5nLiB0aGUgbm9uLWZvcm1hbFxuXHRcdCAqIGRlZmluaXRpb24gbWF5IGNvbnRhaW4gcHJvcGVydGllcyB2eCBhbmQgdnkgd2hpY2ggd2lsbCBiZSB0cmFuc2Zvcm1lZFxuXHRcdCAqIGludG8gdGhlIGxpbmVhclZlbG9jaXR5IHZlY3RvciBpbiB0aGUgZm9ybWFsIGRlZmluaXRpb25cblx0XHQgKi9cblxuXHRcdHZhciBuZmRlZiA9IG5vbl9mb3JtYWxfZGVmO1xuXG5cdFx0dmFyIGRlZmluaXRpb24gPSBuZXcgQjJkLmIyQm9keURlZigpO1xuXG5cdFx0aWYobmZkZWYudnggIT0gbnVsbCAmJiBuZmRlZi52eSAhPSBudWxsKXtcblx0XHRcdC8vIGNoZWNrIGZvciBpbmZvcm1hbCBwYXJhbWV0ZXIgc3BlY2lmaWNhdGlvbiBmaXJzdFxuXHRcdFx0bmZkZWYubGluZWFyVmVsb2NpdHkgPSBuZXcgQjJkLmIyVmVjMihuZmRlZi52eCwgbmZkZWYudnkpO1xuXHRcdH1lbHNle1xuXHRcdFx0Ly8gbWF5YmUgdGhlIGxpbmVhclZlbG9jaXR5IHdhcyBzcGVjaWZpZWQgZGlyZWN0bHkgYXMgdmVjdG9yLFxuXHRcdFx0Ly8gYW5kIG5vdCB0aHJvdWdoIGluZm9ybWFsIHBhcmFtZXRlcnM7IGNoZWNraW5nIHRoYXQsIGFuZCBpZiBub3QsXG5cdFx0XHQvLyBleGNlcHRpb25cblx0XHRcdGlmKCEobmZkZWYubGluZWFyVmVsb2NpdHkpKXtcblx0XHRcdFx0dGhyb3cgbmV3IFByb3BlcnR5VW5kZWZpbmVkKFwibGluZWFyVmVsb2NpdHlcIik7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYobmZkZWYueCAhPSBudWxsICYmIG5mZGVmLnkgIT0gbnVsbCl7XG5cdFx0XHQvLyBzYW1lIHByb2NlZHVyZSBhcyBmb3IgdGhlIGxpbmVhciB2ZWxvY2l0eVxuXHRcdFx0Ly8gY2hlY2tpbmcgZm9yIGluZm9ybWFsIHNwZWNpZmljYXRpb24gaGVyZVxuXHRcdFx0Ly8gYW5kIGlmIHByZXNlbnQsIHR1cm5pbmcgaW50byB0aGUgZm9ybWFsXG5cdFx0XHRuZmRlZi5wb3NpdGlvbiA9IG5ldyBCMmQuYjJWZWMyKG5mZGVmLngsIG5mZGVmLnkpO1xuXHRcdH1lbHNle1xuXHRcdFx0Ly8gY2hlY2tpbmcgaWYgZm9ybWFsIHdhcyBzcGVjaWZpZWQgZGlyZWN0bHlcblx0XHRcdGlmKCEobmZkZWYucG9zaXRpb24pKXtcblx0XHRcdFx0Ly8gaWYgbm90LCB0aHJvdyBjdXN0b20gZXhjZXB0aW9uXG5cdFx0XHRcdHRocm93IG5ldyBQcm9wZXJ0eVVuZGVmaW5lZChcInBvc2l0aW9uXCIpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmKG5mZGVmLnR5cGUpe1xuXHRcdFx0bmZkZWYudHlwZSA9IHtcblx0XHRcdFx0XCJzdGF0aWNcIjogQjJkLmIyQm9keS5iMl9zdGF0aWNCb2R5LCBcblx0XHRcdFx0XCJkeW5hbWljXCI6IEIyZC5iMkJvZHkuYjJfZHluYW1pY0JvZHksXG5cdFx0XHRcdFwia2luZW1hdGljXCI6IEIyZC5iMkJvZHkuYjJfa2luZW1hdGljQm9keVxuXHRcdFx0fVtuZmRlZi50eXBlXTsgLy8gdHVybiBzdHJpbmctdHlwZSBpbnRvIGIyZCB0eXBlXG5cdFx0fWVsc2V7XG5cdFx0XHR0aHJvdyBuZXcgUHJvcGVydHlVbmRlZmluZWQoXCJ0eXBlXCIpO1xuXHRcdH1cblxuXHRcdGFwcGx5X3Byb3BlcnR5X2xpc3QobmZkZWYsIGRlZmluaXRpb24sIHRhcmdldF9wcm9wcy5ib2R5X2RlZik7XG5cblx0XHRyZXR1cm4gZGVmaW5pdGlvbjtcblxuXHR9O1xuXG5cdHZhciBnZXRfZm9ybWFsX2ZpeHR1cmVfZGVmID0gZnVuY3Rpb24obm9uX2Zvcm1hbF9kZWYpe1xuXHRcdC8qKlxuXHRcdCAqIHR1cm5zIG5vbi1mb3JtYWwgZGVmaW5pdGlvbiBpbnRvIHRoZSBmb3JtYWwgb25lXG5cdFx0ICogc2VlIGdldF9mcm9tYWxfYm9keV9kZWYgZm9yIGV4cGxhbmF0aW9uXG5cdFx0ICovXG5cblx0XHR2YXIgbmZkZWYgPSBub25fZm9ybWFsX2RlZjtcblx0XHR2YXIgc2hhcGUgPSBuZmRlZi5zaGFwZTtcblx0XHR2YXIgZml4dHVyZV9kZWYgPSBuZXcgQjJkLmIyRml4dHVyZURlZigpO1xuXG5cdFx0YXBwbHlfcHJvcGVydHlfbGlzdChub25fZm9ybWFsX2RlZiwgZml4dHVyZV9kZWYsIHRhcmdldF9wcm9wcy5maXh0dXJlX2RlZik7XG5cblx0XHRzd2l0Y2ggKHNoYXBlKSB7XG5cdFx0XHRjYXNlIFwicmVjdGFuZ2xlXCI6XG5cblx0XHRcdFx0aWYobmZkZWYud2lkdGggIT0gbnVsbCAmJiBuZmRlZi5oZWlnaHQgIT0gbnVsbCl7XG5cdFx0XHRcdFx0Zml4dHVyZV9kZWYuc2hhcGUgPSBuZXcgQjJkLmIyUG9seWdvblNoYXBlKCk7XG5cdFx0XHRcdFx0Zml4dHVyZV9kZWYuc2hhcGUuU2V0QXNCb3gobmZkZWYud2lkdGgvMiwgbmZkZWYuaGVpZ2h0LzIpO1xuXHRcdFx0XHR9ZWxzZXtcblx0XHRcdFx0XHR0aHJvdyBuZXcgUHJvcGVydHlVbmRlZmluZWQoXCJ3aWR0aCBvciBoZWlnaHRcIik7XG5cdFx0XHRcdH1cblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIFwicG9seWdvblwiOlxuXG5cdFx0XHRcdGlmKG5mZGVmLnBvaW50cyAhPSBudWxsKXtcblx0XHRcdFx0XHRmaXh0dXJlX2RlZi5zaGFwZSA9IG5ldyBCMmQuYjJQb2x5Z29uU2hhcGUoKTtcblx0XHRcdFx0XHRmaXh0dXJlX2RlZi5zaGFwZS5TZXRBc0FycmF5KG5mZGVmLnBvaW50cywgbmZkZWYucG9pbnRzLmxlbmd0aCk7XG5cdFx0XHRcdH1lbHNle1xuXHRcdFx0XHRcdHRocm93IG5ldyBQcm9wZXJ0eVVuZGVmaW5lZChcInBvaW50c1wiKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgXCJjaXJjbGVcIjpcblxuXHRcdFx0XHRpZihuZmRlZi5yYWRpdXMgIT0gbnVsbCl7XG5cdFx0XHRcdFx0Zml4dHVyZV9kZWYuc2hhcGUgPSBuZXcgQjJkLmIyQ2lyY2xlU2hhcGUobmZkZWYucmFkaXVzKTtcblx0XHRcdFx0fWVsc2V7XG5cdFx0XHRcdFx0dGhyb3cgbmV3IFByb3BlcnR5VW5kZWZpbmVkKFwicmFkaXVzXCIpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0dGhyb3cgXCJFcnJvcjogc2hhcGUgbXVzdCBiZSBvbmUgb2YgdGhlIGZvbGxvd2luZzogXCIgKyBcblx0XHRcdFx0XHQnXCJwb2x5Z29uXCIsIFwicmVjdGFuZ2xlXCIsIFwiY2lyY2xlXCIuIFlvdSBzcGVjaWZpZWQ6ICcgK1xuXHRcdFx0XHRcdFN0cmluZyhzaGFwZSk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZpeHR1cmVfZGVmO1xuXG5cdH07XG5cdFxuXG5cdHZhciBnZXRfYm9keSA9IGZ1bmN0aW9uKG5vbl9mb3JtYWxfZGVmKXtcblx0XHQvKipcblx0XHQgKiB0YWtlcyBub24tZm9ybWFsIGRlZmluaXRpb25cblx0XHQgKiByZXR1cm5zIGJvZHkgYmFzZWQgb24gdGhpcyBkZWZpbml0aW9uXG5cdFx0ICpcblx0XHQgKi9cblx0XHR2YXIgZGVmaW5pdGlvbiA9IGdldF9mb3JtYWxfYm9keV9kZWYobm9uX2Zvcm1hbF9kZWYpO1xuXG5cdFx0dmFyIGJvZHkgPSBQaHlzaWNzTW9kZWwud29ybGQuQ3JlYXRlQm9keShkZWZpbml0aW9uKTtcblxuXHRcdGlmKGJvZHkudXNlckRhdGEgPT0gbnVsbCl7XG5cdFx0XHRib2R5LnVzZXJEYXRhID0ge307XG5cdFx0fVxuXG5cdFx0Ly8gYXBwZW5kIHBhc3NlZCBkZWZpbml0aW9uIHRvIHRoZSB1c2VyIGRhdGEgb2YgdGhlIGJvZHlcblx0XHQvLyBmb3IgZGVidWdnaW5nIHB1cnBvc2VzLCBhbmQgYWxzbyB0byBhbGxvdyBlYXN5IHNwZWNpZmljYXRpb24gb2YgXG5cdFx0Ly8gY3VzdG9tIHBhcmFtZXRlcnMgZHVyaW5nIGRlZmluaXRpb24uIElmIHRoaXMgd2lsbCBjYXVzZSBjb25mdXNpb24sXG5cdFx0Ly8gSSdsbCByZW1vdmUgdGhhdFxuXHRcdGJvZHkudXNlckRhdGEuZGVmID0gbm9uX2Zvcm1hbF9kZWY7XG5cblx0XHRyZXR1cm4gYm9keTtcblx0XG5cdH07XG5cblx0dmFyIGF0dGFjaF9maXh0dXJlID0gZnVuY3Rpb24oYm9keSwgbm9uX2Zvcm1hbF9kZWYsIGZpeHR1cmVfZGVzY3JpcHRpb24pe1xuXHRcdC8qKlxuXHRcdCAqIGdpdmVuIGIyZCBib2R5LCAobm9uLWZvcm1hbCkgZml4dHVyZSBkZWZpbml0aW9uIGFuZCAoT1BUSU9OQUwpIGZpeHR1cmVfZGVzY3JpcHRpb25cblx0XHQgKiB0aGlzIGZ1bmN0aW9uIGF0dGFjaGVzIGZpeHR1cmUgdG8gdGhlIGJvZHlcblx0XHQgKi9cblxuXHRcdHZhciBmaXh0dXJlX2RlZiA9IGdldF9mb3JtYWxfZml4dHVyZV9kZWYobm9uX2Zvcm1hbF9kZWYpO1xuXG5cdFx0aWYoZml4dHVyZV9kZWYudXNlckRhdGEgPT0gbnVsbCl7XG5cdFx0XHRmaXh0dXJlX2RlZi51c2VyRGF0YSA9IHt9O1xuXHRcdH1cblxuXHRcdGZpeHR1cmVfZGVmLnVzZXJEYXRhLmRlZiA9IG5vbl9mb3JtYWxfZGVmO1xuXHRcdGZpeHR1cmVfZGVmLnVzZXJEYXRhLmRlc2NyaXB0aW9uID0gZml4dHVyZV9kZXNjcmlwdGlvbjtcblx0XHRcblx0XHQvL2lmIG9mZnNldCBpcyBkZWZpbmVkLCBzZXQgdGhlIG9mZnNldCBvZiB0aGUgZml4dHVyZSBoZXJlXG5cdFx0Ly8gb2Zmc2V0IGlzIG9mIHRoZSBmb3JtIHt4OiBudW1iZXIsIHk6IG51bWJlcn1cblx0XHRpZihub25fZm9ybWFsX2RlZi5vZmZzZXQgIT0gbnVsbCl7XG5cdFx0XHRmaXh0dXJlX2RlZi5wb3NpdGlvbiA9IG5vbl9mb3JtYWxfZGVmLm9mZnNldDtcblx0XHR9XG5cdFx0XG5cdFx0Ym9keS5DcmVhdGVGaXh0dXJlKGZpeHR1cmVfZGVmKTtcblx0XHRcblx0fTtcblxuXHQvL25vbl9mb3JtYWxfZGVmIGNsYXNzLCB1c2VkIHRvIGNvbnRhaW4gaW5mb3JtYWwgZGF0YVxuXHR2YXIgbm9uX2Zvcm1hbF9kZWYgPSBmdW5jdGlvbigpe1xuXHRcdHZhciBzaGFwZSxkZW5zaXR5LGlzU2Vuc29yLGhlaWdodCx3aWR0aCxvZmZzZXQ7XG5cdH1cblx0XG5cdFxuXHR2YXIgYXR0YWNoX3NlbnNvcnMgPSBmdW5jdGlvbihib2R5KXtcblx0XHQvLyBnZXQgdGhlIHdpZHRoIGFuZCBoZWlnaHQgb2YgdGhlIGJvZHkncyBtYWluIGZpeHR1cmVcblx0XHQvLyBhbmQgY3JlYXRlIDQgc2Vuc29yIGZpeHR1cmVzIGJhc2VkIG9uIHRob3NlIHBhcmFtZXRlcnNcblx0XHQvLyBjYWxjdWxhdGUgb2Zmc2V0IG9mIHNlbnNvcnMgc28gdGhhdCB0aGV5IG1hdGNoIHRoZSBtYWluIGZpeHR1cmVcblx0XHR2YXIgeCA9IGJvZHkuR2V0UG9zaXRpb24oKS54O1xuXHRcdHZhciB5ID0gYm9keS5HZXRQb3NpdGlvbigpLnk7XG5cdFx0dmFyIGggPSBib2R5LkdldEZpeHR1cmVMaXN0KCkuR2V0QUFCQigpLkdldEV4dGVudHMoKS54O1xuXHRcdHZhciB3ID0gYm9keS5HZXRGaXh0dXJlTGlzdCgpLkdldEFBQkIoKS5HZXRFeHRlbnRzKCkueTtcblx0XHRcblx0XHQvL2F0dGFjaCB0b3AgZml4dHVyZVxuXHRcdHZhciB0b3Bfc2Vuc29yID0ge307XG5cdFx0dG9wX3NlbnNvci5zaGFwZSA9IFwicmVjdGFuZ2xlXCI7XG5cdFx0dG9wX3NlbnNvci5kZW5zaXR5ID0gMDtcblx0XHR0b3Bfc2Vuc29yLmlzU2Vuc29yID0gdHJ1ZTtcblx0XHR0b3Bfc2Vuc29yLmhlaWdodCA9IDAuMTtcblx0XHR0b3Bfc2Vuc29yLndpZHRoID0gdyoyO1xuXHRcdHRvcF9zZW5zb3Iub2Zmc2V0ID0ge3g6MCwgeTooLTEqaCl9O1xuXHRcdGF0dGFjaF9maXh0dXJlKGJvZHksdG9wX3NlbnNvcixcInRvcCBzZW5zb3JcIik7XG5cblx0XHQvL2F0dGFjaCBib3R0b20gZml4dHVyZVxuXHRcdHZhciBib3R0b21fc2Vuc29yID0ge31cblx0XHRib3R0b21fc2Vuc29yLnNoYXBlID0gXCJyZWN0YW5nbGVcIjtcblx0XHRib3R0b21fc2Vuc29yLmRlbnNpdHkgPSAwO1xuXHRcdGJvdHRvbV9zZW5zb3IuaXNTZW5zb3IgPSB0cnVlO1xuXHRcdGJvdHRvbV9zZW5zb3IuaGVpZ2h0ID0gMC4xO1xuXHRcdGJvdHRvbV9zZW5zb3Iud2lkdGggPSB3KjI7XG5cdFx0Ym90dG9tX3NlbnNvci5vZmZzZXQgPSB7eDowLCB5Omh9O1xuXHRcdGF0dGFjaF9maXh0dXJlKGJvZHksYm90dG9tX3NlbnNvcixcImJvdHRvbSBzZW5zb3JcIik7XG5cdFx0XG5cdFx0Ly9hdHRhY2ggbGVmdCBmaXh0dXJlXG5cdFx0dmFyIGxlZnRfc2Vuc29yID0ge307XG5cdFx0bGVmdF9zZW5zb3Iuc2hhcGUgPSBcInJlY3RhbmdsZVwiO1xuXHRcdGxlZnRfc2Vuc29yLmRlbnNpdHkgPSAwO1xuXHRcdGxlZnRfc2Vuc29yLmlzU2Vuc29yID0gdHJ1ZTtcblx0XHRsZWZ0X3NlbnNvci5oZWlnaHQgPSBoKjI7XG5cdFx0bGVmdF9zZW5zb3Iud2lkdGggPSAwLjE7XG5cdFx0bGVmdF9zZW5zb3Iub2Zmc2V0ID0ge3g6KC0xKncpLHk6MH07XG5cdFx0YXR0YWNoX2ZpeHR1cmUoYm9keSxsZWZ0X3NlbnNvcixcImxlZnQgc2Vuc29yXCIpO1xuXHRcdFxuXHRcdC8vYXR0YWNoIHJpZ2h0IGZpeHR1cmVcblx0XHR2YXIgcmlnaHRfc2Vuc29yID0ge307XG5cdFx0cmlnaHRfc2Vuc29yLnNoYXBlID0gXCJyZWN0YW5nbGVcIjtcblx0XHRyaWdodF9zZW5zb3IuZGVuc2l0eSA9IDA7XG5cdFx0cmlnaHRfc2Vuc29yLmlzU2Vuc29yID0gdHJ1ZTtcblx0XHRyaWdodF9zZW5zb3IuaGVpZ2h0ID0gaCoyO1xuXHRcdHJpZ2h0X3NlbnNvci53aWR0aCA9IDAuMTtcblx0XHRyaWdodF9zZW5zb3Iub2Zmc2V0ID0ge3g6dywgeTowfTtcblx0XHRhdHRhY2hfZml4dHVyZShib2R5LHJpZ2h0X3NlbnNvcixcInJpZ2h0IHNlbnNvclwiKTtcblx0fTtcblx0XG5cdFxuXHRcblxuXHR2YXIgZ2V0X3JlY3Rhbmd1bGFyID0gZnVuY3Rpb24oZGVmLCB0ZW1wbGF0ZV9uYW1lKXtcblx0XHQvLyBnZXQgYXBwcm9wcmlhdGUgdGVtcGxhdGUgY29sbGVjdGlvbiB0byBkcmF3IGZyb21cblx0XHR2YXIgdGVtcGxhdGVfY29sbGVjdGlvbiA9IFBoeXNpY3NNb2RlbC5yX3RlbXBsYXRlcztcblx0XHR2YXIgY29tcGlsZWRfdGVtcGxhdGUgPSBhcHBseV9wYXJlbnRzKHRlbXBsYXRlX25hbWUsIHRlbXBsYXRlX2NvbGxlY3Rpb24pO1xuXG5cdFx0Ly8gYXBwbHkgY3VzdG9tIG92ZXJyaWRlXG5cdFx0dmFyIGZpbmFsX2RlZiA9IGNvbXBpbGVkX3RlbXBsYXRlO1xuXHRcdGZvcih2YXIgcHJvcCBpbiBkZWYpe1xuXHRcdFx0ZmluYWxfZGVmW3Byb3BdID0gZGVmW3Byb3BdO1xuXHRcdH1cblxuXHRcdGZpbmFsX2RlZi5zaGFwZSA9IFwicmVjdGFuZ2xlXCI7XG5cblx0XHQvLyBmaW5hbF9kZWYgY29udGFpbnMgYWxsIGZpbmFsIGRhdGEsIGFib3V0IGJvZHkgd2UgYXJlIGFib3V0IHRvIGNyZWF0ZVxuXHRcdC8vIGl0IHRha2VzIGludG8gYWNjb3VudCB0ZW1wbGF0ZSBnaXZlbiBhbmQgYWxsIGl0J3MgcGFyZW50c1xuXHRcdC8vIGFuZCBhbHNvIG1hbnVhbGx5IHNwZWNpZmllZCBwYXJhbWV0ZXJzLiBIb3dldmVyLCB0aGlzIGRlZmluaXRpb24gaXMgcmF3LFxuXHRcdC8vIGkuZS4gc29tZSBkYXRhIGluIGl0IG1heSBub3QgYmUgaW4gaXRzIGZpbmFsIGZvcm0sIGUuZy4gbGluZWFyIHZlbG9jaXR5IGlzIHNwZWNpZmllZFxuXHRcdC8vIGFzIHR3byBwYXJhbWV0ZXJzLCB2eCBhbmQgdnksIHdoaWxlIGl0IHdob3VsZCBiZSBjb252ZXJ0ZWQgaW50byB0aGUgdmVjdG9yXG5cdFx0Ly8gZm9yIGJveDJkLiBzbyBmaW5hbF9kZWYgaXMgYSBmaW5hbCBkZXNjcmlwdGlvbiwgYnV0IG5vdCBpbiBmaW5hbCBmb3JtXG5cblxuXHRcdHZhciBib2R5ID0gZ2V0X2JvZHkoZmluYWxfZGVmKTtcblx0XHQgXG5cdFx0YXR0YWNoX2ZpeHR1cmUoYm9keSwgZmluYWxfZGVmLCBcIm1haW5cIik7XG5cdFx0XG5cdFx0aWYoZmluYWxfZGVmLmJvcmRlcl9zZW5zb3JzKXtcblx0XHRcdGF0dGFjaF9zZW5zb3JzKGJvZHkpO1xuXHRcdH1cblxuXHRcdHJldHVybiBib2R5O1xuXHR9O1xuXG5cdHZhciBnZXRfY2lyY3VsYXIgPSBmdW5jdGlvbihkZWYsIHRlbXBsYXRlKXtcblx0XHR2YXIgdHlwZSA9IFwiY2lyY3VsYXJcIjtcblx0XHQvLyBkb250JyBmb3JnZXQgYWJvdXQgcmVmYWN0b3Jpbmcgc29tZSBzdHVmZiBpbnRvIHRoZVxuXHRcdC8vIHNldF9jb21tb24gZnVuY3Rpb25cblx0XHRcblx0XHR2YXIgZGVmaW5pdGlvbiA9IG5ldyBCMmQuYjJCb2R5RGVmKCk7XG5cdFx0XG5cdH07XG5cdFx0XG5cdHZhciBnZXRfcG9seWdvbmFsID0gZnVuY3Rpb24oZGVmLCB0ZW1wbGF0ZSl7XG5cdFx0dmFyIHR5cGUgPSBcInBvbHlnb25hbFwiO1xuXHRcdFxuXHRcdHZhciBkZWZpbml0aW9uID0gbmV3IEIyZC5iMkJvZHlEZWYoKTtcblx0XHRcblx0fTtcblxuXHR2YXIgc2V0X2RlYnVnX2RyYXcgPSBmdW5jdGlvbihkZWJ1Z19kcmF3KXtcblx0XHRQaHlzaWNzTW9kZWwud29ybGQuU2V0RGVidWdEcmF3KGRlYnVnX2RyYXcpO1xuXHR9O1xuXG5cdHZhciBzZXR1cF9jb2xsaXNpb25fbGlzdGVuZXIgPSBmdW5jdGlvbihmdW5jdGlvbnMsIG9wdGlvbmFsKXtcblx0XHRcblx0XHQvKipcblx0XHQgKiB0YWtlcyB0d28gb2JqZWN0cywgPmZ1bmN0aW9uczwgYW5kID5vcHRpb25hbDxcblx0XHQgKiBmaXJzdCBvYmplY3Qgc2hvdWxkIGNvbnRhaW4gYW55IG9mIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcblx0XHQgKiBCZWdpbkNvbnRhY3QsIFByZVNvbHZlLCBQb3N0U29sdmUsIEVuZENvbnRhY3Rcblx0XHQgKiB3aXRoIHRoZXJlIHZhbHVlcyBiZWluZyBmdW5jdGlvbnMgdG8gYmUgY2FsbGVkIG9uIGVhY2ggZXZlbnRcblx0XHQgKiB0aGUgb3B0aW9uYWwgb2JqZWN0IGlzIGZvciBzb21lIG5hbWVkIHBhcmFtZXRlcnMgdGhhdCBtaWdodCBiZSB1c2VkIGxhdGVyXG5cdFx0ICogTm90aWNlIHRoYXQgdGhpcyBmdW5jdGlvbiB3cmFwcyBjYWxscyBvZiB0aGUgZ2l2ZW4gZnVuY3Rpb25zLCB0byBnaXZlIG1vcmVcblx0XHQgKiBoZWxwZnVsIGluZm8gYWJvdXQgdGhlIGNvbGxpc2lvbiBpbiBwYXJ0aWN1bGFyLCBpdCB3aWxsIHByb3ZpZGUgaW5mbyBhYm91dCB0aGVcblx0XHQgKiBzaWRlcyBvbiB3aGljaCBvYmplY3RzIGNvbGxpZGVkLCBncmFudGVkIHRoYXQgc2lkZWQgc2Vuc29ycyBhcmUgcHJlc2VudFxuXHRcdCAqXG5cdFx0ICogc3VwcG9ydGVkIHByb3BlcnRpZXMgb2YgPm9wdGlvbmFsPDpcblx0XHQgKiBcdG11c3RfYmVfaW52b2x2ZWQ6IGIyZF9ib2R5XG5cdFx0ICogXHRcdHJlcG9ydCBvbmx5IGNvbnRhY3RzIGluIHdoaWNoIHRoaXMgYm9keSBpcyBpbnZvbHZlZFxuXHRcdCAqIFx0XHRlLmcuIGlmIHlvdSBwYXNzIGl0IGJvZHkgb2YgdGhlIHBsYXllciwgb25seSBjb2xsaXNpb25zIHdpdGggdGhlXG5cdFx0ICogXHRcdHBsYXllciB3aWxsIGNhdXNlIHBhc3NlZCBmdW5jdGlvbnMgdG8gYmUgY2FsbGVkXG5cdFx0ICovXG5cblx0XHR2YXIgbGlzdGVuZXIgPSBuZXcgQjJkLmIyQ29udGFjdExpc3RlbmVyO1xuXG5cdFx0dmFyIG5hbWVzID0gW1wiQmVnaW5Db250YWN0XCIsIFwiRW5kQ29udGFjdFwiLCBcIlByZVNvbHZlXCIsIFwiUG9zdFNvbHZlXCJdO1xuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCA0OyBpKyspe1xuXHRcdFx0dmFyIG5hbWUgPSBuYW1lc1tpXTtcblx0XHRcdHZhciBjdXN0b21fZnVuY3Rpb24gPSBmdW5jdGlvbnNbbmFtZV07XG5cblx0XHRcdGlmKGN1c3RvbV9mdW5jdGlvbil7XG5cdFx0XHRcdC8vIGlmIGdpdmVuIGZ1bmN0aW9uIHdhcyBzcGVjaWZpZWRcblx0XHRcdFx0XG5cdFx0XHRcdC8vIHdyYXAgaXQgcHJvcGVybHkgYW5kIGF0dGFjaCB0byB0aGUgbGlzdGVuZXJcblx0XHRcdFx0bGlzdGVuZXJbbmFtZV0gPSAoZnVuY3Rpb24oY3VzdG9tX2Z1bmN0aW9uLCBtdXN0X2JlX2ludm9sdmVkKXtcblx0XHRcdFx0XHQvLyBzZWxmIGNhbGxpbmcgZnVuY3Rpb24gdG8gZGVhbCB3aXRoIHNjb3BlIGlzc3Vlc1xuXHRcdFx0XHRcdCBcblx0XHRcdFx0XHRyZXR1cm4gZnVuY3Rpb24gd3JhcHBlcihjb250YWN0LCBzZWNvbmRfYXJnKXtcblx0XHRcdFx0XHRcdC8vID5zZWNvbmRfYXJnPCB3aWxsIGJlIGltcHVsc2Ugb2YgY29sbGlzaW9uIGluIGNhc2Ugb2YgUHJlU29sdmUsXG5cdFx0XHRcdFx0XHQvLyBvbGRNYW5pZm9sZCBpbiBjYXNlIG9mIFBvc3RTb2x2ZSwgYW5kIG51bGwgb3RoZXJ3aXNlXG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdHZhciBmaXh0dXJlX0EgPSBjb250YWN0Lm1fZml4dHVyZUE7XG5cdFx0XHRcdFx0XHR2YXIgZml4dHVyZV9CID0gY29udGFjdC5tX2ZpeHR1cmVCO1xuXHRcdFx0XHRcdFx0dmFyIGJvZHlfQSA9IGZpeHR1cmVfQS5HZXRCb2R5KCk7XG5cdFx0XHRcdFx0XHR2YXIgYm9keV9CID0gZml4dHVyZV9CLkdldEJvZHkoKTtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0aWYoIW11c3RfYmVfaW52b2x2ZWQgfHwgLy8gaWYgbm8gY2hlY2tpbmcgZm9yIGJvZGllcyBpbnZvbHZlZCBPUlxuXHRcdFx0XHRcdFx0XHRib2R5X0EgPT09IG11c3RfYmVfaW52b2x2ZWQgfHwgLy8gZmlyc3QgYm9keSBtYXRjaGVzIE9SXG5cdFx0XHRcdFx0XHRcdGJvZHlfQiA9PT0gbXVzdF9iZV9pbnZvbHZlZCAvLyBzZWNvbmQgYm9keSBtYXRjaGVzXG5cdFx0XHRcdFx0XHQpe1xuXHRcdFx0XHRcdFx0XHQvLyB3aGF0ZXZlciBpbmZvIHlvdSB3YW50IHRvIHVucGFjayBmb3IgdGhlIGN1c3RvbSBmdW5jdGlvbiB0byBlYXNpbHkgdXNlOlxuXHRcdFx0XHRcdFx0XHR2YXIgaW5mbyA9IHt9OyBcblxuXHRcdFx0XHRcdFx0XHQvLyBUT0RPOlRISVMgU0hPVUxEIEJFIENIQU5HRUQgdG9nZXRoZXIgd2l0aFxuXHRcdFx0XHRcdFx0XHQvLyBob3cgaWQncyBhcmUgYXR0YWNoZWQgdG8gdGhlIGZpeHR1cmVzXG5cdFx0XHRcdFx0XHRcdC8vIG5vdCBjaGFuZ2luZyBub3csIHRvIGF2b2lkIG1lcmdlIGNvbmZsaWN0cyB3aXRoXG5cdFx0XHRcdFx0XHRcdC8vIEBTZWFuJ3Mgd29yayA+Pj5cblx0XHRcdFx0XHRcdFx0aW5mby5BID0ge307XG5cdFx0XHRcdFx0XHRcdGluZm8uQiA9IHt9O1xuXG5cdFx0XHRcdFx0XHRcdGluZm8uQS5maXh0dXJlID0gZml4dHVyZV9BO1xuXHRcdFx0XHRcdFx0XHRpbmZvLkIuZml4dHVyZSA9IGZpeHR1cmVfQjtcblxuXHRcdFx0XHRcdFx0XHRpbmZvLkEuYm9keSA9IGJvZHlfQTtcblx0XHRcdFx0XHRcdFx0aW5mby5CLmJvZHkgPSBib2R5X0I7XG5cblx0XHRcdFx0XHRcdFx0aW5mby5BLmJvZHlfaWQgPSBnZXRfY3VzdG9tX3Byb3BlcnR5KGJvZHlfQSwgXCJpZFwiKTtcblx0XHRcdFx0XHRcdFx0aW5mby5CLmJvZHlfaWQgPSBnZXRfY3VzdG9tX3Byb3BlcnR5KGJvZHlfQiwgXCJpZFwiKTtcblxuXHRcdFx0XHRcdFx0XHRpbmZvLkEuZml4dHVyZV9pZCA9IGdldF9jdXN0b21fcHJvcGVydHkoZml4dHVyZV9BLCBcImRlc2NyaXB0aW9uXCIpO1xuXHRcdFx0XHRcdFx0XHRpbmZvLkIuZml4dHVyZV9pZCA9IGdldF9jdXN0b21fcHJvcGVydHkoZml4dHVyZV9CLCBcImRlc2NyaXB0aW9uXCIpO1xuXHRcdFx0XHRcdFx0XHQvLyA8PDwgZW5kIG9mIHRlcnJpYmxlbmVzc1xuXG5cdFx0XHRcdFx0XHRcdC8vIGNhbGwgdGhlIGN1c3RvbSBmdW5jdGlvblxuXHRcdFx0XHRcdFx0XHRpZihzZWNvbmRfYXJnKXtcblx0XHRcdFx0XHRcdFx0XHQvLyBzcGVjaWZ5aW5nIHRoZSBpbXBsdWxzZS9vbGRNYW5pZm9sZCBpZiBwcmVzZW50XG5cdFx0XHRcdFx0XHRcdFx0Y3VzdG9tX2Z1bmN0aW9uKGNvbnRhY3QsIHNlY29uZF9hcmcsIGluZm8pO1xuXHRcdFx0XHRcdFx0XHR9ZWxzZXtcblx0XHRcdFx0XHRcdFx0XHQvLyBvciBub3Qgc3BlY2lmeWluZyBpZiBpdCBpcyBub3Rcblx0XHRcdFx0XHRcdFx0XHRjdXN0b21fZnVuY3Rpb24oY29udGFjdCwgaW5mbyk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9KShjdXN0b21fZnVuY3Rpb24sIG9wdGlvbmFsLm11c3RfYmVfaW52b2x2ZWQpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdFBoeXNpY3NNb2RlbC53b3JsZC5TZXRDb250YWN0TGlzdGVuZXIobGlzdGVuZXIpO1xuXHRcblx0fTtcblxuXHR2YXIgZ2V0X2N1c3RvbV9wcm9wZXJ0eSA9IGZ1bmN0aW9uKGIyZF9vYmosIHByb3BlcnR5X25hbWUpe1xuXHRcdFxuXHRcdC8qKlxuXHRcdCAqIGdpdmVuIGFueSBib3gyZCBvYmplY3QgdGhhdCBoYXMgR2V0VXNlckRhdGEgbWV0aG9kXG5cdFx0ICogdGhpcyBmdW5jdGlvbiB3aWxsIHJldHVybiBjdXN0b20gcHJvcGVydHkgd2l0aCBnaXZlblxuXHRcdCAqIHByb3BlcnR5X25hbWUgaWYgdGhpcyBwcm9wZXJ0eSBpcyBzZXQgb24gdXNlckRhdGEgb2YgdGhlIG9iamVjdFxuXHRcdCAqIGlmIG5vdCwgdGhlIGZ1bmN0aW9uIHJldHVybnMgbnVsbFxuXHRcdCAqL1xuXHRcdHZhciB1c2VyX2RhdGEgPSBiMmRfb2JqLkdldFVzZXJEYXRhKCk7XG5cdFx0aWYodXNlcl9kYXRhICYmIHVzZXJfZGF0YVtwcm9wZXJ0eV9uYW1lXSl7XG5cdFx0XHRyZXR1cm4gdXNlcl9kYXRhW3Byb3BlcnR5X25hbWVdO1xuXHRcdH1lbHNle1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXHR9O1xuXHRcblx0XG5cdFxuXHRcblx0cmV0dXJuIHtcblx0XHRnZXRfYm9keTogZ2V0X2JvZHksXG5cdFx0Z2V0X3JlY3Rhbmd1bGFyOiBnZXRfcmVjdGFuZ3VsYXIsXG5cdFx0c2V0dXBfY29sbGlzaW9uX2xpc3RlbmVyOiBzZXR1cF9jb2xsaXNpb25fbGlzdGVuZXIsXG5cdFx0c3RlcDogc3RlcCxcblx0XHRpbml0OiBpbml0LFxuXHRcdHNldF9kZWJ1Z19kcmF3OiBzZXRfZGVidWdfZHJhdyxcblx0XHRkcmF3X2RlYnVnOiBkcmF3X2RlYnVnLFxuXHR9O1xufSkoKTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IFBoeXNpY3NDb250cm9sbGVyO1xuXG52YXIgSW5jbHVkZXMgPSByZXF1aXJlKFwiLi4vSW5jbHVkZXMuanNcIik7IHZhciBpbmNsdWRlX2RhdGEgPSBJbmNsdWRlcy5nZXRfaW5jbHVkZV9kYXRhKHtcblx0Y3VycmVudF9tb2R1bGU6IFwiUGh5c2ljc0NvbnRyb2xsZXJcIiwgXG5cdGluY2x1ZGVfb3B0aW9uczogSW5jbHVkZXMuY2hvaWNlcy5ERUZBVUxUXG59KTsgZXZhbChpbmNsdWRlX2RhdGEubmFtZV9zdGF0ZW1lbnRzKTsgdmFyIGluY2x1ZGUgPSBmdW5jdGlvbigpe2V2YWwoaW5jbHVkZV9kYXRhLm1vZHVsZV9zdGF0ZW1lbnRzKTt9XG5cbiIsIlxudmFyIFBsYXllckNvbnRyb2xsZXIgPSAoZnVuY3Rpb24oKXtcblxuXHR2YXIgaGVybzsgLy8gZm9yIHF1aWNrIGFjY2Vzc1xuXG5cdHZhciBpbml0ID0gZnVuY3Rpb24oKXtcblx0XHRpbmNsdWRlKCk7XG5cdFx0UGxheWVyTW9kZWwuaGVybyA9IFBoeXNpY3NDb250cm9sbGVyLmdldF9yZWN0YW5ndWxhcih7dXNlckRhdGE6IHtpZDogXCJoZXJvXCJ9LCBib3JkZXJfc2Vuc29yczogdHJ1ZX0sIFwicGxheWVyXCIpO1xuXHRcdGhlcm8gPSBQbGF5ZXJNb2RlbC5oZXJvO1xuXG5cdFx0dmFyIGVuZF9jb250YWN0ID0gZnVuY3Rpb24oY29udGFjdCwgaW5mbyl7XG5cdFx0XHRcblx0XHRcdGNvbnNvbGUubG9nKGNvbnRhY3QpO1xuXHRcdFx0Y29uc29sZS5sb2coaW5mbyk7XG5cdFx0fTtcblxuXHRcdFBoeXNpY3NDb250cm9sbGVyLnNldHVwX2NvbGxpc2lvbl9saXN0ZW5lcih7RW5kQ29udGFjdDogZW5kX2NvbnRhY3R9LCB7bXVzdF9iZV9pbnZvbHZlZDogaGVyb30pO1xuXHRcdFxuXHR9O1xuXG5cdHZhciB1cGRhdGUgPSBmdW5jdGlvbiAoKXtcblxuXHRcdHZhciBjbWRzID0gS2V5Ym9hcmRDb250cm9sbGVyLm1vdmVtZW50X2NvbW1hbmRzKCk7XG5cblx0XHR2YXIgTU9WRU1FTlRfRURHRSA9IDUwMDsgLy8gd2hlcmUgdGVycmFpbiBzdGFydCBzY3JvbGxpbmdcblxuXG5cdFx0aWYoY21kcyhcInJpZ2h0XCIpKXtcblx0XHQgICAgLy8gdGVtcG9yYXJ5XG5cblx0XHQgICAgbW92ZV9yaWdodChoZXJvKTtcblx0XHR9XG5cdFx0aWYoY21kcyhcImxlZnRcIikpe1xuXHRcdFx0Ly8gdGVtcG9yYXJ5XG5cdFx0ICAgIFxuXHRcdCAgICBtb3ZlX2xlZnQoaGVybyk7XG5cdFx0fVxuXG5cdFx0aWYoY21kcyhcInVwXCIpKXtcblx0XHRcdGp1bXAoKTtcblx0XHR9XG5cblx0fTtcblxuXHR2YXIgZ2V0X2hlcm8gPSBmdW5jdGlvbigpe1xuXHRcdHJldHVybiBQbGF5ZXJNb2RlbC5oZXJvO1xuXHR9O1xuXG5cdHZhciBtb3ZlX3JpZ2h0ID0gZnVuY3Rpb24oKXtcblx0XHR2YXIgYm9keSA9IEdhbWVNb2RlbC5oZXJvLmIyYjtcblx0XHR2YXIgdmVsb2NpdHkgPSBib2R5LkdldExpbmVhclZlbG9jaXR5KCk7XG5cdFx0dmVsb2NpdHkueCA9IDU7XG5cdFx0Ym9keS5TZXRMaW5lYXJWZWxvY2l0eSh2ZWxvY2l0eSk7IC8vIGJvZHkuU2V0TGluZWFyVmVsb2NpdHkobmV3IGIyVmVjMig1LCAwKSk7IHdvdWxkIHdvcmsgdG9vXG5cdFx0Ym9keS5TZXRBd2FrZSh0cnVlKTtcblx0XHQvL0dhbWVNb2RlbC5oZXJvLnggKz0gMTA7IC8vIG9sZFxuXHRcdC8vR2FtZU1vZGVsLmhlcm8ueCA9IChib2R5LkdldFBvc2l0aW9uKCkueCArIDEuNS8yKSAqIDMwIDsgXG5cdH07XG5cblx0dmFyIGp1bXBzID0gMDtcblxuXHR2YXIganVtcCA9IGZ1bmN0aW9uKCl7XG5cdCAgICB2YXIgYm9keSA9IFBsYXllck1vZGVsLmhlcm87XG5cdCAgICBpZiAoYm9keS5HZXRMaW5lYXJWZWxvY2l0eSgpLnkgPT0gMCkge1xuXHQgICAgICAgIGp1bXBzID0gMDtcblx0ICAgIH1cblx0XHRpZiAoanVtcHMgPT0gMCl7XG5cdFx0ICAgIGJvZHkuQXBwbHlJbXB1bHNlKG5ldyBCMmQuYjJWZWMyKDAsIC0xMDApLCBib2R5LkdldFdvcmxkQ2VudGVyKCkpO1xuXHRcdCAgICBqdW1wcyArPSAxO1xuXHRcdH1cblx0XHRlbHNlIGlmIChqdW1wcyA9PSAxICYmIGJvZHkuR2V0TGluZWFyVmVsb2NpdHkoKS55ID4gLTEpIHtcblx0XHQgICAgYm9keS5BcHBseUltcHVsc2UobmV3IEIyZC5iMlZlYzIoMCwgLTEwMCksIGJvZHkuR2V0V29ybGRDZW50ZXIoKSk7XG5cdFx0ICAgIGp1bXBzICs9IDE7XG5cdFx0fVxuXG5cdFx0Ly9HYW1lTW9kZWwuaGVyby55ID0gYm9keS5HZXRQb3NpdGlvbigpLnkgKiAzMDtcblx0XG5cdH07XG5cblx0dmFyIHNldF9jb29yZGluYXRlcyA9IGZ1bmN0aW9uKHBvc2l0aW9uX3ZlY3Rvcil7XG5cdFx0Ly8gVE9ETzogcmVtb3ZlO1xuXHRcdC8vIHRlbXBvcmFyeS90ZXN0aW5nXG5cdFx0R2FtZU1vZGVsLmhlcm8ueCA9IChwb3NpdGlvbl92ZWN0b3IueCAtIDEuNS8yKSAqIDMwIDtcblx0XHRHYW1lTW9kZWwuaGVyby55ID0gKHBvc2l0aW9uX3ZlY3Rvci55ICsgMi41LzIpICogMzAgO1xuXG5cdH07XG5cblx0dmFyIGIyYl9nZXRfY29vcmRpbmF0ZXMgPSBmdW5jdGlvbigpe1xuXHRcdHJldHVybiBHYW1lTW9kZWwuaGVyby5iMmIuR2V0V29ybGRDZW50ZXIoKTtcblx0fTtcblxuXHR2YXIgbW92ZV9sZWZ0ID0gZnVuY3Rpb24oKXtcblx0XHR2YXIgdmVsb2NpdHkgPSBoZXJvLkdldExpbmVhclZlbG9jaXR5KCk7XG5cdFx0dmVsb2NpdHkueCA9IC01O1xuXHRcdGhlcm8uU2V0TGluZWFyVmVsb2NpdHkodmVsb2NpdHkpOyAvLyBoZXJvLlNldExpbmVhclZlbG9jaXR5KG5ldyBiMlZlYzIoNSwgMCkpOyB3b3VsZCB3b3JrIHRvb1xuXHRcdGhlcm8uU2V0QXdha2UodHJ1ZSk7XG5cdH07XG5cblx0dmFyIG1vdmVfcmlnaHQgPSBmdW5jdGlvbigpe1xuXHRcdHZhciB2ZWxvY2l0eSA9IGhlcm8uR2V0TGluZWFyVmVsb2NpdHkoKTtcblx0XHR2ZWxvY2l0eS54ID0gKzU7XG5cdFx0aGVyby5TZXRMaW5lYXJWZWxvY2l0eSh2ZWxvY2l0eSk7IC8vIGhlcm8uU2V0TGluZWFyVmVsb2NpdHkobmV3IGIyVmVjMig1LCAwKSk7IHdvdWxkIHdvcmsgdG9vXG5cdFx0aGVyby5TZXRBd2FrZSh0cnVlKTtcblx0fTtcblxuXHR2YXIgbW92ZSA9IGZ1bmN0aW9uKG9mZnNldF94LCBvZmZzZXRfeSl7XG5cdFx0Ly8gdW5pbXBsZW1lbnRlZFxuXHRcdC8vIHNob3VsZCBpdCBoYXJkLXNldCBwb3NpdGlvbiAobm90IHNhZmUhKVxuXHRcdC8vIG9yIGp1c3QgYWxsb3cgdG8gc2V0IGFueSB2ZWxvY2l0eS9pbXB1bHNlIHZlY3Rvcj9cblx0fTtcblxuXHRyZXR1cm4ge1xuXHRcdGluaXQ6IGluaXQsXG5cdFx0bW92ZV9yaWdodDogbW92ZV9yaWdodCxcblx0XHRtb3ZlX2xlZnQ6IG1vdmVfbGVmdCxcblx0XHQvL21vdmU6IG1vdmUsIC8vIHVuaXBsZW1lbnRlZC4gd2hhdCB3aWxsIGl0IGRvP1xuXHRcdHNldF9jb29yZGluYXRlczogc2V0X2Nvb3JkaW5hdGVzLFxuXHRcdGIyYl9nZXRfY29vcmRpbmF0ZXM6IGIyYl9nZXRfY29vcmRpbmF0ZXMsXG5cdFx0dXBkYXRlOiB1cGRhdGUsXG5cdFx0anVtcDoganVtcCxcblx0XHRnZXRfaGVybzogZ2V0X2hlcm8sXG5cblx0fTtcbn0pKCk7XG5cbm1vZHVsZS5leHBvcnRzID0gUGxheWVyQ29udHJvbGxlcjtcblxudmFyIEluY2x1ZGVzID0gcmVxdWlyZShcIi4uL0luY2x1ZGVzLmpzXCIpOyB2YXIgaW5jbHVkZV9kYXRhID0gSW5jbHVkZXMuZ2V0X2luY2x1ZGVfZGF0YSh7XG5cdGN1cnJlbnRfbW9kdWxlOiBcIlBsYXllckNvbnRyb2xsZXJcIiwgXG5cdGluY2x1ZGVfb3B0aW9uczogSW5jbHVkZXMuY2hvaWNlcy5ERUZBVUxUXG59KTsgZXZhbChpbmNsdWRlX2RhdGEubmFtZV9zdGF0ZW1lbnRzKTsgdmFyIGluY2x1ZGUgPSBmdW5jdGlvbigpe2V2YWwoaW5jbHVkZV9kYXRhLm1vZHVsZV9zdGF0ZW1lbnRzKTt9XG5cbiIsIlxudmFyIFRlcnJhaW5Db250cm9sbGVyID0gKGZ1bmN0aW9uKCl7XG5cdC8qIHRoaXMgd2lsbCBiZSB0aGUgcGh5c2ljYWwgcmVwcmVzZW50YXRpb24gb2YgdGhlIHRlcnJhaW5cblx0ICogY3VycmVudGx5IGl0IGNvbnRhaW5zIGdyYXBoaWNhbCBiaXRzLCBidXQgdGhhdCB3aWxsIGNoYW5nZVxuXHQgKi9cblxuXHR2YXIgaW5pdCA9IGZ1bmN0aW9uKCl7XG5cdFx0aW5jbHVkZSgpO1xuXHR9O1xuXHRcblxuXHR2YXIgdXBkYXRlID0gZnVuY3Rpb24oKXtcblx0XHQvLyBjaGVjayBmb3IgYW55IGNodW5rcyB0byBiZSB1bmxvYWRlZC9kZWxldGVkIHdpbGwgZ28gaGVyZSwgZm9yIG5vd1xuXHRcdC8vIG1heWJlIGl0J2xsIGNoZWNrIGZvciBhbGwgcGxheWVycyB0byBiZSBzdWZmaWNpZW50bHkgZmFyIHRvIHRoZSByaWdodFxuXHRcdC8vIG9mIGl0LCBtYXliZSBvbmUgY2h1bmsgaW4gYWR2YW5jZSwgb3Igc210aCBsaWtlIHRoYXRcblx0XHR3aGlsZShUZXJyYWluTW9kZWwudGVycmFpbl9zbGljZXNfcXVldWUubGVuZ3RoIDwgNCl7XG5cdFx0XHR2YXIgc2xpY2UgPSBOZXdUZXJyYWluU2xpY2UoKTtcblx0XHRcdFRlcnJhaW5Nb2RlbC50ZXJyYWluX3NsaWNlc19xdWV1ZS5wdXNoKHNsaWNlKTtcblx0XHR9O1xuXHR9O1xuXG5cblx0dmFyIE5ld1RlcnJhaW5TbGljZSA9IGZ1bmN0aW9uKCl7XG5cdFx0LyogdGhpcyB0YWtlcyBjYXJlIG9mIGFwcGVuZGluZyBuZXcgdGVycmFpbiBzbGljZSB0byB0aGUgZ2VuZXJhdGVkIHRlcnJhaW5cblx0XHQgKiBpdCBjYWxjdWxhdGVzIGl0J3Mgb3JpZ2luIHggYW5kIHkgcG9zaXRpb25zIGFuZCB3aGF0ZXZlciBvdGhlciBzdHVmZixcblx0XHQgKiBnZW5lcmF0ZXMgc2xpY2U7IHNldHMgdXAgZXZlcnl0aGluZ1xuXHRcdCAqL1xuXG5cdFx0dmFyIHNsaWNlID0gVGVycmFpblNsaWNlQ29udHJvbGxlci5nZW5lcmF0ZSgpO1xuXHRcdE1hcmtBc05ld1RlcnJhaW5TbGljZShzbGljZSk7IC8vIHNvIHRoYXQgZ3JhcGhpY3MgYW5kIG90aGVyIHN0dWZmIHdpbGwgbm90aWNlXG5cblx0XHRyZXR1cm4gc2xpY2U7XG5cblx0fTtcblxuXHR2YXIgcmV0cmlldmVfd29ybGRfcGFyYW1ldGVycyA9IGZ1bmN0aW9uKCl7fTtcblx0XG5cdHZhciBmb3JfZWFjaF90aWxlID0gZnVuY3Rpb24oZil7XG5cdFx0Ly8gdGFrZXMgZnVuY3Rpb24gPmY8IHRoYXQgdGFrZXMgdGhyZWUgcGFyYW1ldGVyczogdGlsZSAoZXNlbGpzIG9iamVjdCksXG5cdFx0Ly8gdGVycmFpbl9sdmwgKGludCksIGFuZCB0aWxlX2luZGV4IChpbnQpXG5cdFx0Ly8gY2FsbHMgdGhpcyBmdW5jdGlvbiBmb3IgZXZlcnkgdGlsZSBvZiB0aGUgdGVycmFpblxuXHRcdFxuXHRcdHZhciBxdWV1ZXMgPSBUZXJyYWluTW9kZWwudGVycmFpbl9xdWV1ZXM7XG5cblx0XHQkLmVhY2gocXVldWVzLCBmdW5jdGlvbih0ZXJyYWluX2x2bCl7XG5cdFx0XHQkLmVhY2gocXVldWVzW3RlcnJhaW5fbHZsXSwgZnVuY3Rpb24odGlsZV9pbmRleCl7XG5cdFx0XHRcdGYocXVldWVzW3RlcnJhaW5fbHZsXVt0aWxlX2luZGV4XSwgdGVycmFpbl9sdmwsIHRpbGVfaW5kZXgpO1xuXHRcdFx0fSk7XG5cdFx0fSk7XG5cblx0fTtcblxuXHR2YXIgbW92ZV9sZWZ0ID0gZnVuY3Rpb24ocGl4ZWxzKXtcblx0XHQvLyBTaG91bGQgSSBzY3JhcCB0aGlzIGZ1bmN0aW9uIGFuZCBqdXN0IHVzZSA+bW92ZTwsIG9yIGlzIHRoaXMgYSBoZWxwZnVsIHNob3J0Y3V0P1xuXHRcdFxuXHRcdG1vdmUoKC0xKSpwaXhlbHMsIDApO1xuXG5cdH07IC8vIGVuZCBtb3ZlX2xlZnRcblx0XG5cdHZhciBtb3ZlID0gZnVuY3Rpb24ob2Zmc2V0X3gsIG9mZnNldF95KXtcblx0XHRpZihvZmZzZXRfeCAhPSAwKXtcblx0XHRcdGZvcl9lYWNoX3RpbGUoZnVuY3Rpb24odGlsZSwgdGVycmFpbl9sdmwsIHRpbGVfaW5kZXgpe1xuXHRcdFx0XHR0aWxlLnggKz0gb2Zmc2V0X3g7XG5cdFx0XHR9KTtcblxuXHRcdH0vLyBmaVxuXG5cdFx0aWYob2Zmc2V0X3kgIT0gMCl7XG5cdFx0XHRmb3JfZWFjaF90aWxlKGZ1bmN0aW9uKHRpbGUsIHRlcnJhaW5fbHZsLCB0aWxlX2luZGV4KXtcblx0XHRcdFx0dGlsZS55ICs9IG9mZnNldF95O1xuXHRcdFx0fSk7XG5cblx0XHR9XG5cblx0fTtcblxuXHR2YXIgTWFya0FzTmV3VGVycmFpblNsaWNlID0gZnVuY3Rpb24oc2xpY2Upe1xuXHRcdFRlcnJhaW5Nb2RlbC5uZXdfc2xpY2VzLnB1c2goc2xpY2UpO1xuXHR9O1xuXG5cdHZhciBOZXdTbGljZXNBdmFpbGFibGUgPSBmdW5jdGlvbigpe1xuXHRcdHJldHVybiAoVGVycmFpbk1vZGVsLm5ld19zbGljZXMubGVuZ3RoID4gMCk7XG5cdH07XG5cblx0dmFyIEdldE5ld1RlcnJhaW5TbGljZXMgPSBmdW5jdGlvbigpe1xuXHRcdHJldHVybiBUZXJyYWluTW9kZWwubmV3X3NsaWNlcztcblx0fTtcblxuXHRyZXR1cm4ge1xuXHRcdG1vdmVfbGVmdDogbW92ZV9sZWZ0LFxuXHRcdG1vdmU6IG1vdmUsXG5cdFx0dXBkYXRlOiB1cGRhdGUsXG5cdFx0aW5pdDogaW5pdCxcblx0XHROZXdUZXJyYWluU2xpY2U6IE5ld1RlcnJhaW5TbGljZSxcblx0XHRNYXJrQXNOZXdUZXJyYWluU2xpY2U6IE1hcmtBc05ld1RlcnJhaW5TbGljZSxcblx0XHROZXdTbGljZXNBdmFpbGFibGU6IE5ld1NsaWNlc0F2YWlsYWJsZSxcblx0XHRHZXROZXdUZXJyYWluU2xpY2VzOiBHZXROZXdUZXJyYWluU2xpY2VzLFxuXHR9XG59KSgpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFRlcnJhaW5Db250cm9sbGVyO1xuXG52YXIgSW5jbHVkZXMgPSByZXF1aXJlKFwiLi4vSW5jbHVkZXMuanNcIik7IHZhciBpbmNsdWRlX2RhdGEgPSBJbmNsdWRlcy5nZXRfaW5jbHVkZV9kYXRhKHtcblx0Y3VycmVudF9tb2R1bGU6IFwiVGVycmFpbkNvbnRyb2xsZXJcIiwgXG5cdGluY2x1ZGVfb3B0aW9uczogSW5jbHVkZXMuY2hvaWNlcy5ERUZBVUxUXG59KTsgZXZhbChpbmNsdWRlX2RhdGEubmFtZV9zdGF0ZW1lbnRzKTsgdmFyIGluY2x1ZGUgPSBmdW5jdGlvbigpe2V2YWwoaW5jbHVkZV9kYXRhLm1vZHVsZV9zdGF0ZW1lbnRzKTt9XG5cbiIsIlxudmFyIFRlcnJhaW5TbGljZUNvbnRyb2xsZXIgPSAoZnVuY3Rpb24gKCkge1xuXG5cdHZhciBpbml0ID0gZnVuY3Rpb24oKXtcblx0XHQvKiBpcyByYW4gZnJvbSB0aGUgSW5pdENvbnRyb2xsZXIgb25jZSB3aGVuIHRoZSBnYW1lIGlzIGxvYWRlZCAqL1xuXG5cdFx0aW5jbHVkZSgpOyAvLyBzYXRpc2Z5IHJlcXVpcmVtZW50c1xuXG5cdH07XG5cblx0dmFyIHVwZGF0ZSA9IGZ1bmN0aW9uKHNsaWNlKXtcblx0XHRcblxuXHR9O1xuXG5cdHZhciBnZXRfbmV4dF9vcmlnaW4gPSBmdW5jdGlvbigpe1xuXHR9O1xuXG5cdHZhciBnZW5lcmF0ZSA9IGZ1bmN0aW9uKCl7XG5cblx0XHR2YXIgc2xpY2UgPSBuZXcgVGVycmFpblNsaWNlTW9kZWwoKTtcblx0XHRzbGljZS5vcmlnaW4ueCA9IHNsaWNlLmlkICogc2xpY2UuZ3JpZF9jb2x1bW5zICogc2xpY2UuY2VsbF93O1xuXHRcdHNsaWNlLm9yaWdpbi55ID0gMDtcblxuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBzbGljZS5ncmlkX3Jvd3M7IGkrKyl7XG5cdFx0XHQvKiBcdGFzc2lnbmluZyBpZCdzXG5cdFx0XHRcdHRoYXQgaXMgdGhlIGZpcnN0IHBhc3MuIGxhdGVyIGl0IG1heSBiZSB1c2VkIHRvIGxheW91dCBnZW5lcmFsIGZvcm0gb2YgdGhlIHRlcnJhaW5cblx0XHRcdCAgIFx0YXNzaWduaW5nIGVhY2ggY2VsbCBpbiB0aGUgZ3JpZCBzb21lIHJvbGUsIG1hcmtlZCBieSBpdHMgaWQuXG5cdFx0XHQgXHR0aGF0IHJvbGUgbWF5IGluY2x1ZGUgZm9yIGl0IHRvIGJlIGEgcGllY2Ugb2YgdGhlIGJpZ2dlciBvYmplY3QgPj4+XG5cdFx0XHQqL1xuXG5cdFx0XHRzbGljZS5ncmlkW2ldID0gW107XG5cdFx0XHR2YXIgbHZsID0gc2xpY2UuZ3JpZF9yb3dzIC0gaTsgLy8gbGV2ZWwgZnJvbSB0aGUgYm90dG9tXG5cdFx0XHR2YXIgcHJvYiA9IHNsaWNlLmx2bF9wcm9iW2x2bF07XG5cblx0XHRcdGZvcih2YXIgaiA9IDA7IGogPCBzbGljZS5ncmlkX2NvbHVtbnM7IGorKyl7XG5cdFx0XHRcdGlmKHByb2Ipe1xuXHRcdFx0XHRcdHZhciByYW5kb21faWQgPSBHYW1lVXRpbGl0eS5yYW5kb21fY2hvaWNlKHByb2IsIFsxLCAyLCAzXSk7IC8vIGNob3NlIHJhbmRvbSB0ZXJyYWluIHRpbGUgaWRcblx0XHRcdFx0XHQvLyB0aGUgdGlsZSBpbiB0aGUgZ3JpZCBtaWdodCBiZSBtYWRlIHRvIGJlIHNlcGFyYXRlIG9iamVjdCBsYXRlclxuXHRcdFx0XHRcdC8vIHRoZSB0aWxlX2lkIHdpbGwgZGV0ZXJtaW5lIHRoZSB0eXBlIG9mIG9iamVjdCBpbiB0aGF0IHRpbGUsXG5cdFx0XHRcdFx0Ly8gc3VjaCBhcyB0eXBlIG9mIHRlcnJhaW4gZXRjLiB0aGUgdGlsZXMgd2l0aCBkaWZmZXJlbnQgaWQncyBkbyBub3Rcblx0XHRcdFx0XHQvLyBuZWNlc3NhcmlseSBkaWZmZXIgaW4gcGh5c2ljcyByZXByZXNlbnRhdGlvbiwgdGhleSBtaWdodCBqdXN0IGhhdmVcblx0XHRcdFx0XHQvLyBkaWZmZXJlbnQgYXBwZWFyYW5jZVxuXHRcdFx0XHRcdHNsaWNlLmdyaWRbaV1bal0gPSB7aWQ6IHJhbmRvbV9pZH07XG5cblx0XHRcdFx0fWVsc2V7XG5cdFx0XHRcdFx0Ly8gMCB3aWxsIGJlIHRoZSBpZCBmb3IgdGhlIFwiYWlyXCIgaS5lLiBub3RoaW5nXG5cdFx0XHRcdFx0c2xpY2UuZ3JpZFtpXVtqXSA9IHtpZDogMH07XG5cdFx0XHRcdH1cblx0XHRcdH0gLy8gZm9yIGVuZFxuXHRcdFx0Ly8gPDw8IGFzc2lnbmluZyBpZHNcblx0XHRcdFxuXHRcdH0gLy8gZm9yIGVuZFxuXG5cblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgc2xpY2UuZ3JpZF9yb3dzOyBpKyspe1xuXHRcdFx0LypcdGNyZWF0aW5nIHBoeXNpY3MgcmVwcmVzZW50YXRpb25zXG5cdFx0XHQgKlx0Mm5kIHBhc3M7IHRoaXMgd2lsbCBiZSB1c2VkIHRvIGNyZWF0ZSBhbGwgdGhlIG9iamVjdHMgYW5kIHN1Y2hcblx0XHRcdCAqXHRwaHlzaWNzLXdpc2UuIEl0IG1heSBleGFtaW5lIGlkJ3Mgb2YgdGhlIGFkamFjZW50IHRpbGVzIHRvIGZpbmRcblx0XHRcdCAqXHRsYXJnZXIgcGllY2VzIG9mIHRlcnJhaW4gdG8gdW5pdGUgdW5kZXIgdGhlIGNvbW1vbiBib3VuZGluZyBib3hcblx0XHRcdCAqXHRpZiB0aGV5IGhhdmUgc2ltaWxhciBlbm91Z2ggcHJvcGVydGllcyBvciBiZWxvbmcgdG9nZXRoZXIgZm9yIHNvbWUgcmVhc29uXG5cdFx0XHQgKi9cblxuXHRcdFx0dmFyIGx2bCA9IHNsaWNlLmdyaWRfcm93cyAtIGk7IC8vIGxldmVsIGZyb20gdGhlIGJvdHRvbVxuXG5cdFx0XHRmb3IodmFyIGogPSAwOyBqIDwgc2xpY2UuZ3JpZF9jb2x1bW5zOyBqKyspe1xuXHRcdFx0XHR2YXIgaWQgPSBzbGljZS5ncmlkW2ldW2pdLmlkO1xuXHRcdFx0XHRpZihpZCAhPSAwKXsgLy8gaWYgbm90IGFpclxuXHRcdFx0XHRcdHZhciB4ID0gc2xpY2Uub3JpZ2luLnggKyBqICogc2xpY2UuY2VsbF93ICsgc2xpY2UuY2VsbF93LzI7XG5cdFx0XHRcdFx0dmFyIHkgPSBzbGljZS5vcmlnaW4ueSArIGkgKiBzbGljZS5jZWxsX3cgKyBzbGljZS5jZWxsX3cvMjtcblx0XHRcdFx0XHR2YXIgYm9keSA9IFBoeXNpY3NDb250cm9sbGVyLmdldF9yZWN0YW5ndWxhcih7eDogeCwgeTogeX0sIFwidGVycmFpbl90aWxlXCIpO1xuXHRcdFx0XHRcdHNsaWNlLmdyaWRbaV1bal0uYm9keSA9IGJvZHk7XG5cdFx0XHRcdH1cblxuXHRcdFx0fSAvLyBlbmQgZm9yXG5cblx0XHR9Ly9lbmQgZm9yXG5cdFx0XG5cdFx0cmV0dXJuIHNsaWNlO1xuXHR9O1xuXG5cdHJldHVybiB7XG5cdFx0Ly8gZGVjbGFyZSBwdWJsaWNcblx0XHRpbml0OiBpbml0LCBcblx0XHR1cGRhdGU6IHVwZGF0ZSxcblx0XHRnZW5lcmF0ZTogZ2VuZXJhdGUsXG5cdH07XG59KSgpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFRlcnJhaW5TbGljZUNvbnRyb2xsZXI7XG5cbnZhciBJbmNsdWRlcyA9IHJlcXVpcmUoXCIuLi9JbmNsdWRlcy5qc1wiKTsgdmFyIGluY2x1ZGVfZGF0YSA9IEluY2x1ZGVzLmdldF9pbmNsdWRlX2RhdGEoe1xuXHRjdXJyZW50X21vZHVsZTogXCJUZXJyYWluU2xpY2VDb250cm9sbGVyXCIsIFxuXHRpbmNsdWRlX29wdGlvbnM6IEluY2x1ZGVzLmNob2ljZXMuREVGQVVMVFxufSk7IGV2YWwoaW5jbHVkZV9kYXRhLm5hbWVfc3RhdGVtZW50cyk7IHZhciBpbmNsdWRlID0gZnVuY3Rpb24oKXtldmFsKGluY2x1ZGVfZGF0YS5tb2R1bGVfc3RhdGVtZW50cyk7fVxuXG4iLCJ2YXIgVGVzdENvbnRyb2xsZXIgPSAoZnVuY3Rpb24oKXtcblx0Ly8gcGxhY2Vob2xkZXIgZm9yIGltcGxlbWVudGluZyB0ZXN0aW5nXG5cdC8vIG1heSBiZSBjaGFuZ2VkL3JlbW92ZWQvdXBncmFkZWQgZGVwZW5kaW5nIG9uIGhvdyB3ZSB3aWxsIGhhbmRsZSBvdXIgdGVzdHNcblx0XG5cdFxuXHR2YXIgcHJlaW5pdF90ZXN0cyA9IGZ1bmN0aW9uKCl7XG5cdC8vRm9yIHRlc3RzIHJlcXVpcmluZyBydW4gYmVmb3JlIGluaXQgaXMgY2FsbGVkXG5cdFxuXHRcblx0fTtcblx0XG5cdFxuXHR2YXIgdGVzdCA9IGZ1bmN0aW9uKCl7XG5cdFx0Ly8gaWYgeW91IG5lZWQgc29tZSBzb3J0IG9mIHRlc3RzIGxhdW5jaGVkLCB0aGlzIGlzIG9uZSBvZiB0aGUgcGxhY2VzIHRvIGRvIGl0XG5cdFx0UVVuaXQudGVzdCggXCJoZWxsbyB0ZXN0XCIsIGZ1bmN0aW9uKCBhc3NlcnQgKSB7XG5cdFx0XHRhc3NlcnQub2soIDEgPT0gXCIxXCIsIFwiUGFzc2VkIVwiICk7XG5cdFx0fSk7XG5cdFx0SW5jbHVkZXMuYXV0b21hdGVkX3Rlc3RzKCk7XG5cdH07XG5cblx0dmFyIHBvc3RfbG9hZGluZ190ZXN0cyA9IGZ1bmN0aW9uKCl7XG5cdFx0Ly8gVE9ETzogY2FsbCB3aGVuIGxvYWRpbmcgYXNzZXRzIGlzIGNvbXBsZXRlZCBpZiB0aGVyZSBhcmUgc29tZSB0ZXN0cyB0aGF0IG5lZWRcblx0XHQvLyB0byBiZSBkb25lIGF0IHRoYXQgbW9tZW50LiAoUmVmZXIgdG8gSW5pdENvbnRyb2xsZXIuaW5pdCBhbmQgXG5cdFx0Ly8gSW5pdENvbnRyb2xsZXIuc2V0dXBfYXNzZXRfZGVwZW5kZW50IG1ldGhvZHNcblx0fTtcblxuXHR2YXIgaW5pdCA9IGZ1bmN0aW9uKG1vZGUpe1xuXHRcdGluY2x1ZGUoKTtcblx0XHQvLyBTZXRzIHVwIHRoZSBkZWJ1ZyBjYW52YXMgZHVyaW5nIHRlc3Rpbmdcblx0XHRUZXN0TW9kZWwuZF9jYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChDb25maWcuREVCVUdfQ0FOVkFTX05BTUUpO1xuXG5cdFx0aWYobW9kZSA9PSBcInRlc3RcIil7XG5cdFx0XHRUZXN0TW9kZWwuY29udGV4dCA9IFRlc3RNb2RlbC5kX2NhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG5cdFx0XHRcblx0XHRcdFRlc3RNb2RlbC5kZWJ1Z0RyYXcgPSBuZXcgQjJkLmIyRGVidWdEcmF3KCk7XG5cdFx0XHRUZXN0TW9kZWwuZGVidWdEcmF3LlNldFNwcml0ZShUZXN0TW9kZWwuY29udGV4dCk7XG5cdFx0XHRUZXN0TW9kZWwuZGVidWdEcmF3LlNldERyYXdTY2FsZShDb25maWcuQjJELlNDQUxFKTtcblx0XHRcdFRlc3RNb2RlbC5kZWJ1Z0RyYXcuU2V0RmlsbEFscGhhKDAuMyk7XG5cdFx0XHRUZXN0TW9kZWwuZGVidWdEcmF3LlNldExpbmVUaGlja25lc3MoMS4wKTtcblx0XHRcdFRlc3RNb2RlbC5kZWJ1Z0RyYXcuU2V0RmxhZ3MoQjJkLmIyRGVidWdEcmF3LmVfc2hhcGVCaXQgfCBCMmQuYjJEZWJ1Z0RyYXcuZV9qb2ludEJpdCk7XG5cblx0XHRcdFBoeXNpY3NDb250cm9sbGVyLnNldF9kZWJ1Z19kcmF3KFRlc3RNb2RlbC5kZWJ1Z0RyYXcpO1xuXG5cdFx0XHRDb25maWcuQjJELmRlYnVnX2RyYXcgPSB0cnVlO1xuXHRcdFx0Ly8gU2NyZWVuX1cgd2FzIHNldHVwIG9ubHkgYWZ0ZXIgdGhpcyB3YXMgY2FsbGVkXG5cblx0XHRcdFRlc3RNb2RlbC5kX2NhbnZhcy53aWR0aCA9IENvbmZpZy5TQ1JFRU5fVztcblx0XHRcdFRlc3RNb2RlbC5kX2NhbnZhcy5oZWlnaHQgPSBDb25maWcuU0NSRUVOX0g7XG5cblx0XHRcdC8vJCgnIycrQ29uZmlnLkRFQlVHX0NBTlZBU19OQU1FKS5zaG93KCk7XG5cblx0XHR9ZWxzZXtcblx0XHRcdC8vZF9jYW52YXMuaGlkZSgpO1xuXHRcdH1cblx0fTtcblx0XG5cdC8vdGhpcyBmdW5jdGlvbiBzZXRzIHRoZSB4IGFuZCB5IG9mZnNldHMgb2YgdGhlIGRlYnVnIGNhbnZhc1xuXHR2YXIgc2V0X2RlYnVnX29mZnNldCA9IGZ1bmN0aW9uKHhfb2Zmc2V0LCB5X29mZnNldCl7XG5cdFx0Y29udGV4dCA9IFRlc3RNb2RlbC5jb250ZXh0O1xuXHRcdGNvbnRleHQuc2F2ZSgpO1xuXHRcdGNvbnRleHQuY2xlYXJSZWN0KDAsIDAsIENvbmZpZy5TQ1JFRU5fVywgQ29uZmlnLlNDUkVFTl9IKTtcblx0XHRjb250ZXh0LnRyYW5zbGF0ZSh4X29mZnNldCwgeV9vZmZzZXQpO1xuXHRcdFBoeXNpY3NDb250cm9sbGVyLmRyYXdfZGVidWcoKTtcblx0XHRjb250ZXh0LnJlc3RvcmUoKTtcblx0fTtcblxuXHRyZXR1cm4ge1xuXHRcdGluaXQ6IGluaXQsIFxuXHRcdHRlc3Q6IHRlc3QsXG5cdFx0cG9zdF9sb2FkaW5nX3Rlc3RzOiBwb3N0X2xvYWRpbmdfdGVzdHMsXG5cdFx0cHJlaW5pdF90ZXN0czogcHJlaW5pdF90ZXN0cyxcblx0XHRzZXRfZGVidWdfb2Zmc2V0OiBzZXRfZGVidWdfb2Zmc2V0XG5cdH1cbn0pKCk7XG5cbm1vZHVsZS5leHBvcnRzID0gVGVzdENvbnRyb2xsZXI7XG5cbnZhciBJbmNsdWRlcyA9IHJlcXVpcmUoXCIuLi9JbmNsdWRlcy5qc1wiKTsgdmFyIGluY2x1ZGVfZGF0YSA9IEluY2x1ZGVzLmdldF9pbmNsdWRlX2RhdGEoe1xuXHRjdXJyZW50X21vZHVsZTogXCJUZXN0Q29udHJvbGxlclwiLCBcblx0aW5jbHVkZV9vcHRpb25zOiBJbmNsdWRlcy5jaG9pY2VzLkRFRkFVTFRcbn0pOyBldmFsKGluY2x1ZGVfZGF0YS5uYW1lX3N0YXRlbWVudHMpOyB2YXIgaW5jbHVkZSA9IGZ1bmN0aW9uKCl7ZXZhbChpbmNsdWRlX2RhdGEubW9kdWxlX3N0YXRlbWVudHMpO31cblxuIiwiXHRcbnZhciBXb3JsZENvbnRyb2xsZXIgPSAoZnVuY3Rpb24oKXtcblx0LyogYWxsIHRoZSBwaHlzaWNzIGNvbnRyb2wgb2YgdGhlIHdob2xlIHdvcmxkXG5cdCovXG5cbiAgICB2YXIgYm9keV90ZXN0O1xuICAgIHZhciBib2R5X3Rlc3QyO1xuXHQvL3ZhciB0ZW1wID0gMDtcblxuXHR2YXIgaW5pdCA9IGZ1bmN0aW9uKCl7XG5cdFx0LyogaXMgcmFuIGZyb20gdGhlIEluaXRDb250cm9sbGVyIG9uY2Ugd2hlbiB0aGUgZ2FtZSBpcyBsb2FkZWQgKi9cblxuXHRcdGluY2x1ZGUoKTsgLy8gc2F0aXNmeSByZXF1aXJlbWVudHNcblxuXHRcdGJvZHlfdGVzdCA9IFBoeXNpY3NDb250cm9sbGVyLmdldF9yZWN0YW5ndWxhcih7fSwgXCJ0ZXN0XCIpO1xuXHRcdGJvZHlfdGVzdDIgPSBQaHlzaWNzQ29udHJvbGxlci5nZXRfcmVjdGFuZ3VsYXIoe30sIFwicGxhdGZvcm1cIik7XG5cdH07XG5cblx0dmFyIHVwZGF0ZSA9IGZ1bmN0aW9uKGRlbHRhKXtcblx0XHQvKiBpcyByYW4gZWFjaCB0aWNrIGZyb20gdGhlIEdhbWVDb250cm9sbGVyLnVwZGF0ZV9hbGwgKi9cblx0XHRQaHlzaWNzQ29udHJvbGxlci5zdGVwKGRlbHRhKTtcblxuXHRcdC8vaWYodGVtcCsrID09IDApe1xuXHRcdFx0Ly9UZXJyYWluQ29udHJvbGxlci5OZXdUZXJyYWluU2xpY2UoKTtcblx0XHQvL31cblxuXHR9O1xuXG5cdHZhciBNYXJrQXNOZXdUZXJyYWluU2xpY2UgPSBmdW5jdGlvbihzbGljZSl7XG5cdFx0XG5cdH07XG5cblx0cmV0dXJuIHtcblx0XHQvLyBkZWNsYXJlIHB1YmxpY1xuXHRcdGluaXQ6IGluaXQsIFxuXHRcdHVwZGF0ZTogdXBkYXRlLFxuXHR9O1xufSkoKTtcblxubW9kdWxlLmV4cG9ydHMgPSBXb3JsZENvbnRyb2xsZXI7XG5cbnZhciBJbmNsdWRlcyA9IHJlcXVpcmUoXCIuLi9JbmNsdWRlcy5qc1wiKTsgdmFyIGluY2x1ZGVfZGF0YSA9IEluY2x1ZGVzLmdldF9pbmNsdWRlX2RhdGEoe1xuXHRjdXJyZW50X21vZHVsZTogXCJXb3JsZENvbnRyb2xsZXJcIiwgXG5cdGluY2x1ZGVfb3B0aW9uczogSW5jbHVkZXMuY2hvaWNlcy5ERUZBVUxUXG59KTsgZXZhbChpbmNsdWRlX2RhdGEubmFtZV9zdGF0ZW1lbnRzKTsgdmFyIGluY2x1ZGUgPSBmdW5jdGlvbigpe2V2YWwoaW5jbHVkZV9kYXRhLm1vZHVsZV9zdGF0ZW1lbnRzKTt9XG5cbiIsInZhciBHYW1lVXRpbGl0eSA9IChmdW5jdGlvbigpXG57XG4gIGZ1bmN0aW9uIGFycm93X2tleV9zY3JvbGxpbmcoZmxhZykge1xuICAgIC8vIENvbmZpZ3VyZXMgYXJyb3cga2V5IHNjcm9sbGluZyBmb3IgY2FudmFzXG4gICAgaWYgKGZsYWcgPT0gZmFsc2UpIHtcbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBmdW5jdGlvbiAoZSkgeyAvLyAuZ2V0RWxlbWVudEJ5SWQoXCJkaXNwbGF5X2NhbnZhc1wiKVxuICAgICAgICBhcnJvd3MgPSBbMzcsIDM4LCAzOSwgNDBdO1xuICAgICAgICBpZiAoYXJyb3dzLmluZGV4T2YoZS5rZXlDb2RlKSA+IC0xKSB7XG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICB9XG4gICAgICB9KVxuICAgIH1cbiAgfVxuXG5cdHZhciBsZyA9IGZ1bmN0aW9uKClcblx0e1xuXHRcdC8qXG5cdFx0ICogc2hvcnRjdXQgdG8gY29uc29sZS5sb2coKVxuXHRcdCAqIHByaW50cyBhbGwgYXJndW1lbnRzIHRvIGNvbnNvbGVcblx0XHQgKiBmaXJzdCBhcmd1bWVudCBpcyB1c2VkIGFzIGEgbGFiZWwgZm9yIHRoZSByZXN0XG5cdFx0ICpcblx0XHQgKiBlYWNoIGxhYmVsZWQgZ3JvdXAgaXMgZW5jbG9zZWQgaW50byB0aGUgY29sb3JlZCBkZWxpbWl0ZXJzXG5cdFx0ICogPj4+IGFuZCA8PDwgc28gaXQncyBlYXNpbHkgZGlzdGluZ3Vpc2hlZC4gSSBmb3VuZCBpdCBoZWxwZnVsLFxuXHRcdCAqIGlmIHlvdSBkb24ndCBsZXQgbWUga25vdywgb3IgdXNlIHNvbWV0aGluZyBlbHNlXG5cdFx0ICovXG5cdFx0Y29uc29sZS5sb2coXCIlcyAlYyAlc1wiLCBhcmd1bWVudHNbMF0sIFwiYmFja2dyb3VuZDogI0RBRjJCMVwiLCBcIj4+PlwiKTtcblx0XHRcblx0XHRmb3IodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKVxuXHRcdHtcblx0XHRcdGNvbnNvbGUubG9nKFwiXFx0XCIsIGFyZ3VtZW50c1tpXSk7XG5cdFx0fVxuXHRcdGNvbnNvbGUubG9nKFwiJWM8PDxcIiwgXCJiYWNrZ3JvdW5kOiAjREFGMkIxXCIpO1xuXG5cdH07XG5cblx0dmFyIHJhbmRvbV9jaG9pY2UgPSBmdW5jdGlvbihwcm9iYWJpbGl0aWVzLCBjaG9pY2VzKXtcblx0XHQvKlxuXHRcdCAgIHRha2VzIDIgYXJyYXlzIHdpdGggZWxlbWVudHMgYXQgY29ycmVzcG9uZGluZyBpbmRleGVzXG5cdFx0ICAgYmVpbmcgY2hvaWNlIGFuZCBpdCdzIHByb2JhYmlsaXR5LiBwaWNrcyByYW5kb20gb25lLlxuXHRcdCAgIGNob2ljZXMgYXJlIGFueXRoaW5nLCBwcm9iYWJpbGl0eSBpcyBpbnRlZ2VyIGEsIHN1Y2ggdGhhdFxuXHRcdCAgIHByb2JhYmlsaXR5IG9mIGEgY2hvaWNlIGlzIGEvMTAuIHdpdGggYSA8IDEwLCBvZiBjb3Vyc2Vcblx0XHQgICBhbmQgcHJvYmFiaWxpdGllcyBhZGRpbmcgdXAgdG8gMTAuIFxuXHRcdCAgIFllcywgaXQncyBub3QgdmVyeSBnb29kIGltcGxlbWVudGF0aW9uIChyZWFkOiB0ZXJyaWJsZSksIFxuXHRcdCAgIGFuZCBzaW5jZSB5b3Ugbm90aWNlZCwgbm93IGl0J3MgeW91ciBqb2IgdG8gaW1wcm92ZSBpdC5cblxuXHRcdCovXG5cblx0XHQvLyBhcnJheSB3aXRoIGNob2ljZXMgZHVwbGljYXRlZCBhIHByb3BlciBhbW91bnQgb2YgdGltZXMgYmFzZWQgb25cblx0XHQvLyB0aGVpciBwcm9iYWJpbGl0eVxuXHRcdHZhciBibGFoID0gW107IFxuXG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IGNob2ljZXMubGVuZ3RoOyBpKyspe1xuXHRcdFx0Zm9yKHZhciBqID0gMDsgaiA8IHByb2JhYmlsaXRpZXNbaV07IGorKyl7XG5cdFx0XHRcdGJsYWgucHVzaChjaG9pY2VzW2ldKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHR2YXIgcmFuZF9pbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGJsYWgubGVuZ3RoKTtcblxuXHRcdHJldHVybiBibGFoW3JhbmRfaW5kZXhdO1xuXHR9O1xuXG5cdFxuXG5cdHJldHVybiB7XG5cdFx0bGc6IGxnLFxuXHRcdHJhbmRvbV9jaG9pY2U6IHJhbmRvbV9jaG9pY2Vcblx0fTtcblxufSkoKTtcblxubW9kdWxlLmV4cG9ydHMgPSBHYW1lVXRpbGl0eTtcbiIsInZhciBJbmNsdWRlID0gZnVuY3Rpb24oKXtcblxuXHR2YXIgbW9kdWxlcztcblxuXHQvLyBzaW1wbGUgZW51bWVyYXRvciAvLyBvcHRpb24gY29kZXMgTVVTVCBiZSBwb3dlciBvZiAyIG9yIHN1bSBvZiBvdGhlciBvcHRpb25zICh3aXRoIDAgYmVpbmcgdGhlIG9ubHkgZXhjZXB0aW9uKSwgYW5kIHVuaXF1ZVxuXHR2YXIgY2hvaWNlcyA9IChmdW5jdGlvbigpe1xuXHRcdC8vIHNpbXBsZSBvcHRpb25zOiBudW1iZXJpYyB2YWx1ZSBtdXN0IGJlIDAgb3Igc29tZSBwb3dlciBvZiAyLCBuYW1lIHNob3VsZCBiZSBhbGwgY2FwcyBhbmQgdW5pcXVlXG5cdFx0dmFyIHJlc3VsdCA9IHtOT05FOiAwLCBBTExfQ09OVFJPTExFUlM6IDEsIEFMTF9NT0RFTFM6IDIsIE9XTl9NT0RFTDogNCwgT1RIRVJfU1RVRkY6IDh9O1xuXG5cdFx0Ly8gY29tcGxleCBvcHRpb25zOiBzaG91bGQgY29uc2lzdCBvZiBzaW1wbGUgb3B0aW9ucywgYml0d2lzZSghKSBPUidlZCBvciBBTkQnZWQgdG9nZXRoZXIgaW4gYW55IGZhc2hpb25cblx0XHRyZXN1bHQuREVGQVVMVCA9IChyZXN1bHQuQUxMX0NPTlRST0xMRVJTIHwgcmVzdWx0Lk9XTl9NT0RFTCB8IHJlc3VsdC5PVEhFUl9TVFVGRik7XG5cdFx0cmVzdWx0LkFMTCA9ICAocmVzdWx0LkFMTF9DT05UUk9MTEVSUyB8IHJlc3VsdC5BTExfTU9ERUxTIHwgcmVzdWx0Lk9USEVSX1NUVUZGKTsgXG5cblx0XHQvLyBvYmplY3QgaXMgaW1tdXRhYmxlXG5cdFx0cmV0dXJuIE9iamVjdC5mcmVlemUocmVzdWx0KTtcblx0fSkoKTtcblxuXHR2YXIgbW9kdWxlX25hbWVzID0ge1xuXHRcdENvbnRyb2xsZXJzOiBbXG5cdFx0XHRcIkFzc2V0Q29udHJvbGxlclwiLFxuXHRcdFx0XCJFbmVteUNvbnRyb2xsZXJcIixcblx0XHRcdFwiR2FtZUNvbnRyb2xsZXJcIixcblx0XHRcdFwiR3JhcGhpY3NDb250cm9sbGVyXCIsXG5cdFx0XHRcIkluaXRDb250cm9sbGVyXCIsXG5cdFx0XHRcIktleWJvYXJkQ29udHJvbGxlclwiLFxuXHRcdFx0XCJQaHlzaWNzQ29udHJvbGxlclwiLFxuXHRcdFx0XCJQbGF5ZXJDb250cm9sbGVyXCIsXG5cdFx0XHRcIlRlcnJhaW5Db250cm9sbGVyXCIsXG5cdFx0XHRcIlRlcnJhaW5TbGljZUNvbnRyb2xsZXJcIixcblx0XHRcdFwiVGVzdENvbnRyb2xsZXJcIixcblx0XHRcdFwiV29ybGRDb250cm9sbGVyXCIsXG5cdFx0XHRcIkFudENvbnRyb2xsZXJcIixcblx0XHRdLFxuXG5cdFx0TW9kZWxzOiBbXG5cdFx0XG5cdFx0XHRcIkFzc2V0TW9kZWxcIixcblx0XHRcdFwiR2FtZU1vZGVsXCIsXG5cdFx0XHRcIkdyYXBoaWNzTW9kZWxcIixcblx0XHRcdFwiS2V5Ym9hcmRNb2RlbFwiLFxuXHRcdFx0XCJQaHlzaWNzTW9kZWxcIixcblx0XHRcdFwiUGxheWVyTW9kZWxcIixcblx0XHRcdFwiVGVycmFpbk1vZGVsXCIsXG5cdFx0XHRcIlRlcnJhaW5TbGljZU1vZGVsXCIsXG5cdFx0XHRcIlRlc3RNb2RlbFwiLFxuXHRcdFx0XCJXb3JsZE1vZGVsXCIsXG5cdFx0XHRcIkFudE1vZGVsXCIsXG5cdFx0XSxcblxuXHRcdE90aGVyOiBbXG5cdFx0XG5cdFx0XHRcIkIyZFwiLFxuXHRcdFx0XCJCb3gyRFwiLFxuXHRcdFx0XCJDb25maWdcIixcblx0XHRcdFwiR2FtZVV0aWxpdHlcIixcblx0XHRdXG5cblx0fTsvL2VuZCBtb2R1bGVfbmFtZXNcblxuXG5cdHZhciBpbml0ID0gZnVuY3Rpb24oKXtcblxuXHRcdG1vZHVsZXMgPSB7XG5cdFx0XHRBc3NldENvbnRyb2xsZXI6IHJlcXVpcmUoXCIuL0NvbnRyb2xsZXJzL0Fzc2V0Q29udHJvbGxlci5qc1wiKSxcblx0XHRcdEdyYXBoaWNzQ29udHJvbGxlcjogcmVxdWlyZShcIi4vQ29udHJvbGxlcnMvR3JhcGhpY3NDb250cm9sbGVyLmpzXCIpLFxuXHRcdFx0S2V5Ym9hcmRDb250cm9sbGVyOiByZXF1aXJlKFwiLi9Db250cm9sbGVycy9LZXlib2FyZENvbnRyb2xsZXIuanNcIiksXG5cdFx0XHRQaHlzaWNzQ29udHJvbGxlcjogcmVxdWlyZShcIi4vQ29udHJvbGxlcnMvUGh5c2ljc0NvbnRyb2xsZXIuanNcIiksXG5cdFx0XHRQbGF5ZXJDb250cm9sbGVyOiByZXF1aXJlKFwiLi9Db250cm9sbGVycy9QbGF5ZXJDb250cm9sbGVyLmpzXCIpLFxuXHRcdFx0VGVycmFpbkNvbnRyb2xsZXI6IHJlcXVpcmUoXCIuL0NvbnRyb2xsZXJzL1RlcnJhaW5Db250cm9sbGVyLmpzXCIpLFxuXHRcdFx0VGVycmFpblNsaWNlQ29udHJvbGxlcjogcmVxdWlyZShcIi4vQ29udHJvbGxlcnMvVGVycmFpblNsaWNlQ29udHJvbGxlci5qc1wiKSxcblx0XHRcdFdvcmxkQ29udHJvbGxlcjogcmVxdWlyZShcIi4vQ29udHJvbGxlcnMvV29ybGRDb250cm9sbGVyLmpzXCIpLFxuXHRcdFx0SW5pdENvbnRyb2xsZXI6IHJlcXVpcmUoXCIuL0NvbnRyb2xsZXJzL0luaXRDb250cm9sbGVyLmpzXCIpLFxuXHRcdFx0VGVzdENvbnRyb2xsZXI6IHJlcXVpcmUoXCIuL0NvbnRyb2xsZXJzL1Rlc3RDb250cm9sbGVyLmpzXCIpLFxuXHRcdFx0R2FtZUNvbnRyb2xsZXI6IHJlcXVpcmUoXCIuL0NvbnRyb2xsZXJzL0dhbWVDb250cm9sbGVyLmpzXCIpLFxuXHRcdFx0RW5lbXlDb250cm9sbGVyOiByZXF1aXJlKFwiLi9Db250cm9sbGVycy9FbmVteUNvbnRyb2xsZXIuanNcIiksXG5cdFx0XHRBbnRDb250cm9sbGVyOiByZXF1aXJlKFwiLi9Db250cm9sbGVycy9BbnRDb250cm9sbGVyLmpzXCIpLFxuXHRcdFx0XG5cdFx0XHQvLyBNb2RlbHNcblxuXHRcdFx0R2FtZU1vZGVsOiByZXF1aXJlKFwiLi9Nb2RlbHMvR2FtZU1vZGVsLmpzXCIpLFxuXHRcdFx0VGVycmFpblNsaWNlTW9kZWw6IHJlcXVpcmUoXCIuL01vZGVscy9UZXJyYWluU2xpY2VNb2RlbC5qc1wiKSxcblx0XHRcdEFzc2V0TW9kZWw6IHJlcXVpcmUoXCIuL01vZGVscy9Bc3NldE1vZGVsLmpzXCIpLFxuXHRcdFx0UGh5c2ljc01vZGVsOiByZXF1aXJlKFwiLi9Nb2RlbHMvUGh5c2ljc01vZGVsLmpzXCIpLFxuXHRcdFx0R3JhcGhpY3NNb2RlbDogcmVxdWlyZShcIi4vTW9kZWxzL0dyYXBoaWNzTW9kZWwuanNcIiksXG5cdFx0XHRUZXJyYWluTW9kZWw6IHJlcXVpcmUoXCIuL01vZGVscy9UZXJyYWluTW9kZWwuanNcIiksXG5cdFx0XHRXb3JsZE1vZGVsOiByZXF1aXJlKFwiLi9Nb2RlbHMvV29ybGRNb2RlbC5qc1wiKSxcblx0XHRcdEtleWJvYXJkTW9kZWw6IHJlcXVpcmUoXCIuL01vZGVscy9LZXlib2FyZE1vZGVsLmpzXCIpLFxuXHRcdFx0UGxheWVyTW9kZWw6IHJlcXVpcmUoXCIuL01vZGVscy9QbGF5ZXJNb2RlbC5qc1wiKSxcblx0XHRcdFRlc3RNb2RlbDogcmVxdWlyZShcIi4vTW9kZWxzL1Rlc3RNb2RlbC5qc1wiKSxcblx0XHRcdEFudE1vZGVsOiByZXF1aXJlKFwiLi9Nb2RlbHMvQW50TW9kZWwuanNcIiksXG5cdFx0XHRcdFxuXHRcdFx0Ly8gT3RoZXIgc3R1ZmZcblx0XHRcdFxuXHRcdFx0Q29uZmlnOiByZXF1aXJlKFwiLi9Db25maWcuanNcIiksXG5cdFx0XHRHYW1lVXRpbGl0eTogcmVxdWlyZShcIi4vR2FtZVV0aWxpdHkuanNcIiksXG5cdFx0XHRCMmQ6IHJlcXVpcmUoXCIuL0IyZC5qc1wiKSxcblx0XHRcdEJveDJEOiByZXF1aXJlKFwiYm94MmR3ZWJcIiksXG5cdFx0XG5cdFx0fTtcblx0fTsgLy8gZW5kIGluaXRcblxuXHR2YXIgb3B0aW9uX2lzX3NldCA9IGZ1bmN0aW9uKHdoYXRfbW9kc19zZWxlY3RlZCwgb3B0aW9ucyl7XG5cdFx0aWYod2hhdF9tb2RzX3NlbGVjdGVkID09IDAgJiYgb3B0aW9ucyA9PSAwKXtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblx0XHQvLyBiZSBtaW5kZnVsIG9mIGJpdHdpc2Ugb3BlcmF0b3IgYWhlYWRcblx0XHRyZXR1cm4gKHdoYXRfbW9kc19zZWxlY3RlZCAmIG9wdGlvbnMpO1xuXHR9Oy8vZW5kIG9wdGlvbl9pc19zZXRcblxuXHR2YXIgZ2V0X21vZHVsZSA9IGZ1bmN0aW9uKG5hbWUpe1xuXHRcdC8vIGNhbiBiZSBtb2RpZmllZCB0byB0aHJvdyBvYmplY3QgZXJyb3IgaW5zdGVhZCBvZiBzaW1wbGUgb25lXG5cdFx0Ly8gaW4gdGhhdCBjYXNlIGl0IG1heSBjb250YWluIGxpc3Qgb2YgZGlmaW5lZCBtb2R1bGVzXG5cdFx0Ly8gbWF5IGFsc28gYmUgbW9kaWZpZWQgdG8gY2hlY2sgd2hldGhlciBtb2R1bGUgaXMgbWlzc2luZyBmcm9tIFxuXHRcdC8vIG1vZHVsZV9uYW1lcywgbW9kdWxlcywgb3IgYm90aCwgYW5kIGdpdmUgbW9yZSBhY2N1cmF0ZSBkZXNjcmlwdGlvblxuXHRcdHZhciBtZXNzYWdlID0gXCJNb2R1bGUgXCIgKyBuYW1lICsgXG5cdFx0XHRcIiBpcyB1bmRlZmluZWQuIE5vdGUgdGhhdCB5b3UgbXVzdCBoYXJkY29kZSBhbGwgbmV3IG1vZHVsZXNcIiArIFxuXHRcdFx0XCIgaW50byB0aGUgSW5jbHVkZXMubW9kdWxlX25hbWVzIEFORCBJbmNsdWRlcy5tb2R1bGVzLlwiXG5cdFx0XG5cdFx0aWYobW9kdWxlcyl7XG5cdFx0XHRpZihtb2R1bGVzW25hbWVdKXtcblx0XHRcdFx0cmV0dXJuIG1vZHVsZXNbbmFtZV07XG5cdFx0XHR9ZWxzZSBpZihjb25zb2xlLndhcm4peyAvLyBjaGVjayBpZiBjb25zb2xlLndhcm4gaXMgYXZhaWxhYmxlXG5cdFx0XHRcdGNvbnNvbGUud2FybihtZXNzYWdlKTtcblx0XHRcdH1lbHNle1xuXHRcdFx0XHR0aHJvdyBtZXNzYWdlO1xuXHRcdFx0fVxuXHRcdH1lbHNle1xuXHRcdFx0dGhyb3cgXCJFcnJvcjogWW91IG11c3QgcnVuIHRoZSBJbmNsdWRlcy5pbml0KCkgYmVmb3JlIHlvdSBjYW4gdXNlIGFueSBtb2R1bGVzXCI7XG5cdFx0fVxuXHR9Oy8vZW5kIGdldF9tb2R1bGVcblx0XG5cblx0dmFyIGdldF9uYW1lcyA9IGZ1bmN0aW9uKGN1cnJlbnRfbW9kdWxlX25hbWUsIG9wdGlvbnNfY29kZSl7XG5cdFx0dmFyIHJlc3VsdCA9IHtNb2RlbHM6IFtdLCBDb250cm9sbGVyczogW10sIE90aGVyOiBbXX07XG5cblx0XHRpZihvcHRpb25faXNfc2V0KGNob2ljZXMuTk9ORSwgb3B0aW9uc19jb2RlKSl7XG5cdFx0XHRyZXR1cm4gcmVzdWx0O1xuXHRcdH1cblxuXHRcdGlmIChvcHRpb25faXNfc2V0KGNob2ljZXMuQUxMX0NPTlRST0xMRVJTLCBvcHRpb25zX2NvZGUpKXtcblxuXHRcdFx0dmFyIGNvbnRyb2xsZXJfbmFtZXMgPSBtb2R1bGVfbmFtZXMuQ29udHJvbGxlcnM7XG5cblx0XHRcdGZvcih2YXIgaSA9IDA7IGkgPCBjb250cm9sbGVyX25hbWVzLmxlbmd0aDsgaSsrKXtcblxuXHRcdFx0XHR2YXIgY3RsX25hbWUgPSBjb250cm9sbGVyX25hbWVzW2ldO1xuXG5cdFx0XHRcdGlmKGN0bF9uYW1lICE9IGN1cnJlbnRfbW9kdWxlX25hbWUpe1xuXHRcdFx0XHRcdHJlc3VsdC5Db250cm9sbGVycy5wdXNoKGN0bF9uYW1lKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0fVxuXG5cdFx0aWYgKG9wdGlvbl9pc19zZXQoY2hvaWNlcy5BTExfTU9ERUxTLCBvcHRpb25zX2NvZGUpKXtcblx0XHRcdHJlc3VsdC5Nb2RlbHMgPSBtb2R1bGVfbmFtZXMuTW9kZWxzO1xuXHRcdH1cblx0XHRlbHNlIGlmKG9wdGlvbl9pc19zZXQoY2hvaWNlcy5PV05fTU9ERUwsIG9wdGlvbnNfY29kZSkpe1xuXHRcdFx0dmFyIG93bl9tb2RlbCA9IGN1cnJlbnRfbW9kdWxlX25hbWUucmVwbGFjZShcIkNvbnRyb2xsZXJcIiwgXCJNb2RlbFwiKTtcblx0XHRcdHJlc3VsdC5Nb2RlbHMucHVzaChvd25fbW9kZWwpO1xuXHRcdH1cblxuXHRcdGlmKG9wdGlvbl9pc19zZXQoY2hvaWNlcy5PVEhFUl9TVFVGRiwgb3B0aW9uc19jb2RlKSl7XG5cdFx0XHRyZXN1bHQuT3RoZXIgPSBtb2R1bGVfbmFtZXMuT3RoZXI7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHJlc3VsdDtcblx0fTsvL2VuZCBnZXRfbmFtZXNcblxuXHR2YXIgZ2V0X25hbWVfc3RhdGVtZW50cyA9IGZ1bmN0aW9uKG5hbWVzKXtcblx0XHR2YXIgcmVzdWx0ID0gXCJcIjtcblx0XHRmb3IodmFyIHNlY3Rpb25faW5kZXggPSAwOyBzZWN0aW9uX2luZGV4IDwgMzsgc2VjdGlvbl9pbmRleCsrKXtcblx0XHRcdHZhciBzZWN0aW9uID0gW1wiTW9kZWxzXCIsIFwiQ29udHJvbGxlcnNcIiwgXCJPdGhlclwiXVtzZWN0aW9uX2luZGV4XTtcblx0XHRcdGZvcih2YXIgaSA9IDA7IGkgPCBuYW1lc1tzZWN0aW9uXS5sZW5ndGg7IGkrKyl7XG5cdFx0XHRcdHJlc3VsdCArPSAoXCJ2YXIgXCIgKyBuYW1lc1tzZWN0aW9uXVtpXSArIFwiOyBcIik7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHJlc3VsdDtcblx0XHRcblx0fTsvL2VuZCBnZXRfbmFtZV9zdGF0ZW1lbnRzXG5cblx0dmFyIGdldF9tb2R1bGVfc3RhdGVtZW50cyA9IGZ1bmN0aW9uKG5hbWVzKXtcblx0XHR2YXIgcmVzdWx0ID0gXCJcIjtcblx0XHRmb3IodmFyIHNlY3Rpb25faW5kZXggPSAwOyBzZWN0aW9uX2luZGV4IDwgMzsgc2VjdGlvbl9pbmRleCsrKXtcblx0XHRcdHZhciBzZWN0aW9uID0gW1wiTW9kZWxzXCIsIFwiQ29udHJvbGxlcnNcIiwgXCJPdGhlclwiXVtzZWN0aW9uX2luZGV4XTtcblx0XHRcdGZvcih2YXIgaSA9IDA7IGkgPCBuYW1lc1tzZWN0aW9uXS5sZW5ndGg7IGkrKyl7XG5cdFx0XHRcdHJlc3VsdCArPSAobmFtZXNbc2VjdGlvbl1baV0gKyBcIiA9IEluY2x1ZGVzLmdldF9tb2R1bGUoXFxcIlwiICsgbmFtZXNbc2VjdGlvbl1baV0gKyBcIlxcXCIpOyBcIik7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHJlc3VsdDtcblx0fTsvL2VuZCBnZXRfbW9kdWxlX3N0YXRlbWVudHNcblxuXHR2YXIgZ2V0X2luY2x1ZGVfZGF0YSA9IGZ1bmN0aW9uKHBhcmFtcyl7XG5cdFx0dmFyIGN1cnJlbnRfbW9kdWxlID0gcGFyYW1zLmN1cnJlbnRfbW9kdWxlO1xuXHRcdHZhciBpbmNsdWRlX29wdGlvbnMgPSBwYXJhbXMuaW5jbHVkZV9vcHRpb25zO1xuXHRcdHZhciBuYW1lcyA9IGdldF9uYW1lcyhjdXJyZW50X21vZHVsZSwgaW5jbHVkZV9vcHRpb25zKTtcblxuXHRcdHZhciBuYW1lX3N0YXRlbWVudHMgPSBnZXRfbmFtZV9zdGF0ZW1lbnRzKG5hbWVzKTtcblx0XHR2YXIgbW9kdWxlX3N0YXRlbWVudHMgPSBnZXRfbW9kdWxlX3N0YXRlbWVudHMobmFtZXMpO1xuXG5cdFx0cmV0dXJuIHtcblx0XHRcdGltcG9ydGVkX21vZHVsZXM6IG5hbWVzLFxuXHRcdFx0bmFtZV9zdGF0ZW1lbnRzOiBuYW1lX3N0YXRlbWVudHMsXG5cdFx0XHRtb2R1bGVfc3RhdGVtZW50czogbW9kdWxlX3N0YXRlbWVudHMsXG5cdFx0fTtcblxuXHR9Oy8vZW5kIGdldF9pbmNsdWRlX2RhdGFcblxuXHR2YXIgYXV0b21hdGVkX3Rlc3RzID0gZnVuY3Rpb24oKXtcblx0XHRcblx0XHRRVW5pdC50ZXN0KFwib3B0aW9uIG1hdGNoaW5nIGZ1bmN0aW9uXCIsIGZ1bmN0aW9uKCBhc3NlcnQpIHtcblxuXHRcdFx0Ly9JZiBib3RoIGFyZSBub25lXG5cdFx0XHRhc3NlcnQuZXF1YWwob3B0aW9uX2lzX3NldChjaG9pY2VzLk5PTkUsIGNob2ljZXMuTk9ORSksIHRydWUpO1xuXG5cdFx0XHRhc3NlcnQudGhyb3dzKG9wdGlvbl9pc19zZXQoY2hvaWNlcy5OT05FLCAtMSkpO1xuXG5cdFx0XHQvL0lmIGJvdGggbWF0Y2gsIGl0IHJldHVybnMgdGhlIHZhbHVlIG9mIGNob2ljZXNcblx0XHRcdC8vSWYgdGhleSBkb24ndCBtYXRjaCwgaXQgcmV0dXJucyAwXG5cdFx0XHRcblx0XHRcdC8vTUFUQ0hcblx0XHRcdGFzc2VydC5lcXVhbChvcHRpb25faXNfc2V0KGNob2ljZXMuQUxMX0NPTlRST0xMRVJTLCBjaG9pY2VzLkFMTF9DT05UUk9MTEVSUyksIDEpO1xuXHRcdFx0YXNzZXJ0LmVxdWFsKG9wdGlvbl9pc19zZXQoY2hvaWNlcy5BTExfTU9ERUxTLCBjaG9pY2VzLkFMTF9NT0RFTFMpLCAyKTtcblx0XHRcdGFzc2VydC5lcXVhbChvcHRpb25faXNfc2V0KGNob2ljZXMuT1RIRVJfU1RVRkYsIGNob2ljZXMuT1RIRVJfU1RVRkYpLCA4KTtcblxuXHRcdFx0Ly9NaXNtYXRjaFxuXHRcdFx0YXNzZXJ0LmVxdWFsKG9wdGlvbl9pc19zZXQoY2hvaWNlcy5OT05FLCBjaG9pY2VzLkFMTF9DT05UUk9MTEVSUyksIDApO1xuXHRcdFx0YXNzZXJ0LmVxdWFsKG9wdGlvbl9pc19zZXQoY2hvaWNlcy5PVEhFUl9TVFVGRiwgY2hvaWNlcy5OT05FKSwgMCk7XG5cdFx0XHRhc3NlcnQuZXF1YWwob3B0aW9uX2lzX3NldChjaG9pY2VzLkFMTF9NT0RFTFMsIGNob2ljZXMuQUxMX0NPTlRST0xMRVJTKSwgMCk7XG5cdFx0XHRhc3NlcnQuZXF1YWwob3B0aW9uX2lzX3NldChjaG9pY2VzLk9XTl9NT0RFTCwgY2hvaWNlcy5BTExfTU9ERUxTKSwgMCk7XG5cdFx0fSk7Ly9lbmQgb3B0aW9uIG1hdGNoaW5nIHRlc3Rcblx0XHRcblx0fTsvL2VuZCBhdXRvbWF0ZWRfdGVzdHNcblxuXG5cdHJldHVybiB7XG5cdFx0aW5pdDogaW5pdCxcblx0XHRtb2R1bGVfbmFtZXM6IG1vZHVsZV9uYW1lcyxcblx0XHRnZXRfbW9kdWxlOiBnZXRfbW9kdWxlLFxuXHRcdGdldF9pbmNsdWRlX2RhdGE6IGdldF9pbmNsdWRlX2RhdGEsXG5cdFx0Y2hvaWNlczogY2hvaWNlcyxcblx0XHRhdXRvbWF0ZWRfdGVzdHM6IGF1dG9tYXRlZF90ZXN0c1xuXHR9O1xuXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBJbmNsdWRlO1xuXG4iLCIvL01vZGVsIENvbXBvbmVudCAocmVwcmVzZW50YXRpb24gb2YgZW5lbXkgZGF0YSlcblxuXG52YXIgQW50TW9kZWwgPSBmdW5jdGlvbigpe1xuXHQvL2RlZmluZSB5b3VyIGNvbnN0YW50cyBoZXJlXG5cdHRoaXMuSCA9IDMxOy8vaGVpZ2h0XG5cdHRoaXMuVyA9IDUwO1xuXHR0aGlzLnNwcml0ZV9hcnJheSA9IFtdOyAgLy9zaW5nbGUgc291cmNlIGZvciBzcHJpdGVzXG5cdHRoaXMudHlwZSA9IFwiZW5lbXlcIjtcblx0XG5cdHRoaXMuaGVyb19odXJ0X21lID0gZmFsc2U7XG5cdHRoaXMubWVfaHVydF9oZXJvID0gZmFsc2U7XG5cdHRoaXMuZGVhdGhfdGljayA9IDA7XG5cblx0Ly9zZXQgeW91ciBnYW1lIGxvZ2ljIHBhcmFtZXRlcnMgaGVyZVxuXHR0aGlzLm9iamVjdF9pZCA9IDE7IC8vaGFyZGNvZGUgYSB1bmlxdWUgaWRlbnRpZmllciBmb3IgZWFjaCBuZXcgZW5lbXkgY2xhc3Ncblx0dGhpcy5ocCA9IDI7XG5cdHRoaXMuc3BlZWQgPSA0O1xuXHR0aGlzLmRhbWFnZSA9IDE7XG5cdC8vdGhpcy5hdHRhY2tfY29vbGRvd24gPSA0OyAvL3VzZSB0aGlzIGZvciBlbmVtaWVzIHdobyBuZWVkXG5cdHRoaXMuY2FuX2F0dGFjayA9IHRydWU7Ly91c2UgdGhpcyBmb3IgZW5lbWllcyB3aG8gYWx0ZXJuYXRlIGJldHdlZW4gXG5cdC8vdGhpcy5jb29sZG93bl90aW1lcj0tMTtcblx0dGhpcy5BSV9zdGF0ZSA9IFwid2Fsa1wiOy8vdXNlIHRoaXMgdG8ga2VlcCB0cmFjayBvZiB0aGUgZW5lbXkncyBBSSBzdGF0ZVxuXHRcblx0LyogVEhJUyBET0VTIE5PVCBCRUxPTkcgSEVSRS4gXG5cdC8vZGVmaW5lIGZpeHR1cmUgKGZyaWN0aW9uLCBkZW5zaXR5LCBldGMuKVxuXHR0aGlzLmZpeHR1cmVfZGVmID0gbmV3IGJveDJkLmIyRml4dHVyZURlZlxuXHQvL2RlbnNpdHkgPSAobWFzcy92b2x1bWUpXG5cdHRoaXMuZml4dHVyZV9kZWYuZGVuc2l0eSA9IDE7XG5cdC8vZnJpY3Rpb24gaXMgd2hhdCB5b3Ugd291bGQgaW1hZ2luZVxuXHR0aGlzLmZpeHR1cmVfZGVmLmZyaWN0aW9uID0gMTtcblx0Ly9yZXN0aXR1dGlvbiA9IGJvdW5jaW5lc3Ncblx0dGhpcy5maXh0dXJlX2RlZi5yZXN0aXR1dGlvbiA9IDAuNTtcblx0Ly9zaGFwZSA9IHRoZSBpbnRlcm5hbCBib3gyZCBwb2x5Z29uIHVzZWQgZm9yIGNvbGxpc2lvblxuXHR0aGlzLmZpeHR1cmVfZGVmLnNoYXBlID0gbmV3IGJveDJkLmIyUG9seWdvblNoYXBlKCkuQXNCb3goSCxXKTtcblx0XG5cdC8vZGVmaW5lIGJvZHkgKHBoeXNpY3Mgc3R1ZmYpXG5cdHRoaXMuYm9keV9kZWYgPSBuZXcgYm94MmQuYjJCb2R5RGVmKCk7XG5cdHRoaXMuYm9keV9kZWYudHlwZSA9IGJveDJkLmIyQm9keS5iMl9keW5hbWljQm9keTtcblx0dGhpcy5ib2R5X2RlZi5pc19zZW5zb3IgPSB0cnVlO1xuXHR0aGlzLmJvZHkuU2V0TGluZWFyVmVsb2NpdHkobmV3IGJveDJkLmIyVmVjMigwLCAwKSk7Ki9cblx0XG5cdC8vZGVmaW5lIHNwcml0ZSAodGhlIGdyYXBoaWNzKVxuXHQvL3dhbGtpbmcgc3ByaXRlXG5cdFxuXHQvL0FjY2Vzc29yIHRvIHN0YXRlIGFuZCBzcHJpdGVcblx0Lypcblx0Tk9URVMgT04gR1JBUEhJQ1Ncblx0ZWFjaCBzcHJpdGUgc2hlZXQgY29udGFpbnMgYSBudW1iZXIgb2YgZnJhbWVzIGluIGEgc2luZ2xlIGFuaW1hdGlvbi4gXG5cdGNyZWF0ZSBhIG5ldyBzcHJpdGVfc2hlZXQgb2JqZWN0IGZvciBlYWNoIGFuaW1hdGlvblxuXHRzZXQgdGhpcy5zcHJpdGUgdG8gdGhlIGRlZmF1bHQgc3RhcnRpbmcgYW5pbWF0aW9uXG5cdFxuXHRmcmFtZXJhdGUgaXMgdGhlIG51bWJlciBvZiBmcmFtZXMgY3ljbGVkIHBlciBzZWNvbmRcblx0aW1hZ2VzIGxvYWRzIHRoZSBhY3R1YWwgcG5nIGZpbGUgZnJvbSB0aGUgYXNzZXRzIGZvbGRlclxuXHRmcmFtZXMgc3BlY2lmaWVzIGhvdyB0aGUgcmF3IGltYWdlIHNob3VsZCBiZSBwYXJ0aXRpb25lZCB0byBnZW5lcmF0ZSB0aGUgYWN0dWFsIGZyYW1lcyBcblx0XHRyZWdYICYgcmVnWSBhcmUgeHkgb2Zmc2V0c1xuXHRcdGhlaWdodCBhbmQgd2lkdGggZ2l2ZSB0aGUgZGltZW5zaW9ucyBvZiB0aGUgaW5kaXZpZHVhbCBmcmFtZXNcblx0XHRjb3VudCBzcGVjaWZpZXMgdGhlIG51bWJlciBvZiBmcmFtZXNcblx0WW91IG5lZWQgdG8gbWFrZSBzdXJlIHRoYXQgaGVpZ2h0KmNvdW50IDw9IHRoZSBoZWlnaHQgb2YgdGhlIG9yaWdpbmFsIGZpbGUgKHNhbWUgZm9yIHdpZHRoKVxuXHRcblx0XG5cdGJlIGF3YXJlIHRoYXQgdGhlIG9yaWdpbiBvZiB0aGUgYm9keS5zaGFwZShILzIsVy8yKSAhPSB0aGUgb3JpZ2luIG9mIHRoZSBzcHJpdGUgKDAsMClcblx0cmVnWCBhbmQgcmVnWSBhcmUgeHkgb2Zmc2V0cyBmb3IgdGhlIHNwcml0ZS4gdXNlIHRoZXNlIHRvIGtlZXAgdGhlIFxuXHRzcHJpdGUgaW4gdGhlIHJpZ2h0IHBsYWNlIHJlbGF0aXZlIHRvIHRoZSBib3gyZCBib2R5XG5cdFxuXHQqL1xuXHRcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbmV3IEFudE1vZGVsO1xuXG4iLCJ2YXIgQXNzZXRNb2RlbCA9IG5ldyBmdW5jdGlvbigpe1xuXHQvLyBBcyBhbHdheXMsIGFsbW9zdCBhbnl0aGluZyBpcyBpbml0aWFsaXplZCBpbiB0aGUgSW5pdENvbnRyb2xsZXJcblx0XG5cdHRoaXMubG9hZGVyO1xuXG5cdHRoaXMubWFuaWZlc3QgPSBbIC8vIGRlZmluaW5nIHJlc291cmNlcyB0byBiZSBsb2FkZWQgaW4gYnVsayB3aXRoIHByZWxvYWQuanNcblx0XHRcdHtzcmM6IFwiZ3JlZWtfd2Fycmlvci5wbmdcIiwgaWQ6IFwiZ3JlZWtfd2FycmlvclwifSxcblx0XHRcdC8ve3NyYzosIGlkOn0sXG5cdFx0XHR7c3JjOiBcIm1pZGRsZV90ZXJyYWluLnBuZ1wiLCBpZDpcIm1pZGRsZV90ZXJyYWluXCJ9LFxuXHRcdFx0e3NyYzogXCJib3R0b21fdGVycmFpbi5wbmdcIiwgaWQ6IFwiYm90dG9tX3RlcnJhaW5cIn0sXG5cdFx0XHR7c3JjOiBcImdyYXNzLnBuZ1wiLCBpZDogXCJncmFzc1wifSxcblx0XHRcdHtzcmM6IFwiQW50Q2hvbXBlcnMucG5nXCIsIGlkOiBcIkFudDFcIn0sXG5cdFx0XHR7c3JjOiBcIkFudENob21wZXJzMi5wbmdcIiwgaWQ6IFwiQW50MlwifSxcblx0XHRcdHtzcmM6IFwiQW50Q2hvbXBlcnNEZWF0aC5wbmdcIiwgaWQ6IFwiQW50M1wifVxuXHRcdF07IFxuXHRcdC8vIFRPRE8gbWFrZSBhZGRpbmcgcmVzb3VyY2VzIGVhc2llcj8gQXV0b21hdGljIGxvYWRpbmcgXG5cdFx0Ly8gb2YgZXZlcnl0aGluZyBmcm9tIGFzc2V0cywgYXV0b21hdGljIG5hbWVzIGV0Yy4/XG5cblx0dGhpcy5zaGFwZXMgPSB7fTsgLy8gbWF5YmUgdGhpcyBhcmVuJ3QgbmVlZGVkXG5cblx0dGhpcy5iaXRtYXBzID0ge307XG5cblx0dGhpcy5hbmltYXRpb25zID0ge307XG5cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gQXNzZXRNb2RlbDtcbiIsInZhciBHYW1lTW9kZWwgPSBuZXcgZnVuY3Rpb24oKXsgLy8gbWFpbiBtb2RlbFxuXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEdhbWVNb2RlbDtcbiIsInZhciBHcmFwaGljc01vZGVsID0gZnVuY3Rpb24oKXtcblx0dGhpcy5zdGFnZTsgLy8gbWFpbiBzdGFnZSB0byB3aGVyZSBldmVyeXRoaW5nIHdpbGwgYmUgZHJhd25cblx0Ly8gbm90ZSB0aGF0IGV2ZXJ5IGdyYXBoaWNzIG9iamVjdCBtdXN0IGJlIGF1Z21lbnRlZCB3aXRoXG5cdC8vIHRoZSByZWZlcmVuY2UgdG8gdGhlIGNvcnJlc3BvbmRpbmcgcGh5c2ljcyBvYmplY3QsIGlmIGFueVxuXHR0aGlzLmhlcm87XG5cdHRoaXMub3RoZXJfcGxheWVycyA9IFtdOyAvLyBhcnJheSBvZiBwbGF5ZXJzIG90aGVyIHRoZW4gaGVybyBmb3IgbXVsdGlwbGF5ZXJcblx0dGhpcy5hbnQ7XG4gICAgLy9QSVpaQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQVxuXHR0aGlzLmhlYWx0aDtcblx0dGhpcy5zY29yZTtcblx0Ly8gYWxsIG9iamVjdCByZWdpc3RlcmVkIGZvciBjb250aW5pb3VzIHVwZGF0ZSB0byBtYXRjaCB0aGVpciBwaHlzaWNhbCBib2R5XG5cdC8vIHBvc2l0aW9uIFxuXHR0aGlzLmFsbF9waHlzaWNhbCA9IFtdOyBcblxuXHQvLyBhbGwgc3ByaXRlc2hlZXQgZGVmaW5pdGlvbnMgKGFkZGVkIGF0IHRoZSBpbml0aWFsaXphdGlvbiBzdGFnZVxuXHQvLyBiZWNhdXNlIHRoZXkgbmVlZCBhc3NldHMgdG8gYmUgbG9hZGVkKVxuXHR0aGlzLnNwcml0ZXNoZWV0cyA9IHt9OyBcblxuXHR0aGlzLmNhbWVyYSA9IHtcblx0XHQvLyBzaG91bGQgYmUgZWFzZWxqcyBvYmplY3Qgb3IgbnVsbFxuXHRcdGZvbGxvd2luZzogbnVsbCxcblxuXHRcdC8vIGludGVybmFsIGNhbWVyYSBpbXBsZW1lbnRhdGlvbiB0aGluZyB0byBrbm93IGhvdyBmYXIgdG8gb2Zmc2V0IGZyb20gdGhlXG5cdFx0Ly8gaW5pdGlhbCBwb3NpdGlvblxuXHRcdG9mZnNldDoge3g6IDAsIHk6IDB9LFxuXG5cdFx0Ly8gdGhlIG9mZnNldCBvZiB0aGUgY2FtZXJhIGZyb20gdGhlIGZvbGxvd2VkIG9iamVjdFxuXHRcdC8vIGUuZy4gb2Zmc2V0IG9mIHt4OiAxMDAsIHk6IDEwMH0gd2lsbCBjZW50ZXIgY2FtZXJhXG5cdFx0Ly8gMTAwIHBpeGVscyB0byB0aGUgcmlnaHQgYW5kIDEwMCBwaXhlbHMgYmVsb3cgdGhlIGZvbGxvd2VkIG9iamVjdFxuXHRcdG9mZnNldF9mcm9tX2ZvbGxvd2VkOiB7eDogNDAwLCB5OiAtMTAwfSxcblx0XHQvL29mZnNldF9mcm9tX2ZvbGxvd2VkOiB7eDogMzMwLCB5OiAtMjA1fSwgLy9GT1IgR0FNRSBQQUdFXG5cdFx0Ly8gdGhpcyBpcyBjZW50ZXIgb2YgdGhlIHNjcmVlbiBpbiBwaXhlbHMuIGdldHMgZHluYW1pY2FsbHkgcmVjYWxjdWxhdGVkIFxuXHRcdC8vIGR1cmluZyB0aGUgY2FtZXJhIHVwZGF0ZSBzbyBpZiBpdCdzIGV2ZXIgY2hhbmdlZCwgY2FtZXJhIHN0aWxsIHdvcmtzIGFzIGV4cGVjdGVkXG5cdFx0Y2VudGVyOiB7eDogMCwgeTogMH1cblxuXHR9O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBuZXcgR3JhcGhpY3NNb2RlbDtcblxuIixudWxsLCJcbnZhciBQaHlzaWNzTW9kZWwgPSBmdW5jdGlvbigpIHtcblx0XG5cdHRoaXMuZ3Jhdml0eTtcblx0dGhpcy53b3JsZDtcbiBcblx0Ly8gZ2V0dGluZyBjb250ZXh0IG9mIHRoZSBkZWJ1ZyBjYW52YXMsIGZvciBib3gyZCB0byBkcmF3IGRlYnVnZ2luIGJveGVzXG5cblx0Ly8gdGltZVRvQ292ZXIgaXMgdGhlIHRpbWUgdGhhdCBzaW11bGF0aW9uIG11c3QgY292ZXIgdG8gY2F0Y2ggdXAgdG8gdGhlIHJlYWwgd29ybGQgdGltZTtcblx0Ly8gc2luY2UgY3JlYXRlanMgdGlja2VyIGlzIHdoYXQgd2UgdXNlIGZvciB0aW1pbmcsIGFuZCBib3gyZCB0aWNrc1xuXHQvLyBtdXN0IGJlIG9mIGNvbnN0YW50IGxlbmd0aCBhbmQgaW5kZXBlbmRlbnQgZnJvbSB0aGUgZ3JhcGhpY3MgZnJhbWVyYXRlLFxuXHQvLyB3ZSBrZWVwIHRyYWNrIG9mIHRpbWUgdGhhdCBwYXNzZWQgc2luY2UgbGFzdCBib3gyZCBzdGVwIGJ5IGFkZGluZyB0aW1lIGRlbHRhc1xuXHQvLyB0byB0aGUgdGltZVRvQ292ZXIuIFRoZW4sIHdoZW4gdGltZVRvQ292ZXIgZXhjZWVkcyBkZXNpcmVkIGJveDJkIHN0ZXAgbGVuZ3RoLFxuXHQvLyB3ZSBwZXJmb3JtIHRoZSBzdGVwIGFuZCBzdWJ0cmFjdCB0aGUgY29ycmVzcG9uZGluZyB0aW1lIGZyb20gdGhlIHRpbWVUb0NvdmVyO1xuXHQvLyBJZiBhbnl0aGluZyBpcyBzdGlsbCB1bmNsZWFyLCBhc2sgbWUgKEFLKTtcblx0XHR0aGlzLnRpbWVUb0NvdmVyID0gMDsgXG5cblx0dGhpcy5zdGVwX2Ftb3VudDtcblxufTsgXG5cbnZhciB0ZW1wbGF0ZXM7XG4vKlxuICogUGFyYW1ldGVycyBmb3IgYjJkIGJvZHkgZGVmaW5pdGlvblxuXHRhY3RpdmU6IHRydWVcblx0YWxsb3dTbGVlcDogdHJ1ZVxuXHRhbmdsZTogMFxuXHRhbmd1bGFyRGFtcGluZzogMFxuXHRhbmd1bGFyVmVsb2NpdHk6IDBcblx0YXdha2U6IHRydWVcblx0YnVsbGV0OiBmYWxzZVxuXHRmaXhlZFJvdGF0aW9uOiBmYWxzZVxuXHRpbmVydGlhU2NhbGU6IDFcblx0bGluZWFyRGFtcGluZzogMFxuXHRsaW5lYXJWZWxvY2l0eTogYjJWZWMyXG5cdHBvc2l0aW9uOiBiMlZlYzJcblx0dHlwZTogMFxuXHR1c2VyRGF0YTogbnVsbFxuKi9cblxuLypcbiAqIEZpeHR1cmUgZGVmaW5pdGlvbiBwYXJhbWV0ZXJzOlxuXHRkZW5zaXR5OiAwXG5cdGZpbHRlcjogYjJGaWx0ZXJEYXRhXG5cdGZyaWN0aW9uOiAwLjJcblx0aXNTZW5zb3I6IGZhbHNlXG5cdHJlc3RpdHV0aW9uOiAwXG5cdHNoYXBlOiBudWxsXG5cdHVzZXJEYXRhOiBudWxsXG4gKi9cblxuLy8gcmVjdGFuZ3VsYXJcblBoeXNpY3NNb2RlbC5wcm90b3R5cGUucl90ZW1wbGF0ZXMgPSByX3RlbXBsYXRlcyA9IHt9O1xuLy8gY2lyY3VsYXJcblBoeXNpY3NNb2RlbC5wcm90b3R5cGUuY190ZW1wbGF0ZXMgPSBjX3RlbXBsYXRlcyA9IHt9O1xuLy8gcG9seWdvbmFsXG5QaHlzaWNzTW9kZWwucHJvdG90eXBlLnBfdGVtcGxhdGVzID0gcF90ZW1wbGF0ZXMgPSB7fTtcblxuXG5cbnJfdGVtcGxhdGVzW1wiZGVmYXVsdFwiXSA9IHtcblxuXHQvL3NoYXBlOiBcInJlY3RhbmdsZVwiLCAvLyBpbXBsaWVkIGZyb20gdGhlIHRlbXBsYXRlIHR5cGVcblx0eDogMyxcblx0eTogMyxcblx0dng6IDAsXG5cdHZ5OiAwLFxuXG5cdHdpZHRoOiA1LFxuXHRoZWlnaHQ6IDUsXG5cdGRlbnNpdHk6IDIsXG5cdGZyaWN0aW9uOiAxLFxuXHRyZXN0aXR1dGlvbjogMC4yLFxuXHRpc1NlbnNvcjogZmFsc2UsXG5cblxuXHRhY3RpdmU6IHRydWUsXG5cdGFsbG93U2xlZXA6IHRydWUsXG5cdGFuZ2xlOiAwLFxuXHRhbmd1bGFyVmVsb2NpdHk6IDAsXG5cdGF3YWtlOiB0cnVlLFxuXHRidWxsZXQ6IGZhbHNlLFxuXHRmaXhlZFJvdGF0aW9uOiBmYWxzZSxcblx0dHlwZTogXCJkeW5hbWljXCIsXG5cbn07XG5cbnJfdGVtcGxhdGVzLmxpdmluZyA9IHtcblx0Zml4ZWRSb3RhdGlvbjogdHJ1ZSxcblx0YXdha2U6IHRydWUsXG5cdGlzU2Vuc29yOiBmYWxzZSxcblx0Ly9tb2JleHArK1xufTtcblxucl90ZW1wbGF0ZXMudGVycmFpbl90aWxlID0ge1xuXHR0eXBlOiBcInN0YXRpY1wiLFxuXHR3aWR0aDogMSxcblx0aGVpZ2h0OiAxLFxuXHQvL21vYmV4cCsrXG59O1xuXG5yX3RlbXBsYXRlcy5wbGF5ZXIgPSB7XG5cdHBhcmVudDogcl90ZW1wbGF0ZXMubGl2aW5nLFxuXHR3aWR0aDogMS41LFxuXHRoZWlnaHQ6IDIuNSxcblx0dHlwZTogXCJkeW5hbWljXCIsXG5cdC8vbW9iZXhwKytcbn07XG5cbnJfdGVtcGxhdGVzLmFudCA9IHtcblx0cGFyZW50OiByX3RlbXBsYXRlcy5saXZpbmcsXG5cdHdpZHRoOiAxLFxuXHRoZWlnaHQ6IDAuNSxcblx0dHlwZTogXCJkeW5hbWljXCIsXG5cdHg6IDQwLFxuXHR5OiAxMCxcblx0Ly9tb2JleHArK1xufTtcblxucl90ZW1wbGF0ZXMudGVzdCA9IHtcblx0d2lkdGg6IDEsXG5cdGhlaWdodDogMixcblx0Zml4ZWRSb3RhdGlvbjogZmFsc2UsXG5cdC8vbW9iZXhwKytcbn1cblxucl90ZW1wbGF0ZXMucGxhdGZvcm0gPSB7XG4gICAgeDogMTAsXG4gICAgeTogMTEsXG4gICAgd2lkdGg6IDEwLFxuICAgIGhlaWdodDogLjUsXG4gICAgdHlwZTogXCJzdGF0aWNcIixcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBuZXcgUGh5c2ljc01vZGVsO1xuIiwidmFyIFBsYXllck1vZGVsID0gZnVuY3Rpb24oKXtcblx0dGhpcy5oZXJvO1xuXHR0aGlzLnR5cGUgPSBcImhlcm9cIjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbmV3IFBsYXllck1vZGVsO1xuXG4iLCJ2YXIgVGVycmFpbk1vZGVsID0gZnVuY3Rpb24oKXtcblx0Ly9UaGlzIGlzIHBoeXNpY3MsIGZvciBncmFwaGljcyBsb29rIGludG8gdGhlIEdyYXBoaWNzQ29udHJvbGxlci9Nb2RlbFxuXHR0aGlzLnRlcnJhaW5fc2xpY2VzX3F1ZXVlID0gW107XG5cdHRoaXMubmV3X3NsaWNlcyA9IFtdO1xuXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBUZXJyYWluTW9kZWw7XG4iLCJUZXJyYWluU2xpY2VDb25maWcgPSByZXF1aXJlIChcIi4uL0NvbmZpZy5qc1wiKS5UZXJyYWluU2xpY2U7XG5cbnZhciBUZXJyYWluU2xpY2VNb2RlbCA9IGZ1bmN0aW9uKCl7XG5cdHRoaXMuaWQgPSBUZXJyYWluU2xpY2VDb25maWcubmV4dF9zbGljZV9pZCsrOyAvLyBhdXRvbWF0aWNhbGwgYXNzaWduIGlkIGFuZCBpbmNyZW1lbnQgXG5cblx0dGhpcy5ncmlkX2NvbHVtbnMgPSBUZXJyYWluU2xpY2VDb25maWcuZ3JpZF9jb2x1bW5zO1xuXHR0aGlzLmdyaWRfcm93cyA9IFRlcnJhaW5TbGljZUNvbmZpZy5ncmlkX3Jvd3M7XG5cdHRoaXMuY2VsbF93ID0gVGVycmFpblNsaWNlQ29uZmlnLmNlbGxfdztcblx0XG5cdC8vIGdyaWRbaV1bal0gaXMgdGhlIGVsZW1lbnQgaW4gdGhlIGkncyBjb2x1bW4gYW5kIGoncyByb3dcblx0Ly8gdGhlIGdyaWQgaXMgbWFpZCB0byBtYXRjaCB0aGUgc2NyZWVuIGNvb3JkaW5hdGVzIGFuZCB0aGUgY3VycmVudCBib3gyZCBjb29yZGluYXRlc1xuXHQvLyBpLmUuIGdyaWRbMF1bMF0gaXMgdGhlIG9uZSBpbiB0aGUgdG9wIGxlZnQgY29ybmVyIG9mIHRoZSB0ZXJyYWluIHNsaWNlXG5cdC8vIGRvIHdlIHdhbnQgdG8gY2hhbmdlIGl0PyB3b3VsZCBpdCBiZSBlYXNpZXIgdG8gZ2VuZXJhdGUgdGVycmFpbiBpZiB3ZSBzdGFydCBhdCB0aGUgYm90dG9tP1xuXHQvLyBpZiB5ZXMsIHRoZW4gd2hhdCBtYWtlcyBtb3JlIHNlbnNlLCBjaGFuZ2luZyBjb29yZGluYXRlIHN5c3RlbXMgb3IganVzdCBzd2l0Y2hpbmcgZ2VuZXJhdGlvblxuXHQvLyBsb29wcyBhcm91bmQ/IGRpc2N1c3Ncblx0Ly9cblx0Ly8gbm90aWNlIHRoYXQgdGhlIGdyaWQgaXMgYSB0ZXJyYWluIGdlbmVyYXRpb24gZGV2aWNlIG9ubHkuIG9uY2UgdGVycmFpbiBzbGljZSBpcyBsb2FkZWQsXG5cdC8vIGJveDJkIHBoeXNpY3Mgc2ltdWxhdGlvbiBtYXkgKGFuZCB3aWxsKSBnbyBudXRzIG9uIGl0LCBjaGFuZ2luZyB3aGF0ZXZlciBpdCB3YW50cyxcblx0Ly8gYW5kIGNoYW5nZXMgd29uJ3QgYW55aG93IGJlIHJlZmxlY3RlZCBpbiB0aGUgZ3JpZC4gdG8ga2VlcCB0cmFjayBvZiBhbGwgdGhlIGJvZGllc1xuXHQvLyBpbiB0aGUgdGVycmFpbiBzbGljZSwgaWYgdGhhdCB3aWxsIGJlIG5lZWRlZCwgb3RoZXIgbWVjaGFuaXNtcyBzaG91bGQgYmUgdXNlZC5cblx0Ly8gaWRlYTogaGF2ZSBhIGNvbGxlY3Rpb25zIG9mIGJvZGllcyBieSB0eXBlLCBhbmQgc2V0dXAgc2Vuc29yIGNvbGxpc2lvbiBiZWFtc1xuXHQvLyBhdCB0aGUgdGVycmFpbiBzbGljZXMnIGJvdW5kYXJpZXMgdG8ga2VlcCB0cmFjayBvZiBib2RpZXMgZmx5aW5nIG92ZXIgZnJvbSBvbmVcblx0Ly8gdGVycmFpbiBzbGljZSB0byBhbm90aGVyLiBCdHcsIEFsaSwgSSBoYXRlIHlvdSBmb3IgbWFraW5nIG1lIHRvIHR5cGUgXCJ0ZXJyYWluIHNsaWNlXCJcblx0Ly8gaW5zdGVhZCBvZiB0aGUgXCJjaHVua1wiIFxuXHR0aGlzLmdyaWQgPSBbXTtcblx0XG5cdHRoaXMub3JpZ2luID0ge3g6IG51bGwsIHk6IG51bGx9O1xuXHRcblxuXHRcblx0XG59O1xuXG5UZXJyYWluU2xpY2VNb2RlbC5wcm90b3R5cGUubHZsX3Byb2IgPSBbXG5cdFs3LCAyLCAxXSxcblx0WzAsIDcsIDNdLFxuXHRbMCwgMSwgOV1cbl1cblxubW9kdWxlLmV4cG9ydHMgPSBUZXJyYWluU2xpY2VNb2RlbDtcbiIsInZhciBUZXN0TW9kZWwgPSBmdW5jdGlvbigpe1xuXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBUZXN0TW9kZWw7XG5cbiIsInZhciBXb3JsZE1vZGVsID0gZnVuY3Rpb24oKXtcblx0XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBXb3JsZE1vZGVsO1xuXG4iLCJcbi8qXG4gKiBSdWxlcyBmb3Igd29ya2luZyBvbiB0aGUgKGNsaWVudC1zaWRlKSBnYW1lIGNvZGU6XG4gKlxuICogMS4gSWYgeW91IHRoaW5rIHRoYXQgb25lIG9mIHRoZXNlIHJ1bGVzIGlzIHN0dXBpZCBvciB1c2VsZXNzLCB0ZWxsIG1lLCBhbG9uZyB3aXRoIHNvbWUgYmV0dGVyIHN1Z2dlc3Rpb25zLlxuICpcbiAqIDIuIE1vZGVsIFtuYW1lXU1vZGVsIGNhbiBvbmx5IGJlIGFjY2Vzc2VkIHRocm91Z2ggW25hbWVdQ29udHJvbGxlci4gSWYgeW91IG5lZWQgdG8gZG8gc29tZXRoaW5nIHRvIFxuICogXHRcdGNoYW5nZSBbbmFtZV1Nb2RlbCBmcm9tIFtvdGhlcl9uYW1lXUNvbnRyb2xsZXIsIHdyaXRlIGZ1bmN0aW9uIGluIHRoZSBbbmFtZV1Db250cm9sbGVyIHRoYXQgZG9lc1xuICogXHRcdHdoYXQgeW91IG5lZWQsIGFuZCBjYWxsIGl0IGZyb20gdGhlIFtvdGhlcl9uYW1lXUNvbnRyb2xsZXJcbiAqXG4gKiAzLiBDb250cm9sbGVycyBhcmUgYWxsb3dlZCB0byBoYXZlIHByaXZhdGUgbWV0aG9kcy9maWVsZHMuIE1vZGVscyBhcmVuJ3QuIFxuICpcbiAqIDQuIENvbnRyb2xsZXJzIGFyZW4ndCBhbGxvd2VkIHRvIGhhdmUgcHVibGljIGRhdGEgZmllbGRzLiBcbiAqIFx0XHRUaG9zZSBkYXRhIGZpZWxkcyB0aGF0IGFyZSBwcmVzZW50IG11c3Qgbm90IHJlZmxlY3Qgc3RhdGUgb2YgdGhlIGdhbWUsIHRoZXkgbXVzdCBiZSByZWxhdGVkIHRvXG4gKiBcdFx0c29tZSBpbnRlcm5hbCBmdW5jdGlvbmFsaXR5IG9mIHRoZSBjb250cm9sbGVyXG4gKlxuICogNS4gSWYgeW91IHdyaXRlIHNvbWUgZnVuY3Rpb24gdGhhdCBkb2Vzbid0IGxvZ2ljYWxseSBiZWxvbmcgdG8gb25lIG9mIHRoZSBjb250cm9sbGVycyxcbiAqIFx0XHRwdXQgaXQgaW4gdGhlIFV0aWxpdHlcbiAqXG4gKiA2LiBWYXJpYWJsZXMgYXJlIG5hbWVkIGxpa2UgdGhhdDogdmFyaWFibGVfbmFtZVxuICogXHRcdEV4Y2VwdCAoc2luZ2xldG9uKWNsYXNzIG5hbWVzLCB0aGF0IGFyZSB3cml0dGVuIGxpa2UgdGhhdDogQ2xhc3NOYW1lXG4gKlxuICogNy4gQW5kIGFsbCB0aGUgb2J2aW91cyBzdHVmZiB0aGF0IGV2ZXJ5b25lIGtub3dzOlxuICogXHRcdGZ1bmN0aW9uIG11c3QgZG8gb25lIHRoaW5nOyBkb24ndCBtYWtlIGZ1bmN0aW9uIHB1YmxpYyB1bmxlc3MgaXQgbmVlZHMgdG8gYmUgdGhhdDsgXG4gKiBcdFx0Y29tbWVudCBhbWJpZ2lvdXMgY29kZSwgZm9yIGxhcmdlciBmdW5jdGlvbnMgaW5kaWNhdGUgdGhlaXIgcHVycG9zZSAodGhyb3VnaCBjb21tZW50aW5nKTtcbiAqL1xuXG5cbi8vIG1haW4gbmFtZXNwYWNlIHRoYXQgaXMgZXhwb3NlZCB0byBnbG9iYWwgc2NvcGUgKHdpbmRvdyBvYmplY3QpXG53aW5kb3cuc2lkZXNjcm9sbGVyX2dhbWUgPSAoZnVuY3Rpb24gbmFtZXNwYWNlKCl7XG5cblx0XHR2YXIgSW5jbHVkZXMgPSByZXF1aXJlKFwiLi9JbmNsdWRlcy5qc1wiKTsgdmFyIGluY2x1ZGVfZGF0YSA9IEluY2x1ZGVzLmdldF9pbmNsdWRlX2RhdGEoe1xuXHRcdGN1cnJlbnRfbW9kdWxlOiBcIk5vbmVcIiwgXG5cdFx0aW5jbHVkZV9vcHRpb25zOiBJbmNsdWRlcy5jaG9pY2VzLkFMTF9DT05UUk9MTEVSU1xuXHR9KTsgZXZhbChpbmNsdWRlX2RhdGEubmFtZV9zdGF0ZW1lbnRzKTsgdmFyIGluY2x1ZGUgPSBmdW5jdGlvbigpe2V2YWwoaW5jbHVkZV9kYXRhLm1vZHVsZV9zdGF0ZW1lbnRzKTt9XG5cblx0Ly8gR2FtZSBpbml0aWF0aW9uIHNlY3Rpb246ID4+PlxuXHRcdFxuXHR2YXIgbG9hZF9nYW1lID0gZnVuY3Rpb24obW9kZSlcblx0e1xuXG5cdFx0SW5jbHVkZXMuaW5pdCgpOyAvLyBmaXJzdFxuXHRcdGluY2x1ZGUoKTsgLy8gc2Vjb25kXG5cblx0XHRJbml0Q29udHJvbGxlci5pbml0KG1vZGUpOyAvLyBpbml0IGFsbCB0aGUgc3R1ZmZcblxuXHRcdGlmKG1vZGUgPT0gXCJ0ZXN0XCIpe1xuXHRcdFx0VGVzdENvbnRyb2xsZXIudGVzdCgpO1xuXHRcdH1cblx0fTtcblxuXG5cdHZhciBydW4gPSBmdW5jdGlvbihtb2RlKVxuXHR7XG5cdFx0Ly8gZG9uZSB0aGlzIHdheSB0byBlbnN1cmUgdGhhdCBsb2FkX2dhbWUncyBpbnRlcm5hbHMgYXJlbid0IGFjY2Vzc2libGUgdG8gdGhlIHdvcmxkOlxuXHRcdGxvYWRfZ2FtZShtb2RlKTtcblx0fTsgXG5cdFxuXHRyZXR1cm4ge1xuXHRcdHJ1bjogcnVuXG5cdH07IC8vIGV4cG9zZSBmdW5jdGlvbiBydW4gdG8gdGhlIHdvcmxkXG5cbn0pKCk7IFxuXG4iLCIvKlxuKiBDb3B5cmlnaHQgKGMpIDIwMDYtMjAwNyBFcmluIENhdHRvIGh0dHA6Ly93d3cuZ3BoeXNpY3MuY29tXG4qXG4qIFRoaXMgc29mdHdhcmUgaXMgcHJvdmlkZWQgJ2FzLWlzJywgd2l0aG91dCBhbnkgZXhwcmVzcyBvciBpbXBsaWVkXG4qIHdhcnJhbnR5LiAgSW4gbm8gZXZlbnQgd2lsbCB0aGUgYXV0aG9ycyBiZSBoZWxkIGxpYWJsZSBmb3IgYW55IGRhbWFnZXNcbiogYXJpc2luZyBmcm9tIHRoZSB1c2Ugb2YgdGhpcyBzb2Z0d2FyZS5cbiogUGVybWlzc2lvbiBpcyBncmFudGVkIHRvIGFueW9uZSB0byB1c2UgdGhpcyBzb2Z0d2FyZSBmb3IgYW55IHB1cnBvc2UsXG4qIGluY2x1ZGluZyBjb21tZXJjaWFsIGFwcGxpY2F0aW9ucywgYW5kIHRvIGFsdGVyIGl0IGFuZCByZWRpc3RyaWJ1dGUgaXRcbiogZnJlZWx5LCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgcmVzdHJpY3Rpb25zOlxuKiAxLiBUaGUgb3JpZ2luIG9mIHRoaXMgc29mdHdhcmUgbXVzdCBub3QgYmUgbWlzcmVwcmVzZW50ZWQ7IHlvdSBtdXN0IG5vdFxuKiBjbGFpbSB0aGF0IHlvdSB3cm90ZSB0aGUgb3JpZ2luYWwgc29mdHdhcmUuIElmIHlvdSB1c2UgdGhpcyBzb2Z0d2FyZVxuKiBpbiBhIHByb2R1Y3QsIGFuIGFja25vd2xlZGdtZW50IGluIHRoZSBwcm9kdWN0IGRvY3VtZW50YXRpb24gd291bGQgYmVcbiogYXBwcmVjaWF0ZWQgYnV0IGlzIG5vdCByZXF1aXJlZC5cbiogMi4gQWx0ZXJlZCBzb3VyY2UgdmVyc2lvbnMgbXVzdCBiZSBwbGFpbmx5IG1hcmtlZCBhcyBzdWNoLCBhbmQgbXVzdCBub3QgYmVcbiogbWlzcmVwcmVzZW50ZWQgYXMgYmVpbmcgdGhlIG9yaWdpbmFsIHNvZnR3YXJlLlxuKiAzLiBUaGlzIG5vdGljZSBtYXkgbm90IGJlIHJlbW92ZWQgb3IgYWx0ZXJlZCBmcm9tIGFueSBzb3VyY2UgZGlzdHJpYnV0aW9uLlxuKi9cblwidXNlIHN0cmljdFwiXG5cbnZhciBCb3gyRCA9IHt9O1xuXG4oZnVuY3Rpb24gKGEyaiwgdW5kZWZpbmVkKSB7XG4gICBcbiAgIGZ1bmN0aW9uIGVtcHR5Rm4oKSB7fTtcbiAgIGEyai5pbmhlcml0ID0gZnVuY3Rpb24oY2xzLCBiYXNlKSB7XG4gICAgICB2YXIgdG1wQ3RyID0gY2xzO1xuICAgICAgZW1wdHlGbi5wcm90b3R5cGUgPSBiYXNlLnByb3RvdHlwZTtcbiAgICAgIGNscy5wcm90b3R5cGUgPSBuZXcgZW1wdHlGbjtcbiAgICAgIGNscy5wcm90b3R5cGUuY29uc3RydWN0b3IgPSB0bXBDdHI7XG4gICB9O1xuICAgXG4gICBhMmouZ2VuZXJhdGVDYWxsYmFjayA9IGZ1bmN0aW9uIGdlbmVyYXRlQ2FsbGJhY2soY29udGV4dCwgY2IpIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICBjYi5hcHBseShjb250ZXh0LCBhcmd1bWVudHMpO1xuICAgICAgfTtcbiAgIH07XG4gICBcbiAgIGEyai5OVmVjdG9yID0gZnVuY3Rpb24gTlZlY3RvcihsZW5ndGgpIHtcbiAgICAgIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCkgbGVuZ3RoID0gMDtcbiAgICAgIHZhciB0bXAgPSBuZXcgQXJyYXkobGVuZ3RoIHx8IDApO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSlcbiAgICAgIHRtcFtpXSA9IDA7XG4gICAgICByZXR1cm4gdG1wO1xuICAgfTtcbiAgIFxuICAgYTJqLmlzID0gZnVuY3Rpb24gaXMobzEsIG8yKSB7XG4gICAgICBpZiAobzEgPT09IG51bGwpIHJldHVybiBmYWxzZTtcbiAgICAgIGlmICgobzIgaW5zdGFuY2VvZiBGdW5jdGlvbikgJiYgKG8xIGluc3RhbmNlb2YgbzIpKSByZXR1cm4gdHJ1ZTtcbiAgICAgIGlmICgobzEuY29uc3RydWN0b3IuX19pbXBsZW1lbnRzICE9IHVuZGVmaW5lZCkgJiYgKG8xLmNvbnN0cnVjdG9yLl9faW1wbGVtZW50c1tvMl0pKSByZXR1cm4gdHJ1ZTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgIH07XG4gICBcbiAgIGEyai5wYXJzZVVJbnQgPSBmdW5jdGlvbih2KSB7XG4gICAgICByZXR1cm4gTWF0aC5hYnMocGFyc2VJbnQodikpO1xuICAgfVxuICAgXG59KShCb3gyRCk7XG5cbi8vI1RPRE8gcmVtb3ZlIGFzc2lnbm1lbnRzIGZyb20gZ2xvYmFsIG5hbWVzcGFjZVxudmFyIFZlY3RvciA9IEFycmF5O1xudmFyIFZlY3Rvcl9hMmpfTnVtYmVyID0gQm94MkQuTlZlY3Rvcjtcbi8vcGFja2FnZSBzdHJ1Y3R1cmVcbmlmICh0eXBlb2YoQm94MkQpID09PSBcInVuZGVmaW5lZFwiKSBCb3gyRCA9IHt9O1xuaWYgKHR5cGVvZihCb3gyRC5Db2xsaXNpb24pID09PSBcInVuZGVmaW5lZFwiKSBCb3gyRC5Db2xsaXNpb24gPSB7fTtcbmlmICh0eXBlb2YoQm94MkQuQ29sbGlzaW9uLlNoYXBlcykgPT09IFwidW5kZWZpbmVkXCIpIEJveDJELkNvbGxpc2lvbi5TaGFwZXMgPSB7fTtcbmlmICh0eXBlb2YoQm94MkQuQ29tbW9uKSA9PT0gXCJ1bmRlZmluZWRcIikgQm94MkQuQ29tbW9uID0ge307XG5pZiAodHlwZW9mKEJveDJELkNvbW1vbi5NYXRoKSA9PT0gXCJ1bmRlZmluZWRcIikgQm94MkQuQ29tbW9uLk1hdGggPSB7fTtcbmlmICh0eXBlb2YoQm94MkQuRHluYW1pY3MpID09PSBcInVuZGVmaW5lZFwiKSBCb3gyRC5EeW5hbWljcyA9IHt9O1xuaWYgKHR5cGVvZihCb3gyRC5EeW5hbWljcy5Db250YWN0cykgPT09IFwidW5kZWZpbmVkXCIpIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzID0ge307XG5pZiAodHlwZW9mKEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzKSA9PT0gXCJ1bmRlZmluZWRcIikgQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMgPSB7fTtcbmlmICh0eXBlb2YoQm94MkQuRHluYW1pY3MuSm9pbnRzKSA9PT0gXCJ1bmRlZmluZWRcIikgQm94MkQuRHluYW1pY3MuSm9pbnRzID0ge307XG4vL3ByZS1kZWZpbml0aW9uc1xuKGZ1bmN0aW9uICgpIHtcbiAgIEJveDJELkNvbGxpc2lvbi5JQnJvYWRQaGFzZSA9ICdCb3gyRC5Db2xsaXNpb24uSUJyb2FkUGhhc2UnO1xuXG4gICBmdW5jdGlvbiBiMkFBQkIoKSB7XG4gICAgICBiMkFBQkIuYjJBQUJCLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuQ29sbGlzaW9uLmIyQUFCQiA9IGIyQUFCQjtcblxuICAgZnVuY3Rpb24gYjJCb3VuZCgpIHtcbiAgICAgIGIyQm91bmQuYjJCb3VuZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkNvbGxpc2lvbi5iMkJvdW5kID0gYjJCb3VuZDtcblxuICAgZnVuY3Rpb24gYjJCb3VuZFZhbHVlcygpIHtcbiAgICAgIGIyQm91bmRWYWx1ZXMuYjJCb3VuZFZhbHVlcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyQm91bmRWYWx1ZXMpIHRoaXMuYjJCb3VuZFZhbHVlcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkNvbGxpc2lvbi5iMkJvdW5kVmFsdWVzID0gYjJCb3VuZFZhbHVlcztcblxuICAgZnVuY3Rpb24gYjJDb2xsaXNpb24oKSB7XG4gICAgICBiMkNvbGxpc2lvbi5iMkNvbGxpc2lvbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkNvbGxpc2lvbi5iMkNvbGxpc2lvbiA9IGIyQ29sbGlzaW9uO1xuXG4gICBmdW5jdGlvbiBiMkNvbnRhY3RJRCgpIHtcbiAgICAgIGIyQ29udGFjdElELmIyQ29udGFjdElELmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJDb250YWN0SUQpIHRoaXMuYjJDb250YWN0SUQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5Db2xsaXNpb24uYjJDb250YWN0SUQgPSBiMkNvbnRhY3RJRDtcblxuICAgZnVuY3Rpb24gYjJDb250YWN0UG9pbnQoKSB7XG4gICAgICBiMkNvbnRhY3RQb2ludC5iMkNvbnRhY3RQb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkNvbGxpc2lvbi5iMkNvbnRhY3RQb2ludCA9IGIyQ29udGFjdFBvaW50O1xuXG4gICBmdW5jdGlvbiBiMkRpc3RhbmNlKCkge1xuICAgICAgYjJEaXN0YW5jZS5iMkRpc3RhbmNlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuQ29sbGlzaW9uLmIyRGlzdGFuY2UgPSBiMkRpc3RhbmNlO1xuXG4gICBmdW5jdGlvbiBiMkRpc3RhbmNlSW5wdXQoKSB7XG4gICAgICBiMkRpc3RhbmNlSW5wdXQuYjJEaXN0YW5jZUlucHV0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuQ29sbGlzaW9uLmIyRGlzdGFuY2VJbnB1dCA9IGIyRGlzdGFuY2VJbnB1dDtcblxuICAgZnVuY3Rpb24gYjJEaXN0YW5jZU91dHB1dCgpIHtcbiAgICAgIGIyRGlzdGFuY2VPdXRwdXQuYjJEaXN0YW5jZU91dHB1dC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkNvbGxpc2lvbi5iMkRpc3RhbmNlT3V0cHV0ID0gYjJEaXN0YW5jZU91dHB1dDtcblxuICAgZnVuY3Rpb24gYjJEaXN0YW5jZVByb3h5KCkge1xuICAgICAgYjJEaXN0YW5jZVByb3h5LmIyRGlzdGFuY2VQcm94eS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkNvbGxpc2lvbi5iMkRpc3RhbmNlUHJveHkgPSBiMkRpc3RhbmNlUHJveHk7XG5cbiAgIGZ1bmN0aW9uIGIyRHluYW1pY1RyZWUoKSB7XG4gICAgICBiMkR5bmFtaWNUcmVlLmIyRHluYW1pY1RyZWUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMkR5bmFtaWNUcmVlKSB0aGlzLmIyRHluYW1pY1RyZWUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5Db2xsaXNpb24uYjJEeW5hbWljVHJlZSA9IGIyRHluYW1pY1RyZWU7XG5cbiAgIGZ1bmN0aW9uIGIyRHluYW1pY1RyZWVCcm9hZFBoYXNlKCkge1xuICAgICAgYjJEeW5hbWljVHJlZUJyb2FkUGhhc2UuYjJEeW5hbWljVHJlZUJyb2FkUGhhc2UuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5Db2xsaXNpb24uYjJEeW5hbWljVHJlZUJyb2FkUGhhc2UgPSBiMkR5bmFtaWNUcmVlQnJvYWRQaGFzZTtcblxuICAgZnVuY3Rpb24gYjJEeW5hbWljVHJlZU5vZGUoKSB7XG4gICAgICBiMkR5bmFtaWNUcmVlTm9kZS5iMkR5bmFtaWNUcmVlTm9kZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkNvbGxpc2lvbi5iMkR5bmFtaWNUcmVlTm9kZSA9IGIyRHluYW1pY1RyZWVOb2RlO1xuXG4gICBmdW5jdGlvbiBiMkR5bmFtaWNUcmVlUGFpcigpIHtcbiAgICAgIGIyRHluYW1pY1RyZWVQYWlyLmIyRHluYW1pY1RyZWVQYWlyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuQ29sbGlzaW9uLmIyRHluYW1pY1RyZWVQYWlyID0gYjJEeW5hbWljVHJlZVBhaXI7XG5cbiAgIGZ1bmN0aW9uIGIyTWFuaWZvbGQoKSB7XG4gICAgICBiMk1hbmlmb2xkLmIyTWFuaWZvbGQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMk1hbmlmb2xkKSB0aGlzLmIyTWFuaWZvbGQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5Db2xsaXNpb24uYjJNYW5pZm9sZCA9IGIyTWFuaWZvbGQ7XG5cbiAgIGZ1bmN0aW9uIGIyTWFuaWZvbGRQb2ludCgpIHtcbiAgICAgIGIyTWFuaWZvbGRQb2ludC5iMk1hbmlmb2xkUG9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMk1hbmlmb2xkUG9pbnQpIHRoaXMuYjJNYW5pZm9sZFBvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuQ29sbGlzaW9uLmIyTWFuaWZvbGRQb2ludCA9IGIyTWFuaWZvbGRQb2ludDtcblxuICAgZnVuY3Rpb24gYjJQb2ludCgpIHtcbiAgICAgIGIyUG9pbnQuYjJQb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkNvbGxpc2lvbi5iMlBvaW50ID0gYjJQb2ludDtcblxuICAgZnVuY3Rpb24gYjJSYXlDYXN0SW5wdXQoKSB7XG4gICAgICBiMlJheUNhc3RJbnB1dC5iMlJheUNhc3RJbnB1dC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyUmF5Q2FzdElucHV0KSB0aGlzLmIyUmF5Q2FzdElucHV0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuQ29sbGlzaW9uLmIyUmF5Q2FzdElucHV0ID0gYjJSYXlDYXN0SW5wdXQ7XG5cbiAgIGZ1bmN0aW9uIGIyUmF5Q2FzdE91dHB1dCgpIHtcbiAgICAgIGIyUmF5Q2FzdE91dHB1dC5iMlJheUNhc3RPdXRwdXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5Db2xsaXNpb24uYjJSYXlDYXN0T3V0cHV0ID0gYjJSYXlDYXN0T3V0cHV0O1xuXG4gICBmdW5jdGlvbiBiMlNlZ21lbnQoKSB7XG4gICAgICBiMlNlZ21lbnQuYjJTZWdtZW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuQ29sbGlzaW9uLmIyU2VnbWVudCA9IGIyU2VnbWVudDtcblxuICAgZnVuY3Rpb24gYjJTZXBhcmF0aW9uRnVuY3Rpb24oKSB7XG4gICAgICBiMlNlcGFyYXRpb25GdW5jdGlvbi5iMlNlcGFyYXRpb25GdW5jdGlvbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkNvbGxpc2lvbi5iMlNlcGFyYXRpb25GdW5jdGlvbiA9IGIyU2VwYXJhdGlvbkZ1bmN0aW9uO1xuXG4gICBmdW5jdGlvbiBiMlNpbXBsZXgoKSB7XG4gICAgICBiMlNpbXBsZXguYjJTaW1wbGV4LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJTaW1wbGV4KSB0aGlzLmIyU2ltcGxleC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkNvbGxpc2lvbi5iMlNpbXBsZXggPSBiMlNpbXBsZXg7XG5cbiAgIGZ1bmN0aW9uIGIyU2ltcGxleENhY2hlKCkge1xuICAgICAgYjJTaW1wbGV4Q2FjaGUuYjJTaW1wbGV4Q2FjaGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5Db2xsaXNpb24uYjJTaW1wbGV4Q2FjaGUgPSBiMlNpbXBsZXhDYWNoZTtcblxuICAgZnVuY3Rpb24gYjJTaW1wbGV4VmVydGV4KCkge1xuICAgICAgYjJTaW1wbGV4VmVydGV4LmIyU2ltcGxleFZlcnRleC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkNvbGxpc2lvbi5iMlNpbXBsZXhWZXJ0ZXggPSBiMlNpbXBsZXhWZXJ0ZXg7XG5cbiAgIGZ1bmN0aW9uIGIyVGltZU9mSW1wYWN0KCkge1xuICAgICAgYjJUaW1lT2ZJbXBhY3QuYjJUaW1lT2ZJbXBhY3QuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5Db2xsaXNpb24uYjJUaW1lT2ZJbXBhY3QgPSBiMlRpbWVPZkltcGFjdDtcblxuICAgZnVuY3Rpb24gYjJUT0lJbnB1dCgpIHtcbiAgICAgIGIyVE9JSW5wdXQuYjJUT0lJbnB1dC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkNvbGxpc2lvbi5iMlRPSUlucHV0ID0gYjJUT0lJbnB1dDtcblxuICAgZnVuY3Rpb24gYjJXb3JsZE1hbmlmb2xkKCkge1xuICAgICAgYjJXb3JsZE1hbmlmb2xkLmIyV29ybGRNYW5pZm9sZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyV29ybGRNYW5pZm9sZCkgdGhpcy5iMldvcmxkTWFuaWZvbGQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5Db2xsaXNpb24uYjJXb3JsZE1hbmlmb2xkID0gYjJXb3JsZE1hbmlmb2xkO1xuXG4gICBmdW5jdGlvbiBDbGlwVmVydGV4KCkge1xuICAgICAgQ2xpcFZlcnRleC5DbGlwVmVydGV4LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuQ29sbGlzaW9uLkNsaXBWZXJ0ZXggPSBDbGlwVmVydGV4O1xuXG4gICBmdW5jdGlvbiBGZWF0dXJlcygpIHtcbiAgICAgIEZlYXR1cmVzLkZlYXR1cmVzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuQ29sbGlzaW9uLkZlYXR1cmVzID0gRmVhdHVyZXM7XG5cbiAgIGZ1bmN0aW9uIGIyQ2lyY2xlU2hhcGUoKSB7XG4gICAgICBiMkNpcmNsZVNoYXBlLmIyQ2lyY2xlU2hhcGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMkNpcmNsZVNoYXBlKSB0aGlzLmIyQ2lyY2xlU2hhcGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyQ2lyY2xlU2hhcGUgPSBiMkNpcmNsZVNoYXBlO1xuXG4gICBmdW5jdGlvbiBiMkVkZ2VDaGFpbkRlZigpIHtcbiAgICAgIGIyRWRnZUNoYWluRGVmLmIyRWRnZUNoYWluRGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJFZGdlQ2hhaW5EZWYpIHRoaXMuYjJFZGdlQ2hhaW5EZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyRWRnZUNoYWluRGVmID0gYjJFZGdlQ2hhaW5EZWY7XG5cbiAgIGZ1bmN0aW9uIGIyRWRnZVNoYXBlKCkge1xuICAgICAgYjJFZGdlU2hhcGUuYjJFZGdlU2hhcGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMkVkZ2VTaGFwZSkgdGhpcy5iMkVkZ2VTaGFwZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJFZGdlU2hhcGUgPSBiMkVkZ2VTaGFwZTtcblxuICAgZnVuY3Rpb24gYjJNYXNzRGF0YSgpIHtcbiAgICAgIGIyTWFzc0RhdGEuYjJNYXNzRGF0YS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJNYXNzRGF0YSA9IGIyTWFzc0RhdGE7XG5cbiAgIGZ1bmN0aW9uIGIyUG9seWdvblNoYXBlKCkge1xuICAgICAgYjJQb2x5Z29uU2hhcGUuYjJQb2x5Z29uU2hhcGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMlBvbHlnb25TaGFwZSkgdGhpcy5iMlBvbHlnb25TaGFwZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJQb2x5Z29uU2hhcGUgPSBiMlBvbHlnb25TaGFwZTtcblxuICAgZnVuY3Rpb24gYjJTaGFwZSgpIHtcbiAgICAgIGIyU2hhcGUuYjJTaGFwZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyU2hhcGUpIHRoaXMuYjJTaGFwZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJTaGFwZSA9IGIyU2hhcGU7XG4gICBCb3gyRC5Db21tb24uYjJpbnRlcm5hbCA9ICdCb3gyRC5Db21tb24uYjJpbnRlcm5hbCc7XG5cbiAgIGZ1bmN0aW9uIGIyQ29sb3IoKSB7XG4gICAgICBiMkNvbG9yLmIyQ29sb3IuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMkNvbG9yKSB0aGlzLmIyQ29sb3IuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5Db21tb24uYjJDb2xvciA9IGIyQ29sb3I7XG5cbiAgIGZ1bmN0aW9uIGIyU2V0dGluZ3MoKSB7XG4gICAgICBiMlNldHRpbmdzLmIyU2V0dGluZ3MuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5Db21tb24uYjJTZXR0aW5ncyA9IGIyU2V0dGluZ3M7XG5cbiAgIGZ1bmN0aW9uIGIyTWF0MjIoKSB7XG4gICAgICBiMk1hdDIyLmIyTWF0MjIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMk1hdDIyKSB0aGlzLmIyTWF0MjIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5Db21tb24uTWF0aC5iMk1hdDIyID0gYjJNYXQyMjtcblxuICAgZnVuY3Rpb24gYjJNYXQzMygpIHtcbiAgICAgIGIyTWF0MzMuYjJNYXQzMy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyTWF0MzMpIHRoaXMuYjJNYXQzMy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkNvbW1vbi5NYXRoLmIyTWF0MzMgPSBiMk1hdDMzO1xuXG4gICBmdW5jdGlvbiBiMk1hdGgoKSB7XG4gICAgICBiMk1hdGguYjJNYXRoLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuQ29tbW9uLk1hdGguYjJNYXRoID0gYjJNYXRoO1xuXG4gICBmdW5jdGlvbiBiMlN3ZWVwKCkge1xuICAgICAgYjJTd2VlcC5iMlN3ZWVwLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuQ29tbW9uLk1hdGguYjJTd2VlcCA9IGIyU3dlZXA7XG5cbiAgIGZ1bmN0aW9uIGIyVHJhbnNmb3JtKCkge1xuICAgICAgYjJUcmFuc2Zvcm0uYjJUcmFuc2Zvcm0uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMlRyYW5zZm9ybSkgdGhpcy5iMlRyYW5zZm9ybS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkNvbW1vbi5NYXRoLmIyVHJhbnNmb3JtID0gYjJUcmFuc2Zvcm07XG5cbiAgIGZ1bmN0aW9uIGIyVmVjMigpIHtcbiAgICAgIGIyVmVjMi5iMlZlYzIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMlZlYzIpIHRoaXMuYjJWZWMyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuQ29tbW9uLk1hdGguYjJWZWMyID0gYjJWZWMyO1xuXG4gICBmdW5jdGlvbiBiMlZlYzMoKSB7XG4gICAgICBiMlZlYzMuYjJWZWMzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJWZWMzKSB0aGlzLmIyVmVjMy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkNvbW1vbi5NYXRoLmIyVmVjMyA9IGIyVmVjMztcblxuICAgZnVuY3Rpb24gYjJCb2R5KCkge1xuICAgICAgYjJCb2R5LmIyQm9keS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyQm9keSkgdGhpcy5iMkJvZHkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5EeW5hbWljcy5iMkJvZHkgPSBiMkJvZHk7XG5cbiAgIGZ1bmN0aW9uIGIyQm9keURlZigpIHtcbiAgICAgIGIyQm9keURlZi5iMkJvZHlEZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMkJvZHlEZWYpIHRoaXMuYjJCb2R5RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuRHluYW1pY3MuYjJCb2R5RGVmID0gYjJCb2R5RGVmO1xuXG4gICBmdW5jdGlvbiBiMkNvbnRhY3RGaWx0ZXIoKSB7XG4gICAgICBiMkNvbnRhY3RGaWx0ZXIuYjJDb250YWN0RmlsdGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuRHluYW1pY3MuYjJDb250YWN0RmlsdGVyID0gYjJDb250YWN0RmlsdGVyO1xuXG4gICBmdW5jdGlvbiBiMkNvbnRhY3RJbXB1bHNlKCkge1xuICAgICAgYjJDb250YWN0SW1wdWxzZS5iMkNvbnRhY3RJbXB1bHNlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuRHluYW1pY3MuYjJDb250YWN0SW1wdWxzZSA9IGIyQ29udGFjdEltcHVsc2U7XG5cbiAgIGZ1bmN0aW9uIGIyQ29udGFjdExpc3RlbmVyKCkge1xuICAgICAgYjJDb250YWN0TGlzdGVuZXIuYjJDb250YWN0TGlzdGVuZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5EeW5hbWljcy5iMkNvbnRhY3RMaXN0ZW5lciA9IGIyQ29udGFjdExpc3RlbmVyO1xuXG4gICBmdW5jdGlvbiBiMkNvbnRhY3RNYW5hZ2VyKCkge1xuICAgICAgYjJDb250YWN0TWFuYWdlci5iMkNvbnRhY3RNYW5hZ2VyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJDb250YWN0TWFuYWdlcikgdGhpcy5iMkNvbnRhY3RNYW5hZ2VyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuRHluYW1pY3MuYjJDb250YWN0TWFuYWdlciA9IGIyQ29udGFjdE1hbmFnZXI7XG5cbiAgIGZ1bmN0aW9uIGIyRGVidWdEcmF3KCkge1xuICAgICAgYjJEZWJ1Z0RyYXcuYjJEZWJ1Z0RyYXcuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMkRlYnVnRHJhdykgdGhpcy5iMkRlYnVnRHJhdy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkR5bmFtaWNzLmIyRGVidWdEcmF3ID0gYjJEZWJ1Z0RyYXc7XG5cbiAgIGZ1bmN0aW9uIGIyRGVzdHJ1Y3Rpb25MaXN0ZW5lcigpIHtcbiAgICAgIGIyRGVzdHJ1Y3Rpb25MaXN0ZW5lci5iMkRlc3RydWN0aW9uTGlzdGVuZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5EeW5hbWljcy5iMkRlc3RydWN0aW9uTGlzdGVuZXIgPSBiMkRlc3RydWN0aW9uTGlzdGVuZXI7XG5cbiAgIGZ1bmN0aW9uIGIyRmlsdGVyRGF0YSgpIHtcbiAgICAgIGIyRmlsdGVyRGF0YS5iMkZpbHRlckRhdGEuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5EeW5hbWljcy5iMkZpbHRlckRhdGEgPSBiMkZpbHRlckRhdGE7XG5cbiAgIGZ1bmN0aW9uIGIyRml4dHVyZSgpIHtcbiAgICAgIGIyRml4dHVyZS5iMkZpeHR1cmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMkZpeHR1cmUpIHRoaXMuYjJGaXh0dXJlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuRHluYW1pY3MuYjJGaXh0dXJlID0gYjJGaXh0dXJlO1xuXG4gICBmdW5jdGlvbiBiMkZpeHR1cmVEZWYoKSB7XG4gICAgICBiMkZpeHR1cmVEZWYuYjJGaXh0dXJlRGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJGaXh0dXJlRGVmKSB0aGlzLmIyRml4dHVyZURlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkR5bmFtaWNzLmIyRml4dHVyZURlZiA9IGIyRml4dHVyZURlZjtcblxuICAgZnVuY3Rpb24gYjJJc2xhbmQoKSB7XG4gICAgICBiMklzbGFuZC5iMklzbGFuZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIySXNsYW5kKSB0aGlzLmIySXNsYW5kLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuRHluYW1pY3MuYjJJc2xhbmQgPSBiMklzbGFuZDtcblxuICAgZnVuY3Rpb24gYjJUaW1lU3RlcCgpIHtcbiAgICAgIGIyVGltZVN0ZXAuYjJUaW1lU3RlcC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkR5bmFtaWNzLmIyVGltZVN0ZXAgPSBiMlRpbWVTdGVwO1xuXG4gICBmdW5jdGlvbiBiMldvcmxkKCkge1xuICAgICAgYjJXb3JsZC5iMldvcmxkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJXb3JsZCkgdGhpcy5iMldvcmxkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuRHluYW1pY3MuYjJXb3JsZCA9IGIyV29ybGQ7XG5cbiAgIGZ1bmN0aW9uIGIyQ2lyY2xlQ29udGFjdCgpIHtcbiAgICAgIGIyQ2lyY2xlQ29udGFjdC5iMkNpcmNsZUNvbnRhY3QuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNpcmNsZUNvbnRhY3QgPSBiMkNpcmNsZUNvbnRhY3Q7XG5cbiAgIGZ1bmN0aW9uIGIyQ29udGFjdCgpIHtcbiAgICAgIGIyQ29udGFjdC5iMkNvbnRhY3QuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMkNvbnRhY3QpIHRoaXMuYjJDb250YWN0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0ID0gYjJDb250YWN0O1xuXG4gICBmdW5jdGlvbiBiMkNvbnRhY3RDb25zdHJhaW50KCkge1xuICAgICAgYjJDb250YWN0Q29uc3RyYWludC5iMkNvbnRhY3RDb25zdHJhaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJDb250YWN0Q29uc3RyYWludCkgdGhpcy5iMkNvbnRhY3RDb25zdHJhaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0Q29uc3RyYWludCA9IGIyQ29udGFjdENvbnN0cmFpbnQ7XG5cbiAgIGZ1bmN0aW9uIGIyQ29udGFjdENvbnN0cmFpbnRQb2ludCgpIHtcbiAgICAgIGIyQ29udGFjdENvbnN0cmFpbnRQb2ludC5iMkNvbnRhY3RDb25zdHJhaW50UG9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3RDb25zdHJhaW50UG9pbnQgPSBiMkNvbnRhY3RDb25zdHJhaW50UG9pbnQ7XG5cbiAgIGZ1bmN0aW9uIGIyQ29udGFjdEVkZ2UoKSB7XG4gICAgICBiMkNvbnRhY3RFZGdlLmIyQ29udGFjdEVkZ2UuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3RFZGdlID0gYjJDb250YWN0RWRnZTtcblxuICAgZnVuY3Rpb24gYjJDb250YWN0RmFjdG9yeSgpIHtcbiAgICAgIGIyQ29udGFjdEZhY3RvcnkuYjJDb250YWN0RmFjdG9yeS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyQ29udGFjdEZhY3RvcnkpIHRoaXMuYjJDb250YWN0RmFjdG9yeS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdEZhY3RvcnkgPSBiMkNvbnRhY3RGYWN0b3J5O1xuXG4gICBmdW5jdGlvbiBiMkNvbnRhY3RSZWdpc3RlcigpIHtcbiAgICAgIGIyQ29udGFjdFJlZ2lzdGVyLmIyQ29udGFjdFJlZ2lzdGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0UmVnaXN0ZXIgPSBiMkNvbnRhY3RSZWdpc3RlcjtcblxuICAgZnVuY3Rpb24gYjJDb250YWN0UmVzdWx0KCkge1xuICAgICAgYjJDb250YWN0UmVzdWx0LmIyQ29udGFjdFJlc3VsdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdFJlc3VsdCA9IGIyQ29udGFjdFJlc3VsdDtcblxuICAgZnVuY3Rpb24gYjJDb250YWN0U29sdmVyKCkge1xuICAgICAgYjJDb250YWN0U29sdmVyLmIyQ29udGFjdFNvbHZlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyQ29udGFjdFNvbHZlcikgdGhpcy5iMkNvbnRhY3RTb2x2ZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3RTb2x2ZXIgPSBiMkNvbnRhY3RTb2x2ZXI7XG5cbiAgIGZ1bmN0aW9uIGIyRWRnZUFuZENpcmNsZUNvbnRhY3QoKSB7XG4gICAgICBiMkVkZ2VBbmRDaXJjbGVDb250YWN0LmIyRWRnZUFuZENpcmNsZUNvbnRhY3QuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkVkZ2VBbmRDaXJjbGVDb250YWN0ID0gYjJFZGdlQW5kQ2lyY2xlQ29udGFjdDtcblxuICAgZnVuY3Rpb24gYjJOdWxsQ29udGFjdCgpIHtcbiAgICAgIGIyTnVsbENvbnRhY3QuYjJOdWxsQ29udGFjdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyTnVsbENvbnRhY3QpIHRoaXMuYjJOdWxsQ29udGFjdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyTnVsbENvbnRhY3QgPSBiMk51bGxDb250YWN0O1xuXG4gICBmdW5jdGlvbiBiMlBvbHlBbmRDaXJjbGVDb250YWN0KCkge1xuICAgICAgYjJQb2x5QW5kQ2lyY2xlQ29udGFjdC5iMlBvbHlBbmRDaXJjbGVDb250YWN0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJQb2x5QW5kQ2lyY2xlQ29udGFjdCA9IGIyUG9seUFuZENpcmNsZUNvbnRhY3Q7XG5cbiAgIGZ1bmN0aW9uIGIyUG9seUFuZEVkZ2VDb250YWN0KCkge1xuICAgICAgYjJQb2x5QW5kRWRnZUNvbnRhY3QuYjJQb2x5QW5kRWRnZUNvbnRhY3QuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMlBvbHlBbmRFZGdlQ29udGFjdCA9IGIyUG9seUFuZEVkZ2VDb250YWN0O1xuXG4gICBmdW5jdGlvbiBiMlBvbHlnb25Db250YWN0KCkge1xuICAgICAgYjJQb2x5Z29uQ29udGFjdC5iMlBvbHlnb25Db250YWN0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJQb2x5Z29uQ29udGFjdCA9IGIyUG9seWdvbkNvbnRhY3Q7XG5cbiAgIGZ1bmN0aW9uIGIyUG9zaXRpb25Tb2x2ZXJNYW5pZm9sZCgpIHtcbiAgICAgIGIyUG9zaXRpb25Tb2x2ZXJNYW5pZm9sZC5iMlBvc2l0aW9uU29sdmVyTWFuaWZvbGQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMlBvc2l0aW9uU29sdmVyTWFuaWZvbGQpIHRoaXMuYjJQb3NpdGlvblNvbHZlck1hbmlmb2xkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJQb3NpdGlvblNvbHZlck1hbmlmb2xkID0gYjJQb3NpdGlvblNvbHZlck1hbmlmb2xkO1xuXG4gICBmdW5jdGlvbiBiMkJ1b3lhbmN5Q29udHJvbGxlcigpIHtcbiAgICAgIGIyQnVveWFuY3lDb250cm9sbGVyLmIyQnVveWFuY3lDb250cm9sbGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJCdW95YW5jeUNvbnRyb2xsZXIgPSBiMkJ1b3lhbmN5Q29udHJvbGxlcjtcblxuICAgZnVuY3Rpb24gYjJDb25zdGFudEFjY2VsQ29udHJvbGxlcigpIHtcbiAgICAgIGIyQ29uc3RhbnRBY2NlbENvbnRyb2xsZXIuYjJDb25zdGFudEFjY2VsQ29udHJvbGxlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyQ29uc3RhbnRBY2NlbENvbnRyb2xsZXIgPSBiMkNvbnN0YW50QWNjZWxDb250cm9sbGVyO1xuXG4gICBmdW5jdGlvbiBiMkNvbnN0YW50Rm9yY2VDb250cm9sbGVyKCkge1xuICAgICAgYjJDb25zdGFudEZvcmNlQ29udHJvbGxlci5iMkNvbnN0YW50Rm9yY2VDb250cm9sbGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJDb25zdGFudEZvcmNlQ29udHJvbGxlciA9IGIyQ29uc3RhbnRGb3JjZUNvbnRyb2xsZXI7XG5cbiAgIGZ1bmN0aW9uIGIyQ29udHJvbGxlcigpIHtcbiAgICAgIGIyQ29udHJvbGxlci5iMkNvbnRyb2xsZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5EeW5hbWljcy5Db250cm9sbGVycy5iMkNvbnRyb2xsZXIgPSBiMkNvbnRyb2xsZXI7XG5cbiAgIGZ1bmN0aW9uIGIyQ29udHJvbGxlckVkZ2UoKSB7XG4gICAgICBiMkNvbnRyb2xsZXJFZGdlLmIyQ29udHJvbGxlckVkZ2UuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5EeW5hbWljcy5Db250cm9sbGVycy5iMkNvbnRyb2xsZXJFZGdlID0gYjJDb250cm9sbGVyRWRnZTtcblxuICAgZnVuY3Rpb24gYjJHcmF2aXR5Q29udHJvbGxlcigpIHtcbiAgICAgIGIyR3Jhdml0eUNvbnRyb2xsZXIuYjJHcmF2aXR5Q29udHJvbGxlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyR3Jhdml0eUNvbnRyb2xsZXIgPSBiMkdyYXZpdHlDb250cm9sbGVyO1xuXG4gICBmdW5jdGlvbiBiMlRlbnNvckRhbXBpbmdDb250cm9sbGVyKCkge1xuICAgICAgYjJUZW5zb3JEYW1waW5nQ29udHJvbGxlci5iMlRlbnNvckRhbXBpbmdDb250cm9sbGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJUZW5zb3JEYW1waW5nQ29udHJvbGxlciA9IGIyVGVuc29yRGFtcGluZ0NvbnRyb2xsZXI7XG5cbiAgIGZ1bmN0aW9uIGIyRGlzdGFuY2VKb2ludCgpIHtcbiAgICAgIGIyRGlzdGFuY2VKb2ludC5iMkRpc3RhbmNlSm9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMkRpc3RhbmNlSm9pbnQpIHRoaXMuYjJEaXN0YW5jZUpvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyRGlzdGFuY2VKb2ludCA9IGIyRGlzdGFuY2VKb2ludDtcblxuICAgZnVuY3Rpb24gYjJEaXN0YW5jZUpvaW50RGVmKCkge1xuICAgICAgYjJEaXN0YW5jZUpvaW50RGVmLmIyRGlzdGFuY2VKb2ludERlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyRGlzdGFuY2VKb2ludERlZikgdGhpcy5iMkRpc3RhbmNlSm9pbnREZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJEaXN0YW5jZUpvaW50RGVmID0gYjJEaXN0YW5jZUpvaW50RGVmO1xuXG4gICBmdW5jdGlvbiBiMkZyaWN0aW9uSm9pbnQoKSB7XG4gICAgICBiMkZyaWN0aW9uSm9pbnQuYjJGcmljdGlvbkpvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJGcmljdGlvbkpvaW50KSB0aGlzLmIyRnJpY3Rpb25Kb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkZyaWN0aW9uSm9pbnQgPSBiMkZyaWN0aW9uSm9pbnQ7XG5cbiAgIGZ1bmN0aW9uIGIyRnJpY3Rpb25Kb2ludERlZigpIHtcbiAgICAgIGIyRnJpY3Rpb25Kb2ludERlZi5iMkZyaWN0aW9uSm9pbnREZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMkZyaWN0aW9uSm9pbnREZWYpIHRoaXMuYjJGcmljdGlvbkpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyRnJpY3Rpb25Kb2ludERlZiA9IGIyRnJpY3Rpb25Kb2ludERlZjtcblxuICAgZnVuY3Rpb24gYjJHZWFySm9pbnQoKSB7XG4gICAgICBiMkdlYXJKb2ludC5iMkdlYXJKb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyR2VhckpvaW50KSB0aGlzLmIyR2VhckpvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyR2VhckpvaW50ID0gYjJHZWFySm9pbnQ7XG5cbiAgIGZ1bmN0aW9uIGIyR2VhckpvaW50RGVmKCkge1xuICAgICAgYjJHZWFySm9pbnREZWYuYjJHZWFySm9pbnREZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMkdlYXJKb2ludERlZikgdGhpcy5iMkdlYXJKb2ludERlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkdlYXJKb2ludERlZiA9IGIyR2VhckpvaW50RGVmO1xuXG4gICBmdW5jdGlvbiBiMkphY29iaWFuKCkge1xuICAgICAgYjJKYWNvYmlhbi5iMkphY29iaWFuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySmFjb2JpYW4gPSBiMkphY29iaWFuO1xuXG4gICBmdW5jdGlvbiBiMkpvaW50KCkge1xuICAgICAgYjJKb2ludC5iMkpvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJKb2ludCkgdGhpcy5iMkpvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQgPSBiMkpvaW50O1xuXG4gICBmdW5jdGlvbiBiMkpvaW50RGVmKCkge1xuICAgICAgYjJKb2ludERlZi5iMkpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJKb2ludERlZikgdGhpcy5iMkpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnREZWYgPSBiMkpvaW50RGVmO1xuXG4gICBmdW5jdGlvbiBiMkpvaW50RWRnZSgpIHtcbiAgICAgIGIySm9pbnRFZGdlLmIySm9pbnRFZGdlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnRFZGdlID0gYjJKb2ludEVkZ2U7XG5cbiAgIGZ1bmN0aW9uIGIyTGluZUpvaW50KCkge1xuICAgICAgYjJMaW5lSm9pbnQuYjJMaW5lSm9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMkxpbmVKb2ludCkgdGhpcy5iMkxpbmVKb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkxpbmVKb2ludCA9IGIyTGluZUpvaW50O1xuXG4gICBmdW5jdGlvbiBiMkxpbmVKb2ludERlZigpIHtcbiAgICAgIGIyTGluZUpvaW50RGVmLmIyTGluZUpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJMaW5lSm9pbnREZWYpIHRoaXMuYjJMaW5lSm9pbnREZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJMaW5lSm9pbnREZWYgPSBiMkxpbmVKb2ludERlZjtcblxuICAgZnVuY3Rpb24gYjJNb3VzZUpvaW50KCkge1xuICAgICAgYjJNb3VzZUpvaW50LmIyTW91c2VKb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyTW91c2VKb2ludCkgdGhpcy5iMk1vdXNlSm9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJNb3VzZUpvaW50ID0gYjJNb3VzZUpvaW50O1xuXG4gICBmdW5jdGlvbiBiMk1vdXNlSm9pbnREZWYoKSB7XG4gICAgICBiMk1vdXNlSm9pbnREZWYuYjJNb3VzZUpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJNb3VzZUpvaW50RGVmKSB0aGlzLmIyTW91c2VKb2ludERlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMk1vdXNlSm9pbnREZWYgPSBiMk1vdXNlSm9pbnREZWY7XG5cbiAgIGZ1bmN0aW9uIGIyUHJpc21hdGljSm9pbnQoKSB7XG4gICAgICBiMlByaXNtYXRpY0pvaW50LmIyUHJpc21hdGljSm9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMlByaXNtYXRpY0pvaW50KSB0aGlzLmIyUHJpc21hdGljSm9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJQcmlzbWF0aWNKb2ludCA9IGIyUHJpc21hdGljSm9pbnQ7XG5cbiAgIGZ1bmN0aW9uIGIyUHJpc21hdGljSm9pbnREZWYoKSB7XG4gICAgICBiMlByaXNtYXRpY0pvaW50RGVmLmIyUHJpc21hdGljSm9pbnREZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMlByaXNtYXRpY0pvaW50RGVmKSB0aGlzLmIyUHJpc21hdGljSm9pbnREZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJQcmlzbWF0aWNKb2ludERlZiA9IGIyUHJpc21hdGljSm9pbnREZWY7XG5cbiAgIGZ1bmN0aW9uIGIyUHVsbGV5Sm9pbnQoKSB7XG4gICAgICBiMlB1bGxleUpvaW50LmIyUHVsbGV5Sm9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMlB1bGxleUpvaW50KSB0aGlzLmIyUHVsbGV5Sm9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJQdWxsZXlKb2ludCA9IGIyUHVsbGV5Sm9pbnQ7XG5cbiAgIGZ1bmN0aW9uIGIyUHVsbGV5Sm9pbnREZWYoKSB7XG4gICAgICBiMlB1bGxleUpvaW50RGVmLmIyUHVsbGV5Sm9pbnREZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMlB1bGxleUpvaW50RGVmKSB0aGlzLmIyUHVsbGV5Sm9pbnREZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJQdWxsZXlKb2ludERlZiA9IGIyUHVsbGV5Sm9pbnREZWY7XG5cbiAgIGZ1bmN0aW9uIGIyUmV2b2x1dGVKb2ludCgpIHtcbiAgICAgIGIyUmV2b2x1dGVKb2ludC5iMlJldm9sdXRlSm9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMlJldm9sdXRlSm9pbnQpIHRoaXMuYjJSZXZvbHV0ZUpvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyUmV2b2x1dGVKb2ludCA9IGIyUmV2b2x1dGVKb2ludDtcblxuICAgZnVuY3Rpb24gYjJSZXZvbHV0ZUpvaW50RGVmKCkge1xuICAgICAgYjJSZXZvbHV0ZUpvaW50RGVmLmIyUmV2b2x1dGVKb2ludERlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyUmV2b2x1dGVKb2ludERlZikgdGhpcy5iMlJldm9sdXRlSm9pbnREZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJSZXZvbHV0ZUpvaW50RGVmID0gYjJSZXZvbHV0ZUpvaW50RGVmO1xuXG4gICBmdW5jdGlvbiBiMldlbGRKb2ludCgpIHtcbiAgICAgIGIyV2VsZEpvaW50LmIyV2VsZEpvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJXZWxkSm9pbnQpIHRoaXMuYjJXZWxkSm9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJXZWxkSm9pbnQgPSBiMldlbGRKb2ludDtcblxuICAgZnVuY3Rpb24gYjJXZWxkSm9pbnREZWYoKSB7XG4gICAgICBiMldlbGRKb2ludERlZi5iMldlbGRKb2ludERlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyV2VsZEpvaW50RGVmKSB0aGlzLmIyV2VsZEpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyV2VsZEpvaW50RGVmID0gYjJXZWxkSm9pbnREZWY7XG59KSgpOyAvL2RlZmluaXRpb25zXG5Cb3gyRC5wb3N0RGVmcyA9IFtdO1xuKGZ1bmN0aW9uICgpIHtcbiAgIHZhciBiMkNpcmNsZVNoYXBlID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMkNpcmNsZVNoYXBlLFxuICAgICAgYjJFZGdlQ2hhaW5EZWYgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyRWRnZUNoYWluRGVmLFxuICAgICAgYjJFZGdlU2hhcGUgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyRWRnZVNoYXBlLFxuICAgICAgYjJNYXNzRGF0YSA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJNYXNzRGF0YSxcbiAgICAgIGIyUG9seWdvblNoYXBlID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlBvbHlnb25TaGFwZSxcbiAgICAgIGIyU2hhcGUgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyU2hhcGUsXG4gICAgICBiMkNvbG9yID0gQm94MkQuQ29tbW9uLmIyQ29sb3IsXG4gICAgICBiMmludGVybmFsID0gQm94MkQuQ29tbW9uLmIyaW50ZXJuYWwsXG4gICAgICBiMlNldHRpbmdzID0gQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MsXG4gICAgICBiMk1hdDIyID0gQm94MkQuQ29tbW9uLk1hdGguYjJNYXQyMixcbiAgICAgIGIyTWF0MzMgPSBCb3gyRC5Db21tb24uTWF0aC5iMk1hdDMzLFxuICAgICAgYjJNYXRoID0gQm94MkQuQ29tbW9uLk1hdGguYjJNYXRoLFxuICAgICAgYjJTd2VlcCA9IEJveDJELkNvbW1vbi5NYXRoLmIyU3dlZXAsXG4gICAgICBiMlRyYW5zZm9ybSA9IEJveDJELkNvbW1vbi5NYXRoLmIyVHJhbnNmb3JtLFxuICAgICAgYjJWZWMyID0gQm94MkQuQ29tbW9uLk1hdGguYjJWZWMyLFxuICAgICAgYjJWZWMzID0gQm94MkQuQ29tbW9uLk1hdGguYjJWZWMzLFxuICAgICAgYjJBQUJCID0gQm94MkQuQ29sbGlzaW9uLmIyQUFCQixcbiAgICAgIGIyQm91bmQgPSBCb3gyRC5Db2xsaXNpb24uYjJCb3VuZCxcbiAgICAgIGIyQm91bmRWYWx1ZXMgPSBCb3gyRC5Db2xsaXNpb24uYjJCb3VuZFZhbHVlcyxcbiAgICAgIGIyQ29sbGlzaW9uID0gQm94MkQuQ29sbGlzaW9uLmIyQ29sbGlzaW9uLFxuICAgICAgYjJDb250YWN0SUQgPSBCb3gyRC5Db2xsaXNpb24uYjJDb250YWN0SUQsXG4gICAgICBiMkNvbnRhY3RQb2ludCA9IEJveDJELkNvbGxpc2lvbi5iMkNvbnRhY3RQb2ludCxcbiAgICAgIGIyRGlzdGFuY2UgPSBCb3gyRC5Db2xsaXNpb24uYjJEaXN0YW5jZSxcbiAgICAgIGIyRGlzdGFuY2VJbnB1dCA9IEJveDJELkNvbGxpc2lvbi5iMkRpc3RhbmNlSW5wdXQsXG4gICAgICBiMkRpc3RhbmNlT3V0cHV0ID0gQm94MkQuQ29sbGlzaW9uLmIyRGlzdGFuY2VPdXRwdXQsXG4gICAgICBiMkRpc3RhbmNlUHJveHkgPSBCb3gyRC5Db2xsaXNpb24uYjJEaXN0YW5jZVByb3h5LFxuICAgICAgYjJEeW5hbWljVHJlZSA9IEJveDJELkNvbGxpc2lvbi5iMkR5bmFtaWNUcmVlLFxuICAgICAgYjJEeW5hbWljVHJlZUJyb2FkUGhhc2UgPSBCb3gyRC5Db2xsaXNpb24uYjJEeW5hbWljVHJlZUJyb2FkUGhhc2UsXG4gICAgICBiMkR5bmFtaWNUcmVlTm9kZSA9IEJveDJELkNvbGxpc2lvbi5iMkR5bmFtaWNUcmVlTm9kZSxcbiAgICAgIGIyRHluYW1pY1RyZWVQYWlyID0gQm94MkQuQ29sbGlzaW9uLmIyRHluYW1pY1RyZWVQYWlyLFxuICAgICAgYjJNYW5pZm9sZCA9IEJveDJELkNvbGxpc2lvbi5iMk1hbmlmb2xkLFxuICAgICAgYjJNYW5pZm9sZFBvaW50ID0gQm94MkQuQ29sbGlzaW9uLmIyTWFuaWZvbGRQb2ludCxcbiAgICAgIGIyUG9pbnQgPSBCb3gyRC5Db2xsaXNpb24uYjJQb2ludCxcbiAgICAgIGIyUmF5Q2FzdElucHV0ID0gQm94MkQuQ29sbGlzaW9uLmIyUmF5Q2FzdElucHV0LFxuICAgICAgYjJSYXlDYXN0T3V0cHV0ID0gQm94MkQuQ29sbGlzaW9uLmIyUmF5Q2FzdE91dHB1dCxcbiAgICAgIGIyU2VnbWVudCA9IEJveDJELkNvbGxpc2lvbi5iMlNlZ21lbnQsXG4gICAgICBiMlNlcGFyYXRpb25GdW5jdGlvbiA9IEJveDJELkNvbGxpc2lvbi5iMlNlcGFyYXRpb25GdW5jdGlvbixcbiAgICAgIGIyU2ltcGxleCA9IEJveDJELkNvbGxpc2lvbi5iMlNpbXBsZXgsXG4gICAgICBiMlNpbXBsZXhDYWNoZSA9IEJveDJELkNvbGxpc2lvbi5iMlNpbXBsZXhDYWNoZSxcbiAgICAgIGIyU2ltcGxleFZlcnRleCA9IEJveDJELkNvbGxpc2lvbi5iMlNpbXBsZXhWZXJ0ZXgsXG4gICAgICBiMlRpbWVPZkltcGFjdCA9IEJveDJELkNvbGxpc2lvbi5iMlRpbWVPZkltcGFjdCxcbiAgICAgIGIyVE9JSW5wdXQgPSBCb3gyRC5Db2xsaXNpb24uYjJUT0lJbnB1dCxcbiAgICAgIGIyV29ybGRNYW5pZm9sZCA9IEJveDJELkNvbGxpc2lvbi5iMldvcmxkTWFuaWZvbGQsXG4gICAgICBDbGlwVmVydGV4ID0gQm94MkQuQ29sbGlzaW9uLkNsaXBWZXJ0ZXgsXG4gICAgICBGZWF0dXJlcyA9IEJveDJELkNvbGxpc2lvbi5GZWF0dXJlcyxcbiAgICAgIElCcm9hZFBoYXNlID0gQm94MkQuQ29sbGlzaW9uLklCcm9hZFBoYXNlO1xuXG4gICBiMkFBQkIuYjJBQUJCID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5sb3dlckJvdW5kID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy51cHBlckJvdW5kID0gbmV3IGIyVmVjMigpO1xuICAgfTtcbiAgIGIyQUFCQi5wcm90b3R5cGUuSXNWYWxpZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBkWCA9IHRoaXMudXBwZXJCb3VuZC54IC0gdGhpcy5sb3dlckJvdW5kLng7XG4gICAgICB2YXIgZFkgPSB0aGlzLnVwcGVyQm91bmQueSAtIHRoaXMubG93ZXJCb3VuZC55O1xuICAgICAgdmFyIHZhbGlkID0gZFggPj0gMC4wICYmIGRZID49IDAuMDtcbiAgICAgIHZhbGlkID0gdmFsaWQgJiYgdGhpcy5sb3dlckJvdW5kLklzVmFsaWQoKSAmJiB0aGlzLnVwcGVyQm91bmQuSXNWYWxpZCgpO1xuICAgICAgcmV0dXJuIHZhbGlkO1xuICAgfVxuICAgYjJBQUJCLnByb3RvdHlwZS5HZXRDZW50ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gbmV3IGIyVmVjMigodGhpcy5sb3dlckJvdW5kLnggKyB0aGlzLnVwcGVyQm91bmQueCkgLyAyLCAodGhpcy5sb3dlckJvdW5kLnkgKyB0aGlzLnVwcGVyQm91bmQueSkgLyAyKTtcbiAgIH1cbiAgIGIyQUFCQi5wcm90b3R5cGUuR2V0RXh0ZW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBuZXcgYjJWZWMyKCh0aGlzLnVwcGVyQm91bmQueCAtIHRoaXMubG93ZXJCb3VuZC54KSAvIDIsICh0aGlzLnVwcGVyQm91bmQueSAtIHRoaXMubG93ZXJCb3VuZC55KSAvIDIpO1xuICAgfVxuICAgYjJBQUJCLnByb3RvdHlwZS5Db250YWlucyA9IGZ1bmN0aW9uIChhYWJiKSB7XG4gICAgICB2YXIgcmVzdWx0ID0gdHJ1ZTtcbiAgICAgIHJlc3VsdCA9IHJlc3VsdCAmJiB0aGlzLmxvd2VyQm91bmQueCA8PSBhYWJiLmxvd2VyQm91bmQueDtcbiAgICAgIHJlc3VsdCA9IHJlc3VsdCAmJiB0aGlzLmxvd2VyQm91bmQueSA8PSBhYWJiLmxvd2VyQm91bmQueTtcbiAgICAgIHJlc3VsdCA9IHJlc3VsdCAmJiBhYWJiLnVwcGVyQm91bmQueCA8PSB0aGlzLnVwcGVyQm91bmQueDtcbiAgICAgIHJlc3VsdCA9IHJlc3VsdCAmJiBhYWJiLnVwcGVyQm91bmQueSA8PSB0aGlzLnVwcGVyQm91bmQueTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICB9XG4gICBiMkFBQkIucHJvdG90eXBlLlJheUNhc3QgPSBmdW5jdGlvbiAob3V0cHV0LCBpbnB1dCkge1xuICAgICAgdmFyIHRtaW4gPSAoLU51bWJlci5NQVhfVkFMVUUpO1xuICAgICAgdmFyIHRtYXggPSBOdW1iZXIuTUFYX1ZBTFVFO1xuICAgICAgdmFyIHBYID0gaW5wdXQucDEueDtcbiAgICAgIHZhciBwWSA9IGlucHV0LnAxLnk7XG4gICAgICB2YXIgZFggPSBpbnB1dC5wMi54IC0gaW5wdXQucDEueDtcbiAgICAgIHZhciBkWSA9IGlucHV0LnAyLnkgLSBpbnB1dC5wMS55O1xuICAgICAgdmFyIGFic0RYID0gTWF0aC5hYnMoZFgpO1xuICAgICAgdmFyIGFic0RZID0gTWF0aC5hYnMoZFkpO1xuICAgICAgdmFyIG5vcm1hbCA9IG91dHB1dC5ub3JtYWw7XG4gICAgICB2YXIgaW52X2QgPSAwO1xuICAgICAgdmFyIHQxID0gMDtcbiAgICAgIHZhciB0MiA9IDA7XG4gICAgICB2YXIgdDMgPSAwO1xuICAgICAgdmFyIHMgPSAwOyB7XG4gICAgICAgICBpZiAoYWJzRFggPCBOdW1iZXIuTUlOX1ZBTFVFKSB7XG4gICAgICAgICAgICBpZiAocFggPCB0aGlzLmxvd2VyQm91bmQueCB8fCB0aGlzLnVwcGVyQm91bmQueCA8IHBYKSByZXR1cm4gZmFsc2U7XG4gICAgICAgICB9XG4gICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGludl9kID0gMS4wIC8gZFg7XG4gICAgICAgICAgICB0MSA9ICh0aGlzLmxvd2VyQm91bmQueCAtIHBYKSAqIGludl9kO1xuICAgICAgICAgICAgdDIgPSAodGhpcy51cHBlckJvdW5kLnggLSBwWCkgKiBpbnZfZDtcbiAgICAgICAgICAgIHMgPSAoLTEuMCk7XG4gICAgICAgICAgICBpZiAodDEgPiB0Mikge1xuICAgICAgICAgICAgICAgdDMgPSB0MTtcbiAgICAgICAgICAgICAgIHQxID0gdDI7XG4gICAgICAgICAgICAgICB0MiA9IHQzO1xuICAgICAgICAgICAgICAgcyA9IDEuMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0MSA+IHRtaW4pIHtcbiAgICAgICAgICAgICAgIG5vcm1hbC54ID0gcztcbiAgICAgICAgICAgICAgIG5vcm1hbC55ID0gMDtcbiAgICAgICAgICAgICAgIHRtaW4gPSB0MTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRtYXggPSBNYXRoLm1pbih0bWF4LCB0Mik7XG4gICAgICAgICAgICBpZiAodG1pbiA+IHRtYXgpIHJldHVybiBmYWxzZTtcbiAgICAgICAgIH1cbiAgICAgIH0ge1xuICAgICAgICAgaWYgKGFic0RZIDwgTnVtYmVyLk1JTl9WQUxVRSkge1xuICAgICAgICAgICAgaWYgKHBZIDwgdGhpcy5sb3dlckJvdW5kLnkgfHwgdGhpcy51cHBlckJvdW5kLnkgPCBwWSkgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgfVxuICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpbnZfZCA9IDEuMCAvIGRZO1xuICAgICAgICAgICAgdDEgPSAodGhpcy5sb3dlckJvdW5kLnkgLSBwWSkgKiBpbnZfZDtcbiAgICAgICAgICAgIHQyID0gKHRoaXMudXBwZXJCb3VuZC55IC0gcFkpICogaW52X2Q7XG4gICAgICAgICAgICBzID0gKC0xLjApO1xuICAgICAgICAgICAgaWYgKHQxID4gdDIpIHtcbiAgICAgICAgICAgICAgIHQzID0gdDE7XG4gICAgICAgICAgICAgICB0MSA9IHQyO1xuICAgICAgICAgICAgICAgdDIgPSB0MztcbiAgICAgICAgICAgICAgIHMgPSAxLjA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodDEgPiB0bWluKSB7XG4gICAgICAgICAgICAgICBub3JtYWwueSA9IHM7XG4gICAgICAgICAgICAgICBub3JtYWwueCA9IDA7XG4gICAgICAgICAgICAgICB0bWluID0gdDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0bWF4ID0gTWF0aC5taW4odG1heCwgdDIpO1xuICAgICAgICAgICAgaWYgKHRtaW4gPiB0bWF4KSByZXR1cm4gZmFsc2U7XG4gICAgICAgICB9XG4gICAgICB9XG4gICAgICBvdXRwdXQuZnJhY3Rpb24gPSB0bWluO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICB9XG4gICBiMkFBQkIucHJvdG90eXBlLlRlc3RPdmVybGFwID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgICB2YXIgZDFYID0gb3RoZXIubG93ZXJCb3VuZC54IC0gdGhpcy51cHBlckJvdW5kLng7XG4gICAgICB2YXIgZDFZID0gb3RoZXIubG93ZXJCb3VuZC55IC0gdGhpcy51cHBlckJvdW5kLnk7XG4gICAgICB2YXIgZDJYID0gdGhpcy5sb3dlckJvdW5kLnggLSBvdGhlci51cHBlckJvdW5kLng7XG4gICAgICB2YXIgZDJZID0gdGhpcy5sb3dlckJvdW5kLnkgLSBvdGhlci51cHBlckJvdW5kLnk7XG4gICAgICBpZiAoZDFYID4gMC4wIHx8IGQxWSA+IDAuMCkgcmV0dXJuIGZhbHNlO1xuICAgICAgaWYgKGQyWCA+IDAuMCB8fCBkMlkgPiAwLjApIHJldHVybiBmYWxzZTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgfVxuICAgYjJBQUJCLkNvbWJpbmUgPSBmdW5jdGlvbiAoYWFiYjEsIGFhYmIyKSB7XG4gICAgICB2YXIgYWFiYiA9IG5ldyBiMkFBQkIoKTtcbiAgICAgIGFhYmIuQ29tYmluZShhYWJiMSwgYWFiYjIpO1xuICAgICAgcmV0dXJuIGFhYmI7XG4gICB9XG4gICBiMkFBQkIucHJvdG90eXBlLkNvbWJpbmUgPSBmdW5jdGlvbiAoYWFiYjEsIGFhYmIyKSB7XG4gICAgICB0aGlzLmxvd2VyQm91bmQueCA9IE1hdGgubWluKGFhYmIxLmxvd2VyQm91bmQueCwgYWFiYjIubG93ZXJCb3VuZC54KTtcbiAgICAgIHRoaXMubG93ZXJCb3VuZC55ID0gTWF0aC5taW4oYWFiYjEubG93ZXJCb3VuZC55LCBhYWJiMi5sb3dlckJvdW5kLnkpO1xuICAgICAgdGhpcy51cHBlckJvdW5kLnggPSBNYXRoLm1heChhYWJiMS51cHBlckJvdW5kLngsIGFhYmIyLnVwcGVyQm91bmQueCk7XG4gICAgICB0aGlzLnVwcGVyQm91bmQueSA9IE1hdGgubWF4KGFhYmIxLnVwcGVyQm91bmQueSwgYWFiYjIudXBwZXJCb3VuZC55KTtcbiAgIH1cbiAgIGIyQm91bmQuYjJCb3VuZCA9IGZ1bmN0aW9uICgpIHt9O1xuICAgYjJCb3VuZC5wcm90b3R5cGUuSXNMb3dlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiAodGhpcy52YWx1ZSAmIDEpID09IDA7XG4gICB9XG4gICBiMkJvdW5kLnByb3RvdHlwZS5Jc1VwcGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuICh0aGlzLnZhbHVlICYgMSkgPT0gMTtcbiAgIH1cbiAgIGIyQm91bmQucHJvdG90eXBlLlN3YXAgPSBmdW5jdGlvbiAoYikge1xuICAgICAgdmFyIHRlbXBWYWx1ZSA9IHRoaXMudmFsdWU7XG4gICAgICB2YXIgdGVtcFByb3h5ID0gdGhpcy5wcm94eTtcbiAgICAgIHZhciB0ZW1wU3RhYmJpbmdDb3VudCA9IHRoaXMuc3RhYmJpbmdDb3VudDtcbiAgICAgIHRoaXMudmFsdWUgPSBiLnZhbHVlO1xuICAgICAgdGhpcy5wcm94eSA9IGIucHJveHk7XG4gICAgICB0aGlzLnN0YWJiaW5nQ291bnQgPSBiLnN0YWJiaW5nQ291bnQ7XG4gICAgICBiLnZhbHVlID0gdGVtcFZhbHVlO1xuICAgICAgYi5wcm94eSA9IHRlbXBQcm94eTtcbiAgICAgIGIuc3RhYmJpbmdDb3VudCA9IHRlbXBTdGFiYmluZ0NvdW50O1xuICAgfVxuICAgYjJCb3VuZFZhbHVlcy5iMkJvdW5kVmFsdWVzID0gZnVuY3Rpb24gKCkge307XG4gICBiMkJvdW5kVmFsdWVzLnByb3RvdHlwZS5iMkJvdW5kVmFsdWVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5sb3dlclZhbHVlcyA9IG5ldyBWZWN0b3JfYTJqX051bWJlcigpO1xuICAgICAgdGhpcy5sb3dlclZhbHVlc1swXSA9IDAuMDtcbiAgICAgIHRoaXMubG93ZXJWYWx1ZXNbMV0gPSAwLjA7XG4gICAgICB0aGlzLnVwcGVyVmFsdWVzID0gbmV3IFZlY3Rvcl9hMmpfTnVtYmVyKCk7XG4gICAgICB0aGlzLnVwcGVyVmFsdWVzWzBdID0gMC4wO1xuICAgICAgdGhpcy51cHBlclZhbHVlc1sxXSA9IDAuMDtcbiAgIH1cbiAgIGIyQ29sbGlzaW9uLmIyQ29sbGlzaW9uID0gZnVuY3Rpb24gKCkge307XG4gICBiMkNvbGxpc2lvbi5DbGlwU2VnbWVudFRvTGluZSA9IGZ1bmN0aW9uICh2T3V0LCB2SW4sIG5vcm1hbCwgb2Zmc2V0KSB7XG4gICAgICBpZiAob2Zmc2V0ID09PSB1bmRlZmluZWQpIG9mZnNldCA9IDA7XG4gICAgICB2YXIgY3Y7XG4gICAgICB2YXIgbnVtT3V0ID0gMDtcbiAgICAgIGN2ID0gdkluWzBdO1xuICAgICAgdmFyIHZJbjAgPSBjdi52O1xuICAgICAgY3YgPSB2SW5bMV07XG4gICAgICB2YXIgdkluMSA9IGN2LnY7XG4gICAgICB2YXIgZGlzdGFuY2UwID0gbm9ybWFsLnggKiB2SW4wLnggKyBub3JtYWwueSAqIHZJbjAueSAtIG9mZnNldDtcbiAgICAgIHZhciBkaXN0YW5jZTEgPSBub3JtYWwueCAqIHZJbjEueCArIG5vcm1hbC55ICogdkluMS55IC0gb2Zmc2V0O1xuICAgICAgaWYgKGRpc3RhbmNlMCA8PSAwLjApIHZPdXRbbnVtT3V0KytdLlNldCh2SW5bMF0pO1xuICAgICAgaWYgKGRpc3RhbmNlMSA8PSAwLjApIHZPdXRbbnVtT3V0KytdLlNldCh2SW5bMV0pO1xuICAgICAgaWYgKGRpc3RhbmNlMCAqIGRpc3RhbmNlMSA8IDAuMCkge1xuICAgICAgICAgdmFyIGludGVycCA9IGRpc3RhbmNlMCAvIChkaXN0YW5jZTAgLSBkaXN0YW5jZTEpO1xuICAgICAgICAgY3YgPSB2T3V0W251bU91dF07XG4gICAgICAgICB2YXIgdFZlYyA9IGN2LnY7XG4gICAgICAgICB0VmVjLnggPSB2SW4wLnggKyBpbnRlcnAgKiAodkluMS54IC0gdkluMC54KTtcbiAgICAgICAgIHRWZWMueSA9IHZJbjAueSArIGludGVycCAqICh2SW4xLnkgLSB2SW4wLnkpO1xuICAgICAgICAgY3YgPSB2T3V0W251bU91dF07XG4gICAgICAgICB2YXIgY3YyO1xuICAgICAgICAgaWYgKGRpc3RhbmNlMCA+IDAuMCkge1xuICAgICAgICAgICAgY3YyID0gdkluWzBdO1xuICAgICAgICAgICAgY3YuaWQgPSBjdjIuaWQ7XG4gICAgICAgICB9XG4gICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGN2MiA9IHZJblsxXTtcbiAgICAgICAgICAgIGN2LmlkID0gY3YyLmlkO1xuICAgICAgICAgfSsrbnVtT3V0O1xuICAgICAgfVxuICAgICAgcmV0dXJuIG51bU91dDtcbiAgIH1cbiAgIGIyQ29sbGlzaW9uLkVkZ2VTZXBhcmF0aW9uID0gZnVuY3Rpb24gKHBvbHkxLCB4ZjEsIGVkZ2UxLCBwb2x5MiwgeGYyKSB7XG4gICAgICBpZiAoZWRnZTEgPT09IHVuZGVmaW5lZCkgZWRnZTEgPSAwO1xuICAgICAgdmFyIGNvdW50MSA9IHBhcnNlSW50KHBvbHkxLm1fdmVydGV4Q291bnQpO1xuICAgICAgdmFyIHZlcnRpY2VzMSA9IHBvbHkxLm1fdmVydGljZXM7XG4gICAgICB2YXIgbm9ybWFsczEgPSBwb2x5MS5tX25vcm1hbHM7XG4gICAgICB2YXIgY291bnQyID0gcGFyc2VJbnQocG9seTIubV92ZXJ0ZXhDb3VudCk7XG4gICAgICB2YXIgdmVydGljZXMyID0gcG9seTIubV92ZXJ0aWNlcztcbiAgICAgIHZhciB0TWF0O1xuICAgICAgdmFyIHRWZWM7XG4gICAgICB0TWF0ID0geGYxLlI7XG4gICAgICB0VmVjID0gbm9ybWFsczFbZWRnZTFdO1xuICAgICAgdmFyIG5vcm1hbDFXb3JsZFggPSAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XG4gICAgICB2YXIgbm9ybWFsMVdvcmxkWSA9ICh0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55KTtcbiAgICAgIHRNYXQgPSB4ZjIuUjtcbiAgICAgIHZhciBub3JtYWwxWCA9ICh0TWF0LmNvbDEueCAqIG5vcm1hbDFXb3JsZFggKyB0TWF0LmNvbDEueSAqIG5vcm1hbDFXb3JsZFkpO1xuICAgICAgdmFyIG5vcm1hbDFZID0gKHRNYXQuY29sMi54ICogbm9ybWFsMVdvcmxkWCArIHRNYXQuY29sMi55ICogbm9ybWFsMVdvcmxkWSk7XG4gICAgICB2YXIgaW5kZXggPSAwO1xuICAgICAgdmFyIG1pbkRvdCA9IE51bWJlci5NQVhfVkFMVUU7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50MjsgKytpKSB7XG4gICAgICAgICB0VmVjID0gdmVydGljZXMyW2ldO1xuICAgICAgICAgdmFyIGRvdCA9IHRWZWMueCAqIG5vcm1hbDFYICsgdFZlYy55ICogbm9ybWFsMVk7XG4gICAgICAgICBpZiAoZG90IDwgbWluRG90KSB7XG4gICAgICAgICAgICBtaW5Eb3QgPSBkb3Q7XG4gICAgICAgICAgICBpbmRleCA9IGk7XG4gICAgICAgICB9XG4gICAgICB9XG4gICAgICB0VmVjID0gdmVydGljZXMxW2VkZ2UxXTtcbiAgICAgIHRNYXQgPSB4ZjEuUjtcbiAgICAgIHZhciB2MVggPSB4ZjEucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcbiAgICAgIHZhciB2MVkgPSB4ZjEucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55KTtcbiAgICAgIHRWZWMgPSB2ZXJ0aWNlczJbaW5kZXhdO1xuICAgICAgdE1hdCA9IHhmMi5SO1xuICAgICAgdmFyIHYyWCA9IHhmMi5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xuICAgICAgdmFyIHYyWSA9IHhmMi5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xuICAgICAgdjJYIC09IHYxWDtcbiAgICAgIHYyWSAtPSB2MVk7XG4gICAgICB2YXIgc2VwYXJhdGlvbiA9IHYyWCAqIG5vcm1hbDFXb3JsZFggKyB2MlkgKiBub3JtYWwxV29ybGRZO1xuICAgICAgcmV0dXJuIHNlcGFyYXRpb247XG4gICB9XG4gICBiMkNvbGxpc2lvbi5GaW5kTWF4U2VwYXJhdGlvbiA9IGZ1bmN0aW9uIChlZGdlSW5kZXgsIHBvbHkxLCB4ZjEsIHBvbHkyLCB4ZjIpIHtcbiAgICAgIHZhciBjb3VudDEgPSBwYXJzZUludChwb2x5MS5tX3ZlcnRleENvdW50KTtcbiAgICAgIHZhciBub3JtYWxzMSA9IHBvbHkxLm1fbm9ybWFscztcbiAgICAgIHZhciB0VmVjO1xuICAgICAgdmFyIHRNYXQ7XG4gICAgICB0TWF0ID0geGYyLlI7XG4gICAgICB0VmVjID0gcG9seTIubV9jZW50cm9pZDtcbiAgICAgIHZhciBkWCA9IHhmMi5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xuICAgICAgdmFyIGRZID0geGYyLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XG4gICAgICB0TWF0ID0geGYxLlI7XG4gICAgICB0VmVjID0gcG9seTEubV9jZW50cm9pZDtcbiAgICAgIGRYIC09IHhmMS5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xuICAgICAgZFkgLT0geGYxLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XG4gICAgICB2YXIgZExvY2FsMVggPSAoZFggKiB4ZjEuUi5jb2wxLnggKyBkWSAqIHhmMS5SLmNvbDEueSk7XG4gICAgICB2YXIgZExvY2FsMVkgPSAoZFggKiB4ZjEuUi5jb2wyLnggKyBkWSAqIHhmMS5SLmNvbDIueSk7XG4gICAgICB2YXIgZWRnZSA9IDA7XG4gICAgICB2YXIgbWF4RG90ID0gKC1OdW1iZXIuTUFYX1ZBTFVFKTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnQxOyArK2kpIHtcbiAgICAgICAgIHRWZWMgPSBub3JtYWxzMVtpXTtcbiAgICAgICAgIHZhciBkb3QgPSAodFZlYy54ICogZExvY2FsMVggKyB0VmVjLnkgKiBkTG9jYWwxWSk7XG4gICAgICAgICBpZiAoZG90ID4gbWF4RG90KSB7XG4gICAgICAgICAgICBtYXhEb3QgPSBkb3Q7XG4gICAgICAgICAgICBlZGdlID0gaTtcbiAgICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHZhciBzID0gYjJDb2xsaXNpb24uRWRnZVNlcGFyYXRpb24ocG9seTEsIHhmMSwgZWRnZSwgcG9seTIsIHhmMik7XG4gICAgICB2YXIgcHJldkVkZ2UgPSBwYXJzZUludChlZGdlIC0gMSA+PSAwID8gZWRnZSAtIDEgOiBjb3VudDEgLSAxKTtcbiAgICAgIHZhciBzUHJldiA9IGIyQ29sbGlzaW9uLkVkZ2VTZXBhcmF0aW9uKHBvbHkxLCB4ZjEsIHByZXZFZGdlLCBwb2x5MiwgeGYyKTtcbiAgICAgIHZhciBuZXh0RWRnZSA9IHBhcnNlSW50KGVkZ2UgKyAxIDwgY291bnQxID8gZWRnZSArIDEgOiAwKTtcbiAgICAgIHZhciBzTmV4dCA9IGIyQ29sbGlzaW9uLkVkZ2VTZXBhcmF0aW9uKHBvbHkxLCB4ZjEsIG5leHRFZGdlLCBwb2x5MiwgeGYyKTtcbiAgICAgIHZhciBiZXN0RWRnZSA9IDA7XG4gICAgICB2YXIgYmVzdFNlcGFyYXRpb24gPSAwO1xuICAgICAgdmFyIGluY3JlbWVudCA9IDA7XG4gICAgICBpZiAoc1ByZXYgPiBzICYmIHNQcmV2ID4gc05leHQpIHtcbiAgICAgICAgIGluY3JlbWVudCA9ICgtMSk7XG4gICAgICAgICBiZXN0RWRnZSA9IHByZXZFZGdlO1xuICAgICAgICAgYmVzdFNlcGFyYXRpb24gPSBzUHJldjtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKHNOZXh0ID4gcykge1xuICAgICAgICAgaW5jcmVtZW50ID0gMTtcbiAgICAgICAgIGJlc3RFZGdlID0gbmV4dEVkZ2U7XG4gICAgICAgICBiZXN0U2VwYXJhdGlvbiA9IHNOZXh0O1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgICBlZGdlSW5kZXhbMF0gPSBlZGdlO1xuICAgICAgICAgcmV0dXJuIHM7XG4gICAgICB9XG4gICAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICAgaWYgKGluY3JlbWVudCA9PSAoLTEpKSBlZGdlID0gYmVzdEVkZ2UgLSAxID49IDAgPyBiZXN0RWRnZSAtIDEgOiBjb3VudDEgLSAxO1xuICAgICAgICAgZWxzZSBlZGdlID0gYmVzdEVkZ2UgKyAxIDwgY291bnQxID8gYmVzdEVkZ2UgKyAxIDogMDtzID0gYjJDb2xsaXNpb24uRWRnZVNlcGFyYXRpb24ocG9seTEsIHhmMSwgZWRnZSwgcG9seTIsIHhmMik7XG4gICAgICAgICBpZiAocyA+IGJlc3RTZXBhcmF0aW9uKSB7XG4gICAgICAgICAgICBiZXN0RWRnZSA9IGVkZ2U7XG4gICAgICAgICAgICBiZXN0U2VwYXJhdGlvbiA9IHM7XG4gICAgICAgICB9XG4gICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgfVxuICAgICAgfVxuICAgICAgZWRnZUluZGV4WzBdID0gYmVzdEVkZ2U7XG4gICAgICByZXR1cm4gYmVzdFNlcGFyYXRpb247XG4gICB9XG4gICBiMkNvbGxpc2lvbi5GaW5kSW5jaWRlbnRFZGdlID0gZnVuY3Rpb24gKGMsIHBvbHkxLCB4ZjEsIGVkZ2UxLCBwb2x5MiwgeGYyKSB7XG4gICAgICBpZiAoZWRnZTEgPT09IHVuZGVmaW5lZCkgZWRnZTEgPSAwO1xuICAgICAgdmFyIGNvdW50MSA9IHBhcnNlSW50KHBvbHkxLm1fdmVydGV4Q291bnQpO1xuICAgICAgdmFyIG5vcm1hbHMxID0gcG9seTEubV9ub3JtYWxzO1xuICAgICAgdmFyIGNvdW50MiA9IHBhcnNlSW50KHBvbHkyLm1fdmVydGV4Q291bnQpO1xuICAgICAgdmFyIHZlcnRpY2VzMiA9IHBvbHkyLm1fdmVydGljZXM7XG4gICAgICB2YXIgbm9ybWFsczIgPSBwb2x5Mi5tX25vcm1hbHM7XG4gICAgICB2YXIgdE1hdDtcbiAgICAgIHZhciB0VmVjO1xuICAgICAgdE1hdCA9IHhmMS5SO1xuICAgICAgdFZlYyA9IG5vcm1hbHMxW2VkZ2UxXTtcbiAgICAgIHZhciBub3JtYWwxWCA9ICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcbiAgICAgIHZhciBub3JtYWwxWSA9ICh0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55KTtcbiAgICAgIHRNYXQgPSB4ZjIuUjtcbiAgICAgIHZhciB0WCA9ICh0TWF0LmNvbDEueCAqIG5vcm1hbDFYICsgdE1hdC5jb2wxLnkgKiBub3JtYWwxWSk7XG4gICAgICBub3JtYWwxWSA9ICh0TWF0LmNvbDIueCAqIG5vcm1hbDFYICsgdE1hdC5jb2wyLnkgKiBub3JtYWwxWSk7XG4gICAgICBub3JtYWwxWCA9IHRYO1xuICAgICAgdmFyIGluZGV4ID0gMDtcbiAgICAgIHZhciBtaW5Eb3QgPSBOdW1iZXIuTUFYX1ZBTFVFO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb3VudDI7ICsraSkge1xuICAgICAgICAgdFZlYyA9IG5vcm1hbHMyW2ldO1xuICAgICAgICAgdmFyIGRvdCA9IChub3JtYWwxWCAqIHRWZWMueCArIG5vcm1hbDFZICogdFZlYy55KTtcbiAgICAgICAgIGlmIChkb3QgPCBtaW5Eb3QpIHtcbiAgICAgICAgICAgIG1pbkRvdCA9IGRvdDtcbiAgICAgICAgICAgIGluZGV4ID0gaTtcbiAgICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHZhciB0Q2xpcDtcbiAgICAgIHZhciBpMSA9IHBhcnNlSW50KGluZGV4KTtcbiAgICAgIHZhciBpMiA9IHBhcnNlSW50KGkxICsgMSA8IGNvdW50MiA/IGkxICsgMSA6IDApO1xuICAgICAgdENsaXAgPSBjWzBdO1xuICAgICAgdFZlYyA9IHZlcnRpY2VzMltpMV07XG4gICAgICB0TWF0ID0geGYyLlI7XG4gICAgICB0Q2xpcC52LnggPSB4ZjIucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcbiAgICAgIHRDbGlwLnYueSA9IHhmMi5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xuICAgICAgdENsaXAuaWQuZmVhdHVyZXMucmVmZXJlbmNlRWRnZSA9IGVkZ2UxO1xuICAgICAgdENsaXAuaWQuZmVhdHVyZXMuaW5jaWRlbnRFZGdlID0gaTE7XG4gICAgICB0Q2xpcC5pZC5mZWF0dXJlcy5pbmNpZGVudFZlcnRleCA9IDA7XG4gICAgICB0Q2xpcCA9IGNbMV07XG4gICAgICB0VmVjID0gdmVydGljZXMyW2kyXTtcbiAgICAgIHRNYXQgPSB4ZjIuUjtcbiAgICAgIHRDbGlwLnYueCA9IHhmMi5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xuICAgICAgdENsaXAudi55ID0geGYyLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XG4gICAgICB0Q2xpcC5pZC5mZWF0dXJlcy5yZWZlcmVuY2VFZGdlID0gZWRnZTE7XG4gICAgICB0Q2xpcC5pZC5mZWF0dXJlcy5pbmNpZGVudEVkZ2UgPSBpMjtcbiAgICAgIHRDbGlwLmlkLmZlYXR1cmVzLmluY2lkZW50VmVydGV4ID0gMTtcbiAgIH1cbiAgIGIyQ29sbGlzaW9uLk1ha2VDbGlwUG9pbnRWZWN0b3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgciA9IG5ldyBWZWN0b3IoMik7XG4gICAgICByWzBdID0gbmV3IENsaXBWZXJ0ZXgoKTtcbiAgICAgIHJbMV0gPSBuZXcgQ2xpcFZlcnRleCgpO1xuICAgICAgcmV0dXJuIHI7XG4gICB9XG4gICBiMkNvbGxpc2lvbi5Db2xsaWRlUG9seWdvbnMgPSBmdW5jdGlvbiAobWFuaWZvbGQsIHBvbHlBLCB4ZkEsIHBvbHlCLCB4ZkIpIHtcbiAgICAgIHZhciBjdjtcbiAgICAgIG1hbmlmb2xkLm1fcG9pbnRDb3VudCA9IDA7XG4gICAgICB2YXIgdG90YWxSYWRpdXMgPSBwb2x5QS5tX3JhZGl1cyArIHBvbHlCLm1fcmFkaXVzO1xuICAgICAgdmFyIGVkZ2VBID0gMDtcbiAgICAgIGIyQ29sbGlzaW9uLnNfZWRnZUFPWzBdID0gZWRnZUE7XG4gICAgICB2YXIgc2VwYXJhdGlvbkEgPSBiMkNvbGxpc2lvbi5GaW5kTWF4U2VwYXJhdGlvbihiMkNvbGxpc2lvbi5zX2VkZ2VBTywgcG9seUEsIHhmQSwgcG9seUIsIHhmQik7XG4gICAgICBlZGdlQSA9IGIyQ29sbGlzaW9uLnNfZWRnZUFPWzBdO1xuICAgICAgaWYgKHNlcGFyYXRpb25BID4gdG90YWxSYWRpdXMpIHJldHVybjtcbiAgICAgIHZhciBlZGdlQiA9IDA7XG4gICAgICBiMkNvbGxpc2lvbi5zX2VkZ2VCT1swXSA9IGVkZ2VCO1xuICAgICAgdmFyIHNlcGFyYXRpb25CID0gYjJDb2xsaXNpb24uRmluZE1heFNlcGFyYXRpb24oYjJDb2xsaXNpb24uc19lZGdlQk8sIHBvbHlCLCB4ZkIsIHBvbHlBLCB4ZkEpO1xuICAgICAgZWRnZUIgPSBiMkNvbGxpc2lvbi5zX2VkZ2VCT1swXTtcbiAgICAgIGlmIChzZXBhcmF0aW9uQiA+IHRvdGFsUmFkaXVzKSByZXR1cm47XG4gICAgICB2YXIgcG9seTE7XG4gICAgICB2YXIgcG9seTI7XG4gICAgICB2YXIgeGYxO1xuICAgICAgdmFyIHhmMjtcbiAgICAgIHZhciBlZGdlMSA9IDA7XG4gICAgICB2YXIgZmxpcCA9IDA7XG4gICAgICB2YXIga19yZWxhdGl2ZVRvbCA9IDAuOTg7XG4gICAgICB2YXIga19hYnNvbHV0ZVRvbCA9IDAuMDAxO1xuICAgICAgdmFyIHRNYXQ7XG4gICAgICBpZiAoc2VwYXJhdGlvbkIgPiBrX3JlbGF0aXZlVG9sICogc2VwYXJhdGlvbkEgKyBrX2Fic29sdXRlVG9sKSB7XG4gICAgICAgICBwb2x5MSA9IHBvbHlCO1xuICAgICAgICAgcG9seTIgPSBwb2x5QTtcbiAgICAgICAgIHhmMSA9IHhmQjtcbiAgICAgICAgIHhmMiA9IHhmQTtcbiAgICAgICAgIGVkZ2UxID0gZWRnZUI7XG4gICAgICAgICBtYW5pZm9sZC5tX3R5cGUgPSBiMk1hbmlmb2xkLmVfZmFjZUI7XG4gICAgICAgICBmbGlwID0gMTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICAgcG9seTEgPSBwb2x5QTtcbiAgICAgICAgIHBvbHkyID0gcG9seUI7XG4gICAgICAgICB4ZjEgPSB4ZkE7XG4gICAgICAgICB4ZjIgPSB4ZkI7XG4gICAgICAgICBlZGdlMSA9IGVkZ2VBO1xuICAgICAgICAgbWFuaWZvbGQubV90eXBlID0gYjJNYW5pZm9sZC5lX2ZhY2VBO1xuICAgICAgICAgZmxpcCA9IDA7XG4gICAgICB9XG4gICAgICB2YXIgaW5jaWRlbnRFZGdlID0gYjJDb2xsaXNpb24uc19pbmNpZGVudEVkZ2U7XG4gICAgICBiMkNvbGxpc2lvbi5GaW5kSW5jaWRlbnRFZGdlKGluY2lkZW50RWRnZSwgcG9seTEsIHhmMSwgZWRnZTEsIHBvbHkyLCB4ZjIpO1xuICAgICAgdmFyIGNvdW50MSA9IHBhcnNlSW50KHBvbHkxLm1fdmVydGV4Q291bnQpO1xuICAgICAgdmFyIHZlcnRpY2VzMSA9IHBvbHkxLm1fdmVydGljZXM7XG4gICAgICB2YXIgbG9jYWxfdjExID0gdmVydGljZXMxW2VkZ2UxXTtcbiAgICAgIHZhciBsb2NhbF92MTI7XG4gICAgICBpZiAoZWRnZTEgKyAxIDwgY291bnQxKSB7XG4gICAgICAgICBsb2NhbF92MTIgPSB2ZXJ0aWNlczFbcGFyc2VJbnQoZWRnZTEgKyAxKV07XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgIGxvY2FsX3YxMiA9IHZlcnRpY2VzMVswXTtcbiAgICAgIH1cbiAgICAgIHZhciBsb2NhbFRhbmdlbnQgPSBiMkNvbGxpc2lvbi5zX2xvY2FsVGFuZ2VudDtcbiAgICAgIGxvY2FsVGFuZ2VudC5TZXQobG9jYWxfdjEyLnggLSBsb2NhbF92MTEueCwgbG9jYWxfdjEyLnkgLSBsb2NhbF92MTEueSk7XG4gICAgICBsb2NhbFRhbmdlbnQuTm9ybWFsaXplKCk7XG4gICAgICB2YXIgbG9jYWxOb3JtYWwgPSBiMkNvbGxpc2lvbi5zX2xvY2FsTm9ybWFsO1xuICAgICAgbG9jYWxOb3JtYWwueCA9IGxvY2FsVGFuZ2VudC55O1xuICAgICAgbG9jYWxOb3JtYWwueSA9ICgtbG9jYWxUYW5nZW50LngpO1xuICAgICAgdmFyIHBsYW5lUG9pbnQgPSBiMkNvbGxpc2lvbi5zX3BsYW5lUG9pbnQ7XG4gICAgICBwbGFuZVBvaW50LlNldCgwLjUgKiAobG9jYWxfdjExLnggKyBsb2NhbF92MTIueCksIDAuNSAqIChsb2NhbF92MTEueSArIGxvY2FsX3YxMi55KSk7XG4gICAgICB2YXIgdGFuZ2VudCA9IGIyQ29sbGlzaW9uLnNfdGFuZ2VudDtcbiAgICAgIHRNYXQgPSB4ZjEuUjtcbiAgICAgIHRhbmdlbnQueCA9ICh0TWF0LmNvbDEueCAqIGxvY2FsVGFuZ2VudC54ICsgdE1hdC5jb2wyLnggKiBsb2NhbFRhbmdlbnQueSk7XG4gICAgICB0YW5nZW50LnkgPSAodE1hdC5jb2wxLnkgKiBsb2NhbFRhbmdlbnQueCArIHRNYXQuY29sMi55ICogbG9jYWxUYW5nZW50LnkpO1xuICAgICAgdmFyIHRhbmdlbnQyID0gYjJDb2xsaXNpb24uc190YW5nZW50MjtcbiAgICAgIHRhbmdlbnQyLnggPSAoLXRhbmdlbnQueCk7XG4gICAgICB0YW5nZW50Mi55ID0gKC10YW5nZW50LnkpO1xuICAgICAgdmFyIG5vcm1hbCA9IGIyQ29sbGlzaW9uLnNfbm9ybWFsO1xuICAgICAgbm9ybWFsLnggPSB0YW5nZW50Lnk7XG4gICAgICBub3JtYWwueSA9ICgtdGFuZ2VudC54KTtcbiAgICAgIHZhciB2MTEgPSBiMkNvbGxpc2lvbi5zX3YxMTtcbiAgICAgIHZhciB2MTIgPSBiMkNvbGxpc2lvbi5zX3YxMjtcbiAgICAgIHYxMS54ID0geGYxLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiBsb2NhbF92MTEueCArIHRNYXQuY29sMi54ICogbG9jYWxfdjExLnkpO1xuICAgICAgdjExLnkgPSB4ZjEucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIGxvY2FsX3YxMS54ICsgdE1hdC5jb2wyLnkgKiBsb2NhbF92MTEueSk7XG4gICAgICB2MTIueCA9IHhmMS5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogbG9jYWxfdjEyLnggKyB0TWF0LmNvbDIueCAqIGxvY2FsX3YxMi55KTtcbiAgICAgIHYxMi55ID0geGYxLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiBsb2NhbF92MTIueCArIHRNYXQuY29sMi55ICogbG9jYWxfdjEyLnkpO1xuICAgICAgdmFyIGZyb250T2Zmc2V0ID0gbm9ybWFsLnggKiB2MTEueCArIG5vcm1hbC55ICogdjExLnk7XG4gICAgICB2YXIgc2lkZU9mZnNldDEgPSAoLXRhbmdlbnQueCAqIHYxMS54KSAtIHRhbmdlbnQueSAqIHYxMS55ICsgdG90YWxSYWRpdXM7XG4gICAgICB2YXIgc2lkZU9mZnNldDIgPSB0YW5nZW50LnggKiB2MTIueCArIHRhbmdlbnQueSAqIHYxMi55ICsgdG90YWxSYWRpdXM7XG4gICAgICB2YXIgY2xpcFBvaW50czEgPSBiMkNvbGxpc2lvbi5zX2NsaXBQb2ludHMxO1xuICAgICAgdmFyIGNsaXBQb2ludHMyID0gYjJDb2xsaXNpb24uc19jbGlwUG9pbnRzMjtcbiAgICAgIHZhciBucCA9IDA7XG4gICAgICBucCA9IGIyQ29sbGlzaW9uLkNsaXBTZWdtZW50VG9MaW5lKGNsaXBQb2ludHMxLCBpbmNpZGVudEVkZ2UsIHRhbmdlbnQyLCBzaWRlT2Zmc2V0MSk7XG4gICAgICBpZiAobnAgPCAyKSByZXR1cm47XG4gICAgICBucCA9IGIyQ29sbGlzaW9uLkNsaXBTZWdtZW50VG9MaW5lKGNsaXBQb2ludHMyLCBjbGlwUG9pbnRzMSwgdGFuZ2VudCwgc2lkZU9mZnNldDIpO1xuICAgICAgaWYgKG5wIDwgMikgcmV0dXJuO1xuICAgICAgbWFuaWZvbGQubV9sb2NhbFBsYW5lTm9ybWFsLlNldFYobG9jYWxOb3JtYWwpO1xuICAgICAgbWFuaWZvbGQubV9sb2NhbFBvaW50LlNldFYocGxhbmVQb2ludCk7XG4gICAgICB2YXIgcG9pbnRDb3VudCA9IDA7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGIyU2V0dGluZ3MuYjJfbWF4TWFuaWZvbGRQb2ludHM7ICsraSkge1xuICAgICAgICAgY3YgPSBjbGlwUG9pbnRzMltpXTtcbiAgICAgICAgIHZhciBzZXBhcmF0aW9uID0gbm9ybWFsLnggKiBjdi52LnggKyBub3JtYWwueSAqIGN2LnYueSAtIGZyb250T2Zmc2V0O1xuICAgICAgICAgaWYgKHNlcGFyYXRpb24gPD0gdG90YWxSYWRpdXMpIHtcbiAgICAgICAgICAgIHZhciBjcCA9IG1hbmlmb2xkLm1fcG9pbnRzW3BvaW50Q291bnRdO1xuICAgICAgICAgICAgdE1hdCA9IHhmMi5SO1xuICAgICAgICAgICAgdmFyIHRYID0gY3Yudi54IC0geGYyLnBvc2l0aW9uLng7XG4gICAgICAgICAgICB2YXIgdFkgPSBjdi52LnkgLSB4ZjIucG9zaXRpb24ueTtcbiAgICAgICAgICAgIGNwLm1fbG9jYWxQb2ludC54ID0gKHRYICogdE1hdC5jb2wxLnggKyB0WSAqIHRNYXQuY29sMS55KTtcbiAgICAgICAgICAgIGNwLm1fbG9jYWxQb2ludC55ID0gKHRYICogdE1hdC5jb2wyLnggKyB0WSAqIHRNYXQuY29sMi55KTtcbiAgICAgICAgICAgIGNwLm1faWQuU2V0KGN2LmlkKTtcbiAgICAgICAgICAgIGNwLm1faWQuZmVhdHVyZXMuZmxpcCA9IGZsaXA7XG4gICAgICAgICAgICArK3BvaW50Q291bnQ7XG4gICAgICAgICB9XG4gICAgICB9XG4gICAgICBtYW5pZm9sZC5tX3BvaW50Q291bnQgPSBwb2ludENvdW50O1xuICAgfVxuICAgYjJDb2xsaXNpb24uQ29sbGlkZUNpcmNsZXMgPSBmdW5jdGlvbiAobWFuaWZvbGQsIGNpcmNsZTEsIHhmMSwgY2lyY2xlMiwgeGYyKSB7XG4gICAgICBtYW5pZm9sZC5tX3BvaW50Q291bnQgPSAwO1xuICAgICAgdmFyIHRNYXQ7XG4gICAgICB2YXIgdFZlYztcbiAgICAgIHRNYXQgPSB4ZjEuUjtcbiAgICAgIHRWZWMgPSBjaXJjbGUxLm1fcDtcbiAgICAgIHZhciBwMVggPSB4ZjEucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcbiAgICAgIHZhciBwMVkgPSB4ZjEucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55KTtcbiAgICAgIHRNYXQgPSB4ZjIuUjtcbiAgICAgIHRWZWMgPSBjaXJjbGUyLm1fcDtcbiAgICAgIHZhciBwMlggPSB4ZjIucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcbiAgICAgIHZhciBwMlkgPSB4ZjIucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55KTtcbiAgICAgIHZhciBkWCA9IHAyWCAtIHAxWDtcbiAgICAgIHZhciBkWSA9IHAyWSAtIHAxWTtcbiAgICAgIHZhciBkaXN0U3FyID0gZFggKiBkWCArIGRZICogZFk7XG4gICAgICB2YXIgcmFkaXVzID0gY2lyY2xlMS5tX3JhZGl1cyArIGNpcmNsZTIubV9yYWRpdXM7XG4gICAgICBpZiAoZGlzdFNxciA+IHJhZGl1cyAqIHJhZGl1cykge1xuICAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgbWFuaWZvbGQubV90eXBlID0gYjJNYW5pZm9sZC5lX2NpcmNsZXM7XG4gICAgICBtYW5pZm9sZC5tX2xvY2FsUG9pbnQuU2V0VihjaXJjbGUxLm1fcCk7XG4gICAgICBtYW5pZm9sZC5tX2xvY2FsUGxhbmVOb3JtYWwuU2V0WmVybygpO1xuICAgICAgbWFuaWZvbGQubV9wb2ludENvdW50ID0gMTtcbiAgICAgIG1hbmlmb2xkLm1fcG9pbnRzWzBdLm1fbG9jYWxQb2ludC5TZXRWKGNpcmNsZTIubV9wKTtcbiAgICAgIG1hbmlmb2xkLm1fcG9pbnRzWzBdLm1faWQua2V5ID0gMDtcbiAgIH1cbiAgIGIyQ29sbGlzaW9uLkNvbGxpZGVQb2x5Z29uQW5kQ2lyY2xlID0gZnVuY3Rpb24gKG1hbmlmb2xkLCBwb2x5Z29uLCB4ZjEsIGNpcmNsZSwgeGYyKSB7XG4gICAgICBtYW5pZm9sZC5tX3BvaW50Q291bnQgPSAwO1xuICAgICAgdmFyIHRQb2ludDtcbiAgICAgIHZhciBkWCA9IDA7XG4gICAgICB2YXIgZFkgPSAwO1xuICAgICAgdmFyIHBvc2l0aW9uWCA9IDA7XG4gICAgICB2YXIgcG9zaXRpb25ZID0gMDtcbiAgICAgIHZhciB0VmVjO1xuICAgICAgdmFyIHRNYXQ7XG4gICAgICB0TWF0ID0geGYyLlI7XG4gICAgICB0VmVjID0gY2lyY2xlLm1fcDtcbiAgICAgIHZhciBjWCA9IHhmMi5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xuICAgICAgdmFyIGNZID0geGYyLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XG4gICAgICBkWCA9IGNYIC0geGYxLnBvc2l0aW9uLng7XG4gICAgICBkWSA9IGNZIC0geGYxLnBvc2l0aW9uLnk7XG4gICAgICB0TWF0ID0geGYxLlI7XG4gICAgICB2YXIgY0xvY2FsWCA9IChkWCAqIHRNYXQuY29sMS54ICsgZFkgKiB0TWF0LmNvbDEueSk7XG4gICAgICB2YXIgY0xvY2FsWSA9IChkWCAqIHRNYXQuY29sMi54ICsgZFkgKiB0TWF0LmNvbDIueSk7XG4gICAgICB2YXIgZGlzdCA9IDA7XG4gICAgICB2YXIgbm9ybWFsSW5kZXggPSAwO1xuICAgICAgdmFyIHNlcGFyYXRpb24gPSAoLU51bWJlci5NQVhfVkFMVUUpO1xuICAgICAgdmFyIHJhZGl1cyA9IHBvbHlnb24ubV9yYWRpdXMgKyBjaXJjbGUubV9yYWRpdXM7XG4gICAgICB2YXIgdmVydGV4Q291bnQgPSBwYXJzZUludChwb2x5Z29uLm1fdmVydGV4Q291bnQpO1xuICAgICAgdmFyIHZlcnRpY2VzID0gcG9seWdvbi5tX3ZlcnRpY2VzO1xuICAgICAgdmFyIG5vcm1hbHMgPSBwb2x5Z29uLm1fbm9ybWFscztcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmVydGV4Q291bnQ7ICsraSkge1xuICAgICAgICAgdFZlYyA9IHZlcnRpY2VzW2ldO1xuICAgICAgICAgZFggPSBjTG9jYWxYIC0gdFZlYy54O1xuICAgICAgICAgZFkgPSBjTG9jYWxZIC0gdFZlYy55O1xuICAgICAgICAgdFZlYyA9IG5vcm1hbHNbaV07XG4gICAgICAgICB2YXIgcyA9IHRWZWMueCAqIGRYICsgdFZlYy55ICogZFk7XG4gICAgICAgICBpZiAocyA+IHJhZGl1cykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgfVxuICAgICAgICAgaWYgKHMgPiBzZXBhcmF0aW9uKSB7XG4gICAgICAgICAgICBzZXBhcmF0aW9uID0gcztcbiAgICAgICAgICAgIG5vcm1hbEluZGV4ID0gaTtcbiAgICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHZhciB2ZXJ0SW5kZXgxID0gcGFyc2VJbnQobm9ybWFsSW5kZXgpO1xuICAgICAgdmFyIHZlcnRJbmRleDIgPSBwYXJzZUludCh2ZXJ0SW5kZXgxICsgMSA8IHZlcnRleENvdW50ID8gdmVydEluZGV4MSArIDEgOiAwKTtcbiAgICAgIHZhciB2MSA9IHZlcnRpY2VzW3ZlcnRJbmRleDFdO1xuICAgICAgdmFyIHYyID0gdmVydGljZXNbdmVydEluZGV4Ml07XG4gICAgICBpZiAoc2VwYXJhdGlvbiA8IE51bWJlci5NSU5fVkFMVUUpIHtcbiAgICAgICAgIG1hbmlmb2xkLm1fcG9pbnRDb3VudCA9IDE7XG4gICAgICAgICBtYW5pZm9sZC5tX3R5cGUgPSBiMk1hbmlmb2xkLmVfZmFjZUE7XG4gICAgICAgICBtYW5pZm9sZC5tX2xvY2FsUGxhbmVOb3JtYWwuU2V0Vihub3JtYWxzW25vcm1hbEluZGV4XSk7XG4gICAgICAgICBtYW5pZm9sZC5tX2xvY2FsUG9pbnQueCA9IDAuNSAqICh2MS54ICsgdjIueCk7XG4gICAgICAgICBtYW5pZm9sZC5tX2xvY2FsUG9pbnQueSA9IDAuNSAqICh2MS55ICsgdjIueSk7XG4gICAgICAgICBtYW5pZm9sZC5tX3BvaW50c1swXS5tX2xvY2FsUG9pbnQuU2V0VihjaXJjbGUubV9wKTtcbiAgICAgICAgIG1hbmlmb2xkLm1fcG9pbnRzWzBdLm1faWQua2V5ID0gMDtcbiAgICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhciB1MSA9IChjTG9jYWxYIC0gdjEueCkgKiAodjIueCAtIHYxLngpICsgKGNMb2NhbFkgLSB2MS55KSAqICh2Mi55IC0gdjEueSk7XG4gICAgICB2YXIgdTIgPSAoY0xvY2FsWCAtIHYyLngpICogKHYxLnggLSB2Mi54KSArIChjTG9jYWxZIC0gdjIueSkgKiAodjEueSAtIHYyLnkpO1xuICAgICAgaWYgKHUxIDw9IDAuMCkge1xuICAgICAgICAgaWYgKChjTG9jYWxYIC0gdjEueCkgKiAoY0xvY2FsWCAtIHYxLngpICsgKGNMb2NhbFkgLSB2MS55KSAqIChjTG9jYWxZIC0gdjEueSkgPiByYWRpdXMgKiByYWRpdXMpIHJldHVybjtcbiAgICAgICAgIG1hbmlmb2xkLm1fcG9pbnRDb3VudCA9IDE7XG4gICAgICAgICBtYW5pZm9sZC5tX3R5cGUgPSBiMk1hbmlmb2xkLmVfZmFjZUE7XG4gICAgICAgICBtYW5pZm9sZC5tX2xvY2FsUGxhbmVOb3JtYWwueCA9IGNMb2NhbFggLSB2MS54O1xuICAgICAgICAgbWFuaWZvbGQubV9sb2NhbFBsYW5lTm9ybWFsLnkgPSBjTG9jYWxZIC0gdjEueTtcbiAgICAgICAgIG1hbmlmb2xkLm1fbG9jYWxQbGFuZU5vcm1hbC5Ob3JtYWxpemUoKTtcbiAgICAgICAgIG1hbmlmb2xkLm1fbG9jYWxQb2ludC5TZXRWKHYxKTtcbiAgICAgICAgIG1hbmlmb2xkLm1fcG9pbnRzWzBdLm1fbG9jYWxQb2ludC5TZXRWKGNpcmNsZS5tX3ApO1xuICAgICAgICAgbWFuaWZvbGQubV9wb2ludHNbMF0ubV9pZC5rZXkgPSAwO1xuICAgICAgfVxuICAgICAgZWxzZSBpZiAodTIgPD0gMCkge1xuICAgICAgICAgaWYgKChjTG9jYWxYIC0gdjIueCkgKiAoY0xvY2FsWCAtIHYyLngpICsgKGNMb2NhbFkgLSB2Mi55KSAqIChjTG9jYWxZIC0gdjIueSkgPiByYWRpdXMgKiByYWRpdXMpIHJldHVybjtcbiAgICAgICAgIG1hbmlmb2xkLm1fcG9pbnRDb3VudCA9IDE7XG4gICAgICAgICBtYW5pZm9sZC5tX3R5cGUgPSBiMk1hbmlmb2xkLmVfZmFjZUE7XG4gICAgICAgICBtYW5pZm9sZC5tX2xvY2FsUGxhbmVOb3JtYWwueCA9IGNMb2NhbFggLSB2Mi54O1xuICAgICAgICAgbWFuaWZvbGQubV9sb2NhbFBsYW5lTm9ybWFsLnkgPSBjTG9jYWxZIC0gdjIueTtcbiAgICAgICAgIG1hbmlmb2xkLm1fbG9jYWxQbGFuZU5vcm1hbC5Ob3JtYWxpemUoKTtcbiAgICAgICAgIG1hbmlmb2xkLm1fbG9jYWxQb2ludC5TZXRWKHYyKTtcbiAgICAgICAgIG1hbmlmb2xkLm1fcG9pbnRzWzBdLm1fbG9jYWxQb2ludC5TZXRWKGNpcmNsZS5tX3ApO1xuICAgICAgICAgbWFuaWZvbGQubV9wb2ludHNbMF0ubV9pZC5rZXkgPSAwO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgICB2YXIgZmFjZUNlbnRlclggPSAwLjUgKiAodjEueCArIHYyLngpO1xuICAgICAgICAgdmFyIGZhY2VDZW50ZXJZID0gMC41ICogKHYxLnkgKyB2Mi55KTtcbiAgICAgICAgIHNlcGFyYXRpb24gPSAoY0xvY2FsWCAtIGZhY2VDZW50ZXJYKSAqIG5vcm1hbHNbdmVydEluZGV4MV0ueCArIChjTG9jYWxZIC0gZmFjZUNlbnRlclkpICogbm9ybWFsc1t2ZXJ0SW5kZXgxXS55O1xuICAgICAgICAgaWYgKHNlcGFyYXRpb24gPiByYWRpdXMpIHJldHVybjtcbiAgICAgICAgIG1hbmlmb2xkLm1fcG9pbnRDb3VudCA9IDE7XG4gICAgICAgICBtYW5pZm9sZC5tX3R5cGUgPSBiMk1hbmlmb2xkLmVfZmFjZUE7XG4gICAgICAgICBtYW5pZm9sZC5tX2xvY2FsUGxhbmVOb3JtYWwueCA9IG5vcm1hbHNbdmVydEluZGV4MV0ueDtcbiAgICAgICAgIG1hbmlmb2xkLm1fbG9jYWxQbGFuZU5vcm1hbC55ID0gbm9ybWFsc1t2ZXJ0SW5kZXgxXS55O1xuICAgICAgICAgbWFuaWZvbGQubV9sb2NhbFBsYW5lTm9ybWFsLk5vcm1hbGl6ZSgpO1xuICAgICAgICAgbWFuaWZvbGQubV9sb2NhbFBvaW50LlNldChmYWNlQ2VudGVyWCwgZmFjZUNlbnRlclkpO1xuICAgICAgICAgbWFuaWZvbGQubV9wb2ludHNbMF0ubV9sb2NhbFBvaW50LlNldFYoY2lyY2xlLm1fcCk7XG4gICAgICAgICBtYW5pZm9sZC5tX3BvaW50c1swXS5tX2lkLmtleSA9IDA7XG4gICAgICB9XG4gICB9XG4gICBiMkNvbGxpc2lvbi5UZXN0T3ZlcmxhcCA9IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICB2YXIgdDEgPSBiLmxvd2VyQm91bmQ7XG4gICAgICB2YXIgdDIgPSBhLnVwcGVyQm91bmQ7XG4gICAgICB2YXIgZDFYID0gdDEueCAtIHQyLng7XG4gICAgICB2YXIgZDFZID0gdDEueSAtIHQyLnk7XG4gICAgICB0MSA9IGEubG93ZXJCb3VuZDtcbiAgICAgIHQyID0gYi51cHBlckJvdW5kO1xuICAgICAgdmFyIGQyWCA9IHQxLnggLSB0Mi54O1xuICAgICAgdmFyIGQyWSA9IHQxLnkgLSB0Mi55O1xuICAgICAgaWYgKGQxWCA+IDAuMCB8fCBkMVkgPiAwLjApIHJldHVybiBmYWxzZTtcbiAgICAgIGlmIChkMlggPiAwLjAgfHwgZDJZID4gMC4wKSByZXR1cm4gZmFsc2U7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgIH1cbiAgIEJveDJELnBvc3REZWZzLnB1c2goZnVuY3Rpb24gKCkge1xuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyQ29sbGlzaW9uLnNfaW5jaWRlbnRFZGdlID0gYjJDb2xsaXNpb24uTWFrZUNsaXBQb2ludFZlY3RvcigpO1xuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyQ29sbGlzaW9uLnNfY2xpcFBvaW50czEgPSBiMkNvbGxpc2lvbi5NYWtlQ2xpcFBvaW50VmVjdG9yKCk7XG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJDb2xsaXNpb24uc19jbGlwUG9pbnRzMiA9IGIyQ29sbGlzaW9uLk1ha2VDbGlwUG9pbnRWZWN0b3IoKTtcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMkNvbGxpc2lvbi5zX2VkZ2VBTyA9IG5ldyBWZWN0b3JfYTJqX051bWJlcigxKTtcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMkNvbGxpc2lvbi5zX2VkZ2VCTyA9IG5ldyBWZWN0b3JfYTJqX051bWJlcigxKTtcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMkNvbGxpc2lvbi5zX2xvY2FsVGFuZ2VudCA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMkNvbGxpc2lvbi5zX2xvY2FsTm9ybWFsID0gbmV3IGIyVmVjMigpO1xuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyQ29sbGlzaW9uLnNfcGxhbmVQb2ludCA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMkNvbGxpc2lvbi5zX25vcm1hbCA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMkNvbGxpc2lvbi5zX3RhbmdlbnQgPSBuZXcgYjJWZWMyKCk7XG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJDb2xsaXNpb24uc190YW5nZW50MiA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMkNvbGxpc2lvbi5zX3YxMSA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMkNvbGxpc2lvbi5zX3YxMiA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMkNvbGxpc2lvbi5iMkNvbGxpZGVQb2x5VGVtcFZlYyA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMkNvbGxpc2lvbi5iMl9udWxsRmVhdHVyZSA9IDB4MDAwMDAwZmY7XG4gICB9KTtcbiAgIGIyQ29udGFjdElELmIyQ29udGFjdElEID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5mZWF0dXJlcyA9IG5ldyBGZWF0dXJlcygpO1xuICAgfTtcbiAgIGIyQ29udGFjdElELnByb3RvdHlwZS5iMkNvbnRhY3RJRCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuZmVhdHVyZXMuX21faWQgPSB0aGlzO1xuICAgfVxuICAgYjJDb250YWN0SUQucHJvdG90eXBlLlNldCA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgdGhpcy5rZXkgPSBpZC5fa2V5O1xuICAgfVxuICAgYjJDb250YWN0SUQucHJvdG90eXBlLkNvcHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgaWQgPSBuZXcgYjJDb250YWN0SUQoKTtcbiAgICAgIGlkLmtleSA9IHRoaXMua2V5O1xuICAgICAgcmV0dXJuIGlkO1xuICAgfVxuICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGIyQ29udGFjdElELnByb3RvdHlwZSwgJ2tleScsIHtcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICByZXR1cm4gdGhpcy5fa2V5O1xuICAgICAgfVxuICAgfSk7XG4gICBPYmplY3QuZGVmaW5lUHJvcGVydHkoYjJDb250YWN0SUQucHJvdG90eXBlLCAna2V5Jywge1xuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHZhbHVlID0gMDtcbiAgICAgICAgIHRoaXMuX2tleSA9IHZhbHVlO1xuICAgICAgICAgdGhpcy5mZWF0dXJlcy5fcmVmZXJlbmNlRWRnZSA9IHRoaXMuX2tleSAmIDB4MDAwMDAwZmY7XG4gICAgICAgICB0aGlzLmZlYXR1cmVzLl9pbmNpZGVudEVkZ2UgPSAoKHRoaXMuX2tleSAmIDB4MDAwMGZmMDApID4+IDgpICYgMHgwMDAwMDBmZjtcbiAgICAgICAgIHRoaXMuZmVhdHVyZXMuX2luY2lkZW50VmVydGV4ID0gKCh0aGlzLl9rZXkgJiAweDAwZmYwMDAwKSA+PiAxNikgJiAweDAwMDAwMGZmO1xuICAgICAgICAgdGhpcy5mZWF0dXJlcy5fZmxpcCA9ICgodGhpcy5fa2V5ICYgMHhmZjAwMDAwMCkgPj4gMjQpICYgMHgwMDAwMDBmZjtcbiAgICAgIH1cbiAgIH0pO1xuICAgYjJDb250YWN0UG9pbnQuYjJDb250YWN0UG9pbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLnBvc2l0aW9uID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy52ZWxvY2l0eSA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIHRoaXMubm9ybWFsID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy5pZCA9IG5ldyBiMkNvbnRhY3RJRCgpO1xuICAgfTtcbiAgIGIyRGlzdGFuY2UuYjJEaXN0YW5jZSA9IGZ1bmN0aW9uICgpIHt9O1xuICAgYjJEaXN0YW5jZS5EaXN0YW5jZSA9IGZ1bmN0aW9uIChvdXRwdXQsIGNhY2hlLCBpbnB1dCkge1xuICAgICAgKytiMkRpc3RhbmNlLmIyX2dqa0NhbGxzO1xuICAgICAgdmFyIHByb3h5QSA9IGlucHV0LnByb3h5QTtcbiAgICAgIHZhciBwcm94eUIgPSBpbnB1dC5wcm94eUI7XG4gICAgICB2YXIgdHJhbnNmb3JtQSA9IGlucHV0LnRyYW5zZm9ybUE7XG4gICAgICB2YXIgdHJhbnNmb3JtQiA9IGlucHV0LnRyYW5zZm9ybUI7XG4gICAgICB2YXIgc2ltcGxleCA9IGIyRGlzdGFuY2Uuc19zaW1wbGV4O1xuICAgICAgc2ltcGxleC5SZWFkQ2FjaGUoY2FjaGUsIHByb3h5QSwgdHJhbnNmb3JtQSwgcHJveHlCLCB0cmFuc2Zvcm1CKTtcbiAgICAgIHZhciB2ZXJ0aWNlcyA9IHNpbXBsZXgubV92ZXJ0aWNlcztcbiAgICAgIHZhciBrX21heEl0ZXJzID0gMjA7XG4gICAgICB2YXIgc2F2ZUEgPSBiMkRpc3RhbmNlLnNfc2F2ZUE7XG4gICAgICB2YXIgc2F2ZUIgPSBiMkRpc3RhbmNlLnNfc2F2ZUI7XG4gICAgICB2YXIgc2F2ZUNvdW50ID0gMDtcbiAgICAgIHZhciBjbG9zZXN0UG9pbnQgPSBzaW1wbGV4LkdldENsb3Nlc3RQb2ludCgpO1xuICAgICAgdmFyIGRpc3RhbmNlU3FyMSA9IGNsb3Nlc3RQb2ludC5MZW5ndGhTcXVhcmVkKCk7XG4gICAgICB2YXIgZGlzdGFuY2VTcXIyID0gZGlzdGFuY2VTcXIxO1xuICAgICAgdmFyIGkgPSAwO1xuICAgICAgdmFyIHA7XG4gICAgICB2YXIgaXRlciA9IDA7XG4gICAgICB3aGlsZSAoaXRlciA8IGtfbWF4SXRlcnMpIHtcbiAgICAgICAgIHNhdmVDb3VudCA9IHNpbXBsZXgubV9jb3VudDtcbiAgICAgICAgIGZvciAoaSA9IDA7XG4gICAgICAgICBpIDwgc2F2ZUNvdW50OyBpKyspIHtcbiAgICAgICAgICAgIHNhdmVBW2ldID0gdmVydGljZXNbaV0uaW5kZXhBO1xuICAgICAgICAgICAgc2F2ZUJbaV0gPSB2ZXJ0aWNlc1tpXS5pbmRleEI7XG4gICAgICAgICB9XG4gICAgICAgICBzd2l0Y2ggKHNpbXBsZXgubV9jb3VudCkge1xuICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICBzaW1wbGV4LlNvbHZlMigpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICBzaW1wbGV4LlNvbHZlMygpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydChmYWxzZSk7XG4gICAgICAgICB9XG4gICAgICAgICBpZiAoc2ltcGxleC5tX2NvdW50ID09IDMpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgfVxuICAgICAgICAgcCA9IHNpbXBsZXguR2V0Q2xvc2VzdFBvaW50KCk7XG4gICAgICAgICBkaXN0YW5jZVNxcjIgPSBwLkxlbmd0aFNxdWFyZWQoKTtcbiAgICAgICAgIGlmIChkaXN0YW5jZVNxcjIgPiBkaXN0YW5jZVNxcjEpIHt9XG4gICAgICAgICBkaXN0YW5jZVNxcjEgPSBkaXN0YW5jZVNxcjI7XG4gICAgICAgICB2YXIgZCA9IHNpbXBsZXguR2V0U2VhcmNoRGlyZWN0aW9uKCk7XG4gICAgICAgICBpZiAoZC5MZW5ndGhTcXVhcmVkKCkgPCBOdW1iZXIuTUlOX1ZBTFVFICogTnVtYmVyLk1JTl9WQUxVRSkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICB9XG4gICAgICAgICB2YXIgdmVydGV4ID0gdmVydGljZXNbc2ltcGxleC5tX2NvdW50XTtcbiAgICAgICAgIHZlcnRleC5pbmRleEEgPSBwcm94eUEuR2V0U3VwcG9ydChiMk1hdGguTXVsVE1WKHRyYW5zZm9ybUEuUiwgZC5HZXROZWdhdGl2ZSgpKSk7XG4gICAgICAgICB2ZXJ0ZXgud0EgPSBiMk1hdGguTXVsWCh0cmFuc2Zvcm1BLCBwcm94eUEuR2V0VmVydGV4KHZlcnRleC5pbmRleEEpKTtcbiAgICAgICAgIHZlcnRleC5pbmRleEIgPSBwcm94eUIuR2V0U3VwcG9ydChiMk1hdGguTXVsVE1WKHRyYW5zZm9ybUIuUiwgZCkpO1xuICAgICAgICAgdmVydGV4LndCID0gYjJNYXRoLk11bFgodHJhbnNmb3JtQiwgcHJveHlCLkdldFZlcnRleCh2ZXJ0ZXguaW5kZXhCKSk7XG4gICAgICAgICB2ZXJ0ZXgudyA9IGIyTWF0aC5TdWJ0cmFjdFZWKHZlcnRleC53QiwgdmVydGV4LndBKTtcbiAgICAgICAgICsraXRlcjtcbiAgICAgICAgICsrYjJEaXN0YW5jZS5iMl9namtJdGVycztcbiAgICAgICAgIHZhciBkdXBsaWNhdGUgPSBmYWxzZTtcbiAgICAgICAgIGZvciAoaSA9IDA7XG4gICAgICAgICBpIDwgc2F2ZUNvdW50OyBpKyspIHtcbiAgICAgICAgICAgIGlmICh2ZXJ0ZXguaW5kZXhBID09IHNhdmVBW2ldICYmIHZlcnRleC5pbmRleEIgPT0gc2F2ZUJbaV0pIHtcbiAgICAgICAgICAgICAgIGR1cGxpY2F0ZSA9IHRydWU7XG4gICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgIH1cbiAgICAgICAgIGlmIChkdXBsaWNhdGUpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgfSsrc2ltcGxleC5tX2NvdW50O1xuICAgICAgfVxuICAgICAgYjJEaXN0YW5jZS5iMl9namtNYXhJdGVycyA9IGIyTWF0aC5NYXgoYjJEaXN0YW5jZS5iMl9namtNYXhJdGVycywgaXRlcik7XG4gICAgICBzaW1wbGV4LkdldFdpdG5lc3NQb2ludHMob3V0cHV0LnBvaW50QSwgb3V0cHV0LnBvaW50Qik7XG4gICAgICBvdXRwdXQuZGlzdGFuY2UgPSBiMk1hdGguU3VidHJhY3RWVihvdXRwdXQucG9pbnRBLCBvdXRwdXQucG9pbnRCKS5MZW5ndGgoKTtcbiAgICAgIG91dHB1dC5pdGVyYXRpb25zID0gaXRlcjtcbiAgICAgIHNpbXBsZXguV3JpdGVDYWNoZShjYWNoZSk7XG4gICAgICBpZiAoaW5wdXQudXNlUmFkaWkpIHtcbiAgICAgICAgIHZhciByQSA9IHByb3h5QS5tX3JhZGl1cztcbiAgICAgICAgIHZhciByQiA9IHByb3h5Qi5tX3JhZGl1cztcbiAgICAgICAgIGlmIChvdXRwdXQuZGlzdGFuY2UgPiByQSArIHJCICYmIG91dHB1dC5kaXN0YW5jZSA+IE51bWJlci5NSU5fVkFMVUUpIHtcbiAgICAgICAgICAgIG91dHB1dC5kaXN0YW5jZSAtPSByQSArIHJCO1xuICAgICAgICAgICAgdmFyIG5vcm1hbCA9IGIyTWF0aC5TdWJ0cmFjdFZWKG91dHB1dC5wb2ludEIsIG91dHB1dC5wb2ludEEpO1xuICAgICAgICAgICAgbm9ybWFsLk5vcm1hbGl6ZSgpO1xuICAgICAgICAgICAgb3V0cHV0LnBvaW50QS54ICs9IHJBICogbm9ybWFsLng7XG4gICAgICAgICAgICBvdXRwdXQucG9pbnRBLnkgKz0gckEgKiBub3JtYWwueTtcbiAgICAgICAgICAgIG91dHB1dC5wb2ludEIueCAtPSByQiAqIG5vcm1hbC54O1xuICAgICAgICAgICAgb3V0cHV0LnBvaW50Qi55IC09IHJCICogbm9ybWFsLnk7XG4gICAgICAgICB9XG4gICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHAgPSBuZXcgYjJWZWMyKCk7XG4gICAgICAgICAgICBwLnggPSAuNSAqIChvdXRwdXQucG9pbnRBLnggKyBvdXRwdXQucG9pbnRCLngpO1xuICAgICAgICAgICAgcC55ID0gLjUgKiAob3V0cHV0LnBvaW50QS55ICsgb3V0cHV0LnBvaW50Qi55KTtcbiAgICAgICAgICAgIG91dHB1dC5wb2ludEEueCA9IG91dHB1dC5wb2ludEIueCA9IHAueDtcbiAgICAgICAgICAgIG91dHB1dC5wb2ludEEueSA9IG91dHB1dC5wb2ludEIueSA9IHAueTtcbiAgICAgICAgICAgIG91dHB1dC5kaXN0YW5jZSA9IDAuMDtcbiAgICAgICAgIH1cbiAgICAgIH1cbiAgIH1cbiAgIEJveDJELnBvc3REZWZzLnB1c2goZnVuY3Rpb24gKCkge1xuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyRGlzdGFuY2Uuc19zaW1wbGV4ID0gbmV3IGIyU2ltcGxleCgpO1xuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyRGlzdGFuY2Uuc19zYXZlQSA9IG5ldyBWZWN0b3JfYTJqX051bWJlcigzKTtcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMkRpc3RhbmNlLnNfc2F2ZUIgPSBuZXcgVmVjdG9yX2Eyal9OdW1iZXIoMyk7XG4gICB9KTtcbiAgIGIyRGlzdGFuY2VJbnB1dC5iMkRpc3RhbmNlSW5wdXQgPSBmdW5jdGlvbiAoKSB7fTtcbiAgIGIyRGlzdGFuY2VPdXRwdXQuYjJEaXN0YW5jZU91dHB1dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMucG9pbnRBID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy5wb2ludEIgPSBuZXcgYjJWZWMyKCk7XG4gICB9O1xuICAgYjJEaXN0YW5jZVByb3h5LmIyRGlzdGFuY2VQcm94eSA9IGZ1bmN0aW9uICgpIHt9O1xuICAgYjJEaXN0YW5jZVByb3h5LnByb3RvdHlwZS5TZXQgPSBmdW5jdGlvbiAoc2hhcGUpIHtcbiAgICAgIHN3aXRjaCAoc2hhcGUuR2V0VHlwZSgpKSB7XG4gICAgICBjYXNlIGIyU2hhcGUuZV9jaXJjbGVTaGFwZTpcbiAgICAgICAgIHtcbiAgICAgICAgICAgIHZhciBjaXJjbGUgPSAoc2hhcGUgaW5zdGFuY2VvZiBiMkNpcmNsZVNoYXBlID8gc2hhcGUgOiBudWxsKTtcbiAgICAgICAgICAgIHRoaXMubV92ZXJ0aWNlcyA9IG5ldyBWZWN0b3IoMSwgdHJ1ZSk7XG4gICAgICAgICAgICB0aGlzLm1fdmVydGljZXNbMF0gPSBjaXJjbGUubV9wO1xuICAgICAgICAgICAgdGhpcy5tX2NvdW50ID0gMTtcbiAgICAgICAgICAgIHRoaXMubV9yYWRpdXMgPSBjaXJjbGUubV9yYWRpdXM7XG4gICAgICAgICB9XG4gICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgYjJTaGFwZS5lX3BvbHlnb25TaGFwZTpcbiAgICAgICAgIHtcbiAgICAgICAgICAgIHZhciBwb2x5Z29uID0gKHNoYXBlIGluc3RhbmNlb2YgYjJQb2x5Z29uU2hhcGUgPyBzaGFwZSA6IG51bGwpO1xuICAgICAgICAgICAgdGhpcy5tX3ZlcnRpY2VzID0gcG9seWdvbi5tX3ZlcnRpY2VzO1xuICAgICAgICAgICAgdGhpcy5tX2NvdW50ID0gcG9seWdvbi5tX3ZlcnRleENvdW50O1xuICAgICAgICAgICAgdGhpcy5tX3JhZGl1cyA9IHBvbHlnb24ubV9yYWRpdXM7XG4gICAgICAgICB9XG4gICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgICBiMlNldHRpbmdzLmIyQXNzZXJ0KGZhbHNlKTtcbiAgICAgIH1cbiAgIH1cbiAgIGIyRGlzdGFuY2VQcm94eS5wcm90b3R5cGUuR2V0U3VwcG9ydCA9IGZ1bmN0aW9uIChkKSB7XG4gICAgICB2YXIgYmVzdEluZGV4ID0gMDtcbiAgICAgIHZhciBiZXN0VmFsdWUgPSB0aGlzLm1fdmVydGljZXNbMF0ueCAqIGQueCArIHRoaXMubV92ZXJ0aWNlc1swXS55ICogZC55O1xuICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCB0aGlzLm1fY291bnQ7ICsraSkge1xuICAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5tX3ZlcnRpY2VzW2ldLnggKiBkLnggKyB0aGlzLm1fdmVydGljZXNbaV0ueSAqIGQueTtcbiAgICAgICAgIGlmICh2YWx1ZSA+IGJlc3RWYWx1ZSkge1xuICAgICAgICAgICAgYmVzdEluZGV4ID0gaTtcbiAgICAgICAgICAgIGJlc3RWYWx1ZSA9IHZhbHVlO1xuICAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGJlc3RJbmRleDtcbiAgIH1cbiAgIGIyRGlzdGFuY2VQcm94eS5wcm90b3R5cGUuR2V0U3VwcG9ydFZlcnRleCA9IGZ1bmN0aW9uIChkKSB7XG4gICAgICB2YXIgYmVzdEluZGV4ID0gMDtcbiAgICAgIHZhciBiZXN0VmFsdWUgPSB0aGlzLm1fdmVydGljZXNbMF0ueCAqIGQueCArIHRoaXMubV92ZXJ0aWNlc1swXS55ICogZC55O1xuICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCB0aGlzLm1fY291bnQ7ICsraSkge1xuICAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5tX3ZlcnRpY2VzW2ldLnggKiBkLnggKyB0aGlzLm1fdmVydGljZXNbaV0ueSAqIGQueTtcbiAgICAgICAgIGlmICh2YWx1ZSA+IGJlc3RWYWx1ZSkge1xuICAgICAgICAgICAgYmVzdEluZGV4ID0gaTtcbiAgICAgICAgICAgIGJlc3RWYWx1ZSA9IHZhbHVlO1xuICAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMubV92ZXJ0aWNlc1tiZXN0SW5kZXhdO1xuICAgfVxuICAgYjJEaXN0YW5jZVByb3h5LnByb3RvdHlwZS5HZXRWZXJ0ZXhDb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fY291bnQ7XG4gICB9XG4gICBiMkRpc3RhbmNlUHJveHkucHJvdG90eXBlLkdldFZlcnRleCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgaWYgKGluZGV4ID09PSB1bmRlZmluZWQpIGluZGV4ID0gMDtcbiAgICAgIGIyU2V0dGluZ3MuYjJBc3NlcnQoMCA8PSBpbmRleCAmJiBpbmRleCA8IHRoaXMubV9jb3VudCk7XG4gICAgICByZXR1cm4gdGhpcy5tX3ZlcnRpY2VzW2luZGV4XTtcbiAgIH1cbiAgIGIyRHluYW1pY1RyZWUuYjJEeW5hbWljVHJlZSA9IGZ1bmN0aW9uICgpIHt9O1xuICAgYjJEeW5hbWljVHJlZS5wcm90b3R5cGUuYjJEeW5hbWljVHJlZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMubV9yb290ID0gbnVsbDtcbiAgICAgIHRoaXMubV9mcmVlTGlzdCA9IG51bGw7XG4gICAgICB0aGlzLm1fcGF0aCA9IDA7XG4gICAgICB0aGlzLm1faW5zZXJ0aW9uQ291bnQgPSAwO1xuICAgfVxuICAgYjJEeW5hbWljVHJlZS5wcm90b3R5cGUuQ3JlYXRlUHJveHkgPSBmdW5jdGlvbiAoYWFiYiwgdXNlckRhdGEpIHtcbiAgICAgIHZhciBub2RlID0gdGhpcy5BbGxvY2F0ZU5vZGUoKTtcbiAgICAgIHZhciBleHRlbmRYID0gYjJTZXR0aW5ncy5iMl9hYWJiRXh0ZW5zaW9uO1xuICAgICAgdmFyIGV4dGVuZFkgPSBiMlNldHRpbmdzLmIyX2FhYmJFeHRlbnNpb247XG4gICAgICBub2RlLmFhYmIubG93ZXJCb3VuZC54ID0gYWFiYi5sb3dlckJvdW5kLnggLSBleHRlbmRYO1xuICAgICAgbm9kZS5hYWJiLmxvd2VyQm91bmQueSA9IGFhYmIubG93ZXJCb3VuZC55IC0gZXh0ZW5kWTtcbiAgICAgIG5vZGUuYWFiYi51cHBlckJvdW5kLnggPSBhYWJiLnVwcGVyQm91bmQueCArIGV4dGVuZFg7XG4gICAgICBub2RlLmFhYmIudXBwZXJCb3VuZC55ID0gYWFiYi51cHBlckJvdW5kLnkgKyBleHRlbmRZO1xuICAgICAgbm9kZS51c2VyRGF0YSA9IHVzZXJEYXRhO1xuICAgICAgdGhpcy5JbnNlcnRMZWFmKG5vZGUpO1xuICAgICAgcmV0dXJuIG5vZGU7XG4gICB9XG4gICBiMkR5bmFtaWNUcmVlLnByb3RvdHlwZS5EZXN0cm95UHJveHkgPSBmdW5jdGlvbiAocHJveHkpIHtcbiAgICAgIHRoaXMuUmVtb3ZlTGVhZihwcm94eSk7XG4gICAgICB0aGlzLkZyZWVOb2RlKHByb3h5KTtcbiAgIH1cbiAgIGIyRHluYW1pY1RyZWUucHJvdG90eXBlLk1vdmVQcm94eSA9IGZ1bmN0aW9uIChwcm94eSwgYWFiYiwgZGlzcGxhY2VtZW50KSB7XG4gICAgICBiMlNldHRpbmdzLmIyQXNzZXJ0KHByb3h5LklzTGVhZigpKTtcbiAgICAgIGlmIChwcm94eS5hYWJiLkNvbnRhaW5zKGFhYmIpKSB7XG4gICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICB0aGlzLlJlbW92ZUxlYWYocHJveHkpO1xuICAgICAgdmFyIGV4dGVuZFggPSBiMlNldHRpbmdzLmIyX2FhYmJFeHRlbnNpb24gKyBiMlNldHRpbmdzLmIyX2FhYmJNdWx0aXBsaWVyICogKGRpc3BsYWNlbWVudC54ID4gMCA/IGRpc3BsYWNlbWVudC54IDogKC1kaXNwbGFjZW1lbnQueCkpO1xuICAgICAgdmFyIGV4dGVuZFkgPSBiMlNldHRpbmdzLmIyX2FhYmJFeHRlbnNpb24gKyBiMlNldHRpbmdzLmIyX2FhYmJNdWx0aXBsaWVyICogKGRpc3BsYWNlbWVudC55ID4gMCA/IGRpc3BsYWNlbWVudC55IDogKC1kaXNwbGFjZW1lbnQueSkpO1xuICAgICAgcHJveHkuYWFiYi5sb3dlckJvdW5kLnggPSBhYWJiLmxvd2VyQm91bmQueCAtIGV4dGVuZFg7XG4gICAgICBwcm94eS5hYWJiLmxvd2VyQm91bmQueSA9IGFhYmIubG93ZXJCb3VuZC55IC0gZXh0ZW5kWTtcbiAgICAgIHByb3h5LmFhYmIudXBwZXJCb3VuZC54ID0gYWFiYi51cHBlckJvdW5kLnggKyBleHRlbmRYO1xuICAgICAgcHJveHkuYWFiYi51cHBlckJvdW5kLnkgPSBhYWJiLnVwcGVyQm91bmQueSArIGV4dGVuZFk7XG4gICAgICB0aGlzLkluc2VydExlYWYocHJveHkpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICB9XG4gICBiMkR5bmFtaWNUcmVlLnByb3RvdHlwZS5SZWJhbGFuY2UgPSBmdW5jdGlvbiAoaXRlcmF0aW9ucykge1xuICAgICAgaWYgKGl0ZXJhdGlvbnMgPT09IHVuZGVmaW5lZCkgaXRlcmF0aW9ucyA9IDA7XG4gICAgICBpZiAodGhpcy5tX3Jvb3QgPT0gbnVsbCkgcmV0dXJuO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpdGVyYXRpb25zOyBpKyspIHtcbiAgICAgICAgIHZhciBub2RlID0gdGhpcy5tX3Jvb3Q7XG4gICAgICAgICB2YXIgYml0ID0gMDtcbiAgICAgICAgIHdoaWxlIChub2RlLklzTGVhZigpID09IGZhbHNlKSB7XG4gICAgICAgICAgICBub2RlID0gKHRoaXMubV9wYXRoID4+IGJpdCkgJiAxID8gbm9kZS5jaGlsZDIgOiBub2RlLmNoaWxkMTtcbiAgICAgICAgICAgIGJpdCA9IChiaXQgKyAxKSAmIDMxO1xuICAgICAgICAgfSsrdGhpcy5tX3BhdGg7XG4gICAgICAgICB0aGlzLlJlbW92ZUxlYWYobm9kZSk7XG4gICAgICAgICB0aGlzLkluc2VydExlYWYobm9kZSk7XG4gICAgICB9XG4gICB9XG4gICBiMkR5bmFtaWNUcmVlLnByb3RvdHlwZS5HZXRGYXRBQUJCID0gZnVuY3Rpb24gKHByb3h5KSB7XG4gICAgICByZXR1cm4gcHJveHkuYWFiYjtcbiAgIH1cbiAgIGIyRHluYW1pY1RyZWUucHJvdG90eXBlLkdldFVzZXJEYXRhID0gZnVuY3Rpb24gKHByb3h5KSB7XG4gICAgICByZXR1cm4gcHJveHkudXNlckRhdGE7XG4gICB9XG4gICBiMkR5bmFtaWNUcmVlLnByb3RvdHlwZS5RdWVyeSA9IGZ1bmN0aW9uIChjYWxsYmFjaywgYWFiYikge1xuICAgICAgaWYgKHRoaXMubV9yb290ID09IG51bGwpIHJldHVybjtcbiAgICAgIHZhciBzdGFjayA9IG5ldyBWZWN0b3IoKTtcbiAgICAgIHZhciBjb3VudCA9IDA7XG4gICAgICBzdGFja1tjb3VudCsrXSA9IHRoaXMubV9yb290O1xuICAgICAgd2hpbGUgKGNvdW50ID4gMCkge1xuICAgICAgICAgdmFyIG5vZGUgPSBzdGFja1stLWNvdW50XTtcbiAgICAgICAgIGlmIChub2RlLmFhYmIuVGVzdE92ZXJsYXAoYWFiYikpIHtcbiAgICAgICAgICAgIGlmIChub2RlLklzTGVhZigpKSB7XG4gICAgICAgICAgICAgICB2YXIgcHJvY2VlZCA9IGNhbGxiYWNrKG5vZGUpO1xuICAgICAgICAgICAgICAgaWYgKCFwcm9jZWVkKSByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgIHN0YWNrW2NvdW50KytdID0gbm9kZS5jaGlsZDE7XG4gICAgICAgICAgICAgICBzdGFja1tjb3VudCsrXSA9IG5vZGUuY2hpbGQyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgfVxuICAgICAgfVxuICAgfVxuICAgYjJEeW5hbWljVHJlZS5wcm90b3R5cGUuUmF5Q2FzdCA9IGZ1bmN0aW9uIChjYWxsYmFjaywgaW5wdXQpIHtcbiAgICAgIGlmICh0aGlzLm1fcm9vdCA9PSBudWxsKSByZXR1cm47XG4gICAgICB2YXIgcDEgPSBpbnB1dC5wMTtcbiAgICAgIHZhciBwMiA9IGlucHV0LnAyO1xuICAgICAgdmFyIHIgPSBiMk1hdGguU3VidHJhY3RWVihwMSwgcDIpO1xuICAgICAgci5Ob3JtYWxpemUoKTtcbiAgICAgIHZhciB2ID0gYjJNYXRoLkNyb3NzRlYoMS4wLCByKTtcbiAgICAgIHZhciBhYnNfdiA9IGIyTWF0aC5BYnNWKHYpO1xuICAgICAgdmFyIG1heEZyYWN0aW9uID0gaW5wdXQubWF4RnJhY3Rpb247XG4gICAgICB2YXIgc2VnbWVudEFBQkIgPSBuZXcgYjJBQUJCKCk7XG4gICAgICB2YXIgdFggPSAwO1xuICAgICAgdmFyIHRZID0gMDsge1xuICAgICAgICAgdFggPSBwMS54ICsgbWF4RnJhY3Rpb24gKiAocDIueCAtIHAxLngpO1xuICAgICAgICAgdFkgPSBwMS55ICsgbWF4RnJhY3Rpb24gKiAocDIueSAtIHAxLnkpO1xuICAgICAgICAgc2VnbWVudEFBQkIubG93ZXJCb3VuZC54ID0gTWF0aC5taW4ocDEueCwgdFgpO1xuICAgICAgICAgc2VnbWVudEFBQkIubG93ZXJCb3VuZC55ID0gTWF0aC5taW4ocDEueSwgdFkpO1xuICAgICAgICAgc2VnbWVudEFBQkIudXBwZXJCb3VuZC54ID0gTWF0aC5tYXgocDEueCwgdFgpO1xuICAgICAgICAgc2VnbWVudEFBQkIudXBwZXJCb3VuZC55ID0gTWF0aC5tYXgocDEueSwgdFkpO1xuICAgICAgfVxuICAgICAgdmFyIHN0YWNrID0gbmV3IFZlY3RvcigpO1xuICAgICAgdmFyIGNvdW50ID0gMDtcbiAgICAgIHN0YWNrW2NvdW50KytdID0gdGhpcy5tX3Jvb3Q7XG4gICAgICB3aGlsZSAoY291bnQgPiAwKSB7XG4gICAgICAgICB2YXIgbm9kZSA9IHN0YWNrWy0tY291bnRdO1xuICAgICAgICAgaWYgKG5vZGUuYWFiYi5UZXN0T3ZlcmxhcChzZWdtZW50QUFCQikgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgfVxuICAgICAgICAgdmFyIGMgPSBub2RlLmFhYmIuR2V0Q2VudGVyKCk7XG4gICAgICAgICB2YXIgaCA9IG5vZGUuYWFiYi5HZXRFeHRlbnRzKCk7XG4gICAgICAgICB2YXIgc2VwYXJhdGlvbiA9IE1hdGguYWJzKHYueCAqIChwMS54IC0gYy54KSArIHYueSAqIChwMS55IC0gYy55KSkgLSBhYnNfdi54ICogaC54IC0gYWJzX3YueSAqIGgueTtcbiAgICAgICAgIGlmIChzZXBhcmF0aW9uID4gMC4wKSBjb250aW51ZTtcbiAgICAgICAgIGlmIChub2RlLklzTGVhZigpKSB7XG4gICAgICAgICAgICB2YXIgc3ViSW5wdXQgPSBuZXcgYjJSYXlDYXN0SW5wdXQoKTtcbiAgICAgICAgICAgIHN1YklucHV0LnAxID0gaW5wdXQucDE7XG4gICAgICAgICAgICBzdWJJbnB1dC5wMiA9IGlucHV0LnAyO1xuICAgICAgICAgICAgc3ViSW5wdXQubWF4RnJhY3Rpb24gPSBpbnB1dC5tYXhGcmFjdGlvbjtcbiAgICAgICAgICAgIG1heEZyYWN0aW9uID0gY2FsbGJhY2soc3ViSW5wdXQsIG5vZGUpO1xuICAgICAgICAgICAgaWYgKG1heEZyYWN0aW9uID09IDAuMCkgcmV0dXJuO1xuICAgICAgICAgICAgaWYgKG1heEZyYWN0aW9uID4gMC4wKSB7XG4gICAgICAgICAgICAgICB0WCA9IHAxLnggKyBtYXhGcmFjdGlvbiAqIChwMi54IC0gcDEueCk7XG4gICAgICAgICAgICAgICB0WSA9IHAxLnkgKyBtYXhGcmFjdGlvbiAqIChwMi55IC0gcDEueSk7XG4gICAgICAgICAgICAgICBzZWdtZW50QUFCQi5sb3dlckJvdW5kLnggPSBNYXRoLm1pbihwMS54LCB0WCk7XG4gICAgICAgICAgICAgICBzZWdtZW50QUFCQi5sb3dlckJvdW5kLnkgPSBNYXRoLm1pbihwMS55LCB0WSk7XG4gICAgICAgICAgICAgICBzZWdtZW50QUFCQi51cHBlckJvdW5kLnggPSBNYXRoLm1heChwMS54LCB0WCk7XG4gICAgICAgICAgICAgICBzZWdtZW50QUFCQi51cHBlckJvdW5kLnkgPSBNYXRoLm1heChwMS55LCB0WSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICB9XG4gICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHN0YWNrW2NvdW50KytdID0gbm9kZS5jaGlsZDE7XG4gICAgICAgICAgICBzdGFja1tjb3VudCsrXSA9IG5vZGUuY2hpbGQyO1xuICAgICAgICAgfVxuICAgICAgfVxuICAgfVxuICAgYjJEeW5hbWljVHJlZS5wcm90b3R5cGUuQWxsb2NhdGVOb2RlID0gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKHRoaXMubV9mcmVlTGlzdCkge1xuICAgICAgICAgdmFyIG5vZGUgPSB0aGlzLm1fZnJlZUxpc3Q7XG4gICAgICAgICB0aGlzLm1fZnJlZUxpc3QgPSBub2RlLnBhcmVudDtcbiAgICAgICAgIG5vZGUucGFyZW50ID0gbnVsbDtcbiAgICAgICAgIG5vZGUuY2hpbGQxID0gbnVsbDtcbiAgICAgICAgIG5vZGUuY2hpbGQyID0gbnVsbDtcbiAgICAgICAgIHJldHVybiBub2RlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG5ldyBiMkR5bmFtaWNUcmVlTm9kZSgpO1xuICAgfVxuICAgYjJEeW5hbWljVHJlZS5wcm90b3R5cGUuRnJlZU5vZGUgPSBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgbm9kZS5wYXJlbnQgPSB0aGlzLm1fZnJlZUxpc3Q7XG4gICAgICB0aGlzLm1fZnJlZUxpc3QgPSBub2RlO1xuICAgfVxuICAgYjJEeW5hbWljVHJlZS5wcm90b3R5cGUuSW5zZXJ0TGVhZiA9IGZ1bmN0aW9uIChsZWFmKSB7XG4gICAgICArK3RoaXMubV9pbnNlcnRpb25Db3VudDtcbiAgICAgIGlmICh0aGlzLm1fcm9vdCA9PSBudWxsKSB7XG4gICAgICAgICB0aGlzLm1fcm9vdCA9IGxlYWY7XG4gICAgICAgICB0aGlzLm1fcm9vdC5wYXJlbnQgPSBudWxsO1xuICAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdmFyIGNlbnRlciA9IGxlYWYuYWFiYi5HZXRDZW50ZXIoKTtcbiAgICAgIHZhciBzaWJsaW5nID0gdGhpcy5tX3Jvb3Q7XG4gICAgICBpZiAoc2libGluZy5Jc0xlYWYoKSA9PSBmYWxzZSkge1xuICAgICAgICAgZG8ge1xuICAgICAgICAgICAgdmFyIGNoaWxkMSA9IHNpYmxpbmcuY2hpbGQxO1xuICAgICAgICAgICAgdmFyIGNoaWxkMiA9IHNpYmxpbmcuY2hpbGQyO1xuICAgICAgICAgICAgdmFyIG5vcm0xID0gTWF0aC5hYnMoKGNoaWxkMS5hYWJiLmxvd2VyQm91bmQueCArIGNoaWxkMS5hYWJiLnVwcGVyQm91bmQueCkgLyAyIC0gY2VudGVyLngpICsgTWF0aC5hYnMoKGNoaWxkMS5hYWJiLmxvd2VyQm91bmQueSArIGNoaWxkMS5hYWJiLnVwcGVyQm91bmQueSkgLyAyIC0gY2VudGVyLnkpO1xuICAgICAgICAgICAgdmFyIG5vcm0yID0gTWF0aC5hYnMoKGNoaWxkMi5hYWJiLmxvd2VyQm91bmQueCArIGNoaWxkMi5hYWJiLnVwcGVyQm91bmQueCkgLyAyIC0gY2VudGVyLngpICsgTWF0aC5hYnMoKGNoaWxkMi5hYWJiLmxvd2VyQm91bmQueSArIGNoaWxkMi5hYWJiLnVwcGVyQm91bmQueSkgLyAyIC0gY2VudGVyLnkpO1xuICAgICAgICAgICAgaWYgKG5vcm0xIDwgbm9ybTIpIHtcbiAgICAgICAgICAgICAgIHNpYmxpbmcgPSBjaGlsZDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgIHNpYmxpbmcgPSBjaGlsZDI7XG4gICAgICAgICAgICB9XG4gICAgICAgICB9XG4gICAgICAgICB3aGlsZSAoc2libGluZy5Jc0xlYWYoKSA9PSBmYWxzZSlcbiAgICAgIH1cbiAgICAgIHZhciBub2RlMSA9IHNpYmxpbmcucGFyZW50O1xuICAgICAgdmFyIG5vZGUyID0gdGhpcy5BbGxvY2F0ZU5vZGUoKTtcbiAgICAgIG5vZGUyLnBhcmVudCA9IG5vZGUxO1xuICAgICAgbm9kZTIudXNlckRhdGEgPSBudWxsO1xuICAgICAgbm9kZTIuYWFiYi5Db21iaW5lKGxlYWYuYWFiYiwgc2libGluZy5hYWJiKTtcbiAgICAgIGlmIChub2RlMSkge1xuICAgICAgICAgaWYgKHNpYmxpbmcucGFyZW50LmNoaWxkMSA9PSBzaWJsaW5nKSB7XG4gICAgICAgICAgICBub2RlMS5jaGlsZDEgPSBub2RlMjtcbiAgICAgICAgIH1cbiAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbm9kZTEuY2hpbGQyID0gbm9kZTI7XG4gICAgICAgICB9XG4gICAgICAgICBub2RlMi5jaGlsZDEgPSBzaWJsaW5nO1xuICAgICAgICAgbm9kZTIuY2hpbGQyID0gbGVhZjtcbiAgICAgICAgIHNpYmxpbmcucGFyZW50ID0gbm9kZTI7XG4gICAgICAgICBsZWFmLnBhcmVudCA9IG5vZGUyO1xuICAgICAgICAgZG8ge1xuICAgICAgICAgICAgaWYgKG5vZGUxLmFhYmIuQ29udGFpbnMobm9kZTIuYWFiYikpIGJyZWFrO1xuICAgICAgICAgICAgbm9kZTEuYWFiYi5Db21iaW5lKG5vZGUxLmNoaWxkMS5hYWJiLCBub2RlMS5jaGlsZDIuYWFiYik7XG4gICAgICAgICAgICBub2RlMiA9IG5vZGUxO1xuICAgICAgICAgICAgbm9kZTEgPSBub2RlMS5wYXJlbnQ7XG4gICAgICAgICB9XG4gICAgICAgICB3aGlsZSAobm9kZTEpXG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgIG5vZGUyLmNoaWxkMSA9IHNpYmxpbmc7XG4gICAgICAgICBub2RlMi5jaGlsZDIgPSBsZWFmO1xuICAgICAgICAgc2libGluZy5wYXJlbnQgPSBub2RlMjtcbiAgICAgICAgIGxlYWYucGFyZW50ID0gbm9kZTI7XG4gICAgICAgICB0aGlzLm1fcm9vdCA9IG5vZGUyO1xuICAgICAgfVxuICAgfVxuICAgYjJEeW5hbWljVHJlZS5wcm90b3R5cGUuUmVtb3ZlTGVhZiA9IGZ1bmN0aW9uIChsZWFmKSB7XG4gICAgICBpZiAobGVhZiA9PSB0aGlzLm1fcm9vdCkge1xuICAgICAgICAgdGhpcy5tX3Jvb3QgPSBudWxsO1xuICAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdmFyIG5vZGUyID0gbGVhZi5wYXJlbnQ7XG4gICAgICB2YXIgbm9kZTEgPSBub2RlMi5wYXJlbnQ7XG4gICAgICB2YXIgc2libGluZztcbiAgICAgIGlmIChub2RlMi5jaGlsZDEgPT0gbGVhZikge1xuICAgICAgICAgc2libGluZyA9IG5vZGUyLmNoaWxkMjtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICAgc2libGluZyA9IG5vZGUyLmNoaWxkMTtcbiAgICAgIH1cbiAgICAgIGlmIChub2RlMSkge1xuICAgICAgICAgaWYgKG5vZGUxLmNoaWxkMSA9PSBub2RlMikge1xuICAgICAgICAgICAgbm9kZTEuY2hpbGQxID0gc2libGluZztcbiAgICAgICAgIH1cbiAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbm9kZTEuY2hpbGQyID0gc2libGluZztcbiAgICAgICAgIH1cbiAgICAgICAgIHNpYmxpbmcucGFyZW50ID0gbm9kZTE7XG4gICAgICAgICB0aGlzLkZyZWVOb2RlKG5vZGUyKTtcbiAgICAgICAgIHdoaWxlIChub2RlMSkge1xuICAgICAgICAgICAgdmFyIG9sZEFBQkIgPSBub2RlMS5hYWJiO1xuICAgICAgICAgICAgbm9kZTEuYWFiYiA9IGIyQUFCQi5Db21iaW5lKG5vZGUxLmNoaWxkMS5hYWJiLCBub2RlMS5jaGlsZDIuYWFiYik7XG4gICAgICAgICAgICBpZiAob2xkQUFCQi5Db250YWlucyhub2RlMS5hYWJiKSkgYnJlYWs7XG4gICAgICAgICAgICBub2RlMSA9IG5vZGUxLnBhcmVudDtcbiAgICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICAgdGhpcy5tX3Jvb3QgPSBzaWJsaW5nO1xuICAgICAgICAgc2libGluZy5wYXJlbnQgPSBudWxsO1xuICAgICAgICAgdGhpcy5GcmVlTm9kZShub2RlMik7XG4gICAgICB9XG4gICB9XG4gICBiMkR5bmFtaWNUcmVlQnJvYWRQaGFzZS5iMkR5bmFtaWNUcmVlQnJvYWRQaGFzZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMubV90cmVlID0gbmV3IGIyRHluYW1pY1RyZWUoKTtcbiAgICAgIHRoaXMubV9tb3ZlQnVmZmVyID0gbmV3IFZlY3RvcigpO1xuICAgICAgdGhpcy5tX3BhaXJCdWZmZXIgPSBuZXcgVmVjdG9yKCk7XG4gICAgICB0aGlzLm1fcGFpckNvdW50ID0gMDtcbiAgIH07XG4gICBiMkR5bmFtaWNUcmVlQnJvYWRQaGFzZS5wcm90b3R5cGUuQ3JlYXRlUHJveHkgPSBmdW5jdGlvbiAoYWFiYiwgdXNlckRhdGEpIHtcbiAgICAgIHZhciBwcm94eSA9IHRoaXMubV90cmVlLkNyZWF0ZVByb3h5KGFhYmIsIHVzZXJEYXRhKTtcbiAgICAgICsrdGhpcy5tX3Byb3h5Q291bnQ7XG4gICAgICB0aGlzLkJ1ZmZlck1vdmUocHJveHkpO1xuICAgICAgcmV0dXJuIHByb3h5O1xuICAgfVxuICAgYjJEeW5hbWljVHJlZUJyb2FkUGhhc2UucHJvdG90eXBlLkRlc3Ryb3lQcm94eSA9IGZ1bmN0aW9uIChwcm94eSkge1xuICAgICAgdGhpcy5VbkJ1ZmZlck1vdmUocHJveHkpO1xuICAgICAgLS10aGlzLm1fcHJveHlDb3VudDtcbiAgICAgIHRoaXMubV90cmVlLkRlc3Ryb3lQcm94eShwcm94eSk7XG4gICB9XG4gICBiMkR5bmFtaWNUcmVlQnJvYWRQaGFzZS5wcm90b3R5cGUuTW92ZVByb3h5ID0gZnVuY3Rpb24gKHByb3h5LCBhYWJiLCBkaXNwbGFjZW1lbnQpIHtcbiAgICAgIHZhciBidWZmZXIgPSB0aGlzLm1fdHJlZS5Nb3ZlUHJveHkocHJveHksIGFhYmIsIGRpc3BsYWNlbWVudCk7XG4gICAgICBpZiAoYnVmZmVyKSB7XG4gICAgICAgICB0aGlzLkJ1ZmZlck1vdmUocHJveHkpO1xuICAgICAgfVxuICAgfVxuICAgYjJEeW5hbWljVHJlZUJyb2FkUGhhc2UucHJvdG90eXBlLlRlc3RPdmVybGFwID0gZnVuY3Rpb24gKHByb3h5QSwgcHJveHlCKSB7XG4gICAgICB2YXIgYWFiYkEgPSB0aGlzLm1fdHJlZS5HZXRGYXRBQUJCKHByb3h5QSk7XG4gICAgICB2YXIgYWFiYkIgPSB0aGlzLm1fdHJlZS5HZXRGYXRBQUJCKHByb3h5Qik7XG4gICAgICByZXR1cm4gYWFiYkEuVGVzdE92ZXJsYXAoYWFiYkIpO1xuICAgfVxuICAgYjJEeW5hbWljVHJlZUJyb2FkUGhhc2UucHJvdG90eXBlLkdldFVzZXJEYXRhID0gZnVuY3Rpb24gKHByb3h5KSB7XG4gICAgICByZXR1cm4gdGhpcy5tX3RyZWUuR2V0VXNlckRhdGEocHJveHkpO1xuICAgfVxuICAgYjJEeW5hbWljVHJlZUJyb2FkUGhhc2UucHJvdG90eXBlLkdldEZhdEFBQkIgPSBmdW5jdGlvbiAocHJveHkpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fdHJlZS5HZXRGYXRBQUJCKHByb3h5KTtcbiAgIH1cbiAgIGIyRHluYW1pY1RyZWVCcm9hZFBoYXNlLnByb3RvdHlwZS5HZXRQcm94eUNvdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV9wcm94eUNvdW50O1xuICAgfVxuICAgYjJEeW5hbWljVHJlZUJyb2FkUGhhc2UucHJvdG90eXBlLlVwZGF0ZVBhaXJzID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICB2YXIgX190aGlzID0gdGhpcztcbiAgICAgIF9fdGhpcy5tX3BhaXJDb3VudCA9IDA7XG4gICAgICB2YXIgaSA9IDAsXG4gICAgICAgICBxdWVyeVByb3h5O1xuICAgICAgIGZ1bmN0aW9uIFF1ZXJ5Q2FsbGJhY2socHJveHkpIHtcbiAgICAgICAgICBpZiAocHJveHkgPT0gcXVlcnlQcm94eSkgcmV0dXJuIHRydWU7XG4gICAgICAgICAgaWYgKF9fdGhpcy5tX3BhaXJDb3VudCA9PSBfX3RoaXMubV9wYWlyQnVmZmVyLmxlbmd0aCkge1xuICAgICAgICAgICAgIF9fdGhpcy5tX3BhaXJCdWZmZXJbX190aGlzLm1fcGFpckNvdW50XSA9IG5ldyBiMkR5bmFtaWNUcmVlUGFpcigpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgcGFpciA9IF9fdGhpcy5tX3BhaXJCdWZmZXJbX190aGlzLm1fcGFpckNvdW50XTtcbiAgICAgICAgICBwYWlyLnByb3h5QSA9IHByb3h5IDwgcXVlcnlQcm94eSA/IHByb3h5IDogcXVlcnlQcm94eTtcbiAgICAgICAgICBwYWlyLnByb3h5QiA9IHByb3h5ID49IHF1ZXJ5UHJveHkgPyBwcm94eSA6IHF1ZXJ5UHJveHk7KytfX3RoaXMubV9wYWlyQ291bnQ7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgfTtcbiAgICAgIGZvciAoaSA9IDA7XG4gICAgICBpIDwgX190aGlzLm1fbW92ZUJ1ZmZlci5sZW5ndGg7ICsraSkge1xuICAgICAgICAgcXVlcnlQcm94eSA9IF9fdGhpcy5tX21vdmVCdWZmZXJbaV07XG4gICAgICAgICB2YXIgZmF0QUFCQiA9IF9fdGhpcy5tX3RyZWUuR2V0RmF0QUFCQihxdWVyeVByb3h5KTtcbiAgICAgICAgIF9fdGhpcy5tX3RyZWUuUXVlcnkoUXVlcnlDYWxsYmFjaywgZmF0QUFCQik7XG4gICAgICB9XG4gICAgICBfX3RoaXMubV9tb3ZlQnVmZmVyLmxlbmd0aCA9IDA7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IF9fdGhpcy5tX3BhaXJDb3VudDspIHtcbiAgICAgICAgIHZhciBwcmltYXJ5UGFpciA9IF9fdGhpcy5tX3BhaXJCdWZmZXJbaV07XG4gICAgICAgICB2YXIgdXNlckRhdGFBID0gX190aGlzLm1fdHJlZS5HZXRVc2VyRGF0YShwcmltYXJ5UGFpci5wcm94eUEpO1xuICAgICAgICAgdmFyIHVzZXJEYXRhQiA9IF9fdGhpcy5tX3RyZWUuR2V0VXNlckRhdGEocHJpbWFyeVBhaXIucHJveHlCKTtcbiAgICAgICAgIGNhbGxiYWNrKHVzZXJEYXRhQSwgdXNlckRhdGFCKTtcbiAgICAgICAgICsraTtcbiAgICAgICAgIHdoaWxlIChpIDwgX190aGlzLm1fcGFpckNvdW50KSB7XG4gICAgICAgICAgICB2YXIgcGFpciA9IF9fdGhpcy5tX3BhaXJCdWZmZXJbaV07XG4gICAgICAgICAgICBpZiAocGFpci5wcm94eUEgIT0gcHJpbWFyeVBhaXIucHJveHlBIHx8IHBhaXIucHJveHlCICE9IHByaW1hcnlQYWlyLnByb3h5Qikge1xuICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9KytpO1xuICAgICAgICAgfVxuICAgICAgfVxuICAgfVxuICAgYjJEeW5hbWljVHJlZUJyb2FkUGhhc2UucHJvdG90eXBlLlF1ZXJ5ID0gZnVuY3Rpb24gKGNhbGxiYWNrLCBhYWJiKSB7XG4gICAgICB0aGlzLm1fdHJlZS5RdWVyeShjYWxsYmFjaywgYWFiYik7XG4gICB9XG4gICBiMkR5bmFtaWNUcmVlQnJvYWRQaGFzZS5wcm90b3R5cGUuUmF5Q2FzdCA9IGZ1bmN0aW9uIChjYWxsYmFjaywgaW5wdXQpIHtcbiAgICAgIHRoaXMubV90cmVlLlJheUNhc3QoY2FsbGJhY2ssIGlucHV0KTtcbiAgIH1cbiAgIGIyRHluYW1pY1RyZWVCcm9hZFBoYXNlLnByb3RvdHlwZS5WYWxpZGF0ZSA9IGZ1bmN0aW9uICgpIHt9XG4gICBiMkR5bmFtaWNUcmVlQnJvYWRQaGFzZS5wcm90b3R5cGUuUmViYWxhbmNlID0gZnVuY3Rpb24gKGl0ZXJhdGlvbnMpIHtcbiAgICAgIGlmIChpdGVyYXRpb25zID09PSB1bmRlZmluZWQpIGl0ZXJhdGlvbnMgPSAwO1xuICAgICAgdGhpcy5tX3RyZWUuUmViYWxhbmNlKGl0ZXJhdGlvbnMpO1xuICAgfVxuICAgYjJEeW5hbWljVHJlZUJyb2FkUGhhc2UucHJvdG90eXBlLkJ1ZmZlck1vdmUgPSBmdW5jdGlvbiAocHJveHkpIHtcbiAgICAgIHRoaXMubV9tb3ZlQnVmZmVyW3RoaXMubV9tb3ZlQnVmZmVyLmxlbmd0aF0gPSBwcm94eTtcbiAgIH1cbiAgIGIyRHluYW1pY1RyZWVCcm9hZFBoYXNlLnByb3RvdHlwZS5VbkJ1ZmZlck1vdmUgPSBmdW5jdGlvbiAocHJveHkpIHtcbiAgICAgIHZhciBpID0gcGFyc2VJbnQodGhpcy5tX21vdmVCdWZmZXIuaW5kZXhPZihwcm94eSkpO1xuICAgICAgdGhpcy5tX21vdmVCdWZmZXIuc3BsaWNlKGksIDEpO1xuICAgfVxuICAgYjJEeW5hbWljVHJlZUJyb2FkUGhhc2UucHJvdG90eXBlLkNvbXBhcmVQYWlycyA9IGZ1bmN0aW9uIChwYWlyMSwgcGFpcjIpIHtcbiAgICAgIHJldHVybiAwO1xuICAgfVxuICAgYjJEeW5hbWljVHJlZUJyb2FkUGhhc2UuX19pbXBsZW1lbnRzID0ge307XG4gICBiMkR5bmFtaWNUcmVlQnJvYWRQaGFzZS5fX2ltcGxlbWVudHNbSUJyb2FkUGhhc2VdID0gdHJ1ZTtcbiAgIGIyRHluYW1pY1RyZWVOb2RlLmIyRHluYW1pY1RyZWVOb2RlID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5hYWJiID0gbmV3IGIyQUFCQigpO1xuICAgfTtcbiAgIGIyRHluYW1pY1RyZWVOb2RlLnByb3RvdHlwZS5Jc0xlYWYgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5jaGlsZDEgPT0gbnVsbDtcbiAgIH1cbiAgIGIyRHluYW1pY1RyZWVQYWlyLmIyRHluYW1pY1RyZWVQYWlyID0gZnVuY3Rpb24gKCkge307XG4gICBiMk1hbmlmb2xkLmIyTWFuaWZvbGQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLm1fcG9pbnRDb3VudCA9IDA7XG4gICB9O1xuICAgYjJNYW5pZm9sZC5wcm90b3R5cGUuYjJNYW5pZm9sZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMubV9wb2ludHMgPSBuZXcgVmVjdG9yKGIyU2V0dGluZ3MuYjJfbWF4TWFuaWZvbGRQb2ludHMpO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBiMlNldHRpbmdzLmIyX21heE1hbmlmb2xkUG9pbnRzOyBpKyspIHtcbiAgICAgICAgIHRoaXMubV9wb2ludHNbaV0gPSBuZXcgYjJNYW5pZm9sZFBvaW50KCk7XG4gICAgICB9XG4gICAgICB0aGlzLm1fbG9jYWxQbGFuZU5vcm1hbCA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIHRoaXMubV9sb2NhbFBvaW50ID0gbmV3IGIyVmVjMigpO1xuICAgfVxuICAgYjJNYW5pZm9sZC5wcm90b3R5cGUuUmVzZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGIyU2V0dGluZ3MuYjJfbWF4TWFuaWZvbGRQb2ludHM7IGkrKykge1xuICAgICAgICAgKCh0aGlzLm1fcG9pbnRzW2ldIGluc3RhbmNlb2YgYjJNYW5pZm9sZFBvaW50ID8gdGhpcy5tX3BvaW50c1tpXSA6IG51bGwpKS5SZXNldCgpO1xuICAgICAgfVxuICAgICAgdGhpcy5tX2xvY2FsUGxhbmVOb3JtYWwuU2V0WmVybygpO1xuICAgICAgdGhpcy5tX2xvY2FsUG9pbnQuU2V0WmVybygpO1xuICAgICAgdGhpcy5tX3R5cGUgPSAwO1xuICAgICAgdGhpcy5tX3BvaW50Q291bnQgPSAwO1xuICAgfVxuICAgYjJNYW5pZm9sZC5wcm90b3R5cGUuU2V0ID0gZnVuY3Rpb24gKG0pIHtcbiAgICAgIHRoaXMubV9wb2ludENvdW50ID0gbS5tX3BvaW50Q291bnQ7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGIyU2V0dGluZ3MuYjJfbWF4TWFuaWZvbGRQb2ludHM7IGkrKykge1xuICAgICAgICAgKCh0aGlzLm1fcG9pbnRzW2ldIGluc3RhbmNlb2YgYjJNYW5pZm9sZFBvaW50ID8gdGhpcy5tX3BvaW50c1tpXSA6IG51bGwpKS5TZXQobS5tX3BvaW50c1tpXSk7XG4gICAgICB9XG4gICAgICB0aGlzLm1fbG9jYWxQbGFuZU5vcm1hbC5TZXRWKG0ubV9sb2NhbFBsYW5lTm9ybWFsKTtcbiAgICAgIHRoaXMubV9sb2NhbFBvaW50LlNldFYobS5tX2xvY2FsUG9pbnQpO1xuICAgICAgdGhpcy5tX3R5cGUgPSBtLm1fdHlwZTtcbiAgIH1cbiAgIGIyTWFuaWZvbGQucHJvdG90eXBlLkNvcHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgY29weSA9IG5ldyBiMk1hbmlmb2xkKCk7XG4gICAgICBjb3B5LlNldCh0aGlzKTtcbiAgICAgIHJldHVybiBjb3B5O1xuICAgfVxuICAgQm94MkQucG9zdERlZnMucHVzaChmdW5jdGlvbiAoKSB7XG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJNYW5pZm9sZC5lX2NpcmNsZXMgPSAweDAwMDE7XG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJNYW5pZm9sZC5lX2ZhY2VBID0gMHgwMDAyO1xuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyTWFuaWZvbGQuZV9mYWNlQiA9IDB4MDAwNDtcbiAgIH0pO1xuICAgYjJNYW5pZm9sZFBvaW50LmIyTWFuaWZvbGRQb2ludCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMubV9sb2NhbFBvaW50ID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy5tX2lkID0gbmV3IGIyQ29udGFjdElEKCk7XG4gICB9O1xuICAgYjJNYW5pZm9sZFBvaW50LnByb3RvdHlwZS5iMk1hbmlmb2xkUG9pbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLlJlc2V0KCk7XG4gICB9XG4gICBiMk1hbmlmb2xkUG9pbnQucHJvdG90eXBlLlJlc2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5tX2xvY2FsUG9pbnQuU2V0WmVybygpO1xuICAgICAgdGhpcy5tX25vcm1hbEltcHVsc2UgPSAwLjA7XG4gICAgICB0aGlzLm1fdGFuZ2VudEltcHVsc2UgPSAwLjA7XG4gICAgICB0aGlzLm1faWQua2V5ID0gMDtcbiAgIH1cbiAgIGIyTWFuaWZvbGRQb2ludC5wcm90b3R5cGUuU2V0ID0gZnVuY3Rpb24gKG0pIHtcbiAgICAgIHRoaXMubV9sb2NhbFBvaW50LlNldFYobS5tX2xvY2FsUG9pbnQpO1xuICAgICAgdGhpcy5tX25vcm1hbEltcHVsc2UgPSBtLm1fbm9ybWFsSW1wdWxzZTtcbiAgICAgIHRoaXMubV90YW5nZW50SW1wdWxzZSA9IG0ubV90YW5nZW50SW1wdWxzZTtcbiAgICAgIHRoaXMubV9pZC5TZXQobS5tX2lkKTtcbiAgIH1cbiAgIGIyUG9pbnQuYjJQb2ludCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMucCA9IG5ldyBiMlZlYzIoKTtcbiAgIH07XG4gICBiMlBvaW50LnByb3RvdHlwZS5TdXBwb3J0ID0gZnVuY3Rpb24gKHhmLCB2WCwgdlkpIHtcbiAgICAgIGlmICh2WCA9PT0gdW5kZWZpbmVkKSB2WCA9IDA7XG4gICAgICBpZiAodlkgPT09IHVuZGVmaW5lZCkgdlkgPSAwO1xuICAgICAgcmV0dXJuIHRoaXMucDtcbiAgIH1cbiAgIGIyUG9pbnQucHJvdG90eXBlLkdldEZpcnN0VmVydGV4ID0gZnVuY3Rpb24gKHhmKSB7XG4gICAgICByZXR1cm4gdGhpcy5wO1xuICAgfVxuICAgYjJSYXlDYXN0SW5wdXQuYjJSYXlDYXN0SW5wdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLnAxID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy5wMiA9IG5ldyBiMlZlYzIoKTtcbiAgIH07XG4gICBiMlJheUNhc3RJbnB1dC5wcm90b3R5cGUuYjJSYXlDYXN0SW5wdXQgPSBmdW5jdGlvbiAocDEsIHAyLCBtYXhGcmFjdGlvbikge1xuICAgICAgaWYgKHAxID09PSB1bmRlZmluZWQpIHAxID0gbnVsbDtcbiAgICAgIGlmIChwMiA9PT0gdW5kZWZpbmVkKSBwMiA9IG51bGw7XG4gICAgICBpZiAobWF4RnJhY3Rpb24gPT09IHVuZGVmaW5lZCkgbWF4RnJhY3Rpb24gPSAxO1xuICAgICAgaWYgKHAxKSB0aGlzLnAxLlNldFYocDEpO1xuICAgICAgaWYgKHAyKSB0aGlzLnAyLlNldFYocDIpO1xuICAgICAgdGhpcy5tYXhGcmFjdGlvbiA9IG1heEZyYWN0aW9uO1xuICAgfVxuICAgYjJSYXlDYXN0T3V0cHV0LmIyUmF5Q2FzdE91dHB1dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMubm9ybWFsID0gbmV3IGIyVmVjMigpO1xuICAgfTtcbiAgIGIyU2VnbWVudC5iMlNlZ21lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLnAxID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy5wMiA9IG5ldyBiMlZlYzIoKTtcbiAgIH07XG4gICBiMlNlZ21lbnQucHJvdG90eXBlLlRlc3RTZWdtZW50ID0gZnVuY3Rpb24gKGxhbWJkYSwgbm9ybWFsLCBzZWdtZW50LCBtYXhMYW1iZGEpIHtcbiAgICAgIGlmIChtYXhMYW1iZGEgPT09IHVuZGVmaW5lZCkgbWF4TGFtYmRhID0gMDtcbiAgICAgIHZhciBzID0gc2VnbWVudC5wMTtcbiAgICAgIHZhciByWCA9IHNlZ21lbnQucDIueCAtIHMueDtcbiAgICAgIHZhciByWSA9IHNlZ21lbnQucDIueSAtIHMueTtcbiAgICAgIHZhciBkWCA9IHRoaXMucDIueCAtIHRoaXMucDEueDtcbiAgICAgIHZhciBkWSA9IHRoaXMucDIueSAtIHRoaXMucDEueTtcbiAgICAgIHZhciBuWCA9IGRZO1xuICAgICAgdmFyIG5ZID0gKC1kWCk7XG4gICAgICB2YXIga19zbG9wID0gMTAwLjAgKiBOdW1iZXIuTUlOX1ZBTFVFO1xuICAgICAgdmFyIGRlbm9tID0gKC0oclggKiBuWCArIHJZICogblkpKTtcbiAgICAgIGlmIChkZW5vbSA+IGtfc2xvcCkge1xuICAgICAgICAgdmFyIGJYID0gcy54IC0gdGhpcy5wMS54O1xuICAgICAgICAgdmFyIGJZID0gcy55IC0gdGhpcy5wMS55O1xuICAgICAgICAgdmFyIGEgPSAoYlggKiBuWCArIGJZICogblkpO1xuICAgICAgICAgaWYgKDAuMCA8PSBhICYmIGEgPD0gbWF4TGFtYmRhICogZGVub20pIHtcbiAgICAgICAgICAgIHZhciBtdTIgPSAoLXJYICogYlkpICsgclkgKiBiWDtcbiAgICAgICAgICAgIGlmICgoLWtfc2xvcCAqIGRlbm9tKSA8PSBtdTIgJiYgbXUyIDw9IGRlbm9tICogKDEuMCArIGtfc2xvcCkpIHtcbiAgICAgICAgICAgICAgIGEgLz0gZGVub207XG4gICAgICAgICAgICAgICB2YXIgbkxlbiA9IE1hdGguc3FydChuWCAqIG5YICsgblkgKiBuWSk7XG4gICAgICAgICAgICAgICBuWCAvPSBuTGVuO1xuICAgICAgICAgICAgICAgblkgLz0gbkxlbjtcbiAgICAgICAgICAgICAgIGxhbWJkYVswXSA9IGE7XG4gICAgICAgICAgICAgICBub3JtYWwuU2V0KG5YLCBuWSk7XG4gICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgIH1cbiAgIGIyU2VnbWVudC5wcm90b3R5cGUuRXh0ZW5kID0gZnVuY3Rpb24gKGFhYmIpIHtcbiAgICAgIHRoaXMuRXh0ZW5kRm9yd2FyZChhYWJiKTtcbiAgICAgIHRoaXMuRXh0ZW5kQmFja3dhcmQoYWFiYik7XG4gICB9XG4gICBiMlNlZ21lbnQucHJvdG90eXBlLkV4dGVuZEZvcndhcmQgPSBmdW5jdGlvbiAoYWFiYikge1xuICAgICAgdmFyIGRYID0gdGhpcy5wMi54IC0gdGhpcy5wMS54O1xuICAgICAgdmFyIGRZID0gdGhpcy5wMi55IC0gdGhpcy5wMS55O1xuICAgICAgdmFyIGxhbWJkYSA9IE1hdGgubWluKGRYID4gMCA/IChhYWJiLnVwcGVyQm91bmQueCAtIHRoaXMucDEueCkgLyBkWCA6IGRYIDwgMCA/IChhYWJiLmxvd2VyQm91bmQueCAtIHRoaXMucDEueCkgLyBkWCA6IE51bWJlci5QT1NJVElWRV9JTkZJTklUWSxcbiAgICAgIGRZID4gMCA/IChhYWJiLnVwcGVyQm91bmQueSAtIHRoaXMucDEueSkgLyBkWSA6IGRZIDwgMCA/IChhYWJiLmxvd2VyQm91bmQueSAtIHRoaXMucDEueSkgLyBkWSA6IE51bWJlci5QT1NJVElWRV9JTkZJTklUWSk7XG4gICAgICB0aGlzLnAyLnggPSB0aGlzLnAxLnggKyBkWCAqIGxhbWJkYTtcbiAgICAgIHRoaXMucDIueSA9IHRoaXMucDEueSArIGRZICogbGFtYmRhO1xuICAgfVxuICAgYjJTZWdtZW50LnByb3RvdHlwZS5FeHRlbmRCYWNrd2FyZCA9IGZ1bmN0aW9uIChhYWJiKSB7XG4gICAgICB2YXIgZFggPSAoLXRoaXMucDIueCkgKyB0aGlzLnAxLng7XG4gICAgICB2YXIgZFkgPSAoLXRoaXMucDIueSkgKyB0aGlzLnAxLnk7XG4gICAgICB2YXIgbGFtYmRhID0gTWF0aC5taW4oZFggPiAwID8gKGFhYmIudXBwZXJCb3VuZC54IC0gdGhpcy5wMi54KSAvIGRYIDogZFggPCAwID8gKGFhYmIubG93ZXJCb3VuZC54IC0gdGhpcy5wMi54KSAvIGRYIDogTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLFxuICAgICAgZFkgPiAwID8gKGFhYmIudXBwZXJCb3VuZC55IC0gdGhpcy5wMi55KSAvIGRZIDogZFkgPCAwID8gKGFhYmIubG93ZXJCb3VuZC55IC0gdGhpcy5wMi55KSAvIGRZIDogTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZKTtcbiAgICAgIHRoaXMucDEueCA9IHRoaXMucDIueCArIGRYICogbGFtYmRhO1xuICAgICAgdGhpcy5wMS55ID0gdGhpcy5wMi55ICsgZFkgKiBsYW1iZGE7XG4gICB9XG4gICBiMlNlcGFyYXRpb25GdW5jdGlvbi5iMlNlcGFyYXRpb25GdW5jdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMubV9sb2NhbFBvaW50ID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy5tX2F4aXMgPSBuZXcgYjJWZWMyKCk7XG4gICB9O1xuICAgYjJTZXBhcmF0aW9uRnVuY3Rpb24ucHJvdG90eXBlLkluaXRpYWxpemUgPSBmdW5jdGlvbiAoY2FjaGUsIHByb3h5QSwgdHJhbnNmb3JtQSwgcHJveHlCLCB0cmFuc2Zvcm1CKSB7XG4gICAgICB0aGlzLm1fcHJveHlBID0gcHJveHlBO1xuICAgICAgdGhpcy5tX3Byb3h5QiA9IHByb3h5QjtcbiAgICAgIHZhciBjb3VudCA9IHBhcnNlSW50KGNhY2hlLmNvdW50KTtcbiAgICAgIGIyU2V0dGluZ3MuYjJBc3NlcnQoMCA8IGNvdW50ICYmIGNvdW50IDwgMyk7XG4gICAgICB2YXIgbG9jYWxQb2ludEE7XG4gICAgICB2YXIgbG9jYWxQb2ludEExO1xuICAgICAgdmFyIGxvY2FsUG9pbnRBMjtcbiAgICAgIHZhciBsb2NhbFBvaW50QjtcbiAgICAgIHZhciBsb2NhbFBvaW50QjE7XG4gICAgICB2YXIgbG9jYWxQb2ludEIyO1xuICAgICAgdmFyIHBvaW50QVggPSAwO1xuICAgICAgdmFyIHBvaW50QVkgPSAwO1xuICAgICAgdmFyIHBvaW50QlggPSAwO1xuICAgICAgdmFyIHBvaW50QlkgPSAwO1xuICAgICAgdmFyIG5vcm1hbFggPSAwO1xuICAgICAgdmFyIG5vcm1hbFkgPSAwO1xuICAgICAgdmFyIHRNYXQ7XG4gICAgICB2YXIgdFZlYztcbiAgICAgIHZhciBzID0gMDtcbiAgICAgIHZhciBzZ24gPSAwO1xuICAgICAgaWYgKGNvdW50ID09IDEpIHtcbiAgICAgICAgIHRoaXMubV90eXBlID0gYjJTZXBhcmF0aW9uRnVuY3Rpb24uZV9wb2ludHM7XG4gICAgICAgICBsb2NhbFBvaW50QSA9IHRoaXMubV9wcm94eUEuR2V0VmVydGV4KGNhY2hlLmluZGV4QVswXSk7XG4gICAgICAgICBsb2NhbFBvaW50QiA9IHRoaXMubV9wcm94eUIuR2V0VmVydGV4KGNhY2hlLmluZGV4QlswXSk7XG4gICAgICAgICB0VmVjID0gbG9jYWxQb2ludEE7XG4gICAgICAgICB0TWF0ID0gdHJhbnNmb3JtQS5SO1xuICAgICAgICAgcG9pbnRBWCA9IHRyYW5zZm9ybUEucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcbiAgICAgICAgIHBvaW50QVkgPSB0cmFuc2Zvcm1BLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XG4gICAgICAgICB0VmVjID0gbG9jYWxQb2ludEI7XG4gICAgICAgICB0TWF0ID0gdHJhbnNmb3JtQi5SO1xuICAgICAgICAgcG9pbnRCWCA9IHRyYW5zZm9ybUIucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcbiAgICAgICAgIHBvaW50QlkgPSB0cmFuc2Zvcm1CLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XG4gICAgICAgICB0aGlzLm1fYXhpcy54ID0gcG9pbnRCWCAtIHBvaW50QVg7XG4gICAgICAgICB0aGlzLm1fYXhpcy55ID0gcG9pbnRCWSAtIHBvaW50QVk7XG4gICAgICAgICB0aGlzLm1fYXhpcy5Ob3JtYWxpemUoKTtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKGNhY2hlLmluZGV4QlswXSA9PSBjYWNoZS5pbmRleEJbMV0pIHtcbiAgICAgICAgIHRoaXMubV90eXBlID0gYjJTZXBhcmF0aW9uRnVuY3Rpb24uZV9mYWNlQTtcbiAgICAgICAgIGxvY2FsUG9pbnRBMSA9IHRoaXMubV9wcm94eUEuR2V0VmVydGV4KGNhY2hlLmluZGV4QVswXSk7XG4gICAgICAgICBsb2NhbFBvaW50QTIgPSB0aGlzLm1fcHJveHlBLkdldFZlcnRleChjYWNoZS5pbmRleEFbMV0pO1xuICAgICAgICAgbG9jYWxQb2ludEIgPSB0aGlzLm1fcHJveHlCLkdldFZlcnRleChjYWNoZS5pbmRleEJbMF0pO1xuICAgICAgICAgdGhpcy5tX2xvY2FsUG9pbnQueCA9IDAuNSAqIChsb2NhbFBvaW50QTEueCArIGxvY2FsUG9pbnRBMi54KTtcbiAgICAgICAgIHRoaXMubV9sb2NhbFBvaW50LnkgPSAwLjUgKiAobG9jYWxQb2ludEExLnkgKyBsb2NhbFBvaW50QTIueSk7XG4gICAgICAgICB0aGlzLm1fYXhpcyA9IGIyTWF0aC5Dcm9zc1ZGKGIyTWF0aC5TdWJ0cmFjdFZWKGxvY2FsUG9pbnRBMiwgbG9jYWxQb2ludEExKSwgMS4wKTtcbiAgICAgICAgIHRoaXMubV9heGlzLk5vcm1hbGl6ZSgpO1xuICAgICAgICAgdFZlYyA9IHRoaXMubV9heGlzO1xuICAgICAgICAgdE1hdCA9IHRyYW5zZm9ybUEuUjtcbiAgICAgICAgIG5vcm1hbFggPSB0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55O1xuICAgICAgICAgbm9ybWFsWSA9IHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnk7XG4gICAgICAgICB0VmVjID0gdGhpcy5tX2xvY2FsUG9pbnQ7XG4gICAgICAgICB0TWF0ID0gdHJhbnNmb3JtQS5SO1xuICAgICAgICAgcG9pbnRBWCA9IHRyYW5zZm9ybUEucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcbiAgICAgICAgIHBvaW50QVkgPSB0cmFuc2Zvcm1BLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XG4gICAgICAgICB0VmVjID0gbG9jYWxQb2ludEI7XG4gICAgICAgICB0TWF0ID0gdHJhbnNmb3JtQi5SO1xuICAgICAgICAgcG9pbnRCWCA9IHRyYW5zZm9ybUIucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcbiAgICAgICAgIHBvaW50QlkgPSB0cmFuc2Zvcm1CLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XG4gICAgICAgICBzID0gKHBvaW50QlggLSBwb2ludEFYKSAqIG5vcm1hbFggKyAocG9pbnRCWSAtIHBvaW50QVkpICogbm9ybWFsWTtcbiAgICAgICAgIGlmIChzIDwgMC4wKSB7XG4gICAgICAgICAgICB0aGlzLm1fYXhpcy5OZWdhdGl2ZVNlbGYoKTtcbiAgICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKGNhY2hlLmluZGV4QVswXSA9PSBjYWNoZS5pbmRleEFbMF0pIHtcbiAgICAgICAgIHRoaXMubV90eXBlID0gYjJTZXBhcmF0aW9uRnVuY3Rpb24uZV9mYWNlQjtcbiAgICAgICAgIGxvY2FsUG9pbnRCMSA9IHRoaXMubV9wcm94eUIuR2V0VmVydGV4KGNhY2hlLmluZGV4QlswXSk7XG4gICAgICAgICBsb2NhbFBvaW50QjIgPSB0aGlzLm1fcHJveHlCLkdldFZlcnRleChjYWNoZS5pbmRleEJbMV0pO1xuICAgICAgICAgbG9jYWxQb2ludEEgPSB0aGlzLm1fcHJveHlBLkdldFZlcnRleChjYWNoZS5pbmRleEFbMF0pO1xuICAgICAgICAgdGhpcy5tX2xvY2FsUG9pbnQueCA9IDAuNSAqIChsb2NhbFBvaW50QjEueCArIGxvY2FsUG9pbnRCMi54KTtcbiAgICAgICAgIHRoaXMubV9sb2NhbFBvaW50LnkgPSAwLjUgKiAobG9jYWxQb2ludEIxLnkgKyBsb2NhbFBvaW50QjIueSk7XG4gICAgICAgICB0aGlzLm1fYXhpcyA9IGIyTWF0aC5Dcm9zc1ZGKGIyTWF0aC5TdWJ0cmFjdFZWKGxvY2FsUG9pbnRCMiwgbG9jYWxQb2ludEIxKSwgMS4wKTtcbiAgICAgICAgIHRoaXMubV9heGlzLk5vcm1hbGl6ZSgpO1xuICAgICAgICAgdFZlYyA9IHRoaXMubV9heGlzO1xuICAgICAgICAgdE1hdCA9IHRyYW5zZm9ybUIuUjtcbiAgICAgICAgIG5vcm1hbFggPSB0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55O1xuICAgICAgICAgbm9ybWFsWSA9IHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnk7XG4gICAgICAgICB0VmVjID0gdGhpcy5tX2xvY2FsUG9pbnQ7XG4gICAgICAgICB0TWF0ID0gdHJhbnNmb3JtQi5SO1xuICAgICAgICAgcG9pbnRCWCA9IHRyYW5zZm9ybUIucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcbiAgICAgICAgIHBvaW50QlkgPSB0cmFuc2Zvcm1CLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XG4gICAgICAgICB0VmVjID0gbG9jYWxQb2ludEE7XG4gICAgICAgICB0TWF0ID0gdHJhbnNmb3JtQS5SO1xuICAgICAgICAgcG9pbnRBWCA9IHRyYW5zZm9ybUEucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcbiAgICAgICAgIHBvaW50QVkgPSB0cmFuc2Zvcm1BLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XG4gICAgICAgICBzID0gKHBvaW50QVggLSBwb2ludEJYKSAqIG5vcm1hbFggKyAocG9pbnRBWSAtIHBvaW50QlkpICogbm9ybWFsWTtcbiAgICAgICAgIGlmIChzIDwgMC4wKSB7XG4gICAgICAgICAgICB0aGlzLm1fYXhpcy5OZWdhdGl2ZVNlbGYoKTtcbiAgICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICAgbG9jYWxQb2ludEExID0gdGhpcy5tX3Byb3h5QS5HZXRWZXJ0ZXgoY2FjaGUuaW5kZXhBWzBdKTtcbiAgICAgICAgIGxvY2FsUG9pbnRBMiA9IHRoaXMubV9wcm94eUEuR2V0VmVydGV4KGNhY2hlLmluZGV4QVsxXSk7XG4gICAgICAgICBsb2NhbFBvaW50QjEgPSB0aGlzLm1fcHJveHlCLkdldFZlcnRleChjYWNoZS5pbmRleEJbMF0pO1xuICAgICAgICAgbG9jYWxQb2ludEIyID0gdGhpcy5tX3Byb3h5Qi5HZXRWZXJ0ZXgoY2FjaGUuaW5kZXhCWzFdKTtcbiAgICAgICAgIHZhciBwQSA9IGIyTWF0aC5NdWxYKHRyYW5zZm9ybUEsIGxvY2FsUG9pbnRBKTtcbiAgICAgICAgIHZhciBkQSA9IGIyTWF0aC5NdWxNVih0cmFuc2Zvcm1BLlIsIGIyTWF0aC5TdWJ0cmFjdFZWKGxvY2FsUG9pbnRBMiwgbG9jYWxQb2ludEExKSk7XG4gICAgICAgICB2YXIgcEIgPSBiMk1hdGguTXVsWCh0cmFuc2Zvcm1CLCBsb2NhbFBvaW50Qik7XG4gICAgICAgICB2YXIgZEIgPSBiMk1hdGguTXVsTVYodHJhbnNmb3JtQi5SLCBiMk1hdGguU3VidHJhY3RWVihsb2NhbFBvaW50QjIsIGxvY2FsUG9pbnRCMSkpO1xuICAgICAgICAgdmFyIGEgPSBkQS54ICogZEEueCArIGRBLnkgKiBkQS55O1xuICAgICAgICAgdmFyIGUgPSBkQi54ICogZEIueCArIGRCLnkgKiBkQi55O1xuICAgICAgICAgdmFyIHIgPSBiMk1hdGguU3VidHJhY3RWVihkQiwgZEEpO1xuICAgICAgICAgdmFyIGMgPSBkQS54ICogci54ICsgZEEueSAqIHIueTtcbiAgICAgICAgIHZhciBmID0gZEIueCAqIHIueCArIGRCLnkgKiByLnk7XG4gICAgICAgICB2YXIgYiA9IGRBLnggKiBkQi54ICsgZEEueSAqIGRCLnk7XG4gICAgICAgICB2YXIgZGVub20gPSBhICogZSAtIGIgKiBiO1xuICAgICAgICAgcyA9IDAuMDtcbiAgICAgICAgIGlmIChkZW5vbSAhPSAwLjApIHtcbiAgICAgICAgICAgIHMgPSBiMk1hdGguQ2xhbXAoKGIgKiBmIC0gYyAqIGUpIC8gZGVub20sIDAuMCwgMS4wKTtcbiAgICAgICAgIH1cbiAgICAgICAgIHZhciB0ID0gKGIgKiBzICsgZikgLyBlO1xuICAgICAgICAgaWYgKHQgPCAwLjApIHtcbiAgICAgICAgICAgIHQgPSAwLjA7XG4gICAgICAgICAgICBzID0gYjJNYXRoLkNsYW1wKChiIC0gYykgLyBhLCAwLjAsIDEuMCk7XG4gICAgICAgICB9XG4gICAgICAgICBsb2NhbFBvaW50QSA9IG5ldyBiMlZlYzIoKTtcbiAgICAgICAgIGxvY2FsUG9pbnRBLnggPSBsb2NhbFBvaW50QTEueCArIHMgKiAobG9jYWxQb2ludEEyLnggLSBsb2NhbFBvaW50QTEueCk7XG4gICAgICAgICBsb2NhbFBvaW50QS55ID0gbG9jYWxQb2ludEExLnkgKyBzICogKGxvY2FsUG9pbnRBMi55IC0gbG9jYWxQb2ludEExLnkpO1xuICAgICAgICAgbG9jYWxQb2ludEIgPSBuZXcgYjJWZWMyKCk7XG4gICAgICAgICBsb2NhbFBvaW50Qi54ID0gbG9jYWxQb2ludEIxLnggKyBzICogKGxvY2FsUG9pbnRCMi54IC0gbG9jYWxQb2ludEIxLngpO1xuICAgICAgICAgbG9jYWxQb2ludEIueSA9IGxvY2FsUG9pbnRCMS55ICsgcyAqIChsb2NhbFBvaW50QjIueSAtIGxvY2FsUG9pbnRCMS55KTtcbiAgICAgICAgIGlmIChzID09IDAuMCB8fCBzID09IDEuMCkge1xuICAgICAgICAgICAgdGhpcy5tX3R5cGUgPSBiMlNlcGFyYXRpb25GdW5jdGlvbi5lX2ZhY2VCO1xuICAgICAgICAgICAgdGhpcy5tX2F4aXMgPSBiMk1hdGguQ3Jvc3NWRihiMk1hdGguU3VidHJhY3RWVihsb2NhbFBvaW50QjIsIGxvY2FsUG9pbnRCMSksIDEuMCk7XG4gICAgICAgICAgICB0aGlzLm1fYXhpcy5Ob3JtYWxpemUoKTtcbiAgICAgICAgICAgIHRoaXMubV9sb2NhbFBvaW50ID0gbG9jYWxQb2ludEI7XG4gICAgICAgICAgICB0VmVjID0gdGhpcy5tX2F4aXM7XG4gICAgICAgICAgICB0TWF0ID0gdHJhbnNmb3JtQi5SO1xuICAgICAgICAgICAgbm9ybWFsWCA9IHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnk7XG4gICAgICAgICAgICBub3JtYWxZID0gdE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueTtcbiAgICAgICAgICAgIHRWZWMgPSB0aGlzLm1fbG9jYWxQb2ludDtcbiAgICAgICAgICAgIHRNYXQgPSB0cmFuc2Zvcm1CLlI7XG4gICAgICAgICAgICBwb2ludEJYID0gdHJhbnNmb3JtQi5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xuICAgICAgICAgICAgcG9pbnRCWSA9IHRyYW5zZm9ybUIucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55KTtcbiAgICAgICAgICAgIHRWZWMgPSBsb2NhbFBvaW50QTtcbiAgICAgICAgICAgIHRNYXQgPSB0cmFuc2Zvcm1BLlI7XG4gICAgICAgICAgICBwb2ludEFYID0gdHJhbnNmb3JtQS5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xuICAgICAgICAgICAgcG9pbnRBWSA9IHRyYW5zZm9ybUEucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55KTtcbiAgICAgICAgICAgIHNnbiA9IChwb2ludEFYIC0gcG9pbnRCWCkgKiBub3JtYWxYICsgKHBvaW50QVkgLSBwb2ludEJZKSAqIG5vcm1hbFk7XG4gICAgICAgICAgICBpZiAocyA8IDAuMCkge1xuICAgICAgICAgICAgICAgdGhpcy5tX2F4aXMuTmVnYXRpdmVTZWxmKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICB9XG4gICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubV90eXBlID0gYjJTZXBhcmF0aW9uRnVuY3Rpb24uZV9mYWNlQTtcbiAgICAgICAgICAgIHRoaXMubV9heGlzID0gYjJNYXRoLkNyb3NzVkYoYjJNYXRoLlN1YnRyYWN0VlYobG9jYWxQb2ludEEyLCBsb2NhbFBvaW50QTEpLCAxLjApO1xuICAgICAgICAgICAgdGhpcy5tX2xvY2FsUG9pbnQgPSBsb2NhbFBvaW50QTtcbiAgICAgICAgICAgIHRWZWMgPSB0aGlzLm1fYXhpcztcbiAgICAgICAgICAgIHRNYXQgPSB0cmFuc2Zvcm1BLlI7XG4gICAgICAgICAgICBub3JtYWxYID0gdE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueTtcbiAgICAgICAgICAgIG5vcm1hbFkgPSB0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55O1xuICAgICAgICAgICAgdFZlYyA9IHRoaXMubV9sb2NhbFBvaW50O1xuICAgICAgICAgICAgdE1hdCA9IHRyYW5zZm9ybUEuUjtcbiAgICAgICAgICAgIHBvaW50QVggPSB0cmFuc2Zvcm1BLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XG4gICAgICAgICAgICBwb2ludEFZID0gdHJhbnNmb3JtQS5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xuICAgICAgICAgICAgdFZlYyA9IGxvY2FsUG9pbnRCO1xuICAgICAgICAgICAgdE1hdCA9IHRyYW5zZm9ybUIuUjtcbiAgICAgICAgICAgIHBvaW50QlggPSB0cmFuc2Zvcm1CLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XG4gICAgICAgICAgICBwb2ludEJZID0gdHJhbnNmb3JtQi5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xuICAgICAgICAgICAgc2duID0gKHBvaW50QlggLSBwb2ludEFYKSAqIG5vcm1hbFggKyAocG9pbnRCWSAtIHBvaW50QVkpICogbm9ybWFsWTtcbiAgICAgICAgICAgIGlmIChzIDwgMC4wKSB7XG4gICAgICAgICAgICAgICB0aGlzLm1fYXhpcy5OZWdhdGl2ZVNlbGYoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgIH1cbiAgICAgIH1cbiAgIH1cbiAgIGIyU2VwYXJhdGlvbkZ1bmN0aW9uLnByb3RvdHlwZS5FdmFsdWF0ZSA9IGZ1bmN0aW9uICh0cmFuc2Zvcm1BLCB0cmFuc2Zvcm1CKSB7XG4gICAgICB2YXIgYXhpc0E7XG4gICAgICB2YXIgYXhpc0I7XG4gICAgICB2YXIgbG9jYWxQb2ludEE7XG4gICAgICB2YXIgbG9jYWxQb2ludEI7XG4gICAgICB2YXIgcG9pbnRBO1xuICAgICAgdmFyIHBvaW50QjtcbiAgICAgIHZhciBzZXBlcmF0aW9uID0gMDtcbiAgICAgIHZhciBub3JtYWw7XG4gICAgICBzd2l0Y2ggKHRoaXMubV90eXBlKSB7XG4gICAgICBjYXNlIGIyU2VwYXJhdGlvbkZ1bmN0aW9uLmVfcG9pbnRzOlxuICAgICAgICAge1xuICAgICAgICAgICAgYXhpc0EgPSBiMk1hdGguTXVsVE1WKHRyYW5zZm9ybUEuUiwgdGhpcy5tX2F4aXMpO1xuICAgICAgICAgICAgYXhpc0IgPSBiMk1hdGguTXVsVE1WKHRyYW5zZm9ybUIuUiwgdGhpcy5tX2F4aXMuR2V0TmVnYXRpdmUoKSk7XG4gICAgICAgICAgICBsb2NhbFBvaW50QSA9IHRoaXMubV9wcm94eUEuR2V0U3VwcG9ydFZlcnRleChheGlzQSk7XG4gICAgICAgICAgICBsb2NhbFBvaW50QiA9IHRoaXMubV9wcm94eUIuR2V0U3VwcG9ydFZlcnRleChheGlzQik7XG4gICAgICAgICAgICBwb2ludEEgPSBiMk1hdGguTXVsWCh0cmFuc2Zvcm1BLCBsb2NhbFBvaW50QSk7XG4gICAgICAgICAgICBwb2ludEIgPSBiMk1hdGguTXVsWCh0cmFuc2Zvcm1CLCBsb2NhbFBvaW50Qik7XG4gICAgICAgICAgICBzZXBlcmF0aW9uID0gKHBvaW50Qi54IC0gcG9pbnRBLngpICogdGhpcy5tX2F4aXMueCArIChwb2ludEIueSAtIHBvaW50QS55KSAqIHRoaXMubV9heGlzLnk7XG4gICAgICAgICAgICByZXR1cm4gc2VwZXJhdGlvbjtcbiAgICAgICAgIH1cbiAgICAgIGNhc2UgYjJTZXBhcmF0aW9uRnVuY3Rpb24uZV9mYWNlQTpcbiAgICAgICAgIHtcbiAgICAgICAgICAgIG5vcm1hbCA9IGIyTWF0aC5NdWxNVih0cmFuc2Zvcm1BLlIsIHRoaXMubV9heGlzKTtcbiAgICAgICAgICAgIHBvaW50QSA9IGIyTWF0aC5NdWxYKHRyYW5zZm9ybUEsIHRoaXMubV9sb2NhbFBvaW50KTtcbiAgICAgICAgICAgIGF4aXNCID0gYjJNYXRoLk11bFRNVih0cmFuc2Zvcm1CLlIsIG5vcm1hbC5HZXROZWdhdGl2ZSgpKTtcbiAgICAgICAgICAgIGxvY2FsUG9pbnRCID0gdGhpcy5tX3Byb3h5Qi5HZXRTdXBwb3J0VmVydGV4KGF4aXNCKTtcbiAgICAgICAgICAgIHBvaW50QiA9IGIyTWF0aC5NdWxYKHRyYW5zZm9ybUIsIGxvY2FsUG9pbnRCKTtcbiAgICAgICAgICAgIHNlcGVyYXRpb24gPSAocG9pbnRCLnggLSBwb2ludEEueCkgKiBub3JtYWwueCArIChwb2ludEIueSAtIHBvaW50QS55KSAqIG5vcm1hbC55O1xuICAgICAgICAgICAgcmV0dXJuIHNlcGVyYXRpb247XG4gICAgICAgICB9XG4gICAgICBjYXNlIGIyU2VwYXJhdGlvbkZ1bmN0aW9uLmVfZmFjZUI6XG4gICAgICAgICB7XG4gICAgICAgICAgICBub3JtYWwgPSBiMk1hdGguTXVsTVYodHJhbnNmb3JtQi5SLCB0aGlzLm1fYXhpcyk7XG4gICAgICAgICAgICBwb2ludEIgPSBiMk1hdGguTXVsWCh0cmFuc2Zvcm1CLCB0aGlzLm1fbG9jYWxQb2ludCk7XG4gICAgICAgICAgICBheGlzQSA9IGIyTWF0aC5NdWxUTVYodHJhbnNmb3JtQS5SLCBub3JtYWwuR2V0TmVnYXRpdmUoKSk7XG4gICAgICAgICAgICBsb2NhbFBvaW50QSA9IHRoaXMubV9wcm94eUEuR2V0U3VwcG9ydFZlcnRleChheGlzQSk7XG4gICAgICAgICAgICBwb2ludEEgPSBiMk1hdGguTXVsWCh0cmFuc2Zvcm1BLCBsb2NhbFBvaW50QSk7XG4gICAgICAgICAgICBzZXBlcmF0aW9uID0gKHBvaW50QS54IC0gcG9pbnRCLngpICogbm9ybWFsLnggKyAocG9pbnRBLnkgLSBwb2ludEIueSkgKiBub3JtYWwueTtcbiAgICAgICAgICAgIHJldHVybiBzZXBlcmF0aW9uO1xuICAgICAgICAgfVxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgIGIyU2V0dGluZ3MuYjJBc3NlcnQoZmFsc2UpO1xuICAgICAgICAgcmV0dXJuIDAuMDtcbiAgICAgIH1cbiAgIH1cbiAgIEJveDJELnBvc3REZWZzLnB1c2goZnVuY3Rpb24gKCkge1xuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyU2VwYXJhdGlvbkZ1bmN0aW9uLmVfcG9pbnRzID0gMHgwMTtcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMlNlcGFyYXRpb25GdW5jdGlvbi5lX2ZhY2VBID0gMHgwMjtcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMlNlcGFyYXRpb25GdW5jdGlvbi5lX2ZhY2VCID0gMHgwNDtcbiAgIH0pO1xuICAgYjJTaW1wbGV4LmIyU2ltcGxleCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMubV92MSA9IG5ldyBiMlNpbXBsZXhWZXJ0ZXgoKTtcbiAgICAgIHRoaXMubV92MiA9IG5ldyBiMlNpbXBsZXhWZXJ0ZXgoKTtcbiAgICAgIHRoaXMubV92MyA9IG5ldyBiMlNpbXBsZXhWZXJ0ZXgoKTtcbiAgICAgIHRoaXMubV92ZXJ0aWNlcyA9IG5ldyBWZWN0b3IoMyk7XG4gICB9O1xuICAgYjJTaW1wbGV4LnByb3RvdHlwZS5iMlNpbXBsZXggPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLm1fdmVydGljZXNbMF0gPSB0aGlzLm1fdjE7XG4gICAgICB0aGlzLm1fdmVydGljZXNbMV0gPSB0aGlzLm1fdjI7XG4gICAgICB0aGlzLm1fdmVydGljZXNbMl0gPSB0aGlzLm1fdjM7XG4gICB9XG4gICBiMlNpbXBsZXgucHJvdG90eXBlLlJlYWRDYWNoZSA9IGZ1bmN0aW9uIChjYWNoZSwgcHJveHlBLCB0cmFuc2Zvcm1BLCBwcm94eUIsIHRyYW5zZm9ybUIpIHtcbiAgICAgIGIyU2V0dGluZ3MuYjJBc3NlcnQoMCA8PSBjYWNoZS5jb3VudCAmJiBjYWNoZS5jb3VudCA8PSAzKTtcbiAgICAgIHZhciB3QUxvY2FsO1xuICAgICAgdmFyIHdCTG9jYWw7XG4gICAgICB0aGlzLm1fY291bnQgPSBjYWNoZS5jb3VudDtcbiAgICAgIHZhciB2ZXJ0aWNlcyA9IHRoaXMubV92ZXJ0aWNlcztcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2NvdW50OyBpKyspIHtcbiAgICAgICAgIHZhciB2ID0gdmVydGljZXNbaV07XG4gICAgICAgICB2LmluZGV4QSA9IGNhY2hlLmluZGV4QVtpXTtcbiAgICAgICAgIHYuaW5kZXhCID0gY2FjaGUuaW5kZXhCW2ldO1xuICAgICAgICAgd0FMb2NhbCA9IHByb3h5QS5HZXRWZXJ0ZXgodi5pbmRleEEpO1xuICAgICAgICAgd0JMb2NhbCA9IHByb3h5Qi5HZXRWZXJ0ZXgodi5pbmRleEIpO1xuICAgICAgICAgdi53QSA9IGIyTWF0aC5NdWxYKHRyYW5zZm9ybUEsIHdBTG9jYWwpO1xuICAgICAgICAgdi53QiA9IGIyTWF0aC5NdWxYKHRyYW5zZm9ybUIsIHdCTG9jYWwpO1xuICAgICAgICAgdi53ID0gYjJNYXRoLlN1YnRyYWN0VlYodi53Qiwgdi53QSk7XG4gICAgICAgICB2LmEgPSAwO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMubV9jb3VudCA+IDEpIHtcbiAgICAgICAgIHZhciBtZXRyaWMxID0gY2FjaGUubWV0cmljO1xuICAgICAgICAgdmFyIG1ldHJpYzIgPSB0aGlzLkdldE1ldHJpYygpO1xuICAgICAgICAgaWYgKG1ldHJpYzIgPCAuNSAqIG1ldHJpYzEgfHwgMi4wICogbWV0cmljMSA8IG1ldHJpYzIgfHwgbWV0cmljMiA8IE51bWJlci5NSU5fVkFMVUUpIHtcbiAgICAgICAgICAgIHRoaXMubV9jb3VudCA9IDA7XG4gICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5tX2NvdW50ID09IDApIHtcbiAgICAgICAgIHYgPSB2ZXJ0aWNlc1swXTtcbiAgICAgICAgIHYuaW5kZXhBID0gMDtcbiAgICAgICAgIHYuaW5kZXhCID0gMDtcbiAgICAgICAgIHdBTG9jYWwgPSBwcm94eUEuR2V0VmVydGV4KDApO1xuICAgICAgICAgd0JMb2NhbCA9IHByb3h5Qi5HZXRWZXJ0ZXgoMCk7XG4gICAgICAgICB2LndBID0gYjJNYXRoLk11bFgodHJhbnNmb3JtQSwgd0FMb2NhbCk7XG4gICAgICAgICB2LndCID0gYjJNYXRoLk11bFgodHJhbnNmb3JtQiwgd0JMb2NhbCk7XG4gICAgICAgICB2LncgPSBiMk1hdGguU3VidHJhY3RWVih2LndCLCB2LndBKTtcbiAgICAgICAgIHRoaXMubV9jb3VudCA9IDE7XG4gICAgICB9XG4gICB9XG4gICBiMlNpbXBsZXgucHJvdG90eXBlLldyaXRlQ2FjaGUgPSBmdW5jdGlvbiAoY2FjaGUpIHtcbiAgICAgIGNhY2hlLm1ldHJpYyA9IHRoaXMuR2V0TWV0cmljKCk7XG4gICAgICBjYWNoZS5jb3VudCA9IEJveDJELnBhcnNlVUludCh0aGlzLm1fY291bnQpO1xuICAgICAgdmFyIHZlcnRpY2VzID0gdGhpcy5tX3ZlcnRpY2VzO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY291bnQ7IGkrKykge1xuICAgICAgICAgY2FjaGUuaW5kZXhBW2ldID0gQm94MkQucGFyc2VVSW50KHZlcnRpY2VzW2ldLmluZGV4QSk7XG4gICAgICAgICBjYWNoZS5pbmRleEJbaV0gPSBCb3gyRC5wYXJzZVVJbnQodmVydGljZXNbaV0uaW5kZXhCKTtcbiAgICAgIH1cbiAgIH1cbiAgIGIyU2ltcGxleC5wcm90b3R5cGUuR2V0U2VhcmNoRGlyZWN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgc3dpdGNoICh0aGlzLm1fY291bnQpIHtcbiAgICAgIGNhc2UgMTpcbiAgICAgICAgIHJldHVybiB0aGlzLm1fdjEudy5HZXROZWdhdGl2ZSgpO1xuICAgICAgY2FzZSAyOlxuICAgICAgICAge1xuICAgICAgICAgICAgdmFyIGUxMiA9IGIyTWF0aC5TdWJ0cmFjdFZWKHRoaXMubV92Mi53LCB0aGlzLm1fdjEudyk7XG4gICAgICAgICAgICB2YXIgc2duID0gYjJNYXRoLkNyb3NzVlYoZTEyLCB0aGlzLm1fdjEudy5HZXROZWdhdGl2ZSgpKTtcbiAgICAgICAgICAgIGlmIChzZ24gPiAwLjApIHtcbiAgICAgICAgICAgICAgIHJldHVybiBiMk1hdGguQ3Jvc3NGVigxLjAsIGUxMik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgIHJldHVybiBiMk1hdGguQ3Jvc3NWRihlMTIsIDEuMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICB9XG4gICAgICBkZWZhdWx0OlxuICAgICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydChmYWxzZSk7XG4gICAgICAgICByZXR1cm4gbmV3IGIyVmVjMigpO1xuICAgICAgfVxuICAgfVxuICAgYjJTaW1wbGV4LnByb3RvdHlwZS5HZXRDbG9zZXN0UG9pbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBzd2l0Y2ggKHRoaXMubV9jb3VudCkge1xuICAgICAgY2FzZSAwOlxuICAgICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydChmYWxzZSk7XG4gICAgICAgICByZXR1cm4gbmV3IGIyVmVjMigpO1xuICAgICAgY2FzZSAxOlxuICAgICAgICAgcmV0dXJuIHRoaXMubV92MS53O1xuICAgICAgY2FzZSAyOlxuICAgICAgICAgcmV0dXJuIG5ldyBiMlZlYzIodGhpcy5tX3YxLmEgKiB0aGlzLm1fdjEudy54ICsgdGhpcy5tX3YyLmEgKiB0aGlzLm1fdjIudy54LCB0aGlzLm1fdjEuYSAqIHRoaXMubV92MS53LnkgKyB0aGlzLm1fdjIuYSAqIHRoaXMubV92Mi53LnkpO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgIGIyU2V0dGluZ3MuYjJBc3NlcnQoZmFsc2UpO1xuICAgICAgICAgcmV0dXJuIG5ldyBiMlZlYzIoKTtcbiAgICAgIH1cbiAgIH1cbiAgIGIyU2ltcGxleC5wcm90b3R5cGUuR2V0V2l0bmVzc1BvaW50cyA9IGZ1bmN0aW9uIChwQSwgcEIpIHtcbiAgICAgIHN3aXRjaCAodGhpcy5tX2NvdW50KSB7XG4gICAgICBjYXNlIDA6XG4gICAgICAgICBiMlNldHRpbmdzLmIyQXNzZXJ0KGZhbHNlKTtcbiAgICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAxOlxuICAgICAgICAgcEEuU2V0Vih0aGlzLm1fdjEud0EpO1xuICAgICAgICAgcEIuU2V0Vih0aGlzLm1fdjEud0IpO1xuICAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDI6XG4gICAgICAgICBwQS54ID0gdGhpcy5tX3YxLmEgKiB0aGlzLm1fdjEud0EueCArIHRoaXMubV92Mi5hICogdGhpcy5tX3YyLndBLng7XG4gICAgICAgICBwQS55ID0gdGhpcy5tX3YxLmEgKiB0aGlzLm1fdjEud0EueSArIHRoaXMubV92Mi5hICogdGhpcy5tX3YyLndBLnk7XG4gICAgICAgICBwQi54ID0gdGhpcy5tX3YxLmEgKiB0aGlzLm1fdjEud0IueCArIHRoaXMubV92Mi5hICogdGhpcy5tX3YyLndCLng7XG4gICAgICAgICBwQi55ID0gdGhpcy5tX3YxLmEgKiB0aGlzLm1fdjEud0IueSArIHRoaXMubV92Mi5hICogdGhpcy5tX3YyLndCLnk7XG4gICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMzpcbiAgICAgICAgIHBCLnggPSBwQS54ID0gdGhpcy5tX3YxLmEgKiB0aGlzLm1fdjEud0EueCArIHRoaXMubV92Mi5hICogdGhpcy5tX3YyLndBLnggKyB0aGlzLm1fdjMuYSAqIHRoaXMubV92My53QS54O1xuICAgICAgICAgcEIueSA9IHBBLnkgPSB0aGlzLm1fdjEuYSAqIHRoaXMubV92MS53QS55ICsgdGhpcy5tX3YyLmEgKiB0aGlzLm1fdjIud0EueSArIHRoaXMubV92My5hICogdGhpcy5tX3YzLndBLnk7XG4gICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgICBiMlNldHRpbmdzLmIyQXNzZXJ0KGZhbHNlKTtcbiAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgfVxuICAgYjJTaW1wbGV4LnByb3RvdHlwZS5HZXRNZXRyaWMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBzd2l0Y2ggKHRoaXMubV9jb3VudCkge1xuICAgICAgY2FzZSAwOlxuICAgICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydChmYWxzZSk7XG4gICAgICAgICByZXR1cm4gMC4wO1xuICAgICAgY2FzZSAxOlxuICAgICAgICAgcmV0dXJuIDAuMDtcbiAgICAgIGNhc2UgMjpcbiAgICAgICAgIHJldHVybiBiMk1hdGguU3VidHJhY3RWVih0aGlzLm1fdjEudywgdGhpcy5tX3YyLncpLkxlbmd0aCgpO1xuICAgICAgY2FzZSAzOlxuICAgICAgICAgcmV0dXJuIGIyTWF0aC5Dcm9zc1ZWKGIyTWF0aC5TdWJ0cmFjdFZWKHRoaXMubV92Mi53LCB0aGlzLm1fdjEudyksIGIyTWF0aC5TdWJ0cmFjdFZWKHRoaXMubV92My53LCB0aGlzLm1fdjEudykpO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgIGIyU2V0dGluZ3MuYjJBc3NlcnQoZmFsc2UpO1xuICAgICAgICAgcmV0dXJuIDAuMDtcbiAgICAgIH1cbiAgIH1cbiAgIGIyU2ltcGxleC5wcm90b3R5cGUuU29sdmUyID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHcxID0gdGhpcy5tX3YxLnc7XG4gICAgICB2YXIgdzIgPSB0aGlzLm1fdjIudztcbiAgICAgIHZhciBlMTIgPSBiMk1hdGguU3VidHJhY3RWVih3MiwgdzEpO1xuICAgICAgdmFyIGQxMl8yID0gKC0odzEueCAqIGUxMi54ICsgdzEueSAqIGUxMi55KSk7XG4gICAgICBpZiAoZDEyXzIgPD0gMC4wKSB7XG4gICAgICAgICB0aGlzLm1fdjEuYSA9IDEuMDtcbiAgICAgICAgIHRoaXMubV9jb3VudCA9IDE7XG4gICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YXIgZDEyXzEgPSAodzIueCAqIGUxMi54ICsgdzIueSAqIGUxMi55KTtcbiAgICAgIGlmIChkMTJfMSA8PSAwLjApIHtcbiAgICAgICAgIHRoaXMubV92Mi5hID0gMS4wO1xuICAgICAgICAgdGhpcy5tX2NvdW50ID0gMTtcbiAgICAgICAgIHRoaXMubV92MS5TZXQodGhpcy5tX3YyKTtcbiAgICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhciBpbnZfZDEyID0gMS4wIC8gKGQxMl8xICsgZDEyXzIpO1xuICAgICAgdGhpcy5tX3YxLmEgPSBkMTJfMSAqIGludl9kMTI7XG4gICAgICB0aGlzLm1fdjIuYSA9IGQxMl8yICogaW52X2QxMjtcbiAgICAgIHRoaXMubV9jb3VudCA9IDI7XG4gICB9XG4gICBiMlNpbXBsZXgucHJvdG90eXBlLlNvbHZlMyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB3MSA9IHRoaXMubV92MS53O1xuICAgICAgdmFyIHcyID0gdGhpcy5tX3YyLnc7XG4gICAgICB2YXIgdzMgPSB0aGlzLm1fdjMudztcbiAgICAgIHZhciBlMTIgPSBiMk1hdGguU3VidHJhY3RWVih3MiwgdzEpO1xuICAgICAgdmFyIHcxZTEyID0gYjJNYXRoLkRvdCh3MSwgZTEyKTtcbiAgICAgIHZhciB3MmUxMiA9IGIyTWF0aC5Eb3QodzIsIGUxMik7XG4gICAgICB2YXIgZDEyXzEgPSB3MmUxMjtcbiAgICAgIHZhciBkMTJfMiA9ICgtdzFlMTIpO1xuICAgICAgdmFyIGUxMyA9IGIyTWF0aC5TdWJ0cmFjdFZWKHczLCB3MSk7XG4gICAgICB2YXIgdzFlMTMgPSBiMk1hdGguRG90KHcxLCBlMTMpO1xuICAgICAgdmFyIHczZTEzID0gYjJNYXRoLkRvdCh3MywgZTEzKTtcbiAgICAgIHZhciBkMTNfMSA9IHczZTEzO1xuICAgICAgdmFyIGQxM18yID0gKC13MWUxMyk7XG4gICAgICB2YXIgZTIzID0gYjJNYXRoLlN1YnRyYWN0VlYodzMsIHcyKTtcbiAgICAgIHZhciB3MmUyMyA9IGIyTWF0aC5Eb3QodzIsIGUyMyk7XG4gICAgICB2YXIgdzNlMjMgPSBiMk1hdGguRG90KHczLCBlMjMpO1xuICAgICAgdmFyIGQyM18xID0gdzNlMjM7XG4gICAgICB2YXIgZDIzXzIgPSAoLXcyZTIzKTtcbiAgICAgIHZhciBuMTIzID0gYjJNYXRoLkNyb3NzVlYoZTEyLCBlMTMpO1xuICAgICAgdmFyIGQxMjNfMSA9IG4xMjMgKiBiMk1hdGguQ3Jvc3NWVih3MiwgdzMpO1xuICAgICAgdmFyIGQxMjNfMiA9IG4xMjMgKiBiMk1hdGguQ3Jvc3NWVih3MywgdzEpO1xuICAgICAgdmFyIGQxMjNfMyA9IG4xMjMgKiBiMk1hdGguQ3Jvc3NWVih3MSwgdzIpO1xuICAgICAgaWYgKGQxMl8yIDw9IDAuMCAmJiBkMTNfMiA8PSAwLjApIHtcbiAgICAgICAgIHRoaXMubV92MS5hID0gMS4wO1xuICAgICAgICAgdGhpcy5tX2NvdW50ID0gMTtcbiAgICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmIChkMTJfMSA+IDAuMCAmJiBkMTJfMiA+IDAuMCAmJiBkMTIzXzMgPD0gMC4wKSB7XG4gICAgICAgICB2YXIgaW52X2QxMiA9IDEuMCAvIChkMTJfMSArIGQxMl8yKTtcbiAgICAgICAgIHRoaXMubV92MS5hID0gZDEyXzEgKiBpbnZfZDEyO1xuICAgICAgICAgdGhpcy5tX3YyLmEgPSBkMTJfMiAqIGludl9kMTI7XG4gICAgICAgICB0aGlzLm1fY291bnQgPSAyO1xuICAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKGQxM18xID4gMC4wICYmIGQxM18yID4gMC4wICYmIGQxMjNfMiA8PSAwLjApIHtcbiAgICAgICAgIHZhciBpbnZfZDEzID0gMS4wIC8gKGQxM18xICsgZDEzXzIpO1xuICAgICAgICAgdGhpcy5tX3YxLmEgPSBkMTNfMSAqIGludl9kMTM7XG4gICAgICAgICB0aGlzLm1fdjMuYSA9IGQxM18yICogaW52X2QxMztcbiAgICAgICAgIHRoaXMubV9jb3VudCA9IDI7XG4gICAgICAgICB0aGlzLm1fdjIuU2V0KHRoaXMubV92Myk7XG4gICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoZDEyXzEgPD0gMC4wICYmIGQyM18yIDw9IDAuMCkge1xuICAgICAgICAgdGhpcy5tX3YyLmEgPSAxLjA7XG4gICAgICAgICB0aGlzLm1fY291bnQgPSAxO1xuICAgICAgICAgdGhpcy5tX3YxLlNldCh0aGlzLm1fdjIpO1xuICAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKGQxM18xIDw9IDAuMCAmJiBkMjNfMSA8PSAwLjApIHtcbiAgICAgICAgIHRoaXMubV92My5hID0gMS4wO1xuICAgICAgICAgdGhpcy5tX2NvdW50ID0gMTtcbiAgICAgICAgIHRoaXMubV92MS5TZXQodGhpcy5tX3YzKTtcbiAgICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmIChkMjNfMSA+IDAuMCAmJiBkMjNfMiA+IDAuMCAmJiBkMTIzXzEgPD0gMC4wKSB7XG4gICAgICAgICB2YXIgaW52X2QyMyA9IDEuMCAvIChkMjNfMSArIGQyM18yKTtcbiAgICAgICAgIHRoaXMubV92Mi5hID0gZDIzXzEgKiBpbnZfZDIzO1xuICAgICAgICAgdGhpcy5tX3YzLmEgPSBkMjNfMiAqIGludl9kMjM7XG4gICAgICAgICB0aGlzLm1fY291bnQgPSAyO1xuICAgICAgICAgdGhpcy5tX3YxLlNldCh0aGlzLm1fdjMpO1xuICAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdmFyIGludl9kMTIzID0gMS4wIC8gKGQxMjNfMSArIGQxMjNfMiArIGQxMjNfMyk7XG4gICAgICB0aGlzLm1fdjEuYSA9IGQxMjNfMSAqIGludl9kMTIzO1xuICAgICAgdGhpcy5tX3YyLmEgPSBkMTIzXzIgKiBpbnZfZDEyMztcbiAgICAgIHRoaXMubV92My5hID0gZDEyM18zICogaW52X2QxMjM7XG4gICAgICB0aGlzLm1fY291bnQgPSAzO1xuICAgfVxuICAgYjJTaW1wbGV4Q2FjaGUuYjJTaW1wbGV4Q2FjaGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLmluZGV4QSA9IG5ldyBWZWN0b3JfYTJqX051bWJlcigzKTtcbiAgICAgIHRoaXMuaW5kZXhCID0gbmV3IFZlY3Rvcl9hMmpfTnVtYmVyKDMpO1xuICAgfTtcbiAgIGIyU2ltcGxleFZlcnRleC5iMlNpbXBsZXhWZXJ0ZXggPSBmdW5jdGlvbiAoKSB7fTtcbiAgIGIyU2ltcGxleFZlcnRleC5wcm90b3R5cGUuU2V0ID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgICB0aGlzLndBLlNldFYob3RoZXIud0EpO1xuICAgICAgdGhpcy53Qi5TZXRWKG90aGVyLndCKTtcbiAgICAgIHRoaXMudy5TZXRWKG90aGVyLncpO1xuICAgICAgdGhpcy5hID0gb3RoZXIuYTtcbiAgICAgIHRoaXMuaW5kZXhBID0gb3RoZXIuaW5kZXhBO1xuICAgICAgdGhpcy5pbmRleEIgPSBvdGhlci5pbmRleEI7XG4gICB9XG4gICBiMlRpbWVPZkltcGFjdC5iMlRpbWVPZkltcGFjdCA9IGZ1bmN0aW9uICgpIHt9O1xuICAgYjJUaW1lT2ZJbXBhY3QuVGltZU9mSW1wYWN0ID0gZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICArK2IyVGltZU9mSW1wYWN0LmIyX3RvaUNhbGxzO1xuICAgICAgdmFyIHByb3h5QSA9IGlucHV0LnByb3h5QTtcbiAgICAgIHZhciBwcm94eUIgPSBpbnB1dC5wcm94eUI7XG4gICAgICB2YXIgc3dlZXBBID0gaW5wdXQuc3dlZXBBO1xuICAgICAgdmFyIHN3ZWVwQiA9IGlucHV0LnN3ZWVwQjtcbiAgICAgIGIyU2V0dGluZ3MuYjJBc3NlcnQoc3dlZXBBLnQwID09IHN3ZWVwQi50MCk7XG4gICAgICBiMlNldHRpbmdzLmIyQXNzZXJ0KDEuMCAtIHN3ZWVwQS50MCA+IE51bWJlci5NSU5fVkFMVUUpO1xuICAgICAgdmFyIHJhZGl1cyA9IHByb3h5QS5tX3JhZGl1cyArIHByb3h5Qi5tX3JhZGl1cztcbiAgICAgIHZhciB0b2xlcmFuY2UgPSBpbnB1dC50b2xlcmFuY2U7XG4gICAgICB2YXIgYWxwaGEgPSAwLjA7XG4gICAgICB2YXIga19tYXhJdGVyYXRpb25zID0gMTAwMDtcbiAgICAgIHZhciBpdGVyID0gMDtcbiAgICAgIHZhciB0YXJnZXQgPSAwLjA7XG4gICAgICBiMlRpbWVPZkltcGFjdC5zX2NhY2hlLmNvdW50ID0gMDtcbiAgICAgIGIyVGltZU9mSW1wYWN0LnNfZGlzdGFuY2VJbnB1dC51c2VSYWRpaSA9IGZhbHNlO1xuICAgICAgZm9yICg7Oykge1xuICAgICAgICAgc3dlZXBBLkdldFRyYW5zZm9ybShiMlRpbWVPZkltcGFjdC5zX3hmQSwgYWxwaGEpO1xuICAgICAgICAgc3dlZXBCLkdldFRyYW5zZm9ybShiMlRpbWVPZkltcGFjdC5zX3hmQiwgYWxwaGEpO1xuICAgICAgICAgYjJUaW1lT2ZJbXBhY3Quc19kaXN0YW5jZUlucHV0LnByb3h5QSA9IHByb3h5QTtcbiAgICAgICAgIGIyVGltZU9mSW1wYWN0LnNfZGlzdGFuY2VJbnB1dC5wcm94eUIgPSBwcm94eUI7XG4gICAgICAgICBiMlRpbWVPZkltcGFjdC5zX2Rpc3RhbmNlSW5wdXQudHJhbnNmb3JtQSA9IGIyVGltZU9mSW1wYWN0LnNfeGZBO1xuICAgICAgICAgYjJUaW1lT2ZJbXBhY3Quc19kaXN0YW5jZUlucHV0LnRyYW5zZm9ybUIgPSBiMlRpbWVPZkltcGFjdC5zX3hmQjtcbiAgICAgICAgIGIyRGlzdGFuY2UuRGlzdGFuY2UoYjJUaW1lT2ZJbXBhY3Quc19kaXN0YW5jZU91dHB1dCwgYjJUaW1lT2ZJbXBhY3Quc19jYWNoZSwgYjJUaW1lT2ZJbXBhY3Quc19kaXN0YW5jZUlucHV0KTtcbiAgICAgICAgIGlmIChiMlRpbWVPZkltcGFjdC5zX2Rpc3RhbmNlT3V0cHV0LmRpc3RhbmNlIDw9IDAuMCkge1xuICAgICAgICAgICAgYWxwaGEgPSAxLjA7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgIH1cbiAgICAgICAgIGIyVGltZU9mSW1wYWN0LnNfZmNuLkluaXRpYWxpemUoYjJUaW1lT2ZJbXBhY3Quc19jYWNoZSwgcHJveHlBLCBiMlRpbWVPZkltcGFjdC5zX3hmQSwgcHJveHlCLCBiMlRpbWVPZkltcGFjdC5zX3hmQik7XG4gICAgICAgICB2YXIgc2VwYXJhdGlvbiA9IGIyVGltZU9mSW1wYWN0LnNfZmNuLkV2YWx1YXRlKGIyVGltZU9mSW1wYWN0LnNfeGZBLCBiMlRpbWVPZkltcGFjdC5zX3hmQik7XG4gICAgICAgICBpZiAoc2VwYXJhdGlvbiA8PSAwLjApIHtcbiAgICAgICAgICAgIGFscGhhID0gMS4wO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICB9XG4gICAgICAgICBpZiAoaXRlciA9PSAwKSB7XG4gICAgICAgICAgICBpZiAoc2VwYXJhdGlvbiA+IHJhZGl1cykge1xuICAgICAgICAgICAgICAgdGFyZ2V0ID0gYjJNYXRoLk1heChyYWRpdXMgLSB0b2xlcmFuY2UsIDAuNzUgKiByYWRpdXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICB0YXJnZXQgPSBiMk1hdGguTWF4KHNlcGFyYXRpb24gLSB0b2xlcmFuY2UsIDAuMDIgKiByYWRpdXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgfVxuICAgICAgICAgaWYgKHNlcGFyYXRpb24gLSB0YXJnZXQgPCAwLjUgKiB0b2xlcmFuY2UpIHtcbiAgICAgICAgICAgIGlmIChpdGVyID09IDApIHtcbiAgICAgICAgICAgICAgIGFscGhhID0gMS4wO1xuICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgIH1cbiAgICAgICAgIHZhciBuZXdBbHBoYSA9IGFscGhhOyB7XG4gICAgICAgICAgICB2YXIgeDEgPSBhbHBoYTtcbiAgICAgICAgICAgIHZhciB4MiA9IDEuMDtcbiAgICAgICAgICAgIHZhciBmMSA9IHNlcGFyYXRpb247XG4gICAgICAgICAgICBzd2VlcEEuR2V0VHJhbnNmb3JtKGIyVGltZU9mSW1wYWN0LnNfeGZBLCB4Mik7XG4gICAgICAgICAgICBzd2VlcEIuR2V0VHJhbnNmb3JtKGIyVGltZU9mSW1wYWN0LnNfeGZCLCB4Mik7XG4gICAgICAgICAgICB2YXIgZjIgPSBiMlRpbWVPZkltcGFjdC5zX2Zjbi5FdmFsdWF0ZShiMlRpbWVPZkltcGFjdC5zX3hmQSwgYjJUaW1lT2ZJbXBhY3Quc194ZkIpO1xuICAgICAgICAgICAgaWYgKGYyID49IHRhcmdldCkge1xuICAgICAgICAgICAgICAgYWxwaGEgPSAxLjA7XG4gICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciByb290SXRlckNvdW50ID0gMDtcbiAgICAgICAgICAgIGZvciAoOzspIHtcbiAgICAgICAgICAgICAgIHZhciB4ID0gMDtcbiAgICAgICAgICAgICAgIGlmIChyb290SXRlckNvdW50ICYgMSkge1xuICAgICAgICAgICAgICAgICAgeCA9IHgxICsgKHRhcmdldCAtIGYxKSAqICh4MiAtIHgxKSAvIChmMiAtIGYxKTtcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgeCA9IDAuNSAqICh4MSArIHgyKTtcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgIHN3ZWVwQS5HZXRUcmFuc2Zvcm0oYjJUaW1lT2ZJbXBhY3Quc194ZkEsIHgpO1xuICAgICAgICAgICAgICAgc3dlZXBCLkdldFRyYW5zZm9ybShiMlRpbWVPZkltcGFjdC5zX3hmQiwgeCk7XG4gICAgICAgICAgICAgICB2YXIgZiA9IGIyVGltZU9mSW1wYWN0LnNfZmNuLkV2YWx1YXRlKGIyVGltZU9mSW1wYWN0LnNfeGZBLCBiMlRpbWVPZkltcGFjdC5zX3hmQik7XG4gICAgICAgICAgICAgICBpZiAoYjJNYXRoLkFicyhmIC0gdGFyZ2V0KSA8IDAuMDI1ICogdG9sZXJhbmNlKSB7XG4gICAgICAgICAgICAgICAgICBuZXdBbHBoYSA9IHg7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgIGlmIChmID4gdGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgICB4MSA9IHg7XG4gICAgICAgICAgICAgICAgICBmMSA9IGY7XG4gICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHgyID0geDtcbiAgICAgICAgICAgICAgICAgIGYyID0gZjtcbiAgICAgICAgICAgICAgIH0rK3Jvb3RJdGVyQ291bnQ7XG4gICAgICAgICAgICAgICArK2IyVGltZU9mSW1wYWN0LmIyX3RvaVJvb3RJdGVycztcbiAgICAgICAgICAgICAgIGlmIChyb290SXRlckNvdW50ID09IDUwKSB7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGIyVGltZU9mSW1wYWN0LmIyX3RvaU1heFJvb3RJdGVycyA9IGIyTWF0aC5NYXgoYjJUaW1lT2ZJbXBhY3QuYjJfdG9pTWF4Um9vdEl0ZXJzLCByb290SXRlckNvdW50KTtcbiAgICAgICAgIH1cbiAgICAgICAgIGlmIChuZXdBbHBoYSA8ICgxLjAgKyAxMDAuMCAqIE51bWJlci5NSU5fVkFMVUUpICogYWxwaGEpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgfVxuICAgICAgICAgYWxwaGEgPSBuZXdBbHBoYTtcbiAgICAgICAgIGl0ZXIrKztcbiAgICAgICAgICsrYjJUaW1lT2ZJbXBhY3QuYjJfdG9pSXRlcnM7XG4gICAgICAgICBpZiAoaXRlciA9PSBrX21heEl0ZXJhdGlvbnMpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgfVxuICAgICAgfVxuICAgICAgYjJUaW1lT2ZJbXBhY3QuYjJfdG9pTWF4SXRlcnMgPSBiMk1hdGguTWF4KGIyVGltZU9mSW1wYWN0LmIyX3RvaU1heEl0ZXJzLCBpdGVyKTtcbiAgICAgIHJldHVybiBhbHBoYTtcbiAgIH1cbiAgIEJveDJELnBvc3REZWZzLnB1c2goZnVuY3Rpb24gKCkge1xuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyVGltZU9mSW1wYWN0LmIyX3RvaUNhbGxzID0gMDtcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMlRpbWVPZkltcGFjdC5iMl90b2lJdGVycyA9IDA7XG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJUaW1lT2ZJbXBhY3QuYjJfdG9pTWF4SXRlcnMgPSAwO1xuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyVGltZU9mSW1wYWN0LmIyX3RvaVJvb3RJdGVycyA9IDA7XG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJUaW1lT2ZJbXBhY3QuYjJfdG9pTWF4Um9vdEl0ZXJzID0gMDtcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMlRpbWVPZkltcGFjdC5zX2NhY2hlID0gbmV3IGIyU2ltcGxleENhY2hlKCk7XG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJUaW1lT2ZJbXBhY3Quc19kaXN0YW5jZUlucHV0ID0gbmV3IGIyRGlzdGFuY2VJbnB1dCgpO1xuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyVGltZU9mSW1wYWN0LnNfeGZBID0gbmV3IGIyVHJhbnNmb3JtKCk7XG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJUaW1lT2ZJbXBhY3Quc194ZkIgPSBuZXcgYjJUcmFuc2Zvcm0oKTtcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMlRpbWVPZkltcGFjdC5zX2ZjbiA9IG5ldyBiMlNlcGFyYXRpb25GdW5jdGlvbigpO1xuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyVGltZU9mSW1wYWN0LnNfZGlzdGFuY2VPdXRwdXQgPSBuZXcgYjJEaXN0YW5jZU91dHB1dCgpO1xuICAgfSk7XG4gICBiMlRPSUlucHV0LmIyVE9JSW5wdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLnByb3h5QSA9IG5ldyBiMkRpc3RhbmNlUHJveHkoKTtcbiAgICAgIHRoaXMucHJveHlCID0gbmV3IGIyRGlzdGFuY2VQcm94eSgpO1xuICAgICAgdGhpcy5zd2VlcEEgPSBuZXcgYjJTd2VlcCgpO1xuICAgICAgdGhpcy5zd2VlcEIgPSBuZXcgYjJTd2VlcCgpO1xuICAgfTtcbiAgIGIyV29ybGRNYW5pZm9sZC5iMldvcmxkTWFuaWZvbGQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLm1fbm9ybWFsID0gbmV3IGIyVmVjMigpO1xuICAgfTtcbiAgIGIyV29ybGRNYW5pZm9sZC5wcm90b3R5cGUuYjJXb3JsZE1hbmlmb2xkID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5tX3BvaW50cyA9IG5ldyBWZWN0b3IoYjJTZXR0aW5ncy5iMl9tYXhNYW5pZm9sZFBvaW50cyk7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGIyU2V0dGluZ3MuYjJfbWF4TWFuaWZvbGRQb2ludHM7IGkrKykge1xuICAgICAgICAgdGhpcy5tX3BvaW50c1tpXSA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIH1cbiAgIH1cbiAgIGIyV29ybGRNYW5pZm9sZC5wcm90b3R5cGUuSW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIChtYW5pZm9sZCwgeGZBLCByYWRpdXNBLCB4ZkIsIHJhZGl1c0IpIHtcbiAgICAgIGlmIChyYWRpdXNBID09PSB1bmRlZmluZWQpIHJhZGl1c0EgPSAwO1xuICAgICAgaWYgKHJhZGl1c0IgPT09IHVuZGVmaW5lZCkgcmFkaXVzQiA9IDA7XG4gICAgICBpZiAobWFuaWZvbGQubV9wb2ludENvdW50ID09IDApIHtcbiAgICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhciBpID0gMDtcbiAgICAgIHZhciB0VmVjO1xuICAgICAgdmFyIHRNYXQ7XG4gICAgICB2YXIgbm9ybWFsWCA9IDA7XG4gICAgICB2YXIgbm9ybWFsWSA9IDA7XG4gICAgICB2YXIgcGxhbmVQb2ludFggPSAwO1xuICAgICAgdmFyIHBsYW5lUG9pbnRZID0gMDtcbiAgICAgIHZhciBjbGlwUG9pbnRYID0gMDtcbiAgICAgIHZhciBjbGlwUG9pbnRZID0gMDtcbiAgICAgIHN3aXRjaCAobWFuaWZvbGQubV90eXBlKSB7XG4gICAgICBjYXNlIGIyTWFuaWZvbGQuZV9jaXJjbGVzOlxuICAgICAgICAge1xuICAgICAgICAgICAgdE1hdCA9IHhmQS5SO1xuICAgICAgICAgICAgdFZlYyA9IG1hbmlmb2xkLm1fbG9jYWxQb2ludDtcbiAgICAgICAgICAgIHZhciBwb2ludEFYID0geGZBLnBvc2l0aW9uLnggKyB0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55O1xuICAgICAgICAgICAgdmFyIHBvaW50QVkgPSB4ZkEucG9zaXRpb24ueSArIHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnk7XG4gICAgICAgICAgICB0TWF0ID0geGZCLlI7XG4gICAgICAgICAgICB0VmVjID0gbWFuaWZvbGQubV9wb2ludHNbMF0ubV9sb2NhbFBvaW50O1xuICAgICAgICAgICAgdmFyIHBvaW50QlggPSB4ZkIucG9zaXRpb24ueCArIHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnk7XG4gICAgICAgICAgICB2YXIgcG9pbnRCWSA9IHhmQi5wb3NpdGlvbi55ICsgdE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueTtcbiAgICAgICAgICAgIHZhciBkWCA9IHBvaW50QlggLSBwb2ludEFYO1xuICAgICAgICAgICAgdmFyIGRZID0gcG9pbnRCWSAtIHBvaW50QVk7XG4gICAgICAgICAgICB2YXIgZDIgPSBkWCAqIGRYICsgZFkgKiBkWTtcbiAgICAgICAgICAgIGlmIChkMiA+IE51bWJlci5NSU5fVkFMVUUgKiBOdW1iZXIuTUlOX1ZBTFVFKSB7XG4gICAgICAgICAgICAgICB2YXIgZCA9IE1hdGguc3FydChkMik7XG4gICAgICAgICAgICAgICB0aGlzLm1fbm9ybWFsLnggPSBkWCAvIGQ7XG4gICAgICAgICAgICAgICB0aGlzLm1fbm9ybWFsLnkgPSBkWSAvIGQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgIHRoaXMubV9ub3JtYWwueCA9IDE7XG4gICAgICAgICAgICAgICB0aGlzLm1fbm9ybWFsLnkgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGNBWCA9IHBvaW50QVggKyByYWRpdXNBICogdGhpcy5tX25vcm1hbC54O1xuICAgICAgICAgICAgdmFyIGNBWSA9IHBvaW50QVkgKyByYWRpdXNBICogdGhpcy5tX25vcm1hbC55O1xuICAgICAgICAgICAgdmFyIGNCWCA9IHBvaW50QlggLSByYWRpdXNCICogdGhpcy5tX25vcm1hbC54O1xuICAgICAgICAgICAgdmFyIGNCWSA9IHBvaW50QlkgLSByYWRpdXNCICogdGhpcy5tX25vcm1hbC55O1xuICAgICAgICAgICAgdGhpcy5tX3BvaW50c1swXS54ID0gMC41ICogKGNBWCArIGNCWCk7XG4gICAgICAgICAgICB0aGlzLm1fcG9pbnRzWzBdLnkgPSAwLjUgKiAoY0FZICsgY0JZKTtcbiAgICAgICAgIH1cbiAgICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBiMk1hbmlmb2xkLmVfZmFjZUE6XG4gICAgICAgICB7XG4gICAgICAgICAgICB0TWF0ID0geGZBLlI7XG4gICAgICAgICAgICB0VmVjID0gbWFuaWZvbGQubV9sb2NhbFBsYW5lTm9ybWFsO1xuICAgICAgICAgICAgbm9ybWFsWCA9IHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnk7XG4gICAgICAgICAgICBub3JtYWxZID0gdE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueTtcbiAgICAgICAgICAgIHRNYXQgPSB4ZkEuUjtcbiAgICAgICAgICAgIHRWZWMgPSBtYW5pZm9sZC5tX2xvY2FsUG9pbnQ7XG4gICAgICAgICAgICBwbGFuZVBvaW50WCA9IHhmQS5wb3NpdGlvbi54ICsgdE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueTtcbiAgICAgICAgICAgIHBsYW5lUG9pbnRZID0geGZBLnBvc2l0aW9uLnkgKyB0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55O1xuICAgICAgICAgICAgdGhpcy5tX25vcm1hbC54ID0gbm9ybWFsWDtcbiAgICAgICAgICAgIHRoaXMubV9ub3JtYWwueSA9IG5vcm1hbFk7XG4gICAgICAgICAgICBmb3IgKGkgPSAwO1xuICAgICAgICAgICAgaSA8IG1hbmlmb2xkLm1fcG9pbnRDb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICB0TWF0ID0geGZCLlI7XG4gICAgICAgICAgICAgICB0VmVjID0gbWFuaWZvbGQubV9wb2ludHNbaV0ubV9sb2NhbFBvaW50O1xuICAgICAgICAgICAgICAgY2xpcFBvaW50WCA9IHhmQi5wb3NpdGlvbi54ICsgdE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueTtcbiAgICAgICAgICAgICAgIGNsaXBQb2ludFkgPSB4ZkIucG9zaXRpb24ueSArIHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnk7XG4gICAgICAgICAgICAgICB0aGlzLm1fcG9pbnRzW2ldLnggPSBjbGlwUG9pbnRYICsgMC41ICogKHJhZGl1c0EgLSAoY2xpcFBvaW50WCAtIHBsYW5lUG9pbnRYKSAqIG5vcm1hbFggLSAoY2xpcFBvaW50WSAtIHBsYW5lUG9pbnRZKSAqIG5vcm1hbFkgLSByYWRpdXNCKSAqIG5vcm1hbFg7XG4gICAgICAgICAgICAgICB0aGlzLm1fcG9pbnRzW2ldLnkgPSBjbGlwUG9pbnRZICsgMC41ICogKHJhZGl1c0EgLSAoY2xpcFBvaW50WCAtIHBsYW5lUG9pbnRYKSAqIG5vcm1hbFggLSAoY2xpcFBvaW50WSAtIHBsYW5lUG9pbnRZKSAqIG5vcm1hbFkgLSByYWRpdXNCKSAqIG5vcm1hbFk7XG4gICAgICAgICAgICB9XG4gICAgICAgICB9XG4gICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgYjJNYW5pZm9sZC5lX2ZhY2VCOlxuICAgICAgICAge1xuICAgICAgICAgICAgdE1hdCA9IHhmQi5SO1xuICAgICAgICAgICAgdFZlYyA9IG1hbmlmb2xkLm1fbG9jYWxQbGFuZU5vcm1hbDtcbiAgICAgICAgICAgIG5vcm1hbFggPSB0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55O1xuICAgICAgICAgICAgbm9ybWFsWSA9IHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnk7XG4gICAgICAgICAgICB0TWF0ID0geGZCLlI7XG4gICAgICAgICAgICB0VmVjID0gbWFuaWZvbGQubV9sb2NhbFBvaW50O1xuICAgICAgICAgICAgcGxhbmVQb2ludFggPSB4ZkIucG9zaXRpb24ueCArIHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnk7XG4gICAgICAgICAgICBwbGFuZVBvaW50WSA9IHhmQi5wb3NpdGlvbi55ICsgdE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueTtcbiAgICAgICAgICAgIHRoaXMubV9ub3JtYWwueCA9ICgtbm9ybWFsWCk7XG4gICAgICAgICAgICB0aGlzLm1fbm9ybWFsLnkgPSAoLW5vcm1hbFkpO1xuICAgICAgICAgICAgZm9yIChpID0gMDtcbiAgICAgICAgICAgIGkgPCBtYW5pZm9sZC5tX3BvaW50Q291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgdE1hdCA9IHhmQS5SO1xuICAgICAgICAgICAgICAgdFZlYyA9IG1hbmlmb2xkLm1fcG9pbnRzW2ldLm1fbG9jYWxQb2ludDtcbiAgICAgICAgICAgICAgIGNsaXBQb2ludFggPSB4ZkEucG9zaXRpb24ueCArIHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnk7XG4gICAgICAgICAgICAgICBjbGlwUG9pbnRZID0geGZBLnBvc2l0aW9uLnkgKyB0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55O1xuICAgICAgICAgICAgICAgdGhpcy5tX3BvaW50c1tpXS54ID0gY2xpcFBvaW50WCArIDAuNSAqIChyYWRpdXNCIC0gKGNsaXBQb2ludFggLSBwbGFuZVBvaW50WCkgKiBub3JtYWxYIC0gKGNsaXBQb2ludFkgLSBwbGFuZVBvaW50WSkgKiBub3JtYWxZIC0gcmFkaXVzQSkgKiBub3JtYWxYO1xuICAgICAgICAgICAgICAgdGhpcy5tX3BvaW50c1tpXS55ID0gY2xpcFBvaW50WSArIDAuNSAqIChyYWRpdXNCIC0gKGNsaXBQb2ludFggLSBwbGFuZVBvaW50WCkgKiBub3JtYWxYIC0gKGNsaXBQb2ludFkgLSBwbGFuZVBvaW50WSkgKiBub3JtYWxZIC0gcmFkaXVzQSkgKiBub3JtYWxZO1xuICAgICAgICAgICAgfVxuICAgICAgICAgfVxuICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICB9XG4gICBDbGlwVmVydGV4LkNsaXBWZXJ0ZXggPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLnYgPSBuZXcgYjJWZWMyKCk7XG4gICAgICB0aGlzLmlkID0gbmV3IGIyQ29udGFjdElEKCk7XG4gICB9O1xuICAgQ2xpcFZlcnRleC5wcm90b3R5cGUuU2V0ID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgICB0aGlzLnYuU2V0VihvdGhlci52KTtcbiAgICAgIHRoaXMuaWQuU2V0KG90aGVyLmlkKTtcbiAgIH1cbiAgIEZlYXR1cmVzLkZlYXR1cmVzID0gZnVuY3Rpb24gKCkge307XG4gICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmVhdHVyZXMucHJvdG90eXBlLCAncmVmZXJlbmNlRWRnZScsIHtcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICByZXR1cm4gdGhpcy5fcmVmZXJlbmNlRWRnZTtcbiAgICAgIH1cbiAgIH0pO1xuICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZlYXR1cmVzLnByb3RvdHlwZSwgJ3JlZmVyZW5jZUVkZ2UnLCB7XG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgdmFsdWUgPSAwO1xuICAgICAgICAgdGhpcy5fcmVmZXJlbmNlRWRnZSA9IHZhbHVlO1xuICAgICAgICAgdGhpcy5fbV9pZC5fa2V5ID0gKHRoaXMuX21faWQuX2tleSAmIDB4ZmZmZmZmMDApIHwgKHRoaXMuX3JlZmVyZW5jZUVkZ2UgJiAweDAwMDAwMGZmKTtcbiAgICAgIH1cbiAgIH0pO1xuICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZlYXR1cmVzLnByb3RvdHlwZSwgJ2luY2lkZW50RWRnZScsIHtcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICByZXR1cm4gdGhpcy5faW5jaWRlbnRFZGdlO1xuICAgICAgfVxuICAgfSk7XG4gICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmVhdHVyZXMucHJvdG90eXBlLCAnaW5jaWRlbnRFZGdlJywge1xuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHZhbHVlID0gMDtcbiAgICAgICAgIHRoaXMuX2luY2lkZW50RWRnZSA9IHZhbHVlO1xuICAgICAgICAgdGhpcy5fbV9pZC5fa2V5ID0gKHRoaXMuX21faWQuX2tleSAmIDB4ZmZmZjAwZmYpIHwgKCh0aGlzLl9pbmNpZGVudEVkZ2UgPDwgOCkgJiAweDAwMDBmZjAwKTtcbiAgICAgIH1cbiAgIH0pO1xuICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZlYXR1cmVzLnByb3RvdHlwZSwgJ2luY2lkZW50VmVydGV4Jywge1xuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgIHJldHVybiB0aGlzLl9pbmNpZGVudFZlcnRleDtcbiAgICAgIH1cbiAgIH0pO1xuICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZlYXR1cmVzLnByb3RvdHlwZSwgJ2luY2lkZW50VmVydGV4Jywge1xuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHZhbHVlID0gMDtcbiAgICAgICAgIHRoaXMuX2luY2lkZW50VmVydGV4ID0gdmFsdWU7XG4gICAgICAgICB0aGlzLl9tX2lkLl9rZXkgPSAodGhpcy5fbV9pZC5fa2V5ICYgMHhmZjAwZmZmZikgfCAoKHRoaXMuX2luY2lkZW50VmVydGV4IDw8IDE2KSAmIDB4MDBmZjAwMDApO1xuICAgICAgfVxuICAgfSk7XG4gICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmVhdHVyZXMucHJvdG90eXBlLCAnZmxpcCcsIHtcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICByZXR1cm4gdGhpcy5fZmxpcDtcbiAgICAgIH1cbiAgIH0pO1xuICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZlYXR1cmVzLnByb3RvdHlwZSwgJ2ZsaXAnLCB7XG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgdmFsdWUgPSAwO1xuICAgICAgICAgdGhpcy5fZmxpcCA9IHZhbHVlO1xuICAgICAgICAgdGhpcy5fbV9pZC5fa2V5ID0gKHRoaXMuX21faWQuX2tleSAmIDB4MDBmZmZmZmYpIHwgKCh0aGlzLl9mbGlwIDw8IDI0KSAmIDB4ZmYwMDAwMDApO1xuICAgICAgfVxuICAgfSk7XG59KSgpO1xuKGZ1bmN0aW9uICgpIHtcbiAgIHZhciBiMkNvbG9yID0gQm94MkQuQ29tbW9uLmIyQ29sb3IsXG4gICAgICBiMmludGVybmFsID0gQm94MkQuQ29tbW9uLmIyaW50ZXJuYWwsXG4gICAgICBiMlNldHRpbmdzID0gQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MsXG4gICAgICBiMkNpcmNsZVNoYXBlID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMkNpcmNsZVNoYXBlLFxuICAgICAgYjJFZGdlQ2hhaW5EZWYgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyRWRnZUNoYWluRGVmLFxuICAgICAgYjJFZGdlU2hhcGUgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyRWRnZVNoYXBlLFxuICAgICAgYjJNYXNzRGF0YSA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJNYXNzRGF0YSxcbiAgICAgIGIyUG9seWdvblNoYXBlID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlBvbHlnb25TaGFwZSxcbiAgICAgIGIyU2hhcGUgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyU2hhcGUsXG4gICAgICBiMk1hdDIyID0gQm94MkQuQ29tbW9uLk1hdGguYjJNYXQyMixcbiAgICAgIGIyTWF0MzMgPSBCb3gyRC5Db21tb24uTWF0aC5iMk1hdDMzLFxuICAgICAgYjJNYXRoID0gQm94MkQuQ29tbW9uLk1hdGguYjJNYXRoLFxuICAgICAgYjJTd2VlcCA9IEJveDJELkNvbW1vbi5NYXRoLmIyU3dlZXAsXG4gICAgICBiMlRyYW5zZm9ybSA9IEJveDJELkNvbW1vbi5NYXRoLmIyVHJhbnNmb3JtLFxuICAgICAgYjJWZWMyID0gQm94MkQuQ29tbW9uLk1hdGguYjJWZWMyLFxuICAgICAgYjJWZWMzID0gQm94MkQuQ29tbW9uLk1hdGguYjJWZWMzLFxuICAgICAgYjJCb2R5ID0gQm94MkQuRHluYW1pY3MuYjJCb2R5LFxuICAgICAgYjJCb2R5RGVmID0gQm94MkQuRHluYW1pY3MuYjJCb2R5RGVmLFxuICAgICAgYjJDb250YWN0RmlsdGVyID0gQm94MkQuRHluYW1pY3MuYjJDb250YWN0RmlsdGVyLFxuICAgICAgYjJDb250YWN0SW1wdWxzZSA9IEJveDJELkR5bmFtaWNzLmIyQ29udGFjdEltcHVsc2UsXG4gICAgICBiMkNvbnRhY3RMaXN0ZW5lciA9IEJveDJELkR5bmFtaWNzLmIyQ29udGFjdExpc3RlbmVyLFxuICAgICAgYjJDb250YWN0TWFuYWdlciA9IEJveDJELkR5bmFtaWNzLmIyQ29udGFjdE1hbmFnZXIsXG4gICAgICBiMkRlYnVnRHJhdyA9IEJveDJELkR5bmFtaWNzLmIyRGVidWdEcmF3LFxuICAgICAgYjJEZXN0cnVjdGlvbkxpc3RlbmVyID0gQm94MkQuRHluYW1pY3MuYjJEZXN0cnVjdGlvbkxpc3RlbmVyLFxuICAgICAgYjJGaWx0ZXJEYXRhID0gQm94MkQuRHluYW1pY3MuYjJGaWx0ZXJEYXRhLFxuICAgICAgYjJGaXh0dXJlID0gQm94MkQuRHluYW1pY3MuYjJGaXh0dXJlLFxuICAgICAgYjJGaXh0dXJlRGVmID0gQm94MkQuRHluYW1pY3MuYjJGaXh0dXJlRGVmLFxuICAgICAgYjJJc2xhbmQgPSBCb3gyRC5EeW5hbWljcy5iMklzbGFuZCxcbiAgICAgIGIyVGltZVN0ZXAgPSBCb3gyRC5EeW5hbWljcy5iMlRpbWVTdGVwLFxuICAgICAgYjJXb3JsZCA9IEJveDJELkR5bmFtaWNzLmIyV29ybGQsXG4gICAgICBiMkFBQkIgPSBCb3gyRC5Db2xsaXNpb24uYjJBQUJCLFxuICAgICAgYjJCb3VuZCA9IEJveDJELkNvbGxpc2lvbi5iMkJvdW5kLFxuICAgICAgYjJCb3VuZFZhbHVlcyA9IEJveDJELkNvbGxpc2lvbi5iMkJvdW5kVmFsdWVzLFxuICAgICAgYjJDb2xsaXNpb24gPSBCb3gyRC5Db2xsaXNpb24uYjJDb2xsaXNpb24sXG4gICAgICBiMkNvbnRhY3RJRCA9IEJveDJELkNvbGxpc2lvbi5iMkNvbnRhY3RJRCxcbiAgICAgIGIyQ29udGFjdFBvaW50ID0gQm94MkQuQ29sbGlzaW9uLmIyQ29udGFjdFBvaW50LFxuICAgICAgYjJEaXN0YW5jZSA9IEJveDJELkNvbGxpc2lvbi5iMkRpc3RhbmNlLFxuICAgICAgYjJEaXN0YW5jZUlucHV0ID0gQm94MkQuQ29sbGlzaW9uLmIyRGlzdGFuY2VJbnB1dCxcbiAgICAgIGIyRGlzdGFuY2VPdXRwdXQgPSBCb3gyRC5Db2xsaXNpb24uYjJEaXN0YW5jZU91dHB1dCxcbiAgICAgIGIyRGlzdGFuY2VQcm94eSA9IEJveDJELkNvbGxpc2lvbi5iMkRpc3RhbmNlUHJveHksXG4gICAgICBiMkR5bmFtaWNUcmVlID0gQm94MkQuQ29sbGlzaW9uLmIyRHluYW1pY1RyZWUsXG4gICAgICBiMkR5bmFtaWNUcmVlQnJvYWRQaGFzZSA9IEJveDJELkNvbGxpc2lvbi5iMkR5bmFtaWNUcmVlQnJvYWRQaGFzZSxcbiAgICAgIGIyRHluYW1pY1RyZWVOb2RlID0gQm94MkQuQ29sbGlzaW9uLmIyRHluYW1pY1RyZWVOb2RlLFxuICAgICAgYjJEeW5hbWljVHJlZVBhaXIgPSBCb3gyRC5Db2xsaXNpb24uYjJEeW5hbWljVHJlZVBhaXIsXG4gICAgICBiMk1hbmlmb2xkID0gQm94MkQuQ29sbGlzaW9uLmIyTWFuaWZvbGQsXG4gICAgICBiMk1hbmlmb2xkUG9pbnQgPSBCb3gyRC5Db2xsaXNpb24uYjJNYW5pZm9sZFBvaW50LFxuICAgICAgYjJQb2ludCA9IEJveDJELkNvbGxpc2lvbi5iMlBvaW50LFxuICAgICAgYjJSYXlDYXN0SW5wdXQgPSBCb3gyRC5Db2xsaXNpb24uYjJSYXlDYXN0SW5wdXQsXG4gICAgICBiMlJheUNhc3RPdXRwdXQgPSBCb3gyRC5Db2xsaXNpb24uYjJSYXlDYXN0T3V0cHV0LFxuICAgICAgYjJTZWdtZW50ID0gQm94MkQuQ29sbGlzaW9uLmIyU2VnbWVudCxcbiAgICAgIGIyU2VwYXJhdGlvbkZ1bmN0aW9uID0gQm94MkQuQ29sbGlzaW9uLmIyU2VwYXJhdGlvbkZ1bmN0aW9uLFxuICAgICAgYjJTaW1wbGV4ID0gQm94MkQuQ29sbGlzaW9uLmIyU2ltcGxleCxcbiAgICAgIGIyU2ltcGxleENhY2hlID0gQm94MkQuQ29sbGlzaW9uLmIyU2ltcGxleENhY2hlLFxuICAgICAgYjJTaW1wbGV4VmVydGV4ID0gQm94MkQuQ29sbGlzaW9uLmIyU2ltcGxleFZlcnRleCxcbiAgICAgIGIyVGltZU9mSW1wYWN0ID0gQm94MkQuQ29sbGlzaW9uLmIyVGltZU9mSW1wYWN0LFxuICAgICAgYjJUT0lJbnB1dCA9IEJveDJELkNvbGxpc2lvbi5iMlRPSUlucHV0LFxuICAgICAgYjJXb3JsZE1hbmlmb2xkID0gQm94MkQuQ29sbGlzaW9uLmIyV29ybGRNYW5pZm9sZCxcbiAgICAgIENsaXBWZXJ0ZXggPSBCb3gyRC5Db2xsaXNpb24uQ2xpcFZlcnRleCxcbiAgICAgIEZlYXR1cmVzID0gQm94MkQuQ29sbGlzaW9uLkZlYXR1cmVzLFxuICAgICAgSUJyb2FkUGhhc2UgPSBCb3gyRC5Db2xsaXNpb24uSUJyb2FkUGhhc2U7XG5cbiAgIEJveDJELmluaGVyaXQoYjJDaXJjbGVTaGFwZSwgQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlNoYXBlKTtcbiAgIGIyQ2lyY2xlU2hhcGUucHJvdG90eXBlLl9fc3VwZXIgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyU2hhcGUucHJvdG90eXBlO1xuICAgYjJDaXJjbGVTaGFwZS5iMkNpcmNsZVNoYXBlID0gZnVuY3Rpb24gKCkge1xuICAgICAgQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlNoYXBlLmIyU2hhcGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIHRoaXMubV9wID0gbmV3IGIyVmVjMigpO1xuICAgfTtcbiAgIGIyQ2lyY2xlU2hhcGUucHJvdG90eXBlLkNvcHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgcyA9IG5ldyBiMkNpcmNsZVNoYXBlKCk7XG4gICAgICBzLlNldCh0aGlzKTtcbiAgICAgIHJldHVybiBzO1xuICAgfVxuICAgYjJDaXJjbGVTaGFwZS5wcm90b3R5cGUuU2V0ID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgICB0aGlzLl9fc3VwZXIuU2V0LmNhbGwodGhpcywgb3RoZXIpO1xuICAgICAgaWYgKEJveDJELmlzKG90aGVyLCBiMkNpcmNsZVNoYXBlKSkge1xuICAgICAgICAgdmFyIG90aGVyMiA9IChvdGhlciBpbnN0YW5jZW9mIGIyQ2lyY2xlU2hhcGUgPyBvdGhlciA6IG51bGwpO1xuICAgICAgICAgdGhpcy5tX3AuU2V0VihvdGhlcjIubV9wKTtcbiAgICAgIH1cbiAgIH1cbiAgIGIyQ2lyY2xlU2hhcGUucHJvdG90eXBlLlRlc3RQb2ludCA9IGZ1bmN0aW9uICh0cmFuc2Zvcm0sIHApIHtcbiAgICAgIHZhciB0TWF0ID0gdHJhbnNmb3JtLlI7XG4gICAgICB2YXIgZFggPSB0cmFuc2Zvcm0ucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRoaXMubV9wLnggKyB0TWF0LmNvbDIueCAqIHRoaXMubV9wLnkpO1xuICAgICAgdmFyIGRZID0gdHJhbnNmb3JtLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0aGlzLm1fcC54ICsgdE1hdC5jb2wyLnkgKiB0aGlzLm1fcC55KTtcbiAgICAgIGRYID0gcC54IC0gZFg7XG4gICAgICBkWSA9IHAueSAtIGRZO1xuICAgICAgcmV0dXJuIChkWCAqIGRYICsgZFkgKiBkWSkgPD0gdGhpcy5tX3JhZGl1cyAqIHRoaXMubV9yYWRpdXM7XG4gICB9XG4gICBiMkNpcmNsZVNoYXBlLnByb3RvdHlwZS5SYXlDYXN0ID0gZnVuY3Rpb24gKG91dHB1dCwgaW5wdXQsIHRyYW5zZm9ybSkge1xuICAgICAgdmFyIHRNYXQgPSB0cmFuc2Zvcm0uUjtcbiAgICAgIHZhciBwb3NpdGlvblggPSB0cmFuc2Zvcm0ucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRoaXMubV9wLnggKyB0TWF0LmNvbDIueCAqIHRoaXMubV9wLnkpO1xuICAgICAgdmFyIHBvc2l0aW9uWSA9IHRyYW5zZm9ybS5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdGhpcy5tX3AueCArIHRNYXQuY29sMi55ICogdGhpcy5tX3AueSk7XG4gICAgICB2YXIgc1ggPSBpbnB1dC5wMS54IC0gcG9zaXRpb25YO1xuICAgICAgdmFyIHNZID0gaW5wdXQucDEueSAtIHBvc2l0aW9uWTtcbiAgICAgIHZhciBiID0gKHNYICogc1ggKyBzWSAqIHNZKSAtIHRoaXMubV9yYWRpdXMgKiB0aGlzLm1fcmFkaXVzO1xuICAgICAgdmFyIHJYID0gaW5wdXQucDIueCAtIGlucHV0LnAxLng7XG4gICAgICB2YXIgclkgPSBpbnB1dC5wMi55IC0gaW5wdXQucDEueTtcbiAgICAgIHZhciBjID0gKHNYICogclggKyBzWSAqIHJZKTtcbiAgICAgIHZhciByciA9IChyWCAqIHJYICsgclkgKiByWSk7XG4gICAgICB2YXIgc2lnbWEgPSBjICogYyAtIHJyICogYjtcbiAgICAgIGlmIChzaWdtYSA8IDAuMCB8fCByciA8IE51bWJlci5NSU5fVkFMVUUpIHtcbiAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHZhciBhID0gKC0oYyArIE1hdGguc3FydChzaWdtYSkpKTtcbiAgICAgIGlmICgwLjAgPD0gYSAmJiBhIDw9IGlucHV0Lm1heEZyYWN0aW9uICogcnIpIHtcbiAgICAgICAgIGEgLz0gcnI7XG4gICAgICAgICBvdXRwdXQuZnJhY3Rpb24gPSBhO1xuICAgICAgICAgb3V0cHV0Lm5vcm1hbC54ID0gc1ggKyBhICogclg7XG4gICAgICAgICBvdXRwdXQubm9ybWFsLnkgPSBzWSArIGEgKiByWTtcbiAgICAgICAgIG91dHB1dC5ub3JtYWwuTm9ybWFsaXplKCk7XG4gICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgIH1cbiAgIGIyQ2lyY2xlU2hhcGUucHJvdG90eXBlLkNvbXB1dGVBQUJCID0gZnVuY3Rpb24gKGFhYmIsIHRyYW5zZm9ybSkge1xuICAgICAgdmFyIHRNYXQgPSB0cmFuc2Zvcm0uUjtcbiAgICAgIHZhciBwWCA9IHRyYW5zZm9ybS5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdGhpcy5tX3AueCArIHRNYXQuY29sMi54ICogdGhpcy5tX3AueSk7XG4gICAgICB2YXIgcFkgPSB0cmFuc2Zvcm0ucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRoaXMubV9wLnggKyB0TWF0LmNvbDIueSAqIHRoaXMubV9wLnkpO1xuICAgICAgYWFiYi5sb3dlckJvdW5kLlNldChwWCAtIHRoaXMubV9yYWRpdXMsIHBZIC0gdGhpcy5tX3JhZGl1cyk7XG4gICAgICBhYWJiLnVwcGVyQm91bmQuU2V0KHBYICsgdGhpcy5tX3JhZGl1cywgcFkgKyB0aGlzLm1fcmFkaXVzKTtcbiAgIH1cbiAgIGIyQ2lyY2xlU2hhcGUucHJvdG90eXBlLkNvbXB1dGVNYXNzID0gZnVuY3Rpb24gKG1hc3NEYXRhLCBkZW5zaXR5KSB7XG4gICAgICBpZiAoZGVuc2l0eSA9PT0gdW5kZWZpbmVkKSBkZW5zaXR5ID0gMDtcbiAgICAgIG1hc3NEYXRhLm1hc3MgPSBkZW5zaXR5ICogYjJTZXR0aW5ncy5iMl9waSAqIHRoaXMubV9yYWRpdXMgKiB0aGlzLm1fcmFkaXVzO1xuICAgICAgbWFzc0RhdGEuY2VudGVyLlNldFYodGhpcy5tX3ApO1xuICAgICAgbWFzc0RhdGEuSSA9IG1hc3NEYXRhLm1hc3MgKiAoMC41ICogdGhpcy5tX3JhZGl1cyAqIHRoaXMubV9yYWRpdXMgKyAodGhpcy5tX3AueCAqIHRoaXMubV9wLnggKyB0aGlzLm1fcC55ICogdGhpcy5tX3AueSkpO1xuICAgfVxuICAgYjJDaXJjbGVTaGFwZS5wcm90b3R5cGUuQ29tcHV0ZVN1Ym1lcmdlZEFyZWEgPSBmdW5jdGlvbiAobm9ybWFsLCBvZmZzZXQsIHhmLCBjKSB7XG4gICAgICBpZiAob2Zmc2V0ID09PSB1bmRlZmluZWQpIG9mZnNldCA9IDA7XG4gICAgICB2YXIgcCA9IGIyTWF0aC5NdWxYKHhmLCB0aGlzLm1fcCk7XG4gICAgICB2YXIgbCA9ICgtKGIyTWF0aC5Eb3Qobm9ybWFsLCBwKSAtIG9mZnNldCkpO1xuICAgICAgaWYgKGwgPCAoLXRoaXMubV9yYWRpdXMpICsgTnVtYmVyLk1JTl9WQUxVRSkge1xuICAgICAgICAgcmV0dXJuIDA7XG4gICAgICB9XG4gICAgICBpZiAobCA+IHRoaXMubV9yYWRpdXMpIHtcbiAgICAgICAgIGMuU2V0VihwKTtcbiAgICAgICAgIHJldHVybiBNYXRoLlBJICogdGhpcy5tX3JhZGl1cyAqIHRoaXMubV9yYWRpdXM7XG4gICAgICB9XG4gICAgICB2YXIgcjIgPSB0aGlzLm1fcmFkaXVzICogdGhpcy5tX3JhZGl1cztcbiAgICAgIHZhciBsMiA9IGwgKiBsO1xuICAgICAgdmFyIGFyZWEgPSByMiAqIChNYXRoLmFzaW4obCAvIHRoaXMubV9yYWRpdXMpICsgTWF0aC5QSSAvIDIpICsgbCAqIE1hdGguc3FydChyMiAtIGwyKTtcbiAgICAgIHZhciBjb20gPSAoLTIgLyAzICogTWF0aC5wb3cocjIgLSBsMiwgMS41KSAvIGFyZWEpO1xuICAgICAgYy54ID0gcC54ICsgbm9ybWFsLnggKiBjb207XG4gICAgICBjLnkgPSBwLnkgKyBub3JtYWwueSAqIGNvbTtcbiAgICAgIHJldHVybiBhcmVhO1xuICAgfVxuICAgYjJDaXJjbGVTaGFwZS5wcm90b3R5cGUuR2V0TG9jYWxQb3NpdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fcDtcbiAgIH1cbiAgIGIyQ2lyY2xlU2hhcGUucHJvdG90eXBlLlNldExvY2FsUG9zaXRpb24gPSBmdW5jdGlvbiAocG9zaXRpb24pIHtcbiAgICAgIHRoaXMubV9wLlNldFYocG9zaXRpb24pO1xuICAgfVxuICAgYjJDaXJjbGVTaGFwZS5wcm90b3R5cGUuR2V0UmFkaXVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV9yYWRpdXM7XG4gICB9XG4gICBiMkNpcmNsZVNoYXBlLnByb3RvdHlwZS5TZXRSYWRpdXMgPSBmdW5jdGlvbiAocmFkaXVzKSB7XG4gICAgICBpZiAocmFkaXVzID09PSB1bmRlZmluZWQpIHJhZGl1cyA9IDA7XG4gICAgICB0aGlzLm1fcmFkaXVzID0gcmFkaXVzO1xuICAgfVxuICAgYjJDaXJjbGVTaGFwZS5wcm90b3R5cGUuYjJDaXJjbGVTaGFwZSA9IGZ1bmN0aW9uIChyYWRpdXMpIHtcbiAgICAgIGlmIChyYWRpdXMgPT09IHVuZGVmaW5lZCkgcmFkaXVzID0gMDtcbiAgICAgIHRoaXMuX19zdXBlci5iMlNoYXBlLmNhbGwodGhpcyk7XG4gICAgICB0aGlzLm1fdHlwZSA9IGIyU2hhcGUuZV9jaXJjbGVTaGFwZTtcbiAgICAgIHRoaXMubV9yYWRpdXMgPSByYWRpdXM7XG4gICB9XG4gICBiMkVkZ2VDaGFpbkRlZi5iMkVkZ2VDaGFpbkRlZiA9IGZ1bmN0aW9uICgpIHt9O1xuICAgYjJFZGdlQ2hhaW5EZWYucHJvdG90eXBlLmIyRWRnZUNoYWluRGVmID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy52ZXJ0ZXhDb3VudCA9IDA7XG4gICAgICB0aGlzLmlzQUxvb3AgPSB0cnVlO1xuICAgICAgdGhpcy52ZXJ0aWNlcyA9IFtdO1xuICAgfVxuICAgQm94MkQuaW5oZXJpdChiMkVkZ2VTaGFwZSwgQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlNoYXBlKTtcbiAgIGIyRWRnZVNoYXBlLnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlNoYXBlLnByb3RvdHlwZTtcbiAgIGIyRWRnZVNoYXBlLmIyRWRnZVNoYXBlID0gZnVuY3Rpb24gKCkge1xuICAgICAgQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlNoYXBlLmIyU2hhcGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIHRoaXMuc19zdXBwb3J0VmVjID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy5tX3YxID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy5tX3YyID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy5tX2NvcmVWMSA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIHRoaXMubV9jb3JlVjIgPSBuZXcgYjJWZWMyKCk7XG4gICAgICB0aGlzLm1fbm9ybWFsID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy5tX2RpcmVjdGlvbiA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIHRoaXMubV9jb3JuZXJEaXIxID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy5tX2Nvcm5lckRpcjIgPSBuZXcgYjJWZWMyKCk7XG4gICB9O1xuICAgYjJFZGdlU2hhcGUucHJvdG90eXBlLlRlc3RQb2ludCA9IGZ1bmN0aW9uICh0cmFuc2Zvcm0sIHApIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgIH1cbiAgIGIyRWRnZVNoYXBlLnByb3RvdHlwZS5SYXlDYXN0ID0gZnVuY3Rpb24gKG91dHB1dCwgaW5wdXQsIHRyYW5zZm9ybSkge1xuICAgICAgdmFyIHRNYXQ7XG4gICAgICB2YXIgclggPSBpbnB1dC5wMi54IC0gaW5wdXQucDEueDtcbiAgICAgIHZhciByWSA9IGlucHV0LnAyLnkgLSBpbnB1dC5wMS55O1xuICAgICAgdE1hdCA9IHRyYW5zZm9ybS5SO1xuICAgICAgdmFyIHYxWCA9IHRyYW5zZm9ybS5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdGhpcy5tX3YxLnggKyB0TWF0LmNvbDIueCAqIHRoaXMubV92MS55KTtcbiAgICAgIHZhciB2MVkgPSB0cmFuc2Zvcm0ucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRoaXMubV92MS54ICsgdE1hdC5jb2wyLnkgKiB0aGlzLm1fdjEueSk7XG4gICAgICB2YXIgblggPSB0cmFuc2Zvcm0ucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRoaXMubV92Mi54ICsgdE1hdC5jb2wyLnkgKiB0aGlzLm1fdjIueSkgLSB2MVk7XG4gICAgICB2YXIgblkgPSAoLSh0cmFuc2Zvcm0ucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRoaXMubV92Mi54ICsgdE1hdC5jb2wyLnggKiB0aGlzLm1fdjIueSkgLSB2MVgpKTtcbiAgICAgIHZhciBrX3Nsb3AgPSAxMDAuMCAqIE51bWJlci5NSU5fVkFMVUU7XG4gICAgICB2YXIgZGVub20gPSAoLShyWCAqIG5YICsgclkgKiBuWSkpO1xuICAgICAgaWYgKGRlbm9tID4ga19zbG9wKSB7XG4gICAgICAgICB2YXIgYlggPSBpbnB1dC5wMS54IC0gdjFYO1xuICAgICAgICAgdmFyIGJZID0gaW5wdXQucDEueSAtIHYxWTtcbiAgICAgICAgIHZhciBhID0gKGJYICogblggKyBiWSAqIG5ZKTtcbiAgICAgICAgIGlmICgwLjAgPD0gYSAmJiBhIDw9IGlucHV0Lm1heEZyYWN0aW9uICogZGVub20pIHtcbiAgICAgICAgICAgIHZhciBtdTIgPSAoLXJYICogYlkpICsgclkgKiBiWDtcbiAgICAgICAgICAgIGlmICgoLWtfc2xvcCAqIGRlbm9tKSA8PSBtdTIgJiYgbXUyIDw9IGRlbm9tICogKDEuMCArIGtfc2xvcCkpIHtcbiAgICAgICAgICAgICAgIGEgLz0gZGVub207XG4gICAgICAgICAgICAgICBvdXRwdXQuZnJhY3Rpb24gPSBhO1xuICAgICAgICAgICAgICAgdmFyIG5MZW4gPSBNYXRoLnNxcnQoblggKiBuWCArIG5ZICogblkpO1xuICAgICAgICAgICAgICAgb3V0cHV0Lm5vcm1hbC54ID0gblggLyBuTGVuO1xuICAgICAgICAgICAgICAgb3V0cHV0Lm5vcm1hbC55ID0gblkgLyBuTGVuO1xuICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICB9XG4gICBiMkVkZ2VTaGFwZS5wcm90b3R5cGUuQ29tcHV0ZUFBQkIgPSBmdW5jdGlvbiAoYWFiYiwgdHJhbnNmb3JtKSB7XG4gICAgICB2YXIgdE1hdCA9IHRyYW5zZm9ybS5SO1xuICAgICAgdmFyIHYxWCA9IHRyYW5zZm9ybS5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdGhpcy5tX3YxLnggKyB0TWF0LmNvbDIueCAqIHRoaXMubV92MS55KTtcbiAgICAgIHZhciB2MVkgPSB0cmFuc2Zvcm0ucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRoaXMubV92MS54ICsgdE1hdC5jb2wyLnkgKiB0aGlzLm1fdjEueSk7XG4gICAgICB2YXIgdjJYID0gdHJhbnNmb3JtLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0aGlzLm1fdjIueCArIHRNYXQuY29sMi54ICogdGhpcy5tX3YyLnkpO1xuICAgICAgdmFyIHYyWSA9IHRyYW5zZm9ybS5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdGhpcy5tX3YyLnggKyB0TWF0LmNvbDIueSAqIHRoaXMubV92Mi55KTtcbiAgICAgIGlmICh2MVggPCB2MlgpIHtcbiAgICAgICAgIGFhYmIubG93ZXJCb3VuZC54ID0gdjFYO1xuICAgICAgICAgYWFiYi51cHBlckJvdW5kLnggPSB2Mlg7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgIGFhYmIubG93ZXJCb3VuZC54ID0gdjJYO1xuICAgICAgICAgYWFiYi51cHBlckJvdW5kLnggPSB2MVg7XG4gICAgICB9XG4gICAgICBpZiAodjFZIDwgdjJZKSB7XG4gICAgICAgICBhYWJiLmxvd2VyQm91bmQueSA9IHYxWTtcbiAgICAgICAgIGFhYmIudXBwZXJCb3VuZC55ID0gdjJZO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgICBhYWJiLmxvd2VyQm91bmQueSA9IHYyWTtcbiAgICAgICAgIGFhYmIudXBwZXJCb3VuZC55ID0gdjFZO1xuICAgICAgfVxuICAgfVxuICAgYjJFZGdlU2hhcGUucHJvdG90eXBlLkNvbXB1dGVNYXNzID0gZnVuY3Rpb24gKG1hc3NEYXRhLCBkZW5zaXR5KSB7XG4gICAgICBpZiAoZGVuc2l0eSA9PT0gdW5kZWZpbmVkKSBkZW5zaXR5ID0gMDtcbiAgICAgIG1hc3NEYXRhLm1hc3MgPSAwO1xuICAgICAgbWFzc0RhdGEuY2VudGVyLlNldFYodGhpcy5tX3YxKTtcbiAgICAgIG1hc3NEYXRhLkkgPSAwO1xuICAgfVxuICAgYjJFZGdlU2hhcGUucHJvdG90eXBlLkNvbXB1dGVTdWJtZXJnZWRBcmVhID0gZnVuY3Rpb24gKG5vcm1hbCwgb2Zmc2V0LCB4ZiwgYykge1xuICAgICAgaWYgKG9mZnNldCA9PT0gdW5kZWZpbmVkKSBvZmZzZXQgPSAwO1xuICAgICAgdmFyIHYwID0gbmV3IGIyVmVjMihub3JtYWwueCAqIG9mZnNldCwgbm9ybWFsLnkgKiBvZmZzZXQpO1xuICAgICAgdmFyIHYxID0gYjJNYXRoLk11bFgoeGYsIHRoaXMubV92MSk7XG4gICAgICB2YXIgdjIgPSBiMk1hdGguTXVsWCh4ZiwgdGhpcy5tX3YyKTtcbiAgICAgIHZhciBkMSA9IGIyTWF0aC5Eb3Qobm9ybWFsLCB2MSkgLSBvZmZzZXQ7XG4gICAgICB2YXIgZDIgPSBiMk1hdGguRG90KG5vcm1hbCwgdjIpIC0gb2Zmc2V0O1xuICAgICAgaWYgKGQxID4gMCkge1xuICAgICAgICAgaWYgKGQyID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICB9XG4gICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHYxLnggPSAoLWQyIC8gKGQxIC0gZDIpICogdjEueCkgKyBkMSAvIChkMSAtIGQyKSAqIHYyLng7XG4gICAgICAgICAgICB2MS55ID0gKC1kMiAvIChkMSAtIGQyKSAqIHYxLnkpICsgZDEgLyAoZDEgLSBkMikgKiB2Mi55O1xuICAgICAgICAgfVxuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgICBpZiAoZDIgPiAwKSB7XG4gICAgICAgICAgICB2Mi54ID0gKC1kMiAvIChkMSAtIGQyKSAqIHYxLngpICsgZDEgLyAoZDEgLSBkMikgKiB2Mi54O1xuICAgICAgICAgICAgdjIueSA9ICgtZDIgLyAoZDEgLSBkMikgKiB2MS55KSArIGQxIC8gKGQxIC0gZDIpICogdjIueTtcbiAgICAgICAgIH1cbiAgICAgICAgIGVsc2Uge31cbiAgICAgIH1cbiAgICAgIGMueCA9ICh2MC54ICsgdjEueCArIHYyLngpIC8gMztcbiAgICAgIGMueSA9ICh2MC55ICsgdjEueSArIHYyLnkpIC8gMztcbiAgICAgIHJldHVybiAwLjUgKiAoKHYxLnggLSB2MC54KSAqICh2Mi55IC0gdjAueSkgLSAodjEueSAtIHYwLnkpICogKHYyLnggLSB2MC54KSk7XG4gICB9XG4gICBiMkVkZ2VTaGFwZS5wcm90b3R5cGUuR2V0TGVuZ3RoID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV9sZW5ndGg7XG4gICB9XG4gICBiMkVkZ2VTaGFwZS5wcm90b3R5cGUuR2V0VmVydGV4MSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fdjE7XG4gICB9XG4gICBiMkVkZ2VTaGFwZS5wcm90b3R5cGUuR2V0VmVydGV4MiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fdjI7XG4gICB9XG4gICBiMkVkZ2VTaGFwZS5wcm90b3R5cGUuR2V0Q29yZVZlcnRleDEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX2NvcmVWMTtcbiAgIH1cbiAgIGIyRWRnZVNoYXBlLnByb3RvdHlwZS5HZXRDb3JlVmVydGV4MiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fY29yZVYyO1xuICAgfVxuICAgYjJFZGdlU2hhcGUucHJvdG90eXBlLkdldE5vcm1hbFZlY3RvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fbm9ybWFsO1xuICAgfVxuICAgYjJFZGdlU2hhcGUucHJvdG90eXBlLkdldERpcmVjdGlvblZlY3RvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fZGlyZWN0aW9uO1xuICAgfVxuICAgYjJFZGdlU2hhcGUucHJvdG90eXBlLkdldENvcm5lcjFWZWN0b3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX2Nvcm5lckRpcjE7XG4gICB9XG4gICBiMkVkZ2VTaGFwZS5wcm90b3R5cGUuR2V0Q29ybmVyMlZlY3RvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fY29ybmVyRGlyMjtcbiAgIH1cbiAgIGIyRWRnZVNoYXBlLnByb3RvdHlwZS5Db3JuZXIxSXNDb252ZXggPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX2Nvcm5lckNvbnZleDE7XG4gICB9XG4gICBiMkVkZ2VTaGFwZS5wcm90b3R5cGUuQ29ybmVyMklzQ29udmV4ID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV9jb3JuZXJDb252ZXgyO1xuICAgfVxuICAgYjJFZGdlU2hhcGUucHJvdG90eXBlLkdldEZpcnN0VmVydGV4ID0gZnVuY3Rpb24gKHhmKSB7XG4gICAgICB2YXIgdE1hdCA9IHhmLlI7XG4gICAgICByZXR1cm4gbmV3IGIyVmVjMih4Zi5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdGhpcy5tX2NvcmVWMS54ICsgdE1hdC5jb2wyLnggKiB0aGlzLm1fY29yZVYxLnkpLCB4Zi5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdGhpcy5tX2NvcmVWMS54ICsgdE1hdC5jb2wyLnkgKiB0aGlzLm1fY29yZVYxLnkpKTtcbiAgIH1cbiAgIGIyRWRnZVNoYXBlLnByb3RvdHlwZS5HZXROZXh0RWRnZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fbmV4dEVkZ2U7XG4gICB9XG4gICBiMkVkZ2VTaGFwZS5wcm90b3R5cGUuR2V0UHJldkVkZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX3ByZXZFZGdlO1xuICAgfVxuICAgYjJFZGdlU2hhcGUucHJvdG90eXBlLlN1cHBvcnQgPSBmdW5jdGlvbiAoeGYsIGRYLCBkWSkge1xuICAgICAgaWYgKGRYID09PSB1bmRlZmluZWQpIGRYID0gMDtcbiAgICAgIGlmIChkWSA9PT0gdW5kZWZpbmVkKSBkWSA9IDA7XG4gICAgICB2YXIgdE1hdCA9IHhmLlI7XG4gICAgICB2YXIgdjFYID0geGYucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRoaXMubV9jb3JlVjEueCArIHRNYXQuY29sMi54ICogdGhpcy5tX2NvcmVWMS55KTtcbiAgICAgIHZhciB2MVkgPSB4Zi5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdGhpcy5tX2NvcmVWMS54ICsgdE1hdC5jb2wyLnkgKiB0aGlzLm1fY29yZVYxLnkpO1xuICAgICAgdmFyIHYyWCA9IHhmLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0aGlzLm1fY29yZVYyLnggKyB0TWF0LmNvbDIueCAqIHRoaXMubV9jb3JlVjIueSk7XG4gICAgICB2YXIgdjJZID0geGYucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRoaXMubV9jb3JlVjIueCArIHRNYXQuY29sMi55ICogdGhpcy5tX2NvcmVWMi55KTtcbiAgICAgIGlmICgodjFYICogZFggKyB2MVkgKiBkWSkgPiAodjJYICogZFggKyB2MlkgKiBkWSkpIHtcbiAgICAgICAgIHRoaXMuc19zdXBwb3J0VmVjLnggPSB2MVg7XG4gICAgICAgICB0aGlzLnNfc3VwcG9ydFZlYy55ID0gdjFZO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgICB0aGlzLnNfc3VwcG9ydFZlYy54ID0gdjJYO1xuICAgICAgICAgdGhpcy5zX3N1cHBvcnRWZWMueSA9IHYyWTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLnNfc3VwcG9ydFZlYztcbiAgIH1cbiAgIGIyRWRnZVNoYXBlLnByb3RvdHlwZS5iMkVkZ2VTaGFwZSA9IGZ1bmN0aW9uICh2MSwgdjIpIHtcbiAgICAgIHRoaXMuX19zdXBlci5iMlNoYXBlLmNhbGwodGhpcyk7XG4gICAgICB0aGlzLm1fdHlwZSA9IGIyU2hhcGUuZV9lZGdlU2hhcGU7XG4gICAgICB0aGlzLm1fcHJldkVkZ2UgPSBudWxsO1xuICAgICAgdGhpcy5tX25leHRFZGdlID0gbnVsbDtcbiAgICAgIHRoaXMubV92MSA9IHYxO1xuICAgICAgdGhpcy5tX3YyID0gdjI7XG4gICAgICB0aGlzLm1fZGlyZWN0aW9uLlNldCh0aGlzLm1fdjIueCAtIHRoaXMubV92MS54LCB0aGlzLm1fdjIueSAtIHRoaXMubV92MS55KTtcbiAgICAgIHRoaXMubV9sZW5ndGggPSB0aGlzLm1fZGlyZWN0aW9uLk5vcm1hbGl6ZSgpO1xuICAgICAgdGhpcy5tX25vcm1hbC5TZXQodGhpcy5tX2RpcmVjdGlvbi55LCAoLXRoaXMubV9kaXJlY3Rpb24ueCkpO1xuICAgICAgdGhpcy5tX2NvcmVWMS5TZXQoKC1iMlNldHRpbmdzLmIyX3RvaVNsb3AgKiAodGhpcy5tX25vcm1hbC54IC0gdGhpcy5tX2RpcmVjdGlvbi54KSkgKyB0aGlzLm1fdjEueCwgKC1iMlNldHRpbmdzLmIyX3RvaVNsb3AgKiAodGhpcy5tX25vcm1hbC55IC0gdGhpcy5tX2RpcmVjdGlvbi55KSkgKyB0aGlzLm1fdjEueSk7XG4gICAgICB0aGlzLm1fY29yZVYyLlNldCgoLWIyU2V0dGluZ3MuYjJfdG9pU2xvcCAqICh0aGlzLm1fbm9ybWFsLnggKyB0aGlzLm1fZGlyZWN0aW9uLngpKSArIHRoaXMubV92Mi54LCAoLWIyU2V0dGluZ3MuYjJfdG9pU2xvcCAqICh0aGlzLm1fbm9ybWFsLnkgKyB0aGlzLm1fZGlyZWN0aW9uLnkpKSArIHRoaXMubV92Mi55KTtcbiAgICAgIHRoaXMubV9jb3JuZXJEaXIxID0gdGhpcy5tX25vcm1hbDtcbiAgICAgIHRoaXMubV9jb3JuZXJEaXIyLlNldCgoLXRoaXMubV9ub3JtYWwueCksICgtdGhpcy5tX25vcm1hbC55KSk7XG4gICB9XG4gICBiMkVkZ2VTaGFwZS5wcm90b3R5cGUuU2V0UHJldkVkZ2UgPSBmdW5jdGlvbiAoZWRnZSwgY29yZSwgY29ybmVyRGlyLCBjb252ZXgpIHtcbiAgICAgIHRoaXMubV9wcmV2RWRnZSA9IGVkZ2U7XG4gICAgICB0aGlzLm1fY29yZVYxID0gY29yZTtcbiAgICAgIHRoaXMubV9jb3JuZXJEaXIxID0gY29ybmVyRGlyO1xuICAgICAgdGhpcy5tX2Nvcm5lckNvbnZleDEgPSBjb252ZXg7XG4gICB9XG4gICBiMkVkZ2VTaGFwZS5wcm90b3R5cGUuU2V0TmV4dEVkZ2UgPSBmdW5jdGlvbiAoZWRnZSwgY29yZSwgY29ybmVyRGlyLCBjb252ZXgpIHtcbiAgICAgIHRoaXMubV9uZXh0RWRnZSA9IGVkZ2U7XG4gICAgICB0aGlzLm1fY29yZVYyID0gY29yZTtcbiAgICAgIHRoaXMubV9jb3JuZXJEaXIyID0gY29ybmVyRGlyO1xuICAgICAgdGhpcy5tX2Nvcm5lckNvbnZleDIgPSBjb252ZXg7XG4gICB9XG4gICBiMk1hc3NEYXRhLmIyTWFzc0RhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLm1hc3MgPSAwLjA7XG4gICAgICB0aGlzLmNlbnRlciA9IG5ldyBiMlZlYzIoMCwgMCk7XG4gICAgICB0aGlzLkkgPSAwLjA7XG4gICB9O1xuICAgQm94MkQuaW5oZXJpdChiMlBvbHlnb25TaGFwZSwgQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlNoYXBlKTtcbiAgIGIyUG9seWdvblNoYXBlLnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlNoYXBlLnByb3RvdHlwZTtcbiAgIGIyUG9seWdvblNoYXBlLmIyUG9seWdvblNoYXBlID0gZnVuY3Rpb24gKCkge1xuICAgICAgQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlNoYXBlLmIyU2hhcGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBiMlBvbHlnb25TaGFwZS5wcm90b3R5cGUuQ29weSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBzID0gbmV3IGIyUG9seWdvblNoYXBlKCk7XG4gICAgICBzLlNldCh0aGlzKTtcbiAgICAgIHJldHVybiBzO1xuICAgfVxuICAgYjJQb2x5Z29uU2hhcGUucHJvdG90eXBlLlNldCA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgICAgdGhpcy5fX3N1cGVyLlNldC5jYWxsKHRoaXMsIG90aGVyKTtcbiAgICAgIGlmIChCb3gyRC5pcyhvdGhlciwgYjJQb2x5Z29uU2hhcGUpKSB7XG4gICAgICAgICB2YXIgb3RoZXIyID0gKG90aGVyIGluc3RhbmNlb2YgYjJQb2x5Z29uU2hhcGUgPyBvdGhlciA6IG51bGwpO1xuICAgICAgICAgdGhpcy5tX2NlbnRyb2lkLlNldFYob3RoZXIyLm1fY2VudHJvaWQpO1xuICAgICAgICAgdGhpcy5tX3ZlcnRleENvdW50ID0gb3RoZXIyLm1fdmVydGV4Q291bnQ7XG4gICAgICAgICB0aGlzLlJlc2VydmUodGhpcy5tX3ZlcnRleENvdW50KTtcbiAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX3ZlcnRleENvdW50OyBpKyspIHtcbiAgICAgICAgICAgIHRoaXMubV92ZXJ0aWNlc1tpXS5TZXRWKG90aGVyMi5tX3ZlcnRpY2VzW2ldKTtcbiAgICAgICAgICAgIHRoaXMubV9ub3JtYWxzW2ldLlNldFYob3RoZXIyLm1fbm9ybWFsc1tpXSk7XG4gICAgICAgICB9XG4gICAgICB9XG4gICB9XG4gICBiMlBvbHlnb25TaGFwZS5wcm90b3R5cGUuU2V0QXNBcnJheSA9IGZ1bmN0aW9uICh2ZXJ0aWNlcywgdmVydGV4Q291bnQpIHtcbiAgICAgIGlmICh2ZXJ0ZXhDb3VudCA9PT0gdW5kZWZpbmVkKSB2ZXJ0ZXhDb3VudCA9IDA7XG4gICAgICB2YXIgdiA9IG5ldyBWZWN0b3IoKTtcbiAgICAgIHZhciBpID0gMCxcbiAgICAgICAgIHRWZWM7XG4gICAgICBmb3IgKGkgPSAwO1xuICAgICAgaSA8IHZlcnRpY2VzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICB0VmVjID0gdmVydGljZXNbaV07XG4gICAgICAgICB2LnB1c2godFZlYyk7XG4gICAgICB9XG4gICAgICB0aGlzLlNldEFzVmVjdG9yKHYsIHZlcnRleENvdW50KTtcbiAgIH1cbiAgIGIyUG9seWdvblNoYXBlLkFzQXJyYXkgPSBmdW5jdGlvbiAodmVydGljZXMsIHZlcnRleENvdW50KSB7XG4gICAgICBpZiAodmVydGV4Q291bnQgPT09IHVuZGVmaW5lZCkgdmVydGV4Q291bnQgPSAwO1xuICAgICAgdmFyIHBvbHlnb25TaGFwZSA9IG5ldyBiMlBvbHlnb25TaGFwZSgpO1xuICAgICAgcG9seWdvblNoYXBlLlNldEFzQXJyYXkodmVydGljZXMsIHZlcnRleENvdW50KTtcbiAgICAgIHJldHVybiBwb2x5Z29uU2hhcGU7XG4gICB9XG4gICBiMlBvbHlnb25TaGFwZS5wcm90b3R5cGUuU2V0QXNWZWN0b3IgPSBmdW5jdGlvbiAodmVydGljZXMsIHZlcnRleENvdW50KSB7XG4gICAgICBpZiAodmVydGV4Q291bnQgPT09IHVuZGVmaW5lZCkgdmVydGV4Q291bnQgPSAwO1xuICAgICAgaWYgKHZlcnRleENvdW50ID09IDApIHZlcnRleENvdW50ID0gdmVydGljZXMubGVuZ3RoO1xuICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydCgyIDw9IHZlcnRleENvdW50KTtcbiAgICAgIHRoaXMubV92ZXJ0ZXhDb3VudCA9IHZlcnRleENvdW50O1xuICAgICAgdGhpcy5SZXNlcnZlKHZlcnRleENvdW50KTtcbiAgICAgIHZhciBpID0gMDtcbiAgICAgIGZvciAoaSA9IDA7XG4gICAgICBpIDwgdGhpcy5tX3ZlcnRleENvdW50OyBpKyspIHtcbiAgICAgICAgIHRoaXMubV92ZXJ0aWNlc1tpXS5TZXRWKHZlcnRpY2VzW2ldKTtcbiAgICAgIH1cbiAgICAgIGZvciAoaSA9IDA7XG4gICAgICBpIDwgdGhpcy5tX3ZlcnRleENvdW50OyArK2kpIHtcbiAgICAgICAgIHZhciBpMSA9IHBhcnNlSW50KGkpO1xuICAgICAgICAgdmFyIGkyID0gcGFyc2VJbnQoaSArIDEgPCB0aGlzLm1fdmVydGV4Q291bnQgPyBpICsgMSA6IDApO1xuICAgICAgICAgdmFyIGVkZ2UgPSBiMk1hdGguU3VidHJhY3RWVih0aGlzLm1fdmVydGljZXNbaTJdLCB0aGlzLm1fdmVydGljZXNbaTFdKTtcbiAgICAgICAgIGIyU2V0dGluZ3MuYjJBc3NlcnQoZWRnZS5MZW5ndGhTcXVhcmVkKCkgPiBOdW1iZXIuTUlOX1ZBTFVFKTtcbiAgICAgICAgIHRoaXMubV9ub3JtYWxzW2ldLlNldFYoYjJNYXRoLkNyb3NzVkYoZWRnZSwgMS4wKSk7XG4gICAgICAgICB0aGlzLm1fbm9ybWFsc1tpXS5Ob3JtYWxpemUoKTtcbiAgICAgIH1cbiAgICAgIHRoaXMubV9jZW50cm9pZCA9IGIyUG9seWdvblNoYXBlLkNvbXB1dGVDZW50cm9pZCh0aGlzLm1fdmVydGljZXMsIHRoaXMubV92ZXJ0ZXhDb3VudCk7XG4gICB9XG4gICBiMlBvbHlnb25TaGFwZS5Bc1ZlY3RvciA9IGZ1bmN0aW9uICh2ZXJ0aWNlcywgdmVydGV4Q291bnQpIHtcbiAgICAgIGlmICh2ZXJ0ZXhDb3VudCA9PT0gdW5kZWZpbmVkKSB2ZXJ0ZXhDb3VudCA9IDA7XG4gICAgICB2YXIgcG9seWdvblNoYXBlID0gbmV3IGIyUG9seWdvblNoYXBlKCk7XG4gICAgICBwb2x5Z29uU2hhcGUuU2V0QXNWZWN0b3IodmVydGljZXMsIHZlcnRleENvdW50KTtcbiAgICAgIHJldHVybiBwb2x5Z29uU2hhcGU7XG4gICB9XG4gICBiMlBvbHlnb25TaGFwZS5wcm90b3R5cGUuU2V0QXNCb3ggPSBmdW5jdGlvbiAoaHgsIGh5KSB7XG4gICAgICBpZiAoaHggPT09IHVuZGVmaW5lZCkgaHggPSAwO1xuICAgICAgaWYgKGh5ID09PSB1bmRlZmluZWQpIGh5ID0gMDtcbiAgICAgIHRoaXMubV92ZXJ0ZXhDb3VudCA9IDQ7XG4gICAgICB0aGlzLlJlc2VydmUoNCk7XG4gICAgICB0aGlzLm1fdmVydGljZXNbMF0uU2V0KCgtaHgpLCAoLWh5KSk7XG4gICAgICB0aGlzLm1fdmVydGljZXNbMV0uU2V0KGh4LCAoLWh5KSk7XG4gICAgICB0aGlzLm1fdmVydGljZXNbMl0uU2V0KGh4LCBoeSk7XG4gICAgICB0aGlzLm1fdmVydGljZXNbM10uU2V0KCgtaHgpLCBoeSk7XG4gICAgICB0aGlzLm1fbm9ybWFsc1swXS5TZXQoMC4wLCAoLTEuMCkpO1xuICAgICAgdGhpcy5tX25vcm1hbHNbMV0uU2V0KDEuMCwgMC4wKTtcbiAgICAgIHRoaXMubV9ub3JtYWxzWzJdLlNldCgwLjAsIDEuMCk7XG4gICAgICB0aGlzLm1fbm9ybWFsc1szXS5TZXQoKC0xLjApLCAwLjApO1xuICAgICAgdGhpcy5tX2NlbnRyb2lkLlNldFplcm8oKTtcbiAgIH1cbiAgIGIyUG9seWdvblNoYXBlLkFzQm94ID0gZnVuY3Rpb24gKGh4LCBoeSkge1xuICAgICAgaWYgKGh4ID09PSB1bmRlZmluZWQpIGh4ID0gMDtcbiAgICAgIGlmIChoeSA9PT0gdW5kZWZpbmVkKSBoeSA9IDA7XG4gICAgICB2YXIgcG9seWdvblNoYXBlID0gbmV3IGIyUG9seWdvblNoYXBlKCk7XG4gICAgICBwb2x5Z29uU2hhcGUuU2V0QXNCb3goaHgsIGh5KTtcbiAgICAgIHJldHVybiBwb2x5Z29uU2hhcGU7XG4gICB9XG4gICBiMlBvbHlnb25TaGFwZS5wcm90b3R5cGUuU2V0QXNPcmllbnRlZEJveCA9IGZ1bmN0aW9uIChoeCwgaHksIGNlbnRlciwgYW5nbGUpIHtcbiAgICAgIGlmIChoeCA9PT0gdW5kZWZpbmVkKSBoeCA9IDA7XG4gICAgICBpZiAoaHkgPT09IHVuZGVmaW5lZCkgaHkgPSAwO1xuICAgICAgaWYgKGNlbnRlciA9PT0gdW5kZWZpbmVkKSBjZW50ZXIgPSBudWxsO1xuICAgICAgaWYgKGFuZ2xlID09PSB1bmRlZmluZWQpIGFuZ2xlID0gMC4wO1xuICAgICAgdGhpcy5tX3ZlcnRleENvdW50ID0gNDtcbiAgICAgIHRoaXMuUmVzZXJ2ZSg0KTtcbiAgICAgIHRoaXMubV92ZXJ0aWNlc1swXS5TZXQoKC1oeCksICgtaHkpKTtcbiAgICAgIHRoaXMubV92ZXJ0aWNlc1sxXS5TZXQoaHgsICgtaHkpKTtcbiAgICAgIHRoaXMubV92ZXJ0aWNlc1syXS5TZXQoaHgsIGh5KTtcbiAgICAgIHRoaXMubV92ZXJ0aWNlc1szXS5TZXQoKC1oeCksIGh5KTtcbiAgICAgIHRoaXMubV9ub3JtYWxzWzBdLlNldCgwLjAsICgtMS4wKSk7XG4gICAgICB0aGlzLm1fbm9ybWFsc1sxXS5TZXQoMS4wLCAwLjApO1xuICAgICAgdGhpcy5tX25vcm1hbHNbMl0uU2V0KDAuMCwgMS4wKTtcbiAgICAgIHRoaXMubV9ub3JtYWxzWzNdLlNldCgoLTEuMCksIDAuMCk7XG4gICAgICB0aGlzLm1fY2VudHJvaWQgPSBjZW50ZXI7XG4gICAgICB2YXIgeGYgPSBuZXcgYjJUcmFuc2Zvcm0oKTtcbiAgICAgIHhmLnBvc2l0aW9uID0gY2VudGVyO1xuICAgICAgeGYuUi5TZXQoYW5nbGUpO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fdmVydGV4Q291bnQ7ICsraSkge1xuICAgICAgICAgdGhpcy5tX3ZlcnRpY2VzW2ldID0gYjJNYXRoLk11bFgoeGYsIHRoaXMubV92ZXJ0aWNlc1tpXSk7XG4gICAgICAgICB0aGlzLm1fbm9ybWFsc1tpXSA9IGIyTWF0aC5NdWxNVih4Zi5SLCB0aGlzLm1fbm9ybWFsc1tpXSk7XG4gICAgICB9XG4gICB9XG4gICBiMlBvbHlnb25TaGFwZS5Bc09yaWVudGVkQm94ID0gZnVuY3Rpb24gKGh4LCBoeSwgY2VudGVyLCBhbmdsZSkge1xuICAgICAgaWYgKGh4ID09PSB1bmRlZmluZWQpIGh4ID0gMDtcbiAgICAgIGlmIChoeSA9PT0gdW5kZWZpbmVkKSBoeSA9IDA7XG4gICAgICBpZiAoY2VudGVyID09PSB1bmRlZmluZWQpIGNlbnRlciA9IG51bGw7XG4gICAgICBpZiAoYW5nbGUgPT09IHVuZGVmaW5lZCkgYW5nbGUgPSAwLjA7XG4gICAgICB2YXIgcG9seWdvblNoYXBlID0gbmV3IGIyUG9seWdvblNoYXBlKCk7XG4gICAgICBwb2x5Z29uU2hhcGUuU2V0QXNPcmllbnRlZEJveChoeCwgaHksIGNlbnRlciwgYW5nbGUpO1xuICAgICAgcmV0dXJuIHBvbHlnb25TaGFwZTtcbiAgIH1cbiAgIGIyUG9seWdvblNoYXBlLnByb3RvdHlwZS5TZXRBc0VkZ2UgPSBmdW5jdGlvbiAodjEsIHYyKSB7XG4gICAgICB0aGlzLm1fdmVydGV4Q291bnQgPSAyO1xuICAgICAgdGhpcy5SZXNlcnZlKDIpO1xuICAgICAgdGhpcy5tX3ZlcnRpY2VzWzBdLlNldFYodjEpO1xuICAgICAgdGhpcy5tX3ZlcnRpY2VzWzFdLlNldFYodjIpO1xuICAgICAgdGhpcy5tX2NlbnRyb2lkLnggPSAwLjUgKiAodjEueCArIHYyLngpO1xuICAgICAgdGhpcy5tX2NlbnRyb2lkLnkgPSAwLjUgKiAodjEueSArIHYyLnkpO1xuICAgICAgdGhpcy5tX25vcm1hbHNbMF0gPSBiMk1hdGguQ3Jvc3NWRihiMk1hdGguU3VidHJhY3RWVih2MiwgdjEpLCAxLjApO1xuICAgICAgdGhpcy5tX25vcm1hbHNbMF0uTm9ybWFsaXplKCk7XG4gICAgICB0aGlzLm1fbm9ybWFsc1sxXS54ID0gKC10aGlzLm1fbm9ybWFsc1swXS54KTtcbiAgICAgIHRoaXMubV9ub3JtYWxzWzFdLnkgPSAoLXRoaXMubV9ub3JtYWxzWzBdLnkpO1xuICAgfVxuICAgYjJQb2x5Z29uU2hhcGUuQXNFZGdlID0gZnVuY3Rpb24gKHYxLCB2Mikge1xuICAgICAgdmFyIHBvbHlnb25TaGFwZSA9IG5ldyBiMlBvbHlnb25TaGFwZSgpO1xuICAgICAgcG9seWdvblNoYXBlLlNldEFzRWRnZSh2MSwgdjIpO1xuICAgICAgcmV0dXJuIHBvbHlnb25TaGFwZTtcbiAgIH1cbiAgIGIyUG9seWdvblNoYXBlLnByb3RvdHlwZS5UZXN0UG9pbnQgPSBmdW5jdGlvbiAoeGYsIHApIHtcbiAgICAgIHZhciB0VmVjO1xuICAgICAgdmFyIHRNYXQgPSB4Zi5SO1xuICAgICAgdmFyIHRYID0gcC54IC0geGYucG9zaXRpb24ueDtcbiAgICAgIHZhciB0WSA9IHAueSAtIHhmLnBvc2l0aW9uLnk7XG4gICAgICB2YXIgcExvY2FsWCA9ICh0WCAqIHRNYXQuY29sMS54ICsgdFkgKiB0TWF0LmNvbDEueSk7XG4gICAgICB2YXIgcExvY2FsWSA9ICh0WCAqIHRNYXQuY29sMi54ICsgdFkgKiB0TWF0LmNvbDIueSk7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV92ZXJ0ZXhDb3VudDsgKytpKSB7XG4gICAgICAgICB0VmVjID0gdGhpcy5tX3ZlcnRpY2VzW2ldO1xuICAgICAgICAgdFggPSBwTG9jYWxYIC0gdFZlYy54O1xuICAgICAgICAgdFkgPSBwTG9jYWxZIC0gdFZlYy55O1xuICAgICAgICAgdFZlYyA9IHRoaXMubV9ub3JtYWxzW2ldO1xuICAgICAgICAgdmFyIGRvdCA9ICh0VmVjLnggKiB0WCArIHRWZWMueSAqIHRZKTtcbiAgICAgICAgIGlmIChkb3QgPiAwLjApIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgfVxuICAgYjJQb2x5Z29uU2hhcGUucHJvdG90eXBlLlJheUNhc3QgPSBmdW5jdGlvbiAob3V0cHV0LCBpbnB1dCwgdHJhbnNmb3JtKSB7XG4gICAgICB2YXIgbG93ZXIgPSAwLjA7XG4gICAgICB2YXIgdXBwZXIgPSBpbnB1dC5tYXhGcmFjdGlvbjtcbiAgICAgIHZhciB0WCA9IDA7XG4gICAgICB2YXIgdFkgPSAwO1xuICAgICAgdmFyIHRNYXQ7XG4gICAgICB2YXIgdFZlYztcbiAgICAgIHRYID0gaW5wdXQucDEueCAtIHRyYW5zZm9ybS5wb3NpdGlvbi54O1xuICAgICAgdFkgPSBpbnB1dC5wMS55IC0gdHJhbnNmb3JtLnBvc2l0aW9uLnk7XG4gICAgICB0TWF0ID0gdHJhbnNmb3JtLlI7XG4gICAgICB2YXIgcDFYID0gKHRYICogdE1hdC5jb2wxLnggKyB0WSAqIHRNYXQuY29sMS55KTtcbiAgICAgIHZhciBwMVkgPSAodFggKiB0TWF0LmNvbDIueCArIHRZICogdE1hdC5jb2wyLnkpO1xuICAgICAgdFggPSBpbnB1dC5wMi54IC0gdHJhbnNmb3JtLnBvc2l0aW9uLng7XG4gICAgICB0WSA9IGlucHV0LnAyLnkgLSB0cmFuc2Zvcm0ucG9zaXRpb24ueTtcbiAgICAgIHRNYXQgPSB0cmFuc2Zvcm0uUjtcbiAgICAgIHZhciBwMlggPSAodFggKiB0TWF0LmNvbDEueCArIHRZICogdE1hdC5jb2wxLnkpO1xuICAgICAgdmFyIHAyWSA9ICh0WCAqIHRNYXQuY29sMi54ICsgdFkgKiB0TWF0LmNvbDIueSk7XG4gICAgICB2YXIgZFggPSBwMlggLSBwMVg7XG4gICAgICB2YXIgZFkgPSBwMlkgLSBwMVk7XG4gICAgICB2YXIgaW5kZXggPSBwYXJzZUludCgoLTEpKTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX3ZlcnRleENvdW50OyArK2kpIHtcbiAgICAgICAgIHRWZWMgPSB0aGlzLm1fdmVydGljZXNbaV07XG4gICAgICAgICB0WCA9IHRWZWMueCAtIHAxWDtcbiAgICAgICAgIHRZID0gdFZlYy55IC0gcDFZO1xuICAgICAgICAgdFZlYyA9IHRoaXMubV9ub3JtYWxzW2ldO1xuICAgICAgICAgdmFyIG51bWVyYXRvciA9ICh0VmVjLnggKiB0WCArIHRWZWMueSAqIHRZKTtcbiAgICAgICAgIHZhciBkZW5vbWluYXRvciA9ICh0VmVjLnggKiBkWCArIHRWZWMueSAqIGRZKTtcbiAgICAgICAgIGlmIChkZW5vbWluYXRvciA9PSAwLjApIHtcbiAgICAgICAgICAgIGlmIChudW1lcmF0b3IgPCAwLjApIHtcbiAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgIH1cbiAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKGRlbm9taW5hdG9yIDwgMC4wICYmIG51bWVyYXRvciA8IGxvd2VyICogZGVub21pbmF0b3IpIHtcbiAgICAgICAgICAgICAgIGxvd2VyID0gbnVtZXJhdG9yIC8gZGVub21pbmF0b3I7XG4gICAgICAgICAgICAgICBpbmRleCA9IGk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChkZW5vbWluYXRvciA+IDAuMCAmJiBudW1lcmF0b3IgPCB1cHBlciAqIGRlbm9taW5hdG9yKSB7XG4gICAgICAgICAgICAgICB1cHBlciA9IG51bWVyYXRvciAvIGRlbm9taW5hdG9yO1xuICAgICAgICAgICAgfVxuICAgICAgICAgfVxuICAgICAgICAgaWYgKHVwcGVyIDwgbG93ZXIgLSBOdW1iZXIuTUlOX1ZBTFVFKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgICAgb3V0cHV0LmZyYWN0aW9uID0gbG93ZXI7XG4gICAgICAgICB0TWF0ID0gdHJhbnNmb3JtLlI7XG4gICAgICAgICB0VmVjID0gdGhpcy5tX25vcm1hbHNbaW5kZXhdO1xuICAgICAgICAgb3V0cHV0Lm5vcm1hbC54ID0gKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xuICAgICAgICAgb3V0cHV0Lm5vcm1hbC55ID0gKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xuICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICB9XG4gICBiMlBvbHlnb25TaGFwZS5wcm90b3R5cGUuQ29tcHV0ZUFBQkIgPSBmdW5jdGlvbiAoYWFiYiwgeGYpIHtcbiAgICAgIHZhciB0TWF0ID0geGYuUjtcbiAgICAgIHZhciB0VmVjID0gdGhpcy5tX3ZlcnRpY2VzWzBdO1xuICAgICAgdmFyIGxvd2VyWCA9IHhmLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XG4gICAgICB2YXIgbG93ZXJZID0geGYucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55KTtcbiAgICAgIHZhciB1cHBlclggPSBsb3dlclg7XG4gICAgICB2YXIgdXBwZXJZID0gbG93ZXJZO1xuICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCB0aGlzLm1fdmVydGV4Q291bnQ7ICsraSkge1xuICAgICAgICAgdFZlYyA9IHRoaXMubV92ZXJ0aWNlc1tpXTtcbiAgICAgICAgIHZhciB2WCA9IHhmLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XG4gICAgICAgICB2YXIgdlkgPSB4Zi5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xuICAgICAgICAgbG93ZXJYID0gbG93ZXJYIDwgdlggPyBsb3dlclggOiB2WDtcbiAgICAgICAgIGxvd2VyWSA9IGxvd2VyWSA8IHZZID8gbG93ZXJZIDogdlk7XG4gICAgICAgICB1cHBlclggPSB1cHBlclggPiB2WCA/IHVwcGVyWCA6IHZYO1xuICAgICAgICAgdXBwZXJZID0gdXBwZXJZID4gdlkgPyB1cHBlclkgOiB2WTtcbiAgICAgIH1cbiAgICAgIGFhYmIubG93ZXJCb3VuZC54ID0gbG93ZXJYIC0gdGhpcy5tX3JhZGl1cztcbiAgICAgIGFhYmIubG93ZXJCb3VuZC55ID0gbG93ZXJZIC0gdGhpcy5tX3JhZGl1cztcbiAgICAgIGFhYmIudXBwZXJCb3VuZC54ID0gdXBwZXJYICsgdGhpcy5tX3JhZGl1cztcbiAgICAgIGFhYmIudXBwZXJCb3VuZC55ID0gdXBwZXJZICsgdGhpcy5tX3JhZGl1cztcbiAgIH1cbiAgIGIyUG9seWdvblNoYXBlLnByb3RvdHlwZS5Db21wdXRlTWFzcyA9IGZ1bmN0aW9uIChtYXNzRGF0YSwgZGVuc2l0eSkge1xuICAgICAgaWYgKGRlbnNpdHkgPT09IHVuZGVmaW5lZCkgZGVuc2l0eSA9IDA7XG4gICAgICBpZiAodGhpcy5tX3ZlcnRleENvdW50ID09IDIpIHtcbiAgICAgICAgIG1hc3NEYXRhLmNlbnRlci54ID0gMC41ICogKHRoaXMubV92ZXJ0aWNlc1swXS54ICsgdGhpcy5tX3ZlcnRpY2VzWzFdLngpO1xuICAgICAgICAgbWFzc0RhdGEuY2VudGVyLnkgPSAwLjUgKiAodGhpcy5tX3ZlcnRpY2VzWzBdLnkgKyB0aGlzLm1fdmVydGljZXNbMV0ueSk7XG4gICAgICAgICBtYXNzRGF0YS5tYXNzID0gMC4wO1xuICAgICAgICAgbWFzc0RhdGEuSSA9IDAuMDtcbiAgICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhciBjZW50ZXJYID0gMC4wO1xuICAgICAgdmFyIGNlbnRlclkgPSAwLjA7XG4gICAgICB2YXIgYXJlYSA9IDAuMDtcbiAgICAgIHZhciBJID0gMC4wO1xuICAgICAgdmFyIHAxWCA9IDAuMDtcbiAgICAgIHZhciBwMVkgPSAwLjA7XG4gICAgICB2YXIga19pbnYzID0gMS4wIC8gMy4wO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fdmVydGV4Q291bnQ7ICsraSkge1xuICAgICAgICAgdmFyIHAyID0gdGhpcy5tX3ZlcnRpY2VzW2ldO1xuICAgICAgICAgdmFyIHAzID0gaSArIDEgPCB0aGlzLm1fdmVydGV4Q291bnQgPyB0aGlzLm1fdmVydGljZXNbcGFyc2VJbnQoaSArIDEpXSA6IHRoaXMubV92ZXJ0aWNlc1swXTtcbiAgICAgICAgIHZhciBlMVggPSBwMi54IC0gcDFYO1xuICAgICAgICAgdmFyIGUxWSA9IHAyLnkgLSBwMVk7XG4gICAgICAgICB2YXIgZTJYID0gcDMueCAtIHAxWDtcbiAgICAgICAgIHZhciBlMlkgPSBwMy55IC0gcDFZO1xuICAgICAgICAgdmFyIEQgPSBlMVggKiBlMlkgLSBlMVkgKiBlMlg7XG4gICAgICAgICB2YXIgdHJpYW5nbGVBcmVhID0gMC41ICogRDthcmVhICs9IHRyaWFuZ2xlQXJlYTtcbiAgICAgICAgIGNlbnRlclggKz0gdHJpYW5nbGVBcmVhICoga19pbnYzICogKHAxWCArIHAyLnggKyBwMy54KTtcbiAgICAgICAgIGNlbnRlclkgKz0gdHJpYW5nbGVBcmVhICoga19pbnYzICogKHAxWSArIHAyLnkgKyBwMy55KTtcbiAgICAgICAgIHZhciBweCA9IHAxWDtcbiAgICAgICAgIHZhciBweSA9IHAxWTtcbiAgICAgICAgIHZhciBleDEgPSBlMVg7XG4gICAgICAgICB2YXIgZXkxID0gZTFZO1xuICAgICAgICAgdmFyIGV4MiA9IGUyWDtcbiAgICAgICAgIHZhciBleTIgPSBlMlk7XG4gICAgICAgICB2YXIgaW50eDIgPSBrX2ludjMgKiAoMC4yNSAqIChleDEgKiBleDEgKyBleDIgKiBleDEgKyBleDIgKiBleDIpICsgKHB4ICogZXgxICsgcHggKiBleDIpKSArIDAuNSAqIHB4ICogcHg7XG4gICAgICAgICB2YXIgaW50eTIgPSBrX2ludjMgKiAoMC4yNSAqIChleTEgKiBleTEgKyBleTIgKiBleTEgKyBleTIgKiBleTIpICsgKHB5ICogZXkxICsgcHkgKiBleTIpKSArIDAuNSAqIHB5ICogcHk7SSArPSBEICogKGludHgyICsgaW50eTIpO1xuICAgICAgfVxuICAgICAgbWFzc0RhdGEubWFzcyA9IGRlbnNpdHkgKiBhcmVhO1xuICAgICAgY2VudGVyWCAqPSAxLjAgLyBhcmVhO1xuICAgICAgY2VudGVyWSAqPSAxLjAgLyBhcmVhO1xuICAgICAgbWFzc0RhdGEuY2VudGVyLlNldChjZW50ZXJYLCBjZW50ZXJZKTtcbiAgICAgIG1hc3NEYXRhLkkgPSBkZW5zaXR5ICogSTtcbiAgIH1cbiAgIGIyUG9seWdvblNoYXBlLnByb3RvdHlwZS5Db21wdXRlU3VibWVyZ2VkQXJlYSA9IGZ1bmN0aW9uIChub3JtYWwsIG9mZnNldCwgeGYsIGMpIHtcbiAgICAgIGlmIChvZmZzZXQgPT09IHVuZGVmaW5lZCkgb2Zmc2V0ID0gMDtcbiAgICAgIHZhciBub3JtYWxMID0gYjJNYXRoLk11bFRNVih4Zi5SLCBub3JtYWwpO1xuICAgICAgdmFyIG9mZnNldEwgPSBvZmZzZXQgLSBiMk1hdGguRG90KG5vcm1hbCwgeGYucG9zaXRpb24pO1xuICAgICAgdmFyIGRlcHRocyA9IG5ldyBWZWN0b3JfYTJqX051bWJlcigpO1xuICAgICAgdmFyIGRpdmVDb3VudCA9IDA7XG4gICAgICB2YXIgaW50b0luZGV4ID0gcGFyc2VJbnQoKC0xKSk7XG4gICAgICB2YXIgb3V0b0luZGV4ID0gcGFyc2VJbnQoKC0xKSk7XG4gICAgICB2YXIgbGFzdFN1Ym1lcmdlZCA9IGZhbHNlO1xuICAgICAgdmFyIGkgPSAwO1xuICAgICAgZm9yIChpID0gMDtcbiAgICAgIGkgPCB0aGlzLm1fdmVydGV4Q291bnQ7ICsraSkge1xuICAgICAgICAgZGVwdGhzW2ldID0gYjJNYXRoLkRvdChub3JtYWxMLCB0aGlzLm1fdmVydGljZXNbaV0pIC0gb2Zmc2V0TDtcbiAgICAgICAgIHZhciBpc1N1Ym1lcmdlZCA9IGRlcHRoc1tpXSA8ICgtTnVtYmVyLk1JTl9WQUxVRSk7XG4gICAgICAgICBpZiAoaSA+IDApIHtcbiAgICAgICAgICAgIGlmIChpc1N1Ym1lcmdlZCkge1xuICAgICAgICAgICAgICAgaWYgKCFsYXN0U3VibWVyZ2VkKSB7XG4gICAgICAgICAgICAgICAgICBpbnRvSW5kZXggPSBpIC0gMTtcbiAgICAgICAgICAgICAgICAgIGRpdmVDb3VudCsrO1xuICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICBpZiAobGFzdFN1Ym1lcmdlZCkge1xuICAgICAgICAgICAgICAgICAgb3V0b0luZGV4ID0gaSAtIDE7XG4gICAgICAgICAgICAgICAgICBkaXZlQ291bnQrKztcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgIH1cbiAgICAgICAgIGxhc3RTdWJtZXJnZWQgPSBpc1N1Ym1lcmdlZDtcbiAgICAgIH1cbiAgICAgIHN3aXRjaCAoZGl2ZUNvdW50KSB7XG4gICAgICBjYXNlIDA6XG4gICAgICAgICBpZiAobGFzdFN1Ym1lcmdlZCkge1xuICAgICAgICAgICAgdmFyIG1kID0gbmV3IGIyTWFzc0RhdGEoKTtcbiAgICAgICAgICAgIHRoaXMuQ29tcHV0ZU1hc3MobWQsIDEpO1xuICAgICAgICAgICAgYy5TZXRWKGIyTWF0aC5NdWxYKHhmLCBtZC5jZW50ZXIpKTtcbiAgICAgICAgICAgIHJldHVybiBtZC5tYXNzO1xuICAgICAgICAgfVxuICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgIH1cbiAgICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAxOlxuICAgICAgICAgaWYgKGludG9JbmRleCA9PSAoLTEpKSB7XG4gICAgICAgICAgICBpbnRvSW5kZXggPSB0aGlzLm1fdmVydGV4Q291bnQgLSAxO1xuICAgICAgICAgfVxuICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBvdXRvSW5kZXggPSB0aGlzLm1fdmVydGV4Q291bnQgLSAxO1xuICAgICAgICAgfVxuICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICB2YXIgaW50b0luZGV4MiA9IHBhcnNlSW50KChpbnRvSW5kZXggKyAxKSAlIHRoaXMubV92ZXJ0ZXhDb3VudCk7XG4gICAgICB2YXIgb3V0b0luZGV4MiA9IHBhcnNlSW50KChvdXRvSW5kZXggKyAxKSAlIHRoaXMubV92ZXJ0ZXhDb3VudCk7XG4gICAgICB2YXIgaW50b0xhbWRkYSA9ICgwIC0gZGVwdGhzW2ludG9JbmRleF0pIC8gKGRlcHRoc1tpbnRvSW5kZXgyXSAtIGRlcHRoc1tpbnRvSW5kZXhdKTtcbiAgICAgIHZhciBvdXRvTGFtZGRhID0gKDAgLSBkZXB0aHNbb3V0b0luZGV4XSkgLyAoZGVwdGhzW291dG9JbmRleDJdIC0gZGVwdGhzW291dG9JbmRleF0pO1xuICAgICAgdmFyIGludG9WZWMgPSBuZXcgYjJWZWMyKHRoaXMubV92ZXJ0aWNlc1tpbnRvSW5kZXhdLnggKiAoMSAtIGludG9MYW1kZGEpICsgdGhpcy5tX3ZlcnRpY2VzW2ludG9JbmRleDJdLnggKiBpbnRvTGFtZGRhLCB0aGlzLm1fdmVydGljZXNbaW50b0luZGV4XS55ICogKDEgLSBpbnRvTGFtZGRhKSArIHRoaXMubV92ZXJ0aWNlc1tpbnRvSW5kZXgyXS55ICogaW50b0xhbWRkYSk7XG4gICAgICB2YXIgb3V0b1ZlYyA9IG5ldyBiMlZlYzIodGhpcy5tX3ZlcnRpY2VzW291dG9JbmRleF0ueCAqICgxIC0gb3V0b0xhbWRkYSkgKyB0aGlzLm1fdmVydGljZXNbb3V0b0luZGV4Ml0ueCAqIG91dG9MYW1kZGEsIHRoaXMubV92ZXJ0aWNlc1tvdXRvSW5kZXhdLnkgKiAoMSAtIG91dG9MYW1kZGEpICsgdGhpcy5tX3ZlcnRpY2VzW291dG9JbmRleDJdLnkgKiBvdXRvTGFtZGRhKTtcbiAgICAgIHZhciBhcmVhID0gMDtcbiAgICAgIHZhciBjZW50ZXIgPSBuZXcgYjJWZWMyKCk7XG4gICAgICB2YXIgcDIgPSB0aGlzLm1fdmVydGljZXNbaW50b0luZGV4Ml07XG4gICAgICB2YXIgcDM7XG4gICAgICBpID0gaW50b0luZGV4MjtcbiAgICAgIHdoaWxlIChpICE9IG91dG9JbmRleDIpIHtcbiAgICAgICAgIGkgPSAoaSArIDEpICUgdGhpcy5tX3ZlcnRleENvdW50O1xuICAgICAgICAgaWYgKGkgPT0gb3V0b0luZGV4MikgcDMgPSBvdXRvVmVjO1xuICAgICAgICAgZWxzZSBwMyA9IHRoaXMubV92ZXJ0aWNlc1tpXTtcbiAgICAgICAgIHZhciB0cmlhbmdsZUFyZWEgPSAwLjUgKiAoKHAyLnggLSBpbnRvVmVjLngpICogKHAzLnkgLSBpbnRvVmVjLnkpIC0gKHAyLnkgLSBpbnRvVmVjLnkpICogKHAzLnggLSBpbnRvVmVjLngpKTtcbiAgICAgICAgIGFyZWEgKz0gdHJpYW5nbGVBcmVhO1xuICAgICAgICAgY2VudGVyLnggKz0gdHJpYW5nbGVBcmVhICogKGludG9WZWMueCArIHAyLnggKyBwMy54KSAvIDM7XG4gICAgICAgICBjZW50ZXIueSArPSB0cmlhbmdsZUFyZWEgKiAoaW50b1ZlYy55ICsgcDIueSArIHAzLnkpIC8gMztcbiAgICAgICAgIHAyID0gcDM7XG4gICAgICB9XG4gICAgICBjZW50ZXIuTXVsdGlwbHkoMSAvIGFyZWEpO1xuICAgICAgYy5TZXRWKGIyTWF0aC5NdWxYKHhmLCBjZW50ZXIpKTtcbiAgICAgIHJldHVybiBhcmVhO1xuICAgfVxuICAgYjJQb2x5Z29uU2hhcGUucHJvdG90eXBlLkdldFZlcnRleENvdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV92ZXJ0ZXhDb3VudDtcbiAgIH1cbiAgIGIyUG9seWdvblNoYXBlLnByb3RvdHlwZS5HZXRWZXJ0aWNlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fdmVydGljZXM7XG4gICB9XG4gICBiMlBvbHlnb25TaGFwZS5wcm90b3R5cGUuR2V0Tm9ybWFscyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fbm9ybWFscztcbiAgIH1cbiAgIGIyUG9seWdvblNoYXBlLnByb3RvdHlwZS5HZXRTdXBwb3J0ID0gZnVuY3Rpb24gKGQpIHtcbiAgICAgIHZhciBiZXN0SW5kZXggPSAwO1xuICAgICAgdmFyIGJlc3RWYWx1ZSA9IHRoaXMubV92ZXJ0aWNlc1swXS54ICogZC54ICsgdGhpcy5tX3ZlcnRpY2VzWzBdLnkgKiBkLnk7XG4gICAgICBmb3IgKHZhciBpID0gMTsgaSA8IHRoaXMubV92ZXJ0ZXhDb3VudDsgKytpKSB7XG4gICAgICAgICB2YXIgdmFsdWUgPSB0aGlzLm1fdmVydGljZXNbaV0ueCAqIGQueCArIHRoaXMubV92ZXJ0aWNlc1tpXS55ICogZC55O1xuICAgICAgICAgaWYgKHZhbHVlID4gYmVzdFZhbHVlKSB7XG4gICAgICAgICAgICBiZXN0SW5kZXggPSBpO1xuICAgICAgICAgICAgYmVzdFZhbHVlID0gdmFsdWU7XG4gICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gYmVzdEluZGV4O1xuICAgfVxuICAgYjJQb2x5Z29uU2hhcGUucHJvdG90eXBlLkdldFN1cHBvcnRWZXJ0ZXggPSBmdW5jdGlvbiAoZCkge1xuICAgICAgdmFyIGJlc3RJbmRleCA9IDA7XG4gICAgICB2YXIgYmVzdFZhbHVlID0gdGhpcy5tX3ZlcnRpY2VzWzBdLnggKiBkLnggKyB0aGlzLm1fdmVydGljZXNbMF0ueSAqIGQueTtcbiAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgdGhpcy5tX3ZlcnRleENvdW50OyArK2kpIHtcbiAgICAgICAgIHZhciB2YWx1ZSA9IHRoaXMubV92ZXJ0aWNlc1tpXS54ICogZC54ICsgdGhpcy5tX3ZlcnRpY2VzW2ldLnkgKiBkLnk7XG4gICAgICAgICBpZiAodmFsdWUgPiBiZXN0VmFsdWUpIHtcbiAgICAgICAgICAgIGJlc3RJbmRleCA9IGk7XG4gICAgICAgICAgICBiZXN0VmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLm1fdmVydGljZXNbYmVzdEluZGV4XTtcbiAgIH1cbiAgIGIyUG9seWdvblNoYXBlLnByb3RvdHlwZS5WYWxpZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgIH1cbiAgIGIyUG9seWdvblNoYXBlLnByb3RvdHlwZS5iMlBvbHlnb25TaGFwZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX19zdXBlci5iMlNoYXBlLmNhbGwodGhpcyk7XG4gICAgICB0aGlzLm1fdHlwZSA9IGIyU2hhcGUuZV9wb2x5Z29uU2hhcGU7XG4gICAgICB0aGlzLm1fY2VudHJvaWQgPSBuZXcgYjJWZWMyKCk7XG4gICAgICB0aGlzLm1fdmVydGljZXMgPSBuZXcgVmVjdG9yKCk7XG4gICAgICB0aGlzLm1fbm9ybWFscyA9IG5ldyBWZWN0b3IoKTtcbiAgIH1cbiAgIGIyUG9seWdvblNoYXBlLnByb3RvdHlwZS5SZXNlcnZlID0gZnVuY3Rpb24gKGNvdW50KSB7XG4gICAgICBpZiAoY291bnQgPT09IHVuZGVmaW5lZCkgY291bnQgPSAwO1xuICAgICAgZm9yICh2YXIgaSA9IHBhcnNlSW50KHRoaXMubV92ZXJ0aWNlcy5sZW5ndGgpOyBpIDwgY291bnQ7IGkrKykge1xuICAgICAgICAgdGhpcy5tX3ZlcnRpY2VzW2ldID0gbmV3IGIyVmVjMigpO1xuICAgICAgICAgdGhpcy5tX25vcm1hbHNbaV0gPSBuZXcgYjJWZWMyKCk7XG4gICAgICB9XG4gICB9XG4gICBiMlBvbHlnb25TaGFwZS5Db21wdXRlQ2VudHJvaWQgPSBmdW5jdGlvbiAodnMsIGNvdW50KSB7XG4gICAgICBpZiAoY291bnQgPT09IHVuZGVmaW5lZCkgY291bnQgPSAwO1xuICAgICAgdmFyIGMgPSBuZXcgYjJWZWMyKCk7XG4gICAgICB2YXIgYXJlYSA9IDAuMDtcbiAgICAgIHZhciBwMVggPSAwLjA7XG4gICAgICB2YXIgcDFZID0gMC4wO1xuICAgICAgdmFyIGludjMgPSAxLjAgLyAzLjA7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyArK2kpIHtcbiAgICAgICAgIHZhciBwMiA9IHZzW2ldO1xuICAgICAgICAgdmFyIHAzID0gaSArIDEgPCBjb3VudCA/IHZzW3BhcnNlSW50KGkgKyAxKV0gOiB2c1swXTtcbiAgICAgICAgIHZhciBlMVggPSBwMi54IC0gcDFYO1xuICAgICAgICAgdmFyIGUxWSA9IHAyLnkgLSBwMVk7XG4gICAgICAgICB2YXIgZTJYID0gcDMueCAtIHAxWDtcbiAgICAgICAgIHZhciBlMlkgPSBwMy55IC0gcDFZO1xuICAgICAgICAgdmFyIEQgPSAoZTFYICogZTJZIC0gZTFZICogZTJYKTtcbiAgICAgICAgIHZhciB0cmlhbmdsZUFyZWEgPSAwLjUgKiBEO2FyZWEgKz0gdHJpYW5nbGVBcmVhO1xuICAgICAgICAgYy54ICs9IHRyaWFuZ2xlQXJlYSAqIGludjMgKiAocDFYICsgcDIueCArIHAzLngpO1xuICAgICAgICAgYy55ICs9IHRyaWFuZ2xlQXJlYSAqIGludjMgKiAocDFZICsgcDIueSArIHAzLnkpO1xuICAgICAgfVxuICAgICAgYy54ICo9IDEuMCAvIGFyZWE7XG4gICAgICBjLnkgKj0gMS4wIC8gYXJlYTtcbiAgICAgIHJldHVybiBjO1xuICAgfVxuICAgYjJQb2x5Z29uU2hhcGUuQ29tcHV0ZU9CQiA9IGZ1bmN0aW9uIChvYmIsIHZzLCBjb3VudCkge1xuICAgICAgaWYgKGNvdW50ID09PSB1bmRlZmluZWQpIGNvdW50ID0gMDtcbiAgICAgIHZhciBpID0gMDtcbiAgICAgIHZhciBwID0gbmV3IFZlY3Rvcihjb3VudCArIDEpO1xuICAgICAgZm9yIChpID0gMDtcbiAgICAgIGkgPCBjb3VudDsgKytpKSB7XG4gICAgICAgICBwW2ldID0gdnNbaV07XG4gICAgICB9XG4gICAgICBwW2NvdW50XSA9IHBbMF07XG4gICAgICB2YXIgbWluQXJlYSA9IE51bWJlci5NQVhfVkFMVUU7XG4gICAgICBmb3IgKGkgPSAxO1xuICAgICAgaSA8PSBjb3VudDsgKytpKSB7XG4gICAgICAgICB2YXIgcm9vdCA9IHBbcGFyc2VJbnQoaSAtIDEpXTtcbiAgICAgICAgIHZhciB1eFggPSBwW2ldLnggLSByb290Lng7XG4gICAgICAgICB2YXIgdXhZID0gcFtpXS55IC0gcm9vdC55O1xuICAgICAgICAgdmFyIGxlbmd0aCA9IE1hdGguc3FydCh1eFggKiB1eFggKyB1eFkgKiB1eFkpO1xuICAgICAgICAgdXhYIC89IGxlbmd0aDtcbiAgICAgICAgIHV4WSAvPSBsZW5ndGg7XG4gICAgICAgICB2YXIgdXlYID0gKC11eFkpO1xuICAgICAgICAgdmFyIHV5WSA9IHV4WDtcbiAgICAgICAgIHZhciBsb3dlclggPSBOdW1iZXIuTUFYX1ZBTFVFO1xuICAgICAgICAgdmFyIGxvd2VyWSA9IE51bWJlci5NQVhfVkFMVUU7XG4gICAgICAgICB2YXIgdXBwZXJYID0gKC1OdW1iZXIuTUFYX1ZBTFVFKTtcbiAgICAgICAgIHZhciB1cHBlclkgPSAoLU51bWJlci5NQVhfVkFMVUUpO1xuICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBjb3VudDsgKytqKSB7XG4gICAgICAgICAgICB2YXIgZFggPSBwW2pdLnggLSByb290Lng7XG4gICAgICAgICAgICB2YXIgZFkgPSBwW2pdLnkgLSByb290Lnk7XG4gICAgICAgICAgICB2YXIgclggPSAodXhYICogZFggKyB1eFkgKiBkWSk7XG4gICAgICAgICAgICB2YXIgclkgPSAodXlYICogZFggKyB1eVkgKiBkWSk7XG4gICAgICAgICAgICBpZiAoclggPCBsb3dlclgpIGxvd2VyWCA9IHJYO1xuICAgICAgICAgICAgaWYgKHJZIDwgbG93ZXJZKSBsb3dlclkgPSByWTtcbiAgICAgICAgICAgIGlmIChyWCA+IHVwcGVyWCkgdXBwZXJYID0gclg7XG4gICAgICAgICAgICBpZiAoclkgPiB1cHBlclkpIHVwcGVyWSA9IHJZO1xuICAgICAgICAgfVxuICAgICAgICAgdmFyIGFyZWEgPSAodXBwZXJYIC0gbG93ZXJYKSAqICh1cHBlclkgLSBsb3dlclkpO1xuICAgICAgICAgaWYgKGFyZWEgPCAwLjk1ICogbWluQXJlYSkge1xuICAgICAgICAgICAgbWluQXJlYSA9IGFyZWE7XG4gICAgICAgICAgICBvYmIuUi5jb2wxLnggPSB1eFg7XG4gICAgICAgICAgICBvYmIuUi5jb2wxLnkgPSB1eFk7XG4gICAgICAgICAgICBvYmIuUi5jb2wyLnggPSB1eVg7XG4gICAgICAgICAgICBvYmIuUi5jb2wyLnkgPSB1eVk7XG4gICAgICAgICAgICB2YXIgY2VudGVyWCA9IDAuNSAqIChsb3dlclggKyB1cHBlclgpO1xuICAgICAgICAgICAgdmFyIGNlbnRlclkgPSAwLjUgKiAobG93ZXJZICsgdXBwZXJZKTtcbiAgICAgICAgICAgIHZhciB0TWF0ID0gb2JiLlI7XG4gICAgICAgICAgICBvYmIuY2VudGVyLnggPSByb290LnggKyAodE1hdC5jb2wxLnggKiBjZW50ZXJYICsgdE1hdC5jb2wyLnggKiBjZW50ZXJZKTtcbiAgICAgICAgICAgIG9iYi5jZW50ZXIueSA9IHJvb3QueSArICh0TWF0LmNvbDEueSAqIGNlbnRlclggKyB0TWF0LmNvbDIueSAqIGNlbnRlclkpO1xuICAgICAgICAgICAgb2JiLmV4dGVudHMueCA9IDAuNSAqICh1cHBlclggLSBsb3dlclgpO1xuICAgICAgICAgICAgb2JiLmV4dGVudHMueSA9IDAuNSAqICh1cHBlclkgLSBsb3dlclkpO1xuICAgICAgICAgfVxuICAgICAgfVxuICAgfVxuICAgQm94MkQucG9zdERlZnMucHVzaChmdW5jdGlvbiAoKSB7XG4gICAgICBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyUG9seWdvblNoYXBlLnNfbWF0ID0gbmV3IGIyTWF0MjIoKTtcbiAgIH0pO1xuICAgYjJTaGFwZS5iMlNoYXBlID0gZnVuY3Rpb24gKCkge307XG4gICBiMlNoYXBlLnByb3RvdHlwZS5Db3B5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICB9XG4gICBiMlNoYXBlLnByb3RvdHlwZS5TZXQgPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICAgIHRoaXMubV9yYWRpdXMgPSBvdGhlci5tX3JhZGl1cztcbiAgIH1cbiAgIGIyU2hhcGUucHJvdG90eXBlLkdldFR5cGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX3R5cGU7XG4gICB9XG4gICBiMlNoYXBlLnByb3RvdHlwZS5UZXN0UG9pbnQgPSBmdW5jdGlvbiAoeGYsIHApIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgIH1cbiAgIGIyU2hhcGUucHJvdG90eXBlLlJheUNhc3QgPSBmdW5jdGlvbiAob3V0cHV0LCBpbnB1dCwgdHJhbnNmb3JtKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICB9XG4gICBiMlNoYXBlLnByb3RvdHlwZS5Db21wdXRlQUFCQiA9IGZ1bmN0aW9uIChhYWJiLCB4Zikge31cbiAgIGIyU2hhcGUucHJvdG90eXBlLkNvbXB1dGVNYXNzID0gZnVuY3Rpb24gKG1hc3NEYXRhLCBkZW5zaXR5KSB7XG4gICAgICBpZiAoZGVuc2l0eSA9PT0gdW5kZWZpbmVkKSBkZW5zaXR5ID0gMDtcbiAgIH1cbiAgIGIyU2hhcGUucHJvdG90eXBlLkNvbXB1dGVTdWJtZXJnZWRBcmVhID0gZnVuY3Rpb24gKG5vcm1hbCwgb2Zmc2V0LCB4ZiwgYykge1xuICAgICAgaWYgKG9mZnNldCA9PT0gdW5kZWZpbmVkKSBvZmZzZXQgPSAwO1xuICAgICAgcmV0dXJuIDA7XG4gICB9XG4gICBiMlNoYXBlLlRlc3RPdmVybGFwID0gZnVuY3Rpb24gKHNoYXBlMSwgdHJhbnNmb3JtMSwgc2hhcGUyLCB0cmFuc2Zvcm0yKSB7XG4gICAgICB2YXIgaW5wdXQgPSBuZXcgYjJEaXN0YW5jZUlucHV0KCk7XG4gICAgICBpbnB1dC5wcm94eUEgPSBuZXcgYjJEaXN0YW5jZVByb3h5KCk7XG4gICAgICBpbnB1dC5wcm94eUEuU2V0KHNoYXBlMSk7XG4gICAgICBpbnB1dC5wcm94eUIgPSBuZXcgYjJEaXN0YW5jZVByb3h5KCk7XG4gICAgICBpbnB1dC5wcm94eUIuU2V0KHNoYXBlMik7XG4gICAgICBpbnB1dC50cmFuc2Zvcm1BID0gdHJhbnNmb3JtMTtcbiAgICAgIGlucHV0LnRyYW5zZm9ybUIgPSB0cmFuc2Zvcm0yO1xuICAgICAgaW5wdXQudXNlUmFkaWkgPSB0cnVlO1xuICAgICAgdmFyIHNpbXBsZXhDYWNoZSA9IG5ldyBiMlNpbXBsZXhDYWNoZSgpO1xuICAgICAgc2ltcGxleENhY2hlLmNvdW50ID0gMDtcbiAgICAgIHZhciBvdXRwdXQgPSBuZXcgYjJEaXN0YW5jZU91dHB1dCgpO1xuICAgICAgYjJEaXN0YW5jZS5EaXN0YW5jZShvdXRwdXQsIHNpbXBsZXhDYWNoZSwgaW5wdXQpO1xuICAgICAgcmV0dXJuIG91dHB1dC5kaXN0YW5jZSA8IDEwLjAgKiBOdW1iZXIuTUlOX1ZBTFVFO1xuICAgfVxuICAgYjJTaGFwZS5wcm90b3R5cGUuYjJTaGFwZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMubV90eXBlID0gYjJTaGFwZS5lX3Vua25vd25TaGFwZTtcbiAgICAgIHRoaXMubV9yYWRpdXMgPSBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3A7XG4gICB9XG4gICBCb3gyRC5wb3N0RGVmcy5wdXNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJTaGFwZS5lX3Vua25vd25TaGFwZSA9IHBhcnNlSW50KCgtMSkpO1xuICAgICAgQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlNoYXBlLmVfY2lyY2xlU2hhcGUgPSAwO1xuICAgICAgQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlNoYXBlLmVfcG9seWdvblNoYXBlID0gMTtcbiAgICAgIEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJTaGFwZS5lX2VkZ2VTaGFwZSA9IDI7XG4gICAgICBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyU2hhcGUuZV9zaGFwZVR5cGVDb3VudCA9IDM7XG4gICAgICBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyU2hhcGUuZV9oaXRDb2xsaWRlID0gMTtcbiAgICAgIEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJTaGFwZS5lX21pc3NDb2xsaWRlID0gMDtcbiAgICAgIEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJTaGFwZS5lX3N0YXJ0c0luc2lkZUNvbGxpZGUgPSBwYXJzZUludCgoLTEpKTtcbiAgIH0pO1xufSkoKTtcbihmdW5jdGlvbiAoKSB7XG4gICB2YXIgYjJDb2xvciA9IEJveDJELkNvbW1vbi5iMkNvbG9yLFxuICAgICAgYjJpbnRlcm5hbCA9IEJveDJELkNvbW1vbi5iMmludGVybmFsLFxuICAgICAgYjJTZXR0aW5ncyA9IEJveDJELkNvbW1vbi5iMlNldHRpbmdzLFxuICAgICAgYjJNYXQyMiA9IEJveDJELkNvbW1vbi5NYXRoLmIyTWF0MjIsXG4gICAgICBiMk1hdDMzID0gQm94MkQuQ29tbW9uLk1hdGguYjJNYXQzMyxcbiAgICAgIGIyTWF0aCA9IEJveDJELkNvbW1vbi5NYXRoLmIyTWF0aCxcbiAgICAgIGIyU3dlZXAgPSBCb3gyRC5Db21tb24uTWF0aC5iMlN3ZWVwLFxuICAgICAgYjJUcmFuc2Zvcm0gPSBCb3gyRC5Db21tb24uTWF0aC5iMlRyYW5zZm9ybSxcbiAgICAgIGIyVmVjMiA9IEJveDJELkNvbW1vbi5NYXRoLmIyVmVjMixcbiAgICAgIGIyVmVjMyA9IEJveDJELkNvbW1vbi5NYXRoLmIyVmVjMztcblxuICAgYjJDb2xvci5iMkNvbG9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5fciA9IDA7XG4gICAgICB0aGlzLl9nID0gMDtcbiAgICAgIHRoaXMuX2IgPSAwO1xuICAgfTtcbiAgIGIyQ29sb3IucHJvdG90eXBlLmIyQ29sb3IgPSBmdW5jdGlvbiAocnIsIGdnLCBiYikge1xuICAgICAgaWYgKHJyID09PSB1bmRlZmluZWQpIHJyID0gMDtcbiAgICAgIGlmIChnZyA9PT0gdW5kZWZpbmVkKSBnZyA9IDA7XG4gICAgICBpZiAoYmIgPT09IHVuZGVmaW5lZCkgYmIgPSAwO1xuICAgICAgdGhpcy5fciA9IEJveDJELnBhcnNlVUludCgyNTUgKiBiMk1hdGguQ2xhbXAocnIsIDAuMCwgMS4wKSk7XG4gICAgICB0aGlzLl9nID0gQm94MkQucGFyc2VVSW50KDI1NSAqIGIyTWF0aC5DbGFtcChnZywgMC4wLCAxLjApKTtcbiAgICAgIHRoaXMuX2IgPSBCb3gyRC5wYXJzZVVJbnQoMjU1ICogYjJNYXRoLkNsYW1wKGJiLCAwLjAsIDEuMCkpO1xuICAgfVxuICAgYjJDb2xvci5wcm90b3R5cGUuU2V0ID0gZnVuY3Rpb24gKHJyLCBnZywgYmIpIHtcbiAgICAgIGlmIChyciA9PT0gdW5kZWZpbmVkKSByciA9IDA7XG4gICAgICBpZiAoZ2cgPT09IHVuZGVmaW5lZCkgZ2cgPSAwO1xuICAgICAgaWYgKGJiID09PSB1bmRlZmluZWQpIGJiID0gMDtcbiAgICAgIHRoaXMuX3IgPSBCb3gyRC5wYXJzZVVJbnQoMjU1ICogYjJNYXRoLkNsYW1wKHJyLCAwLjAsIDEuMCkpO1xuICAgICAgdGhpcy5fZyA9IEJveDJELnBhcnNlVUludCgyNTUgKiBiMk1hdGguQ2xhbXAoZ2csIDAuMCwgMS4wKSk7XG4gICAgICB0aGlzLl9iID0gQm94MkQucGFyc2VVSW50KDI1NSAqIGIyTWF0aC5DbGFtcChiYiwgMC4wLCAxLjApKTtcbiAgIH1cbiAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShiMkNvbG9yLnByb3RvdHlwZSwgJ3InLCB7XG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHJyKSB7XG4gICAgICAgICBpZiAocnIgPT09IHVuZGVmaW5lZCkgcnIgPSAwO1xuICAgICAgICAgdGhpcy5fciA9IEJveDJELnBhcnNlVUludCgyNTUgKiBiMk1hdGguQ2xhbXAocnIsIDAuMCwgMS4wKSk7XG4gICAgICB9XG4gICB9KTtcbiAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShiMkNvbG9yLnByb3RvdHlwZSwgJ2cnLCB7XG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIHNldDogZnVuY3Rpb24gKGdnKSB7XG4gICAgICAgICBpZiAoZ2cgPT09IHVuZGVmaW5lZCkgZ2cgPSAwO1xuICAgICAgICAgdGhpcy5fZyA9IEJveDJELnBhcnNlVUludCgyNTUgKiBiMk1hdGguQ2xhbXAoZ2csIDAuMCwgMS4wKSk7XG4gICAgICB9XG4gICB9KTtcbiAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShiMkNvbG9yLnByb3RvdHlwZSwgJ2InLCB7XG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIHNldDogZnVuY3Rpb24gKGJiKSB7XG4gICAgICAgICBpZiAoYmIgPT09IHVuZGVmaW5lZCkgYmIgPSAwO1xuICAgICAgICAgdGhpcy5fYiA9IEJveDJELnBhcnNlVUludCgyNTUgKiBiMk1hdGguQ2xhbXAoYmIsIDAuMCwgMS4wKSk7XG4gICAgICB9XG4gICB9KTtcbiAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShiMkNvbG9yLnByb3RvdHlwZSwgJ2NvbG9yJywge1xuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgIHJldHVybiAodGhpcy5fciA8PCAxNikgfCAodGhpcy5fZyA8PCA4KSB8ICh0aGlzLl9iKTtcbiAgICAgIH1cbiAgIH0pO1xuICAgYjJTZXR0aW5ncy5iMlNldHRpbmdzID0gZnVuY3Rpb24gKCkge307XG4gICBiMlNldHRpbmdzLmIyTWl4RnJpY3Rpb24gPSBmdW5jdGlvbiAoZnJpY3Rpb24xLCBmcmljdGlvbjIpIHtcbiAgICAgIGlmIChmcmljdGlvbjEgPT09IHVuZGVmaW5lZCkgZnJpY3Rpb24xID0gMDtcbiAgICAgIGlmIChmcmljdGlvbjIgPT09IHVuZGVmaW5lZCkgZnJpY3Rpb24yID0gMDtcbiAgICAgIHJldHVybiBNYXRoLnNxcnQoZnJpY3Rpb24xICogZnJpY3Rpb24yKTtcbiAgIH1cbiAgIGIyU2V0dGluZ3MuYjJNaXhSZXN0aXR1dGlvbiA9IGZ1bmN0aW9uIChyZXN0aXR1dGlvbjEsIHJlc3RpdHV0aW9uMikge1xuICAgICAgaWYgKHJlc3RpdHV0aW9uMSA9PT0gdW5kZWZpbmVkKSByZXN0aXR1dGlvbjEgPSAwO1xuICAgICAgaWYgKHJlc3RpdHV0aW9uMiA9PT0gdW5kZWZpbmVkKSByZXN0aXR1dGlvbjIgPSAwO1xuICAgICAgcmV0dXJuIHJlc3RpdHV0aW9uMSA+IHJlc3RpdHV0aW9uMiA/IHJlc3RpdHV0aW9uMSA6IHJlc3RpdHV0aW9uMjtcbiAgIH1cbiAgIGIyU2V0dGluZ3MuYjJBc3NlcnQgPSBmdW5jdGlvbiAoYSkge1xuICAgICAgaWYgKCFhKSB7XG4gICAgICAgICB0aHJvdyBcIkFzc2VydGlvbiBGYWlsZWRcIjtcbiAgICAgIH1cbiAgIH1cbiAgIEJveDJELnBvc3REZWZzLnB1c2goZnVuY3Rpb24gKCkge1xuICAgICAgQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MuVkVSU0lPTiA9IFwiMi4xYWxwaGFcIjtcbiAgICAgIEJveDJELkNvbW1vbi5iMlNldHRpbmdzLlVTSFJUX01BWCA9IDB4MDAwMGZmZmY7XG4gICAgICBCb3gyRC5Db21tb24uYjJTZXR0aW5ncy5iMl9waSA9IE1hdGguUEk7XG4gICAgICBCb3gyRC5Db21tb24uYjJTZXR0aW5ncy5iMl9tYXhNYW5pZm9sZFBvaW50cyA9IDI7XG4gICAgICBCb3gyRC5Db21tb24uYjJTZXR0aW5ncy5iMl9hYWJiRXh0ZW5zaW9uID0gMC4xO1xuICAgICAgQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MuYjJfYWFiYk11bHRpcGxpZXIgPSAyLjA7XG4gICAgICBCb3gyRC5Db21tb24uYjJTZXR0aW5ncy5iMl9wb2x5Z29uUmFkaXVzID0gMi4wICogYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wO1xuICAgICAgQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCA9IDAuMDA1O1xuICAgICAgQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MuYjJfYW5ndWxhclNsb3AgPSAyLjAgLyAxODAuMCAqIGIyU2V0dGluZ3MuYjJfcGk7XG4gICAgICBCb3gyRC5Db21tb24uYjJTZXR0aW5ncy5iMl90b2lTbG9wID0gOC4wICogYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wO1xuICAgICAgQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MuYjJfbWF4VE9JQ29udGFjdHNQZXJJc2xhbmQgPSAzMjtcbiAgICAgIEJveDJELkNvbW1vbi5iMlNldHRpbmdzLmIyX21heFRPSUpvaW50c1BlcklzbGFuZCA9IDMyO1xuICAgICAgQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MuYjJfdmVsb2NpdHlUaHJlc2hvbGQgPSAxLjA7XG4gICAgICBCb3gyRC5Db21tb24uYjJTZXR0aW5ncy5iMl9tYXhMaW5lYXJDb3JyZWN0aW9uID0gMC4yO1xuICAgICAgQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MuYjJfbWF4QW5ndWxhckNvcnJlY3Rpb24gPSA4LjAgLyAxODAuMCAqIGIyU2V0dGluZ3MuYjJfcGk7XG4gICAgICBCb3gyRC5Db21tb24uYjJTZXR0aW5ncy5iMl9tYXhUcmFuc2xhdGlvbiA9IDIuMDtcbiAgICAgIEJveDJELkNvbW1vbi5iMlNldHRpbmdzLmIyX21heFRyYW5zbGF0aW9uU3F1YXJlZCA9IGIyU2V0dGluZ3MuYjJfbWF4VHJhbnNsYXRpb24gKiBiMlNldHRpbmdzLmIyX21heFRyYW5zbGF0aW9uO1xuICAgICAgQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MuYjJfbWF4Um90YXRpb24gPSAwLjUgKiBiMlNldHRpbmdzLmIyX3BpO1xuICAgICAgQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MuYjJfbWF4Um90YXRpb25TcXVhcmVkID0gYjJTZXR0aW5ncy5iMl9tYXhSb3RhdGlvbiAqIGIyU2V0dGluZ3MuYjJfbWF4Um90YXRpb247XG4gICAgICBCb3gyRC5Db21tb24uYjJTZXR0aW5ncy5iMl9jb250YWN0QmF1bWdhcnRlID0gMC4yO1xuICAgICAgQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MuYjJfdGltZVRvU2xlZXAgPSAwLjU7XG4gICAgICBCb3gyRC5Db21tb24uYjJTZXR0aW5ncy5iMl9saW5lYXJTbGVlcFRvbGVyYW5jZSA9IDAuMDE7XG4gICAgICBCb3gyRC5Db21tb24uYjJTZXR0aW5ncy5iMl9hbmd1bGFyU2xlZXBUb2xlcmFuY2UgPSAyLjAgLyAxODAuMCAqIGIyU2V0dGluZ3MuYjJfcGk7XG4gICB9KTtcbn0pKCk7XG4oZnVuY3Rpb24gKCkge1xuICAgdmFyIGIyQUFCQiA9IEJveDJELkNvbGxpc2lvbi5iMkFBQkIsXG4gICAgICBiMkNvbG9yID0gQm94MkQuQ29tbW9uLmIyQ29sb3IsXG4gICAgICBiMmludGVybmFsID0gQm94MkQuQ29tbW9uLmIyaW50ZXJuYWwsXG4gICAgICBiMlNldHRpbmdzID0gQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MsXG4gICAgICBiMk1hdDIyID0gQm94MkQuQ29tbW9uLk1hdGguYjJNYXQyMixcbiAgICAgIGIyTWF0MzMgPSBCb3gyRC5Db21tb24uTWF0aC5iMk1hdDMzLFxuICAgICAgYjJNYXRoID0gQm94MkQuQ29tbW9uLk1hdGguYjJNYXRoLFxuICAgICAgYjJTd2VlcCA9IEJveDJELkNvbW1vbi5NYXRoLmIyU3dlZXAsXG4gICAgICBiMlRyYW5zZm9ybSA9IEJveDJELkNvbW1vbi5NYXRoLmIyVHJhbnNmb3JtLFxuICAgICAgYjJWZWMyID0gQm94MkQuQ29tbW9uLk1hdGguYjJWZWMyLFxuICAgICAgYjJWZWMzID0gQm94MkQuQ29tbW9uLk1hdGguYjJWZWMzO1xuXG4gICBiMk1hdDIyLmIyTWF0MjIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLmNvbDEgPSBuZXcgYjJWZWMyKCk7XG4gICAgICB0aGlzLmNvbDIgPSBuZXcgYjJWZWMyKCk7XG4gICB9O1xuICAgYjJNYXQyMi5wcm90b3R5cGUuYjJNYXQyMiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuU2V0SWRlbnRpdHkoKTtcbiAgIH1cbiAgIGIyTWF0MjIuRnJvbUFuZ2xlID0gZnVuY3Rpb24gKGFuZ2xlKSB7XG4gICAgICBpZiAoYW5nbGUgPT09IHVuZGVmaW5lZCkgYW5nbGUgPSAwO1xuICAgICAgdmFyIG1hdCA9IG5ldyBiMk1hdDIyKCk7XG4gICAgICBtYXQuU2V0KGFuZ2xlKTtcbiAgICAgIHJldHVybiBtYXQ7XG4gICB9XG4gICBiMk1hdDIyLkZyb21WViA9IGZ1bmN0aW9uIChjMSwgYzIpIHtcbiAgICAgIHZhciBtYXQgPSBuZXcgYjJNYXQyMigpO1xuICAgICAgbWF0LlNldFZWKGMxLCBjMik7XG4gICAgICByZXR1cm4gbWF0O1xuICAgfVxuICAgYjJNYXQyMi5wcm90b3R5cGUuU2V0ID0gZnVuY3Rpb24gKGFuZ2xlKSB7XG4gICAgICBpZiAoYW5nbGUgPT09IHVuZGVmaW5lZCkgYW5nbGUgPSAwO1xuICAgICAgdmFyIGMgPSBNYXRoLmNvcyhhbmdsZSk7XG4gICAgICB2YXIgcyA9IE1hdGguc2luKGFuZ2xlKTtcbiAgICAgIHRoaXMuY29sMS54ID0gYztcbiAgICAgIHRoaXMuY29sMi54ID0gKC1zKTtcbiAgICAgIHRoaXMuY29sMS55ID0gcztcbiAgICAgIHRoaXMuY29sMi55ID0gYztcbiAgIH1cbiAgIGIyTWF0MjIucHJvdG90eXBlLlNldFZWID0gZnVuY3Rpb24gKGMxLCBjMikge1xuICAgICAgdGhpcy5jb2wxLlNldFYoYzEpO1xuICAgICAgdGhpcy5jb2wyLlNldFYoYzIpO1xuICAgfVxuICAgYjJNYXQyMi5wcm90b3R5cGUuQ29weSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBtYXQgPSBuZXcgYjJNYXQyMigpO1xuICAgICAgbWF0LlNldE0odGhpcyk7XG4gICAgICByZXR1cm4gbWF0O1xuICAgfVxuICAgYjJNYXQyMi5wcm90b3R5cGUuU2V0TSA9IGZ1bmN0aW9uIChtKSB7XG4gICAgICB0aGlzLmNvbDEuU2V0VihtLmNvbDEpO1xuICAgICAgdGhpcy5jb2wyLlNldFYobS5jb2wyKTtcbiAgIH1cbiAgIGIyTWF0MjIucHJvdG90eXBlLkFkZE0gPSBmdW5jdGlvbiAobSkge1xuICAgICAgdGhpcy5jb2wxLnggKz0gbS5jb2wxLng7XG4gICAgICB0aGlzLmNvbDEueSArPSBtLmNvbDEueTtcbiAgICAgIHRoaXMuY29sMi54ICs9IG0uY29sMi54O1xuICAgICAgdGhpcy5jb2wyLnkgKz0gbS5jb2wyLnk7XG4gICB9XG4gICBiMk1hdDIyLnByb3RvdHlwZS5TZXRJZGVudGl0eSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuY29sMS54ID0gMS4wO1xuICAgICAgdGhpcy5jb2wyLnggPSAwLjA7XG4gICAgICB0aGlzLmNvbDEueSA9IDAuMDtcbiAgICAgIHRoaXMuY29sMi55ID0gMS4wO1xuICAgfVxuICAgYjJNYXQyMi5wcm90b3R5cGUuU2V0WmVybyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuY29sMS54ID0gMC4wO1xuICAgICAgdGhpcy5jb2wyLnggPSAwLjA7XG4gICAgICB0aGlzLmNvbDEueSA9IDAuMDtcbiAgICAgIHRoaXMuY29sMi55ID0gMC4wO1xuICAgfVxuICAgYjJNYXQyMi5wcm90b3R5cGUuR2V0QW5nbGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gTWF0aC5hdGFuMih0aGlzLmNvbDEueSwgdGhpcy5jb2wxLngpO1xuICAgfVxuICAgYjJNYXQyMi5wcm90b3R5cGUuR2V0SW52ZXJzZSA9IGZ1bmN0aW9uIChvdXQpIHtcbiAgICAgIHZhciBhID0gdGhpcy5jb2wxLng7XG4gICAgICB2YXIgYiA9IHRoaXMuY29sMi54O1xuICAgICAgdmFyIGMgPSB0aGlzLmNvbDEueTtcbiAgICAgIHZhciBkID0gdGhpcy5jb2wyLnk7XG4gICAgICB2YXIgZGV0ID0gYSAqIGQgLSBiICogYztcbiAgICAgIGlmIChkZXQgIT0gMC4wKSB7XG4gICAgICAgICBkZXQgPSAxLjAgLyBkZXQ7XG4gICAgICB9XG4gICAgICBvdXQuY29sMS54ID0gZGV0ICogZDtcbiAgICAgIG91dC5jb2wyLnggPSAoLWRldCAqIGIpO1xuICAgICAgb3V0LmNvbDEueSA9ICgtZGV0ICogYyk7XG4gICAgICBvdXQuY29sMi55ID0gZGV0ICogYTtcbiAgICAgIHJldHVybiBvdXQ7XG4gICB9XG4gICBiMk1hdDIyLnByb3RvdHlwZS5Tb2x2ZSA9IGZ1bmN0aW9uIChvdXQsIGJYLCBiWSkge1xuICAgICAgaWYgKGJYID09PSB1bmRlZmluZWQpIGJYID0gMDtcbiAgICAgIGlmIChiWSA9PT0gdW5kZWZpbmVkKSBiWSA9IDA7XG4gICAgICB2YXIgYTExID0gdGhpcy5jb2wxLng7XG4gICAgICB2YXIgYTEyID0gdGhpcy5jb2wyLng7XG4gICAgICB2YXIgYTIxID0gdGhpcy5jb2wxLnk7XG4gICAgICB2YXIgYTIyID0gdGhpcy5jb2wyLnk7XG4gICAgICB2YXIgZGV0ID0gYTExICogYTIyIC0gYTEyICogYTIxO1xuICAgICAgaWYgKGRldCAhPSAwLjApIHtcbiAgICAgICAgIGRldCA9IDEuMCAvIGRldDtcbiAgICAgIH1cbiAgICAgIG91dC54ID0gZGV0ICogKGEyMiAqIGJYIC0gYTEyICogYlkpO1xuICAgICAgb3V0LnkgPSBkZXQgKiAoYTExICogYlkgLSBhMjEgKiBiWCk7XG4gICAgICByZXR1cm4gb3V0O1xuICAgfVxuICAgYjJNYXQyMi5wcm90b3R5cGUuQWJzID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5jb2wxLkFicygpO1xuICAgICAgdGhpcy5jb2wyLkFicygpO1xuICAgfVxuICAgYjJNYXQzMy5iMk1hdDMzID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5jb2wxID0gbmV3IGIyVmVjMygpO1xuICAgICAgdGhpcy5jb2wyID0gbmV3IGIyVmVjMygpO1xuICAgICAgdGhpcy5jb2wzID0gbmV3IGIyVmVjMygpO1xuICAgfTtcbiAgIGIyTWF0MzMucHJvdG90eXBlLmIyTWF0MzMgPSBmdW5jdGlvbiAoYzEsIGMyLCBjMykge1xuICAgICAgaWYgKGMxID09PSB1bmRlZmluZWQpIGMxID0gbnVsbDtcbiAgICAgIGlmIChjMiA9PT0gdW5kZWZpbmVkKSBjMiA9IG51bGw7XG4gICAgICBpZiAoYzMgPT09IHVuZGVmaW5lZCkgYzMgPSBudWxsO1xuICAgICAgaWYgKCFjMSAmJiAhYzIgJiYgIWMzKSB7XG4gICAgICAgICB0aGlzLmNvbDEuU2V0WmVybygpO1xuICAgICAgICAgdGhpcy5jb2wyLlNldFplcm8oKTtcbiAgICAgICAgIHRoaXMuY29sMy5TZXRaZXJvKCk7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgIHRoaXMuY29sMS5TZXRWKGMxKTtcbiAgICAgICAgIHRoaXMuY29sMi5TZXRWKGMyKTtcbiAgICAgICAgIHRoaXMuY29sMy5TZXRWKGMzKTtcbiAgICAgIH1cbiAgIH1cbiAgIGIyTWF0MzMucHJvdG90eXBlLlNldFZWViA9IGZ1bmN0aW9uIChjMSwgYzIsIGMzKSB7XG4gICAgICB0aGlzLmNvbDEuU2V0VihjMSk7XG4gICAgICB0aGlzLmNvbDIuU2V0VihjMik7XG4gICAgICB0aGlzLmNvbDMuU2V0VihjMyk7XG4gICB9XG4gICBiMk1hdDMzLnByb3RvdHlwZS5Db3B5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIG5ldyBiMk1hdDMzKHRoaXMuY29sMSwgdGhpcy5jb2wyLCB0aGlzLmNvbDMpO1xuICAgfVxuICAgYjJNYXQzMy5wcm90b3R5cGUuU2V0TSA9IGZ1bmN0aW9uIChtKSB7XG4gICAgICB0aGlzLmNvbDEuU2V0VihtLmNvbDEpO1xuICAgICAgdGhpcy5jb2wyLlNldFYobS5jb2wyKTtcbiAgICAgIHRoaXMuY29sMy5TZXRWKG0uY29sMyk7XG4gICB9XG4gICBiMk1hdDMzLnByb3RvdHlwZS5BZGRNID0gZnVuY3Rpb24gKG0pIHtcbiAgICAgIHRoaXMuY29sMS54ICs9IG0uY29sMS54O1xuICAgICAgdGhpcy5jb2wxLnkgKz0gbS5jb2wxLnk7XG4gICAgICB0aGlzLmNvbDEueiArPSBtLmNvbDEuejtcbiAgICAgIHRoaXMuY29sMi54ICs9IG0uY29sMi54O1xuICAgICAgdGhpcy5jb2wyLnkgKz0gbS5jb2wyLnk7XG4gICAgICB0aGlzLmNvbDIueiArPSBtLmNvbDIuejtcbiAgICAgIHRoaXMuY29sMy54ICs9IG0uY29sMy54O1xuICAgICAgdGhpcy5jb2wzLnkgKz0gbS5jb2wzLnk7XG4gICAgICB0aGlzLmNvbDMueiArPSBtLmNvbDMuejtcbiAgIH1cbiAgIGIyTWF0MzMucHJvdG90eXBlLlNldElkZW50aXR5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5jb2wxLnggPSAxLjA7XG4gICAgICB0aGlzLmNvbDIueCA9IDAuMDtcbiAgICAgIHRoaXMuY29sMy54ID0gMC4wO1xuICAgICAgdGhpcy5jb2wxLnkgPSAwLjA7XG4gICAgICB0aGlzLmNvbDIueSA9IDEuMDtcbiAgICAgIHRoaXMuY29sMy55ID0gMC4wO1xuICAgICAgdGhpcy5jb2wxLnogPSAwLjA7XG4gICAgICB0aGlzLmNvbDIueiA9IDAuMDtcbiAgICAgIHRoaXMuY29sMy56ID0gMS4wO1xuICAgfVxuICAgYjJNYXQzMy5wcm90b3R5cGUuU2V0WmVybyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuY29sMS54ID0gMC4wO1xuICAgICAgdGhpcy5jb2wyLnggPSAwLjA7XG4gICAgICB0aGlzLmNvbDMueCA9IDAuMDtcbiAgICAgIHRoaXMuY29sMS55ID0gMC4wO1xuICAgICAgdGhpcy5jb2wyLnkgPSAwLjA7XG4gICAgICB0aGlzLmNvbDMueSA9IDAuMDtcbiAgICAgIHRoaXMuY29sMS56ID0gMC4wO1xuICAgICAgdGhpcy5jb2wyLnogPSAwLjA7XG4gICAgICB0aGlzLmNvbDMueiA9IDAuMDtcbiAgIH1cbiAgIGIyTWF0MzMucHJvdG90eXBlLlNvbHZlMjIgPSBmdW5jdGlvbiAob3V0LCBiWCwgYlkpIHtcbiAgICAgIGlmIChiWCA9PT0gdW5kZWZpbmVkKSBiWCA9IDA7XG4gICAgICBpZiAoYlkgPT09IHVuZGVmaW5lZCkgYlkgPSAwO1xuICAgICAgdmFyIGExMSA9IHRoaXMuY29sMS54O1xuICAgICAgdmFyIGExMiA9IHRoaXMuY29sMi54O1xuICAgICAgdmFyIGEyMSA9IHRoaXMuY29sMS55O1xuICAgICAgdmFyIGEyMiA9IHRoaXMuY29sMi55O1xuICAgICAgdmFyIGRldCA9IGExMSAqIGEyMiAtIGExMiAqIGEyMTtcbiAgICAgIGlmIChkZXQgIT0gMC4wKSB7XG4gICAgICAgICBkZXQgPSAxLjAgLyBkZXQ7XG4gICAgICB9XG4gICAgICBvdXQueCA9IGRldCAqIChhMjIgKiBiWCAtIGExMiAqIGJZKTtcbiAgICAgIG91dC55ID0gZGV0ICogKGExMSAqIGJZIC0gYTIxICogYlgpO1xuICAgICAgcmV0dXJuIG91dDtcbiAgIH1cbiAgIGIyTWF0MzMucHJvdG90eXBlLlNvbHZlMzMgPSBmdW5jdGlvbiAob3V0LCBiWCwgYlksIGJaKSB7XG4gICAgICBpZiAoYlggPT09IHVuZGVmaW5lZCkgYlggPSAwO1xuICAgICAgaWYgKGJZID09PSB1bmRlZmluZWQpIGJZID0gMDtcbiAgICAgIGlmIChiWiA9PT0gdW5kZWZpbmVkKSBiWiA9IDA7XG4gICAgICB2YXIgYTExID0gdGhpcy5jb2wxLng7XG4gICAgICB2YXIgYTIxID0gdGhpcy5jb2wxLnk7XG4gICAgICB2YXIgYTMxID0gdGhpcy5jb2wxLno7XG4gICAgICB2YXIgYTEyID0gdGhpcy5jb2wyLng7XG4gICAgICB2YXIgYTIyID0gdGhpcy5jb2wyLnk7XG4gICAgICB2YXIgYTMyID0gdGhpcy5jb2wyLno7XG4gICAgICB2YXIgYTEzID0gdGhpcy5jb2wzLng7XG4gICAgICB2YXIgYTIzID0gdGhpcy5jb2wzLnk7XG4gICAgICB2YXIgYTMzID0gdGhpcy5jb2wzLno7XG4gICAgICB2YXIgZGV0ID0gYTExICogKGEyMiAqIGEzMyAtIGEzMiAqIGEyMykgKyBhMjEgKiAoYTMyICogYTEzIC0gYTEyICogYTMzKSArIGEzMSAqIChhMTIgKiBhMjMgLSBhMjIgKiBhMTMpO1xuICAgICAgaWYgKGRldCAhPSAwLjApIHtcbiAgICAgICAgIGRldCA9IDEuMCAvIGRldDtcbiAgICAgIH1cbiAgICAgIG91dC54ID0gZGV0ICogKGJYICogKGEyMiAqIGEzMyAtIGEzMiAqIGEyMykgKyBiWSAqIChhMzIgKiBhMTMgLSBhMTIgKiBhMzMpICsgYlogKiAoYTEyICogYTIzIC0gYTIyICogYTEzKSk7XG4gICAgICBvdXQueSA9IGRldCAqIChhMTEgKiAoYlkgKiBhMzMgLSBiWiAqIGEyMykgKyBhMjEgKiAoYlogKiBhMTMgLSBiWCAqIGEzMykgKyBhMzEgKiAoYlggKiBhMjMgLSBiWSAqIGExMykpO1xuICAgICAgb3V0LnogPSBkZXQgKiAoYTExICogKGEyMiAqIGJaIC0gYTMyICogYlkpICsgYTIxICogKGEzMiAqIGJYIC0gYTEyICogYlopICsgYTMxICogKGExMiAqIGJZIC0gYTIyICogYlgpKTtcbiAgICAgIHJldHVybiBvdXQ7XG4gICB9XG4gICBiMk1hdGguYjJNYXRoID0gZnVuY3Rpb24gKCkge307XG4gICBiMk1hdGguSXNWYWxpZCA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICBpZiAoeCA9PT0gdW5kZWZpbmVkKSB4ID0gMDtcbiAgICAgIHJldHVybiBpc0Zpbml0ZSh4KTtcbiAgIH1cbiAgIGIyTWF0aC5Eb3QgPSBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgcmV0dXJuIGEueCAqIGIueCArIGEueSAqIGIueTtcbiAgIH1cbiAgIGIyTWF0aC5Dcm9zc1ZWID0gZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgIHJldHVybiBhLnggKiBiLnkgLSBhLnkgKiBiLng7XG4gICB9XG4gICBiMk1hdGguQ3Jvc3NWRiA9IGZ1bmN0aW9uIChhLCBzKSB7XG4gICAgICBpZiAocyA9PT0gdW5kZWZpbmVkKSBzID0gMDtcbiAgICAgIHZhciB2ID0gbmV3IGIyVmVjMihzICogYS55LCAoLXMgKiBhLngpKTtcbiAgICAgIHJldHVybiB2O1xuICAgfVxuICAgYjJNYXRoLkNyb3NzRlYgPSBmdW5jdGlvbiAocywgYSkge1xuICAgICAgaWYgKHMgPT09IHVuZGVmaW5lZCkgcyA9IDA7XG4gICAgICB2YXIgdiA9IG5ldyBiMlZlYzIoKC1zICogYS55KSwgcyAqIGEueCk7XG4gICAgICByZXR1cm4gdjtcbiAgIH1cbiAgIGIyTWF0aC5NdWxNViA9IGZ1bmN0aW9uIChBLCB2KSB7XG4gICAgICB2YXIgdSA9IG5ldyBiMlZlYzIoQS5jb2wxLnggKiB2LnggKyBBLmNvbDIueCAqIHYueSwgQS5jb2wxLnkgKiB2LnggKyBBLmNvbDIueSAqIHYueSk7XG4gICAgICByZXR1cm4gdTtcbiAgIH1cbiAgIGIyTWF0aC5NdWxUTVYgPSBmdW5jdGlvbiAoQSwgdikge1xuICAgICAgdmFyIHUgPSBuZXcgYjJWZWMyKGIyTWF0aC5Eb3QodiwgQS5jb2wxKSwgYjJNYXRoLkRvdCh2LCBBLmNvbDIpKTtcbiAgICAgIHJldHVybiB1O1xuICAgfVxuICAgYjJNYXRoLk11bFggPSBmdW5jdGlvbiAoVCwgdikge1xuICAgICAgdmFyIGEgPSBiMk1hdGguTXVsTVYoVC5SLCB2KTtcbiAgICAgIGEueCArPSBULnBvc2l0aW9uLng7XG4gICAgICBhLnkgKz0gVC5wb3NpdGlvbi55O1xuICAgICAgcmV0dXJuIGE7XG4gICB9XG4gICBiMk1hdGguTXVsWFQgPSBmdW5jdGlvbiAoVCwgdikge1xuICAgICAgdmFyIGEgPSBiMk1hdGguU3VidHJhY3RWVih2LCBULnBvc2l0aW9uKTtcbiAgICAgIHZhciB0WCA9IChhLnggKiBULlIuY29sMS54ICsgYS55ICogVC5SLmNvbDEueSk7XG4gICAgICBhLnkgPSAoYS54ICogVC5SLmNvbDIueCArIGEueSAqIFQuUi5jb2wyLnkpO1xuICAgICAgYS54ID0gdFg7XG4gICAgICByZXR1cm4gYTtcbiAgIH1cbiAgIGIyTWF0aC5BZGRWViA9IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICB2YXIgdiA9IG5ldyBiMlZlYzIoYS54ICsgYi54LCBhLnkgKyBiLnkpO1xuICAgICAgcmV0dXJuIHY7XG4gICB9XG4gICBiMk1hdGguU3VidHJhY3RWViA9IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICB2YXIgdiA9IG5ldyBiMlZlYzIoYS54IC0gYi54LCBhLnkgLSBiLnkpO1xuICAgICAgcmV0dXJuIHY7XG4gICB9XG4gICBiMk1hdGguRGlzdGFuY2UgPSBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgdmFyIGNYID0gYS54IC0gYi54O1xuICAgICAgdmFyIGNZID0gYS55IC0gYi55O1xuICAgICAgcmV0dXJuIE1hdGguc3FydChjWCAqIGNYICsgY1kgKiBjWSk7XG4gICB9XG4gICBiMk1hdGguRGlzdGFuY2VTcXVhcmVkID0gZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgIHZhciBjWCA9IGEueCAtIGIueDtcbiAgICAgIHZhciBjWSA9IGEueSAtIGIueTtcbiAgICAgIHJldHVybiAoY1ggKiBjWCArIGNZICogY1kpO1xuICAgfVxuICAgYjJNYXRoLk11bEZWID0gZnVuY3Rpb24gKHMsIGEpIHtcbiAgICAgIGlmIChzID09PSB1bmRlZmluZWQpIHMgPSAwO1xuICAgICAgdmFyIHYgPSBuZXcgYjJWZWMyKHMgKiBhLngsIHMgKiBhLnkpO1xuICAgICAgcmV0dXJuIHY7XG4gICB9XG4gICBiMk1hdGguQWRkTU0gPSBmdW5jdGlvbiAoQSwgQikge1xuICAgICAgdmFyIEMgPSBiMk1hdDIyLkZyb21WVihiMk1hdGguQWRkVlYoQS5jb2wxLCBCLmNvbDEpLCBiMk1hdGguQWRkVlYoQS5jb2wyLCBCLmNvbDIpKTtcbiAgICAgIHJldHVybiBDO1xuICAgfVxuICAgYjJNYXRoLk11bE1NID0gZnVuY3Rpb24gKEEsIEIpIHtcbiAgICAgIHZhciBDID0gYjJNYXQyMi5Gcm9tVlYoYjJNYXRoLk11bE1WKEEsIEIuY29sMSksIGIyTWF0aC5NdWxNVihBLCBCLmNvbDIpKTtcbiAgICAgIHJldHVybiBDO1xuICAgfVxuICAgYjJNYXRoLk11bFRNTSA9IGZ1bmN0aW9uIChBLCBCKSB7XG4gICAgICB2YXIgYzEgPSBuZXcgYjJWZWMyKGIyTWF0aC5Eb3QoQS5jb2wxLCBCLmNvbDEpLCBiMk1hdGguRG90KEEuY29sMiwgQi5jb2wxKSk7XG4gICAgICB2YXIgYzIgPSBuZXcgYjJWZWMyKGIyTWF0aC5Eb3QoQS5jb2wxLCBCLmNvbDIpLCBiMk1hdGguRG90KEEuY29sMiwgQi5jb2wyKSk7XG4gICAgICB2YXIgQyA9IGIyTWF0MjIuRnJvbVZWKGMxLCBjMik7XG4gICAgICByZXR1cm4gQztcbiAgIH1cbiAgIGIyTWF0aC5BYnMgPSBmdW5jdGlvbiAoYSkge1xuICAgICAgaWYgKGEgPT09IHVuZGVmaW5lZCkgYSA9IDA7XG4gICAgICByZXR1cm4gYSA+IDAuMCA/IGEgOiAoLWEpO1xuICAgfVxuICAgYjJNYXRoLkFic1YgPSBmdW5jdGlvbiAoYSkge1xuICAgICAgdmFyIGIgPSBuZXcgYjJWZWMyKGIyTWF0aC5BYnMoYS54KSwgYjJNYXRoLkFicyhhLnkpKTtcbiAgICAgIHJldHVybiBiO1xuICAgfVxuICAgYjJNYXRoLkFic00gPSBmdW5jdGlvbiAoQSkge1xuICAgICAgdmFyIEIgPSBiMk1hdDIyLkZyb21WVihiMk1hdGguQWJzVihBLmNvbDEpLCBiMk1hdGguQWJzVihBLmNvbDIpKTtcbiAgICAgIHJldHVybiBCO1xuICAgfVxuICAgYjJNYXRoLk1pbiA9IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICBpZiAoYSA9PT0gdW5kZWZpbmVkKSBhID0gMDtcbiAgICAgIGlmIChiID09PSB1bmRlZmluZWQpIGIgPSAwO1xuICAgICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7XG4gICB9XG4gICBiMk1hdGguTWluViA9IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICB2YXIgYyA9IG5ldyBiMlZlYzIoYjJNYXRoLk1pbihhLngsIGIueCksIGIyTWF0aC5NaW4oYS55LCBiLnkpKTtcbiAgICAgIHJldHVybiBjO1xuICAgfVxuICAgYjJNYXRoLk1heCA9IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICBpZiAoYSA9PT0gdW5kZWZpbmVkKSBhID0gMDtcbiAgICAgIGlmIChiID09PSB1bmRlZmluZWQpIGIgPSAwO1xuICAgICAgcmV0dXJuIGEgPiBiID8gYSA6IGI7XG4gICB9XG4gICBiMk1hdGguTWF4ViA9IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICB2YXIgYyA9IG5ldyBiMlZlYzIoYjJNYXRoLk1heChhLngsIGIueCksIGIyTWF0aC5NYXgoYS55LCBiLnkpKTtcbiAgICAgIHJldHVybiBjO1xuICAgfVxuICAgYjJNYXRoLkNsYW1wID0gZnVuY3Rpb24gKGEsIGxvdywgaGlnaCkge1xuICAgICAgaWYgKGEgPT09IHVuZGVmaW5lZCkgYSA9IDA7XG4gICAgICBpZiAobG93ID09PSB1bmRlZmluZWQpIGxvdyA9IDA7XG4gICAgICBpZiAoaGlnaCA9PT0gdW5kZWZpbmVkKSBoaWdoID0gMDtcbiAgICAgIHJldHVybiBhIDwgbG93ID8gbG93IDogYSA+IGhpZ2ggPyBoaWdoIDogYTtcbiAgIH1cbiAgIGIyTWF0aC5DbGFtcFYgPSBmdW5jdGlvbiAoYSwgbG93LCBoaWdoKSB7XG4gICAgICByZXR1cm4gYjJNYXRoLk1heFYobG93LCBiMk1hdGguTWluVihhLCBoaWdoKSk7XG4gICB9XG4gICBiMk1hdGguU3dhcCA9IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICB2YXIgdG1wID0gYVswXTtcbiAgICAgIGFbMF0gPSBiWzBdO1xuICAgICAgYlswXSA9IHRtcDtcbiAgIH1cbiAgIGIyTWF0aC5SYW5kb20gPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gTWF0aC5yYW5kb20oKSAqIDIgLSAxO1xuICAgfVxuICAgYjJNYXRoLlJhbmRvbVJhbmdlID0gZnVuY3Rpb24gKGxvLCBoaSkge1xuICAgICAgaWYgKGxvID09PSB1bmRlZmluZWQpIGxvID0gMDtcbiAgICAgIGlmIChoaSA9PT0gdW5kZWZpbmVkKSBoaSA9IDA7XG4gICAgICB2YXIgciA9IE1hdGgucmFuZG9tKCk7XG4gICAgICByID0gKGhpIC0gbG8pICogciArIGxvO1xuICAgICAgcmV0dXJuIHI7XG4gICB9XG4gICBiMk1hdGguTmV4dFBvd2VyT2ZUd28gPSBmdW5jdGlvbiAoeCkge1xuICAgICAgaWYgKHggPT09IHVuZGVmaW5lZCkgeCA9IDA7XG4gICAgICB4IHw9ICh4ID4+IDEpICYgMHg3RkZGRkZGRjtcbiAgICAgIHggfD0gKHggPj4gMikgJiAweDNGRkZGRkZGO1xuICAgICAgeCB8PSAoeCA+PiA0KSAmIDB4MEZGRkZGRkY7XG4gICAgICB4IHw9ICh4ID4+IDgpICYgMHgwMEZGRkZGRjtcbiAgICAgIHggfD0gKHggPj4gMTYpICYgMHgwMDAwRkZGRjtcbiAgICAgIHJldHVybiB4ICsgMTtcbiAgIH1cbiAgIGIyTWF0aC5Jc1Bvd2VyT2ZUd28gPSBmdW5jdGlvbiAoeCkge1xuICAgICAgaWYgKHggPT09IHVuZGVmaW5lZCkgeCA9IDA7XG4gICAgICB2YXIgcmVzdWx0ID0geCA+IDAgJiYgKHggJiAoeCAtIDEpKSA9PSAwO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgIH1cbiAgIEJveDJELnBvc3REZWZzLnB1c2goZnVuY3Rpb24gKCkge1xuICAgICAgQm94MkQuQ29tbW9uLk1hdGguYjJNYXRoLmIyVmVjMl96ZXJvID0gbmV3IGIyVmVjMigwLjAsIDAuMCk7XG4gICAgICBCb3gyRC5Db21tb24uTWF0aC5iMk1hdGguYjJNYXQyMl9pZGVudGl0eSA9IGIyTWF0MjIuRnJvbVZWKG5ldyBiMlZlYzIoMS4wLCAwLjApLCBuZXcgYjJWZWMyKDAuMCwgMS4wKSk7XG4gICAgICBCb3gyRC5Db21tb24uTWF0aC5iMk1hdGguYjJUcmFuc2Zvcm1faWRlbnRpdHkgPSBuZXcgYjJUcmFuc2Zvcm0oYjJNYXRoLmIyVmVjMl96ZXJvLCBiMk1hdGguYjJNYXQyMl9pZGVudGl0eSk7XG4gICB9KTtcbiAgIGIyU3dlZXAuYjJTd2VlcCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMubG9jYWxDZW50ZXIgPSBuZXcgYjJWZWMyKCk7XG4gICAgICB0aGlzLmMwID0gbmV3IGIyVmVjMjtcbiAgICAgIHRoaXMuYyA9IG5ldyBiMlZlYzIoKTtcbiAgIH07XG4gICBiMlN3ZWVwLnByb3RvdHlwZS5TZXQgPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICAgIHRoaXMubG9jYWxDZW50ZXIuU2V0VihvdGhlci5sb2NhbENlbnRlcik7XG4gICAgICB0aGlzLmMwLlNldFYob3RoZXIuYzApO1xuICAgICAgdGhpcy5jLlNldFYob3RoZXIuYyk7XG4gICAgICB0aGlzLmEwID0gb3RoZXIuYTA7XG4gICAgICB0aGlzLmEgPSBvdGhlci5hO1xuICAgICAgdGhpcy50MCA9IG90aGVyLnQwO1xuICAgfVxuICAgYjJTd2VlcC5wcm90b3R5cGUuQ29weSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBjb3B5ID0gbmV3IGIyU3dlZXAoKTtcbiAgICAgIGNvcHkubG9jYWxDZW50ZXIuU2V0Vih0aGlzLmxvY2FsQ2VudGVyKTtcbiAgICAgIGNvcHkuYzAuU2V0Vih0aGlzLmMwKTtcbiAgICAgIGNvcHkuYy5TZXRWKHRoaXMuYyk7XG4gICAgICBjb3B5LmEwID0gdGhpcy5hMDtcbiAgICAgIGNvcHkuYSA9IHRoaXMuYTtcbiAgICAgIGNvcHkudDAgPSB0aGlzLnQwO1xuICAgICAgcmV0dXJuIGNvcHk7XG4gICB9XG4gICBiMlN3ZWVwLnByb3RvdHlwZS5HZXRUcmFuc2Zvcm0gPSBmdW5jdGlvbiAoeGYsIGFscGhhKSB7XG4gICAgICBpZiAoYWxwaGEgPT09IHVuZGVmaW5lZCkgYWxwaGEgPSAwO1xuICAgICAgeGYucG9zaXRpb24ueCA9ICgxLjAgLSBhbHBoYSkgKiB0aGlzLmMwLnggKyBhbHBoYSAqIHRoaXMuYy54O1xuICAgICAgeGYucG9zaXRpb24ueSA9ICgxLjAgLSBhbHBoYSkgKiB0aGlzLmMwLnkgKyBhbHBoYSAqIHRoaXMuYy55O1xuICAgICAgdmFyIGFuZ2xlID0gKDEuMCAtIGFscGhhKSAqIHRoaXMuYTAgKyBhbHBoYSAqIHRoaXMuYTtcbiAgICAgIHhmLlIuU2V0KGFuZ2xlKTtcbiAgICAgIHZhciB0TWF0ID0geGYuUjtcbiAgICAgIHhmLnBvc2l0aW9uLnggLT0gKHRNYXQuY29sMS54ICogdGhpcy5sb2NhbENlbnRlci54ICsgdE1hdC5jb2wyLnggKiB0aGlzLmxvY2FsQ2VudGVyLnkpO1xuICAgICAgeGYucG9zaXRpb24ueSAtPSAodE1hdC5jb2wxLnkgKiB0aGlzLmxvY2FsQ2VudGVyLnggKyB0TWF0LmNvbDIueSAqIHRoaXMubG9jYWxDZW50ZXIueSk7XG4gICB9XG4gICBiMlN3ZWVwLnByb3RvdHlwZS5BZHZhbmNlID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIGlmICh0ID09PSB1bmRlZmluZWQpIHQgPSAwO1xuICAgICAgaWYgKHRoaXMudDAgPCB0ICYmIDEuMCAtIHRoaXMudDAgPiBOdW1iZXIuTUlOX1ZBTFVFKSB7XG4gICAgICAgICB2YXIgYWxwaGEgPSAodCAtIHRoaXMudDApIC8gKDEuMCAtIHRoaXMudDApO1xuICAgICAgICAgdGhpcy5jMC54ID0gKDEuMCAtIGFscGhhKSAqIHRoaXMuYzAueCArIGFscGhhICogdGhpcy5jLng7XG4gICAgICAgICB0aGlzLmMwLnkgPSAoMS4wIC0gYWxwaGEpICogdGhpcy5jMC55ICsgYWxwaGEgKiB0aGlzLmMueTtcbiAgICAgICAgIHRoaXMuYTAgPSAoMS4wIC0gYWxwaGEpICogdGhpcy5hMCArIGFscGhhICogdGhpcy5hO1xuICAgICAgICAgdGhpcy50MCA9IHQ7XG4gICAgICB9XG4gICB9XG4gICBiMlRyYW5zZm9ybS5iMlRyYW5zZm9ybSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMucG9zaXRpb24gPSBuZXcgYjJWZWMyO1xuICAgICAgdGhpcy5SID0gbmV3IGIyTWF0MjIoKTtcbiAgIH07XG4gICBiMlRyYW5zZm9ybS5wcm90b3R5cGUuYjJUcmFuc2Zvcm0gPSBmdW5jdGlvbiAocG9zLCByKSB7XG4gICAgICBpZiAocG9zID09PSB1bmRlZmluZWQpIHBvcyA9IG51bGw7XG4gICAgICBpZiAociA9PT0gdW5kZWZpbmVkKSByID0gbnVsbDtcbiAgICAgIGlmIChwb3MpIHtcbiAgICAgICAgIHRoaXMucG9zaXRpb24uU2V0Vihwb3MpO1xuICAgICAgICAgdGhpcy5SLlNldE0ocik7XG4gICAgICB9XG4gICB9XG4gICBiMlRyYW5zZm9ybS5wcm90b3R5cGUuSW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIChwb3MsIHIpIHtcbiAgICAgIHRoaXMucG9zaXRpb24uU2V0Vihwb3MpO1xuICAgICAgdGhpcy5SLlNldE0ocik7XG4gICB9XG4gICBiMlRyYW5zZm9ybS5wcm90b3R5cGUuU2V0SWRlbnRpdHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLnBvc2l0aW9uLlNldFplcm8oKTtcbiAgICAgIHRoaXMuUi5TZXRJZGVudGl0eSgpO1xuICAgfVxuICAgYjJUcmFuc2Zvcm0ucHJvdG90eXBlLlNldCA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICB0aGlzLnBvc2l0aW9uLlNldFYoeC5wb3NpdGlvbik7XG4gICAgICB0aGlzLlIuU2V0TSh4LlIpO1xuICAgfVxuICAgYjJUcmFuc2Zvcm0ucHJvdG90eXBlLkdldEFuZ2xlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIE1hdGguYXRhbjIodGhpcy5SLmNvbDEueSwgdGhpcy5SLmNvbDEueCk7XG4gICB9XG4gICBiMlZlYzIuYjJWZWMyID0gZnVuY3Rpb24gKCkge307XG4gICBiMlZlYzIucHJvdG90eXBlLmIyVmVjMiA9IGZ1bmN0aW9uICh4XywgeV8pIHtcbiAgICAgIGlmICh4XyA9PT0gdW5kZWZpbmVkKSB4XyA9IDA7XG4gICAgICBpZiAoeV8gPT09IHVuZGVmaW5lZCkgeV8gPSAwO1xuICAgICAgdGhpcy54ID0geF87XG4gICAgICB0aGlzLnkgPSB5XztcbiAgIH1cbiAgIGIyVmVjMi5wcm90b3R5cGUuU2V0WmVybyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMueCA9IDAuMDtcbiAgICAgIHRoaXMueSA9IDAuMDtcbiAgIH1cbiAgIGIyVmVjMi5wcm90b3R5cGUuU2V0ID0gZnVuY3Rpb24gKHhfLCB5Xykge1xuICAgICAgaWYgKHhfID09PSB1bmRlZmluZWQpIHhfID0gMDtcbiAgICAgIGlmICh5XyA9PT0gdW5kZWZpbmVkKSB5XyA9IDA7XG4gICAgICB0aGlzLnggPSB4XztcbiAgICAgIHRoaXMueSA9IHlfO1xuICAgfVxuICAgYjJWZWMyLnByb3RvdHlwZS5TZXRWID0gZnVuY3Rpb24gKHYpIHtcbiAgICAgIHRoaXMueCA9IHYueDtcbiAgICAgIHRoaXMueSA9IHYueTtcbiAgIH1cbiAgIGIyVmVjMi5wcm90b3R5cGUuR2V0TmVnYXRpdmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gbmV3IGIyVmVjMigoLXRoaXMueCksICgtdGhpcy55KSk7XG4gICB9XG4gICBiMlZlYzIucHJvdG90eXBlLk5lZ2F0aXZlU2VsZiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMueCA9ICgtdGhpcy54KTtcbiAgICAgIHRoaXMueSA9ICgtdGhpcy55KTtcbiAgIH1cbiAgIGIyVmVjMi5NYWtlID0gZnVuY3Rpb24gKHhfLCB5Xykge1xuICAgICAgaWYgKHhfID09PSB1bmRlZmluZWQpIHhfID0gMDtcbiAgICAgIGlmICh5XyA9PT0gdW5kZWZpbmVkKSB5XyA9IDA7XG4gICAgICByZXR1cm4gbmV3IGIyVmVjMih4XywgeV8pO1xuICAgfVxuICAgYjJWZWMyLnByb3RvdHlwZS5Db3B5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIG5ldyBiMlZlYzIodGhpcy54LCB0aGlzLnkpO1xuICAgfVxuICAgYjJWZWMyLnByb3RvdHlwZS5BZGQgPSBmdW5jdGlvbiAodikge1xuICAgICAgdGhpcy54ICs9IHYueDtcbiAgICAgIHRoaXMueSArPSB2Lnk7XG4gICB9XG4gICBiMlZlYzIucHJvdG90eXBlLlN1YnRyYWN0ID0gZnVuY3Rpb24gKHYpIHtcbiAgICAgIHRoaXMueCAtPSB2Lng7XG4gICAgICB0aGlzLnkgLT0gdi55O1xuICAgfVxuICAgYjJWZWMyLnByb3RvdHlwZS5NdWx0aXBseSA9IGZ1bmN0aW9uIChhKSB7XG4gICAgICBpZiAoYSA9PT0gdW5kZWZpbmVkKSBhID0gMDtcbiAgICAgIHRoaXMueCAqPSBhO1xuICAgICAgdGhpcy55ICo9IGE7XG4gICB9XG4gICBiMlZlYzIucHJvdG90eXBlLk11bE0gPSBmdW5jdGlvbiAoQSkge1xuICAgICAgdmFyIHRYID0gdGhpcy54O1xuICAgICAgdGhpcy54ID0gQS5jb2wxLnggKiB0WCArIEEuY29sMi54ICogdGhpcy55O1xuICAgICAgdGhpcy55ID0gQS5jb2wxLnkgKiB0WCArIEEuY29sMi55ICogdGhpcy55O1xuICAgfVxuICAgYjJWZWMyLnByb3RvdHlwZS5NdWxUTSA9IGZ1bmN0aW9uIChBKSB7XG4gICAgICB2YXIgdFggPSBiMk1hdGguRG90KHRoaXMsIEEuY29sMSk7XG4gICAgICB0aGlzLnkgPSBiMk1hdGguRG90KHRoaXMsIEEuY29sMik7XG4gICAgICB0aGlzLnggPSB0WDtcbiAgIH1cbiAgIGIyVmVjMi5wcm90b3R5cGUuQ3Jvc3NWRiA9IGZ1bmN0aW9uIChzKSB7XG4gICAgICBpZiAocyA9PT0gdW5kZWZpbmVkKSBzID0gMDtcbiAgICAgIHZhciB0WCA9IHRoaXMueDtcbiAgICAgIHRoaXMueCA9IHMgKiB0aGlzLnk7XG4gICAgICB0aGlzLnkgPSAoLXMgKiB0WCk7XG4gICB9XG4gICBiMlZlYzIucHJvdG90eXBlLkNyb3NzRlYgPSBmdW5jdGlvbiAocykge1xuICAgICAgaWYgKHMgPT09IHVuZGVmaW5lZCkgcyA9IDA7XG4gICAgICB2YXIgdFggPSB0aGlzLng7XG4gICAgICB0aGlzLnggPSAoLXMgKiB0aGlzLnkpO1xuICAgICAgdGhpcy55ID0gcyAqIHRYO1xuICAgfVxuICAgYjJWZWMyLnByb3RvdHlwZS5NaW5WID0gZnVuY3Rpb24gKGIpIHtcbiAgICAgIHRoaXMueCA9IHRoaXMueCA8IGIueCA/IHRoaXMueCA6IGIueDtcbiAgICAgIHRoaXMueSA9IHRoaXMueSA8IGIueSA/IHRoaXMueSA6IGIueTtcbiAgIH1cbiAgIGIyVmVjMi5wcm90b3R5cGUuTWF4ViA9IGZ1bmN0aW9uIChiKSB7XG4gICAgICB0aGlzLnggPSB0aGlzLnggPiBiLnggPyB0aGlzLnggOiBiLng7XG4gICAgICB0aGlzLnkgPSB0aGlzLnkgPiBiLnkgPyB0aGlzLnkgOiBiLnk7XG4gICB9XG4gICBiMlZlYzIucHJvdG90eXBlLkFicyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICh0aGlzLnggPCAwKSB0aGlzLnggPSAoLXRoaXMueCk7XG4gICAgICBpZiAodGhpcy55IDwgMCkgdGhpcy55ID0gKC10aGlzLnkpO1xuICAgfVxuICAgYjJWZWMyLnByb3RvdHlwZS5MZW5ndGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gTWF0aC5zcXJ0KHRoaXMueCAqIHRoaXMueCArIHRoaXMueSAqIHRoaXMueSk7XG4gICB9XG4gICBiMlZlYzIucHJvdG90eXBlLkxlbmd0aFNxdWFyZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gKHRoaXMueCAqIHRoaXMueCArIHRoaXMueSAqIHRoaXMueSk7XG4gICB9XG4gICBiMlZlYzIucHJvdG90eXBlLk5vcm1hbGl6ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBsZW5ndGggPSBNYXRoLnNxcnQodGhpcy54ICogdGhpcy54ICsgdGhpcy55ICogdGhpcy55KTtcbiAgICAgIGlmIChsZW5ndGggPCBOdW1iZXIuTUlOX1ZBTFVFKSB7XG4gICAgICAgICByZXR1cm4gMC4wO1xuICAgICAgfVxuICAgICAgdmFyIGludkxlbmd0aCA9IDEuMCAvIGxlbmd0aDtcbiAgICAgIHRoaXMueCAqPSBpbnZMZW5ndGg7XG4gICAgICB0aGlzLnkgKj0gaW52TGVuZ3RoO1xuICAgICAgcmV0dXJuIGxlbmd0aDtcbiAgIH1cbiAgIGIyVmVjMi5wcm90b3R5cGUuSXNWYWxpZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBiMk1hdGguSXNWYWxpZCh0aGlzLngpICYmIGIyTWF0aC5Jc1ZhbGlkKHRoaXMueSk7XG4gICB9XG4gICBiMlZlYzMuYjJWZWMzID0gZnVuY3Rpb24gKCkge307XG4gICBiMlZlYzMucHJvdG90eXBlLmIyVmVjMyA9IGZ1bmN0aW9uICh4LCB5LCB6KSB7XG4gICAgICBpZiAoeCA9PT0gdW5kZWZpbmVkKSB4ID0gMDtcbiAgICAgIGlmICh5ID09PSB1bmRlZmluZWQpIHkgPSAwO1xuICAgICAgaWYgKHogPT09IHVuZGVmaW5lZCkgeiA9IDA7XG4gICAgICB0aGlzLnggPSB4O1xuICAgICAgdGhpcy55ID0geTtcbiAgICAgIHRoaXMueiA9IHo7XG4gICB9XG4gICBiMlZlYzMucHJvdG90eXBlLlNldFplcm8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLnggPSB0aGlzLnkgPSB0aGlzLnogPSAwLjA7XG4gICB9XG4gICBiMlZlYzMucHJvdG90eXBlLlNldCA9IGZ1bmN0aW9uICh4LCB5LCB6KSB7XG4gICAgICBpZiAoeCA9PT0gdW5kZWZpbmVkKSB4ID0gMDtcbiAgICAgIGlmICh5ID09PSB1bmRlZmluZWQpIHkgPSAwO1xuICAgICAgaWYgKHogPT09IHVuZGVmaW5lZCkgeiA9IDA7XG4gICAgICB0aGlzLnggPSB4O1xuICAgICAgdGhpcy55ID0geTtcbiAgICAgIHRoaXMueiA9IHo7XG4gICB9XG4gICBiMlZlYzMucHJvdG90eXBlLlNldFYgPSBmdW5jdGlvbiAodikge1xuICAgICAgdGhpcy54ID0gdi54O1xuICAgICAgdGhpcy55ID0gdi55O1xuICAgICAgdGhpcy56ID0gdi56O1xuICAgfVxuICAgYjJWZWMzLnByb3RvdHlwZS5HZXROZWdhdGl2ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBuZXcgYjJWZWMzKCgtdGhpcy54KSwgKC10aGlzLnkpLCAoLXRoaXMueikpO1xuICAgfVxuICAgYjJWZWMzLnByb3RvdHlwZS5OZWdhdGl2ZVNlbGYgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLnggPSAoLXRoaXMueCk7XG4gICAgICB0aGlzLnkgPSAoLXRoaXMueSk7XG4gICAgICB0aGlzLnogPSAoLXRoaXMueik7XG4gICB9XG4gICBiMlZlYzMucHJvdG90eXBlLkNvcHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gbmV3IGIyVmVjMyh0aGlzLngsIHRoaXMueSwgdGhpcy56KTtcbiAgIH1cbiAgIGIyVmVjMy5wcm90b3R5cGUuQWRkID0gZnVuY3Rpb24gKHYpIHtcbiAgICAgIHRoaXMueCArPSB2Lng7XG4gICAgICB0aGlzLnkgKz0gdi55O1xuICAgICAgdGhpcy56ICs9IHYuejtcbiAgIH1cbiAgIGIyVmVjMy5wcm90b3R5cGUuU3VidHJhY3QgPSBmdW5jdGlvbiAodikge1xuICAgICAgdGhpcy54IC09IHYueDtcbiAgICAgIHRoaXMueSAtPSB2Lnk7XG4gICAgICB0aGlzLnogLT0gdi56O1xuICAgfVxuICAgYjJWZWMzLnByb3RvdHlwZS5NdWx0aXBseSA9IGZ1bmN0aW9uIChhKSB7XG4gICAgICBpZiAoYSA9PT0gdW5kZWZpbmVkKSBhID0gMDtcbiAgICAgIHRoaXMueCAqPSBhO1xuICAgICAgdGhpcy55ICo9IGE7XG4gICAgICB0aGlzLnogKj0gYTtcbiAgIH1cbn0pKCk7XG4oZnVuY3Rpb24gKCkge1xuICAgdmFyIGIyQ29udHJvbGxlckVkZ2UgPSBCb3gyRC5EeW5hbWljcy5Db250cm9sbGVycy5iMkNvbnRyb2xsZXJFZGdlLFxuICAgICAgYjJNYXQyMiA9IEJveDJELkNvbW1vbi5NYXRoLmIyTWF0MjIsXG4gICAgICBiMk1hdDMzID0gQm94MkQuQ29tbW9uLk1hdGguYjJNYXQzMyxcbiAgICAgIGIyTWF0aCA9IEJveDJELkNvbW1vbi5NYXRoLmIyTWF0aCxcbiAgICAgIGIyU3dlZXAgPSBCb3gyRC5Db21tb24uTWF0aC5iMlN3ZWVwLFxuICAgICAgYjJUcmFuc2Zvcm0gPSBCb3gyRC5Db21tb24uTWF0aC5iMlRyYW5zZm9ybSxcbiAgICAgIGIyVmVjMiA9IEJveDJELkNvbW1vbi5NYXRoLmIyVmVjMixcbiAgICAgIGIyVmVjMyA9IEJveDJELkNvbW1vbi5NYXRoLmIyVmVjMyxcbiAgICAgIGIyQ29sb3IgPSBCb3gyRC5Db21tb24uYjJDb2xvcixcbiAgICAgIGIyaW50ZXJuYWwgPSBCb3gyRC5Db21tb24uYjJpbnRlcm5hbCxcbiAgICAgIGIyU2V0dGluZ3MgPSBCb3gyRC5Db21tb24uYjJTZXR0aW5ncyxcbiAgICAgIGIyQUFCQiA9IEJveDJELkNvbGxpc2lvbi5iMkFBQkIsXG4gICAgICBiMkJvdW5kID0gQm94MkQuQ29sbGlzaW9uLmIyQm91bmQsXG4gICAgICBiMkJvdW5kVmFsdWVzID0gQm94MkQuQ29sbGlzaW9uLmIyQm91bmRWYWx1ZXMsXG4gICAgICBiMkNvbGxpc2lvbiA9IEJveDJELkNvbGxpc2lvbi5iMkNvbGxpc2lvbixcbiAgICAgIGIyQ29udGFjdElEID0gQm94MkQuQ29sbGlzaW9uLmIyQ29udGFjdElELFxuICAgICAgYjJDb250YWN0UG9pbnQgPSBCb3gyRC5Db2xsaXNpb24uYjJDb250YWN0UG9pbnQsXG4gICAgICBiMkRpc3RhbmNlID0gQm94MkQuQ29sbGlzaW9uLmIyRGlzdGFuY2UsXG4gICAgICBiMkRpc3RhbmNlSW5wdXQgPSBCb3gyRC5Db2xsaXNpb24uYjJEaXN0YW5jZUlucHV0LFxuICAgICAgYjJEaXN0YW5jZU91dHB1dCA9IEJveDJELkNvbGxpc2lvbi5iMkRpc3RhbmNlT3V0cHV0LFxuICAgICAgYjJEaXN0YW5jZVByb3h5ID0gQm94MkQuQ29sbGlzaW9uLmIyRGlzdGFuY2VQcm94eSxcbiAgICAgIGIyRHluYW1pY1RyZWUgPSBCb3gyRC5Db2xsaXNpb24uYjJEeW5hbWljVHJlZSxcbiAgICAgIGIyRHluYW1pY1RyZWVCcm9hZFBoYXNlID0gQm94MkQuQ29sbGlzaW9uLmIyRHluYW1pY1RyZWVCcm9hZFBoYXNlLFxuICAgICAgYjJEeW5hbWljVHJlZU5vZGUgPSBCb3gyRC5Db2xsaXNpb24uYjJEeW5hbWljVHJlZU5vZGUsXG4gICAgICBiMkR5bmFtaWNUcmVlUGFpciA9IEJveDJELkNvbGxpc2lvbi5iMkR5bmFtaWNUcmVlUGFpcixcbiAgICAgIGIyTWFuaWZvbGQgPSBCb3gyRC5Db2xsaXNpb24uYjJNYW5pZm9sZCxcbiAgICAgIGIyTWFuaWZvbGRQb2ludCA9IEJveDJELkNvbGxpc2lvbi5iMk1hbmlmb2xkUG9pbnQsXG4gICAgICBiMlBvaW50ID0gQm94MkQuQ29sbGlzaW9uLmIyUG9pbnQsXG4gICAgICBiMlJheUNhc3RJbnB1dCA9IEJveDJELkNvbGxpc2lvbi5iMlJheUNhc3RJbnB1dCxcbiAgICAgIGIyUmF5Q2FzdE91dHB1dCA9IEJveDJELkNvbGxpc2lvbi5iMlJheUNhc3RPdXRwdXQsXG4gICAgICBiMlNlZ21lbnQgPSBCb3gyRC5Db2xsaXNpb24uYjJTZWdtZW50LFxuICAgICAgYjJTZXBhcmF0aW9uRnVuY3Rpb24gPSBCb3gyRC5Db2xsaXNpb24uYjJTZXBhcmF0aW9uRnVuY3Rpb24sXG4gICAgICBiMlNpbXBsZXggPSBCb3gyRC5Db2xsaXNpb24uYjJTaW1wbGV4LFxuICAgICAgYjJTaW1wbGV4Q2FjaGUgPSBCb3gyRC5Db2xsaXNpb24uYjJTaW1wbGV4Q2FjaGUsXG4gICAgICBiMlNpbXBsZXhWZXJ0ZXggPSBCb3gyRC5Db2xsaXNpb24uYjJTaW1wbGV4VmVydGV4LFxuICAgICAgYjJUaW1lT2ZJbXBhY3QgPSBCb3gyRC5Db2xsaXNpb24uYjJUaW1lT2ZJbXBhY3QsXG4gICAgICBiMlRPSUlucHV0ID0gQm94MkQuQ29sbGlzaW9uLmIyVE9JSW5wdXQsXG4gICAgICBiMldvcmxkTWFuaWZvbGQgPSBCb3gyRC5Db2xsaXNpb24uYjJXb3JsZE1hbmlmb2xkLFxuICAgICAgQ2xpcFZlcnRleCA9IEJveDJELkNvbGxpc2lvbi5DbGlwVmVydGV4LFxuICAgICAgRmVhdHVyZXMgPSBCb3gyRC5Db2xsaXNpb24uRmVhdHVyZXMsXG4gICAgICBJQnJvYWRQaGFzZSA9IEJveDJELkNvbGxpc2lvbi5JQnJvYWRQaGFzZSxcbiAgICAgIGIyQ2lyY2xlU2hhcGUgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyQ2lyY2xlU2hhcGUsXG4gICAgICBiMkVkZ2VDaGFpbkRlZiA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJFZGdlQ2hhaW5EZWYsXG4gICAgICBiMkVkZ2VTaGFwZSA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJFZGdlU2hhcGUsXG4gICAgICBiMk1hc3NEYXRhID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMk1hc3NEYXRhLFxuICAgICAgYjJQb2x5Z29uU2hhcGUgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyUG9seWdvblNoYXBlLFxuICAgICAgYjJTaGFwZSA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJTaGFwZSxcbiAgICAgIGIyQm9keSA9IEJveDJELkR5bmFtaWNzLmIyQm9keSxcbiAgICAgIGIyQm9keURlZiA9IEJveDJELkR5bmFtaWNzLmIyQm9keURlZixcbiAgICAgIGIyQ29udGFjdEZpbHRlciA9IEJveDJELkR5bmFtaWNzLmIyQ29udGFjdEZpbHRlcixcbiAgICAgIGIyQ29udGFjdEltcHVsc2UgPSBCb3gyRC5EeW5hbWljcy5iMkNvbnRhY3RJbXB1bHNlLFxuICAgICAgYjJDb250YWN0TGlzdGVuZXIgPSBCb3gyRC5EeW5hbWljcy5iMkNvbnRhY3RMaXN0ZW5lcixcbiAgICAgIGIyQ29udGFjdE1hbmFnZXIgPSBCb3gyRC5EeW5hbWljcy5iMkNvbnRhY3RNYW5hZ2VyLFxuICAgICAgYjJEZWJ1Z0RyYXcgPSBCb3gyRC5EeW5hbWljcy5iMkRlYnVnRHJhdyxcbiAgICAgIGIyRGVzdHJ1Y3Rpb25MaXN0ZW5lciA9IEJveDJELkR5bmFtaWNzLmIyRGVzdHJ1Y3Rpb25MaXN0ZW5lcixcbiAgICAgIGIyRmlsdGVyRGF0YSA9IEJveDJELkR5bmFtaWNzLmIyRmlsdGVyRGF0YSxcbiAgICAgIGIyRml4dHVyZSA9IEJveDJELkR5bmFtaWNzLmIyRml4dHVyZSxcbiAgICAgIGIyRml4dHVyZURlZiA9IEJveDJELkR5bmFtaWNzLmIyRml4dHVyZURlZixcbiAgICAgIGIySXNsYW5kID0gQm94MkQuRHluYW1pY3MuYjJJc2xhbmQsXG4gICAgICBiMlRpbWVTdGVwID0gQm94MkQuRHluYW1pY3MuYjJUaW1lU3RlcCxcbiAgICAgIGIyV29ybGQgPSBCb3gyRC5EeW5hbWljcy5iMldvcmxkLFxuICAgICAgYjJDaXJjbGVDb250YWN0ID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDaXJjbGVDb250YWN0LFxuICAgICAgYjJDb250YWN0ID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0LFxuICAgICAgYjJDb250YWN0Q29uc3RyYWludCA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdENvbnN0cmFpbnQsXG4gICAgICBiMkNvbnRhY3RDb25zdHJhaW50UG9pbnQgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3RDb25zdHJhaW50UG9pbnQsXG4gICAgICBiMkNvbnRhY3RFZGdlID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0RWRnZSxcbiAgICAgIGIyQ29udGFjdEZhY3RvcnkgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3RGYWN0b3J5LFxuICAgICAgYjJDb250YWN0UmVnaXN0ZXIgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3RSZWdpc3RlcixcbiAgICAgIGIyQ29udGFjdFJlc3VsdCA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdFJlc3VsdCxcbiAgICAgIGIyQ29udGFjdFNvbHZlciA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdFNvbHZlcixcbiAgICAgIGIyRWRnZUFuZENpcmNsZUNvbnRhY3QgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkVkZ2VBbmRDaXJjbGVDb250YWN0LFxuICAgICAgYjJOdWxsQ29udGFjdCA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyTnVsbENvbnRhY3QsXG4gICAgICBiMlBvbHlBbmRDaXJjbGVDb250YWN0ID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJQb2x5QW5kQ2lyY2xlQ29udGFjdCxcbiAgICAgIGIyUG9seUFuZEVkZ2VDb250YWN0ID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJQb2x5QW5kRWRnZUNvbnRhY3QsXG4gICAgICBiMlBvbHlnb25Db250YWN0ID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJQb2x5Z29uQ29udGFjdCxcbiAgICAgIGIyUG9zaXRpb25Tb2x2ZXJNYW5pZm9sZCA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyUG9zaXRpb25Tb2x2ZXJNYW5pZm9sZCxcbiAgICAgIGIyQ29udHJvbGxlciA9IEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyQ29udHJvbGxlcixcbiAgICAgIGIyRGlzdGFuY2VKb2ludCA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkRpc3RhbmNlSm9pbnQsXG4gICAgICBiMkRpc3RhbmNlSm9pbnREZWYgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJEaXN0YW5jZUpvaW50RGVmLFxuICAgICAgYjJGcmljdGlvbkpvaW50ID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyRnJpY3Rpb25Kb2ludCxcbiAgICAgIGIyRnJpY3Rpb25Kb2ludERlZiA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkZyaWN0aW9uSm9pbnREZWYsXG4gICAgICBiMkdlYXJKb2ludCA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkdlYXJKb2ludCxcbiAgICAgIGIyR2VhckpvaW50RGVmID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyR2VhckpvaW50RGVmLFxuICAgICAgYjJKYWNvYmlhbiA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkphY29iaWFuLFxuICAgICAgYjJKb2ludCA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50LFxuICAgICAgYjJKb2ludERlZiA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmLFxuICAgICAgYjJKb2ludEVkZ2UgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludEVkZ2UsXG4gICAgICBiMkxpbmVKb2ludCA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkxpbmVKb2ludCxcbiAgICAgIGIyTGluZUpvaW50RGVmID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyTGluZUpvaW50RGVmLFxuICAgICAgYjJNb3VzZUpvaW50ID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyTW91c2VKb2ludCxcbiAgICAgIGIyTW91c2VKb2ludERlZiA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMk1vdXNlSm9pbnREZWYsXG4gICAgICBiMlByaXNtYXRpY0pvaW50ID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyUHJpc21hdGljSm9pbnQsXG4gICAgICBiMlByaXNtYXRpY0pvaW50RGVmID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyUHJpc21hdGljSm9pbnREZWYsXG4gICAgICBiMlB1bGxleUpvaW50ID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyUHVsbGV5Sm9pbnQsXG4gICAgICBiMlB1bGxleUpvaW50RGVmID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyUHVsbGV5Sm9pbnREZWYsXG4gICAgICBiMlJldm9sdXRlSm9pbnQgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJSZXZvbHV0ZUpvaW50LFxuICAgICAgYjJSZXZvbHV0ZUpvaW50RGVmID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyUmV2b2x1dGVKb2ludERlZixcbiAgICAgIGIyV2VsZEpvaW50ID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyV2VsZEpvaW50LFxuICAgICAgYjJXZWxkSm9pbnREZWYgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJXZWxkSm9pbnREZWY7XG5cbiAgIGIyQm9keS5iMkJvZHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLm1feGYgPSBuZXcgYjJUcmFuc2Zvcm0oKTtcbiAgICAgIHRoaXMubV9zd2VlcCA9IG5ldyBiMlN3ZWVwKCk7XG4gICAgICB0aGlzLm1fbGluZWFyVmVsb2NpdHkgPSBuZXcgYjJWZWMyKCk7XG4gICAgICB0aGlzLm1fZm9yY2UgPSBuZXcgYjJWZWMyKCk7XG4gICB9O1xuICAgYjJCb2R5LnByb3RvdHlwZS5jb25uZWN0RWRnZXMgPSBmdW5jdGlvbiAoczEsIHMyLCBhbmdsZTEpIHtcbiAgICAgIGlmIChhbmdsZTEgPT09IHVuZGVmaW5lZCkgYW5nbGUxID0gMDtcbiAgICAgIHZhciBhbmdsZTIgPSBNYXRoLmF0YW4yKHMyLkdldERpcmVjdGlvblZlY3RvcigpLnksIHMyLkdldERpcmVjdGlvblZlY3RvcigpLngpO1xuICAgICAgdmFyIGNvcmVPZmZzZXQgPSBNYXRoLnRhbigoYW5nbGUyIC0gYW5nbGUxKSAqIDAuNSk7XG4gICAgICB2YXIgY29yZSA9IGIyTWF0aC5NdWxGVihjb3JlT2Zmc2V0LCBzMi5HZXREaXJlY3Rpb25WZWN0b3IoKSk7XG4gICAgICBjb3JlID0gYjJNYXRoLlN1YnRyYWN0VlYoY29yZSwgczIuR2V0Tm9ybWFsVmVjdG9yKCkpO1xuICAgICAgY29yZSA9IGIyTWF0aC5NdWxGVihiMlNldHRpbmdzLmIyX3RvaVNsb3AsIGNvcmUpO1xuICAgICAgY29yZSA9IGIyTWF0aC5BZGRWVihjb3JlLCBzMi5HZXRWZXJ0ZXgxKCkpO1xuICAgICAgdmFyIGNvcm5lckRpciA9IGIyTWF0aC5BZGRWVihzMS5HZXREaXJlY3Rpb25WZWN0b3IoKSwgczIuR2V0RGlyZWN0aW9uVmVjdG9yKCkpO1xuICAgICAgY29ybmVyRGlyLk5vcm1hbGl6ZSgpO1xuICAgICAgdmFyIGNvbnZleCA9IGIyTWF0aC5Eb3QoczEuR2V0RGlyZWN0aW9uVmVjdG9yKCksIHMyLkdldE5vcm1hbFZlY3RvcigpKSA+IDAuMDtcbiAgICAgIHMxLlNldE5leHRFZGdlKHMyLCBjb3JlLCBjb3JuZXJEaXIsIGNvbnZleCk7XG4gICAgICBzMi5TZXRQcmV2RWRnZShzMSwgY29yZSwgY29ybmVyRGlyLCBjb252ZXgpO1xuICAgICAgcmV0dXJuIGFuZ2xlMjtcbiAgIH1cbiAgIGIyQm9keS5wcm90b3R5cGUuQ3JlYXRlRml4dHVyZSA9IGZ1bmN0aW9uIChkZWYpIHtcbiAgICAgIGlmICh0aGlzLm1fd29ybGQuSXNMb2NrZWQoKSA9PSB0cnVlKSB7XG4gICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIHZhciBmaXh0dXJlID0gbmV3IGIyRml4dHVyZSgpO1xuICAgICAgZml4dHVyZS5DcmVhdGUodGhpcywgdGhpcy5tX3hmLCBkZWYpO1xuICAgICAgaWYgKHRoaXMubV9mbGFncyAmIGIyQm9keS5lX2FjdGl2ZUZsYWcpIHtcbiAgICAgICAgIHZhciBicm9hZFBoYXNlID0gdGhpcy5tX3dvcmxkLm1fY29udGFjdE1hbmFnZXIubV9icm9hZFBoYXNlO1xuICAgICAgICAgZml4dHVyZS5DcmVhdGVQcm94eShicm9hZFBoYXNlLCB0aGlzLm1feGYpO1xuICAgICAgfVxuICAgICAgZml4dHVyZS5tX25leHQgPSB0aGlzLm1fZml4dHVyZUxpc3Q7XG4gICAgICB0aGlzLm1fZml4dHVyZUxpc3QgPSBmaXh0dXJlO1xuICAgICAgKyt0aGlzLm1fZml4dHVyZUNvdW50O1xuICAgICAgZml4dHVyZS5tX2JvZHkgPSB0aGlzO1xuICAgICAgaWYgKGZpeHR1cmUubV9kZW5zaXR5ID4gMC4wKSB7XG4gICAgICAgICB0aGlzLlJlc2V0TWFzc0RhdGEoKTtcbiAgICAgIH1cbiAgICAgIHRoaXMubV93b3JsZC5tX2ZsYWdzIHw9IGIyV29ybGQuZV9uZXdGaXh0dXJlO1xuICAgICAgcmV0dXJuIGZpeHR1cmU7XG4gICB9XG4gICBiMkJvZHkucHJvdG90eXBlLkNyZWF0ZUZpeHR1cmUyID0gZnVuY3Rpb24gKHNoYXBlLCBkZW5zaXR5KSB7XG4gICAgICBpZiAoZGVuc2l0eSA9PT0gdW5kZWZpbmVkKSBkZW5zaXR5ID0gMC4wO1xuICAgICAgdmFyIGRlZiA9IG5ldyBiMkZpeHR1cmVEZWYoKTtcbiAgICAgIGRlZi5zaGFwZSA9IHNoYXBlO1xuICAgICAgZGVmLmRlbnNpdHkgPSBkZW5zaXR5O1xuICAgICAgcmV0dXJuIHRoaXMuQ3JlYXRlRml4dHVyZShkZWYpO1xuICAgfVxuICAgYjJCb2R5LnByb3RvdHlwZS5EZXN0cm95Rml4dHVyZSA9IGZ1bmN0aW9uIChmaXh0dXJlKSB7XG4gICAgICBpZiAodGhpcy5tX3dvcmxkLklzTG9ja2VkKCkgPT0gdHJ1ZSkge1xuICAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdmFyIG5vZGUgPSB0aGlzLm1fZml4dHVyZUxpc3Q7XG4gICAgICB2YXIgcHBGID0gbnVsbDtcbiAgICAgIHZhciBmb3VuZCA9IGZhbHNlO1xuICAgICAgd2hpbGUgKG5vZGUgIT0gbnVsbCkge1xuICAgICAgICAgaWYgKG5vZGUgPT0gZml4dHVyZSkge1xuICAgICAgICAgICAgaWYgKHBwRikgcHBGLm1fbmV4dCA9IGZpeHR1cmUubV9uZXh0O1xuICAgICAgICAgICAgZWxzZSB0aGlzLm1fZml4dHVyZUxpc3QgPSBmaXh0dXJlLm1fbmV4dDtcbiAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgfVxuICAgICAgICAgcHBGID0gbm9kZTtcbiAgICAgICAgIG5vZGUgPSBub2RlLm1fbmV4dDtcbiAgICAgIH1cbiAgICAgIHZhciBlZGdlID0gdGhpcy5tX2NvbnRhY3RMaXN0O1xuICAgICAgd2hpbGUgKGVkZ2UpIHtcbiAgICAgICAgIHZhciBjID0gZWRnZS5jb250YWN0O1xuICAgICAgICAgZWRnZSA9IGVkZ2UubmV4dDtcbiAgICAgICAgIHZhciBmaXh0dXJlQSA9IGMuR2V0Rml4dHVyZUEoKTtcbiAgICAgICAgIHZhciBmaXh0dXJlQiA9IGMuR2V0Rml4dHVyZUIoKTtcbiAgICAgICAgIGlmIChmaXh0dXJlID09IGZpeHR1cmVBIHx8IGZpeHR1cmUgPT0gZml4dHVyZUIpIHtcbiAgICAgICAgICAgIHRoaXMubV93b3JsZC5tX2NvbnRhY3RNYW5hZ2VyLkRlc3Ryb3koYyk7XG4gICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5tX2ZsYWdzICYgYjJCb2R5LmVfYWN0aXZlRmxhZykge1xuICAgICAgICAgdmFyIGJyb2FkUGhhc2UgPSB0aGlzLm1fd29ybGQubV9jb250YWN0TWFuYWdlci5tX2Jyb2FkUGhhc2U7XG4gICAgICAgICBmaXh0dXJlLkRlc3Ryb3lQcm94eShicm9hZFBoYXNlKTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge31cbiAgICAgIGZpeHR1cmUuRGVzdHJveSgpO1xuICAgICAgZml4dHVyZS5tX2JvZHkgPSBudWxsO1xuICAgICAgZml4dHVyZS5tX25leHQgPSBudWxsO1xuICAgICAgLS10aGlzLm1fZml4dHVyZUNvdW50O1xuICAgICAgdGhpcy5SZXNldE1hc3NEYXRhKCk7XG4gICB9XG4gICBiMkJvZHkucHJvdG90eXBlLlNldFBvc2l0aW9uQW5kQW5nbGUgPSBmdW5jdGlvbiAocG9zaXRpb24sIGFuZ2xlKSB7XG4gICAgICBpZiAoYW5nbGUgPT09IHVuZGVmaW5lZCkgYW5nbGUgPSAwO1xuICAgICAgdmFyIGY7XG4gICAgICBpZiAodGhpcy5tX3dvcmxkLklzTG9ja2VkKCkgPT0gdHJ1ZSkge1xuICAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy5tX3hmLlIuU2V0KGFuZ2xlKTtcbiAgICAgIHRoaXMubV94Zi5wb3NpdGlvbi5TZXRWKHBvc2l0aW9uKTtcbiAgICAgIHZhciB0TWF0ID0gdGhpcy5tX3hmLlI7XG4gICAgICB2YXIgdFZlYyA9IHRoaXMubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgIHRoaXMubV9zd2VlcC5jLnggPSAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XG4gICAgICB0aGlzLm1fc3dlZXAuYy55ID0gKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xuICAgICAgdGhpcy5tX3N3ZWVwLmMueCArPSB0aGlzLm1feGYucG9zaXRpb24ueDtcbiAgICAgIHRoaXMubV9zd2VlcC5jLnkgKz0gdGhpcy5tX3hmLnBvc2l0aW9uLnk7XG4gICAgICB0aGlzLm1fc3dlZXAuYzAuU2V0Vih0aGlzLm1fc3dlZXAuYyk7XG4gICAgICB0aGlzLm1fc3dlZXAuYTAgPSB0aGlzLm1fc3dlZXAuYSA9IGFuZ2xlO1xuICAgICAgdmFyIGJyb2FkUGhhc2UgPSB0aGlzLm1fd29ybGQubV9jb250YWN0TWFuYWdlci5tX2Jyb2FkUGhhc2U7XG4gICAgICBmb3IgKGYgPSB0aGlzLm1fZml4dHVyZUxpc3Q7XG4gICAgICBmOyBmID0gZi5tX25leHQpIHtcbiAgICAgICAgIGYuU3luY2hyb25pemUoYnJvYWRQaGFzZSwgdGhpcy5tX3hmLCB0aGlzLm1feGYpO1xuICAgICAgfVxuICAgICAgdGhpcy5tX3dvcmxkLm1fY29udGFjdE1hbmFnZXIuRmluZE5ld0NvbnRhY3RzKCk7XG4gICB9XG4gICBiMkJvZHkucHJvdG90eXBlLlNldFRyYW5zZm9ybSA9IGZ1bmN0aW9uICh4Zikge1xuICAgICAgdGhpcy5TZXRQb3NpdGlvbkFuZEFuZ2xlKHhmLnBvc2l0aW9uLCB4Zi5HZXRBbmdsZSgpKTtcbiAgIH1cbiAgIGIyQm9keS5wcm90b3R5cGUuR2V0VHJhbnNmb3JtID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV94ZjtcbiAgIH1cbiAgIGIyQm9keS5wcm90b3R5cGUuR2V0UG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX3hmLnBvc2l0aW9uO1xuICAgfVxuICAgYjJCb2R5LnByb3RvdHlwZS5TZXRQb3NpdGlvbiA9IGZ1bmN0aW9uIChwb3NpdGlvbikge1xuICAgICAgdGhpcy5TZXRQb3NpdGlvbkFuZEFuZ2xlKHBvc2l0aW9uLCB0aGlzLkdldEFuZ2xlKCkpO1xuICAgfVxuICAgYjJCb2R5LnByb3RvdHlwZS5HZXRBbmdsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fc3dlZXAuYTtcbiAgIH1cbiAgIGIyQm9keS5wcm90b3R5cGUuU2V0QW5nbGUgPSBmdW5jdGlvbiAoYW5nbGUpIHtcbiAgICAgIGlmIChhbmdsZSA9PT0gdW5kZWZpbmVkKSBhbmdsZSA9IDA7XG4gICAgICB0aGlzLlNldFBvc2l0aW9uQW5kQW5nbGUodGhpcy5HZXRQb3NpdGlvbigpLCBhbmdsZSk7XG4gICB9XG4gICBiMkJvZHkucHJvdG90eXBlLkdldFdvcmxkQ2VudGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV9zd2VlcC5jO1xuICAgfVxuICAgYjJCb2R5LnByb3RvdHlwZS5HZXRMb2NhbENlbnRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fc3dlZXAubG9jYWxDZW50ZXI7XG4gICB9XG4gICBiMkJvZHkucHJvdG90eXBlLlNldExpbmVhclZlbG9jaXR5ID0gZnVuY3Rpb24gKHYpIHtcbiAgICAgIGlmICh0aGlzLm1fdHlwZSA9PSBiMkJvZHkuYjJfc3RhdGljQm9keSkge1xuICAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy5tX2xpbmVhclZlbG9jaXR5LlNldFYodik7XG4gICB9XG4gICBiMkJvZHkucHJvdG90eXBlLkdldExpbmVhclZlbG9jaXR5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV9saW5lYXJWZWxvY2l0eTtcbiAgIH1cbiAgIGIyQm9keS5wcm90b3R5cGUuU2V0QW5ndWxhclZlbG9jaXR5ID0gZnVuY3Rpb24gKG9tZWdhKSB7XG4gICAgICBpZiAob21lZ2EgPT09IHVuZGVmaW5lZCkgb21lZ2EgPSAwO1xuICAgICAgaWYgKHRoaXMubV90eXBlID09IGIyQm9keS5iMl9zdGF0aWNCb2R5KSB7XG4gICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLm1fYW5ndWxhclZlbG9jaXR5ID0gb21lZ2E7XG4gICB9XG4gICBiMkJvZHkucHJvdG90eXBlLkdldEFuZ3VsYXJWZWxvY2l0eSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fYW5ndWxhclZlbG9jaXR5O1xuICAgfVxuICAgYjJCb2R5LnByb3RvdHlwZS5HZXREZWZpbml0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIGJkID0gbmV3IGIyQm9keURlZigpO1xuICAgICAgYmQudHlwZSA9IHRoaXMuR2V0VHlwZSgpO1xuICAgICAgYmQuYWxsb3dTbGVlcCA9ICh0aGlzLm1fZmxhZ3MgJiBiMkJvZHkuZV9hbGxvd1NsZWVwRmxhZykgPT0gYjJCb2R5LmVfYWxsb3dTbGVlcEZsYWc7XG4gICAgICBiZC5hbmdsZSA9IHRoaXMuR2V0QW5nbGUoKTtcbiAgICAgIGJkLmFuZ3VsYXJEYW1waW5nID0gdGhpcy5tX2FuZ3VsYXJEYW1waW5nO1xuICAgICAgYmQuYW5ndWxhclZlbG9jaXR5ID0gdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eTtcbiAgICAgIGJkLmZpeGVkUm90YXRpb24gPSAodGhpcy5tX2ZsYWdzICYgYjJCb2R5LmVfZml4ZWRSb3RhdGlvbkZsYWcpID09IGIyQm9keS5lX2ZpeGVkUm90YXRpb25GbGFnO1xuICAgICAgYmQuYnVsbGV0ID0gKHRoaXMubV9mbGFncyAmIGIyQm9keS5lX2J1bGxldEZsYWcpID09IGIyQm9keS5lX2J1bGxldEZsYWc7XG4gICAgICBiZC5hd2FrZSA9ICh0aGlzLm1fZmxhZ3MgJiBiMkJvZHkuZV9hd2FrZUZsYWcpID09IGIyQm9keS5lX2F3YWtlRmxhZztcbiAgICAgIGJkLmxpbmVhckRhbXBpbmcgPSB0aGlzLm1fbGluZWFyRGFtcGluZztcbiAgICAgIGJkLmxpbmVhclZlbG9jaXR5LlNldFYodGhpcy5HZXRMaW5lYXJWZWxvY2l0eSgpKTtcbiAgICAgIGJkLnBvc2l0aW9uID0gdGhpcy5HZXRQb3NpdGlvbigpO1xuICAgICAgYmQudXNlckRhdGEgPSB0aGlzLkdldFVzZXJEYXRhKCk7XG4gICAgICByZXR1cm4gYmQ7XG4gICB9XG4gICBiMkJvZHkucHJvdG90eXBlLkFwcGx5Rm9yY2UgPSBmdW5jdGlvbiAoZm9yY2UsIHBvaW50KSB7XG4gICAgICBpZiAodGhpcy5tX3R5cGUgIT0gYjJCb2R5LmIyX2R5bmFtaWNCb2R5KSB7XG4gICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5Jc0F3YWtlKCkgPT0gZmFsc2UpIHtcbiAgICAgICAgIHRoaXMuU2V0QXdha2UodHJ1ZSk7XG4gICAgICB9XG4gICAgICB0aGlzLm1fZm9yY2UueCArPSBmb3JjZS54O1xuICAgICAgdGhpcy5tX2ZvcmNlLnkgKz0gZm9yY2UueTtcbiAgICAgIHRoaXMubV90b3JxdWUgKz0gKChwb2ludC54IC0gdGhpcy5tX3N3ZWVwLmMueCkgKiBmb3JjZS55IC0gKHBvaW50LnkgLSB0aGlzLm1fc3dlZXAuYy55KSAqIGZvcmNlLngpO1xuICAgfVxuICAgYjJCb2R5LnByb3RvdHlwZS5BcHBseVRvcnF1ZSA9IGZ1bmN0aW9uICh0b3JxdWUpIHtcbiAgICAgIGlmICh0b3JxdWUgPT09IHVuZGVmaW5lZCkgdG9ycXVlID0gMDtcbiAgICAgIGlmICh0aGlzLm1fdHlwZSAhPSBiMkJvZHkuYjJfZHluYW1pY0JvZHkpIHtcbiAgICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLklzQXdha2UoKSA9PSBmYWxzZSkge1xuICAgICAgICAgdGhpcy5TZXRBd2FrZSh0cnVlKTtcbiAgICAgIH1cbiAgICAgIHRoaXMubV90b3JxdWUgKz0gdG9ycXVlO1xuICAgfVxuICAgYjJCb2R5LnByb3RvdHlwZS5BcHBseUltcHVsc2UgPSBmdW5jdGlvbiAoaW1wdWxzZSwgcG9pbnQpIHtcbiAgICAgIGlmICh0aGlzLm1fdHlwZSAhPSBiMkJvZHkuYjJfZHluYW1pY0JvZHkpIHtcbiAgICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLklzQXdha2UoKSA9PSBmYWxzZSkge1xuICAgICAgICAgdGhpcy5TZXRBd2FrZSh0cnVlKTtcbiAgICAgIH1cbiAgICAgIHRoaXMubV9saW5lYXJWZWxvY2l0eS54ICs9IHRoaXMubV9pbnZNYXNzICogaW1wdWxzZS54O1xuICAgICAgdGhpcy5tX2xpbmVhclZlbG9jaXR5LnkgKz0gdGhpcy5tX2ludk1hc3MgKiBpbXB1bHNlLnk7XG4gICAgICB0aGlzLm1fYW5ndWxhclZlbG9jaXR5ICs9IHRoaXMubV9pbnZJICogKChwb2ludC54IC0gdGhpcy5tX3N3ZWVwLmMueCkgKiBpbXB1bHNlLnkgLSAocG9pbnQueSAtIHRoaXMubV9zd2VlcC5jLnkpICogaW1wdWxzZS54KTtcbiAgIH1cbiAgIGIyQm9keS5wcm90b3R5cGUuU3BsaXQgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgIHZhciBsaW5lYXJWZWxvY2l0eSA9IHRoaXMuR2V0TGluZWFyVmVsb2NpdHkoKS5Db3B5KCk7XG4gICAgICB2YXIgYW5ndWxhclZlbG9jaXR5ID0gdGhpcy5HZXRBbmd1bGFyVmVsb2NpdHkoKTtcbiAgICAgIHZhciBjZW50ZXIgPSB0aGlzLkdldFdvcmxkQ2VudGVyKCk7XG4gICAgICB2YXIgYm9keTEgPSB0aGlzO1xuICAgICAgdmFyIGJvZHkyID0gdGhpcy5tX3dvcmxkLkNyZWF0ZUJvZHkodGhpcy5HZXREZWZpbml0aW9uKCkpO1xuICAgICAgdmFyIHByZXY7XG4gICAgICBmb3IgKHZhciBmID0gYm9keTEubV9maXh0dXJlTGlzdDsgZjspIHtcbiAgICAgICAgIGlmIChjYWxsYmFjayhmKSkge1xuICAgICAgICAgICAgdmFyIG5leHQgPSBmLm1fbmV4dDtcbiAgICAgICAgICAgIGlmIChwcmV2KSB7XG4gICAgICAgICAgICAgICBwcmV2Lm1fbmV4dCA9IG5leHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgIGJvZHkxLm1fZml4dHVyZUxpc3QgPSBuZXh0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYm9keTEubV9maXh0dXJlQ291bnQtLTtcbiAgICAgICAgICAgIGYubV9uZXh0ID0gYm9keTIubV9maXh0dXJlTGlzdDtcbiAgICAgICAgICAgIGJvZHkyLm1fZml4dHVyZUxpc3QgPSBmO1xuICAgICAgICAgICAgYm9keTIubV9maXh0dXJlQ291bnQrKztcbiAgICAgICAgICAgIGYubV9ib2R5ID0gYm9keTI7XG4gICAgICAgICAgICBmID0gbmV4dDtcbiAgICAgICAgIH1cbiAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcHJldiA9IGY7XG4gICAgICAgICAgICBmID0gZi5tX25leHQ7XG4gICAgICAgICB9XG4gICAgICB9XG4gICAgICBib2R5MS5SZXNldE1hc3NEYXRhKCk7XG4gICAgICBib2R5Mi5SZXNldE1hc3NEYXRhKCk7XG4gICAgICB2YXIgY2VudGVyMSA9IGJvZHkxLkdldFdvcmxkQ2VudGVyKCk7XG4gICAgICB2YXIgY2VudGVyMiA9IGJvZHkyLkdldFdvcmxkQ2VudGVyKCk7XG4gICAgICB2YXIgdmVsb2NpdHkxID0gYjJNYXRoLkFkZFZWKGxpbmVhclZlbG9jaXR5LCBiMk1hdGguQ3Jvc3NGVihhbmd1bGFyVmVsb2NpdHksIGIyTWF0aC5TdWJ0cmFjdFZWKGNlbnRlcjEsIGNlbnRlcikpKTtcbiAgICAgIHZhciB2ZWxvY2l0eTIgPSBiMk1hdGguQWRkVlYobGluZWFyVmVsb2NpdHksIGIyTWF0aC5Dcm9zc0ZWKGFuZ3VsYXJWZWxvY2l0eSwgYjJNYXRoLlN1YnRyYWN0VlYoY2VudGVyMiwgY2VudGVyKSkpO1xuICAgICAgYm9keTEuU2V0TGluZWFyVmVsb2NpdHkodmVsb2NpdHkxKTtcbiAgICAgIGJvZHkyLlNldExpbmVhclZlbG9jaXR5KHZlbG9jaXR5Mik7XG4gICAgICBib2R5MS5TZXRBbmd1bGFyVmVsb2NpdHkoYW5ndWxhclZlbG9jaXR5KTtcbiAgICAgIGJvZHkyLlNldEFuZ3VsYXJWZWxvY2l0eShhbmd1bGFyVmVsb2NpdHkpO1xuICAgICAgYm9keTEuU3luY2hyb25pemVGaXh0dXJlcygpO1xuICAgICAgYm9keTIuU3luY2hyb25pemVGaXh0dXJlcygpO1xuICAgICAgcmV0dXJuIGJvZHkyO1xuICAgfVxuICAgYjJCb2R5LnByb3RvdHlwZS5NZXJnZSA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgICAgdmFyIGY7XG4gICAgICBmb3IgKGYgPSBvdGhlci5tX2ZpeHR1cmVMaXN0O1xuICAgICAgZjspIHtcbiAgICAgICAgIHZhciBuZXh0ID0gZi5tX25leHQ7XG4gICAgICAgICBvdGhlci5tX2ZpeHR1cmVDb3VudC0tO1xuICAgICAgICAgZi5tX25leHQgPSB0aGlzLm1fZml4dHVyZUxpc3Q7XG4gICAgICAgICB0aGlzLm1fZml4dHVyZUxpc3QgPSBmO1xuICAgICAgICAgdGhpcy5tX2ZpeHR1cmVDb3VudCsrO1xuICAgICAgICAgZi5tX2JvZHkgPSBib2R5MjtcbiAgICAgICAgIGYgPSBuZXh0O1xuICAgICAgfVxuICAgICAgYm9keTEubV9maXh0dXJlQ291bnQgPSAwO1xuICAgICAgdmFyIGJvZHkxID0gdGhpcztcbiAgICAgIHZhciBib2R5MiA9IG90aGVyO1xuICAgICAgdmFyIGNlbnRlcjEgPSBib2R5MS5HZXRXb3JsZENlbnRlcigpO1xuICAgICAgdmFyIGNlbnRlcjIgPSBib2R5Mi5HZXRXb3JsZENlbnRlcigpO1xuICAgICAgdmFyIHZlbG9jaXR5MSA9IGJvZHkxLkdldExpbmVhclZlbG9jaXR5KCkuQ29weSgpO1xuICAgICAgdmFyIHZlbG9jaXR5MiA9IGJvZHkyLkdldExpbmVhclZlbG9jaXR5KCkuQ29weSgpO1xuICAgICAgdmFyIGFuZ3VsYXIxID0gYm9keTEuR2V0QW5ndWxhclZlbG9jaXR5KCk7XG4gICAgICB2YXIgYW5ndWxhciA9IGJvZHkyLkdldEFuZ3VsYXJWZWxvY2l0eSgpO1xuICAgICAgYm9keTEuUmVzZXRNYXNzRGF0YSgpO1xuICAgICAgdGhpcy5TeW5jaHJvbml6ZUZpeHR1cmVzKCk7XG4gICB9XG4gICBiMkJvZHkucHJvdG90eXBlLkdldE1hc3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX21hc3M7XG4gICB9XG4gICBiMkJvZHkucHJvdG90eXBlLkdldEluZXJ0aWEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX0k7XG4gICB9XG4gICBiMkJvZHkucHJvdG90eXBlLkdldE1hc3NEYXRhID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgIGRhdGEubWFzcyA9IHRoaXMubV9tYXNzO1xuICAgICAgZGF0YS5JID0gdGhpcy5tX0k7XG4gICAgICBkYXRhLmNlbnRlci5TZXRWKHRoaXMubV9zd2VlcC5sb2NhbENlbnRlcik7XG4gICB9XG4gICBiMkJvZHkucHJvdG90eXBlLlNldE1hc3NEYXRhID0gZnVuY3Rpb24gKG1hc3NEYXRhKSB7XG4gICAgICBiMlNldHRpbmdzLmIyQXNzZXJ0KHRoaXMubV93b3JsZC5Jc0xvY2tlZCgpID09IGZhbHNlKTtcbiAgICAgIGlmICh0aGlzLm1fd29ybGQuSXNMb2NrZWQoKSA9PSB0cnVlKSB7XG4gICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5tX3R5cGUgIT0gYjJCb2R5LmIyX2R5bmFtaWNCb2R5KSB7XG4gICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLm1faW52TWFzcyA9IDAuMDtcbiAgICAgIHRoaXMubV9JID0gMC4wO1xuICAgICAgdGhpcy5tX2ludkkgPSAwLjA7XG4gICAgICB0aGlzLm1fbWFzcyA9IG1hc3NEYXRhLm1hc3M7XG4gICAgICBpZiAodGhpcy5tX21hc3MgPD0gMC4wKSB7XG4gICAgICAgICB0aGlzLm1fbWFzcyA9IDEuMDtcbiAgICAgIH1cbiAgICAgIHRoaXMubV9pbnZNYXNzID0gMS4wIC8gdGhpcy5tX21hc3M7XG4gICAgICBpZiAobWFzc0RhdGEuSSA+IDAuMCAmJiAodGhpcy5tX2ZsYWdzICYgYjJCb2R5LmVfZml4ZWRSb3RhdGlvbkZsYWcpID09IDApIHtcbiAgICAgICAgIHRoaXMubV9JID0gbWFzc0RhdGEuSSAtIHRoaXMubV9tYXNzICogKG1hc3NEYXRhLmNlbnRlci54ICogbWFzc0RhdGEuY2VudGVyLnggKyBtYXNzRGF0YS5jZW50ZXIueSAqIG1hc3NEYXRhLmNlbnRlci55KTtcbiAgICAgICAgIHRoaXMubV9pbnZJID0gMS4wIC8gdGhpcy5tX0k7XG4gICAgICB9XG4gICAgICB2YXIgb2xkQ2VudGVyID0gdGhpcy5tX3N3ZWVwLmMuQ29weSgpO1xuICAgICAgdGhpcy5tX3N3ZWVwLmxvY2FsQ2VudGVyLlNldFYobWFzc0RhdGEuY2VudGVyKTtcbiAgICAgIHRoaXMubV9zd2VlcC5jMC5TZXRWKGIyTWF0aC5NdWxYKHRoaXMubV94ZiwgdGhpcy5tX3N3ZWVwLmxvY2FsQ2VudGVyKSk7XG4gICAgICB0aGlzLm1fc3dlZXAuYy5TZXRWKHRoaXMubV9zd2VlcC5jMCk7XG4gICAgICB0aGlzLm1fbGluZWFyVmVsb2NpdHkueCArPSB0aGlzLm1fYW5ndWxhclZlbG9jaXR5ICogKC0odGhpcy5tX3N3ZWVwLmMueSAtIG9sZENlbnRlci55KSk7XG4gICAgICB0aGlzLm1fbGluZWFyVmVsb2NpdHkueSArPSB0aGlzLm1fYW5ndWxhclZlbG9jaXR5ICogKCsodGhpcy5tX3N3ZWVwLmMueCAtIG9sZENlbnRlci54KSk7XG4gICB9XG4gICBiMkJvZHkucHJvdG90eXBlLlJlc2V0TWFzc0RhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLm1fbWFzcyA9IDAuMDtcbiAgICAgIHRoaXMubV9pbnZNYXNzID0gMC4wO1xuICAgICAgdGhpcy5tX0kgPSAwLjA7XG4gICAgICB0aGlzLm1faW52SSA9IDAuMDtcbiAgICAgIHRoaXMubV9zd2VlcC5sb2NhbENlbnRlci5TZXRaZXJvKCk7XG4gICAgICBpZiAodGhpcy5tX3R5cGUgPT0gYjJCb2R5LmIyX3N0YXRpY0JvZHkgfHwgdGhpcy5tX3R5cGUgPT0gYjJCb2R5LmIyX2tpbmVtYXRpY0JvZHkpIHtcbiAgICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhciBjZW50ZXIgPSBiMlZlYzIuTWFrZSgwLCAwKTtcbiAgICAgIGZvciAodmFyIGYgPSB0aGlzLm1fZml4dHVyZUxpc3Q7IGY7IGYgPSBmLm1fbmV4dCkge1xuICAgICAgICAgaWYgKGYubV9kZW5zaXR5ID09IDAuMCkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICB9XG4gICAgICAgICB2YXIgbWFzc0RhdGEgPSBmLkdldE1hc3NEYXRhKCk7XG4gICAgICAgICB0aGlzLm1fbWFzcyArPSBtYXNzRGF0YS5tYXNzO1xuICAgICAgICAgY2VudGVyLnggKz0gbWFzc0RhdGEuY2VudGVyLnggKiBtYXNzRGF0YS5tYXNzO1xuICAgICAgICAgY2VudGVyLnkgKz0gbWFzc0RhdGEuY2VudGVyLnkgKiBtYXNzRGF0YS5tYXNzO1xuICAgICAgICAgdGhpcy5tX0kgKz0gbWFzc0RhdGEuSTtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLm1fbWFzcyA+IDAuMCkge1xuICAgICAgICAgdGhpcy5tX2ludk1hc3MgPSAxLjAgLyB0aGlzLm1fbWFzcztcbiAgICAgICAgIGNlbnRlci54ICo9IHRoaXMubV9pbnZNYXNzO1xuICAgICAgICAgY2VudGVyLnkgKj0gdGhpcy5tX2ludk1hc3M7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgIHRoaXMubV9tYXNzID0gMS4wO1xuICAgICAgICAgdGhpcy5tX2ludk1hc3MgPSAxLjA7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5tX0kgPiAwLjAgJiYgKHRoaXMubV9mbGFncyAmIGIyQm9keS5lX2ZpeGVkUm90YXRpb25GbGFnKSA9PSAwKSB7XG4gICAgICAgICB0aGlzLm1fSSAtPSB0aGlzLm1fbWFzcyAqIChjZW50ZXIueCAqIGNlbnRlci54ICsgY2VudGVyLnkgKiBjZW50ZXIueSk7XG4gICAgICAgICB0aGlzLm1fSSAqPSB0aGlzLm1faW5lcnRpYVNjYWxlO1xuICAgICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydCh0aGlzLm1fSSA+IDApO1xuICAgICAgICAgdGhpcy5tX2ludkkgPSAxLjAgLyB0aGlzLm1fSTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICAgdGhpcy5tX0kgPSAwLjA7XG4gICAgICAgICB0aGlzLm1faW52SSA9IDAuMDtcbiAgICAgIH1cbiAgICAgIHZhciBvbGRDZW50ZXIgPSB0aGlzLm1fc3dlZXAuYy5Db3B5KCk7XG4gICAgICB0aGlzLm1fc3dlZXAubG9jYWxDZW50ZXIuU2V0VihjZW50ZXIpO1xuICAgICAgdGhpcy5tX3N3ZWVwLmMwLlNldFYoYjJNYXRoLk11bFgodGhpcy5tX3hmLCB0aGlzLm1fc3dlZXAubG9jYWxDZW50ZXIpKTtcbiAgICAgIHRoaXMubV9zd2VlcC5jLlNldFYodGhpcy5tX3N3ZWVwLmMwKTtcbiAgICAgIHRoaXMubV9saW5lYXJWZWxvY2l0eS54ICs9IHRoaXMubV9hbmd1bGFyVmVsb2NpdHkgKiAoLSh0aGlzLm1fc3dlZXAuYy55IC0gb2xkQ2VudGVyLnkpKTtcbiAgICAgIHRoaXMubV9saW5lYXJWZWxvY2l0eS55ICs9IHRoaXMubV9hbmd1bGFyVmVsb2NpdHkgKiAoKyh0aGlzLm1fc3dlZXAuYy54IC0gb2xkQ2VudGVyLngpKTtcbiAgIH1cbiAgIGIyQm9keS5wcm90b3R5cGUuR2V0V29ybGRQb2ludCA9IGZ1bmN0aW9uIChsb2NhbFBvaW50KSB7XG4gICAgICB2YXIgQSA9IHRoaXMubV94Zi5SO1xuICAgICAgdmFyIHUgPSBuZXcgYjJWZWMyKEEuY29sMS54ICogbG9jYWxQb2ludC54ICsgQS5jb2wyLnggKiBsb2NhbFBvaW50LnksIEEuY29sMS55ICogbG9jYWxQb2ludC54ICsgQS5jb2wyLnkgKiBsb2NhbFBvaW50LnkpO1xuICAgICAgdS54ICs9IHRoaXMubV94Zi5wb3NpdGlvbi54O1xuICAgICAgdS55ICs9IHRoaXMubV94Zi5wb3NpdGlvbi55O1xuICAgICAgcmV0dXJuIHU7XG4gICB9XG4gICBiMkJvZHkucHJvdG90eXBlLkdldFdvcmxkVmVjdG9yID0gZnVuY3Rpb24gKGxvY2FsVmVjdG9yKSB7XG4gICAgICByZXR1cm4gYjJNYXRoLk11bE1WKHRoaXMubV94Zi5SLCBsb2NhbFZlY3Rvcik7XG4gICB9XG4gICBiMkJvZHkucHJvdG90eXBlLkdldExvY2FsUG9pbnQgPSBmdW5jdGlvbiAod29ybGRQb2ludCkge1xuICAgICAgcmV0dXJuIGIyTWF0aC5NdWxYVCh0aGlzLm1feGYsIHdvcmxkUG9pbnQpO1xuICAgfVxuICAgYjJCb2R5LnByb3RvdHlwZS5HZXRMb2NhbFZlY3RvciA9IGZ1bmN0aW9uICh3b3JsZFZlY3Rvcikge1xuICAgICAgcmV0dXJuIGIyTWF0aC5NdWxUTVYodGhpcy5tX3hmLlIsIHdvcmxkVmVjdG9yKTtcbiAgIH1cbiAgIGIyQm9keS5wcm90b3R5cGUuR2V0TGluZWFyVmVsb2NpdHlGcm9tV29ybGRQb2ludCA9IGZ1bmN0aW9uICh3b3JsZFBvaW50KSB7XG4gICAgICByZXR1cm4gbmV3IGIyVmVjMih0aGlzLm1fbGluZWFyVmVsb2NpdHkueCAtIHRoaXMubV9hbmd1bGFyVmVsb2NpdHkgKiAod29ybGRQb2ludC55IC0gdGhpcy5tX3N3ZWVwLmMueSksIHRoaXMubV9saW5lYXJWZWxvY2l0eS55ICsgdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eSAqICh3b3JsZFBvaW50LnggLSB0aGlzLm1fc3dlZXAuYy54KSk7XG4gICB9XG4gICBiMkJvZHkucHJvdG90eXBlLkdldExpbmVhclZlbG9jaXR5RnJvbUxvY2FsUG9pbnQgPSBmdW5jdGlvbiAobG9jYWxQb2ludCkge1xuICAgICAgdmFyIEEgPSB0aGlzLm1feGYuUjtcbiAgICAgIHZhciB3b3JsZFBvaW50ID0gbmV3IGIyVmVjMihBLmNvbDEueCAqIGxvY2FsUG9pbnQueCArIEEuY29sMi54ICogbG9jYWxQb2ludC55LCBBLmNvbDEueSAqIGxvY2FsUG9pbnQueCArIEEuY29sMi55ICogbG9jYWxQb2ludC55KTtcbiAgICAgIHdvcmxkUG9pbnQueCArPSB0aGlzLm1feGYucG9zaXRpb24ueDtcbiAgICAgIHdvcmxkUG9pbnQueSArPSB0aGlzLm1feGYucG9zaXRpb24ueTtcbiAgICAgIHJldHVybiBuZXcgYjJWZWMyKHRoaXMubV9saW5lYXJWZWxvY2l0eS54IC0gdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eSAqICh3b3JsZFBvaW50LnkgLSB0aGlzLm1fc3dlZXAuYy55KSwgdGhpcy5tX2xpbmVhclZlbG9jaXR5LnkgKyB0aGlzLm1fYW5ndWxhclZlbG9jaXR5ICogKHdvcmxkUG9pbnQueCAtIHRoaXMubV9zd2VlcC5jLngpKTtcbiAgIH1cbiAgIGIyQm9keS5wcm90b3R5cGUuR2V0TGluZWFyRGFtcGluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fbGluZWFyRGFtcGluZztcbiAgIH1cbiAgIGIyQm9keS5wcm90b3R5cGUuU2V0TGluZWFyRGFtcGluZyA9IGZ1bmN0aW9uIChsaW5lYXJEYW1waW5nKSB7XG4gICAgICBpZiAobGluZWFyRGFtcGluZyA9PT0gdW5kZWZpbmVkKSBsaW5lYXJEYW1waW5nID0gMDtcbiAgICAgIHRoaXMubV9saW5lYXJEYW1waW5nID0gbGluZWFyRGFtcGluZztcbiAgIH1cbiAgIGIyQm9keS5wcm90b3R5cGUuR2V0QW5ndWxhckRhbXBpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX2FuZ3VsYXJEYW1waW5nO1xuICAgfVxuICAgYjJCb2R5LnByb3RvdHlwZS5TZXRBbmd1bGFyRGFtcGluZyA9IGZ1bmN0aW9uIChhbmd1bGFyRGFtcGluZykge1xuICAgICAgaWYgKGFuZ3VsYXJEYW1waW5nID09PSB1bmRlZmluZWQpIGFuZ3VsYXJEYW1waW5nID0gMDtcbiAgICAgIHRoaXMubV9hbmd1bGFyRGFtcGluZyA9IGFuZ3VsYXJEYW1waW5nO1xuICAgfVxuICAgYjJCb2R5LnByb3RvdHlwZS5TZXRUeXBlID0gZnVuY3Rpb24gKHR5cGUpIHtcbiAgICAgIGlmICh0eXBlID09PSB1bmRlZmluZWQpIHR5cGUgPSAwO1xuICAgICAgaWYgKHRoaXMubV90eXBlID09IHR5cGUpIHtcbiAgICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMubV90eXBlID0gdHlwZTtcbiAgICAgIHRoaXMuUmVzZXRNYXNzRGF0YSgpO1xuICAgICAgaWYgKHRoaXMubV90eXBlID09IGIyQm9keS5iMl9zdGF0aWNCb2R5KSB7XG4gICAgICAgICB0aGlzLm1fbGluZWFyVmVsb2NpdHkuU2V0WmVybygpO1xuICAgICAgICAgdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eSA9IDAuMDtcbiAgICAgIH1cbiAgICAgIHRoaXMuU2V0QXdha2UodHJ1ZSk7XG4gICAgICB0aGlzLm1fZm9yY2UuU2V0WmVybygpO1xuICAgICAgdGhpcy5tX3RvcnF1ZSA9IDAuMDtcbiAgICAgIGZvciAodmFyIGNlID0gdGhpcy5tX2NvbnRhY3RMaXN0OyBjZTsgY2UgPSBjZS5uZXh0KSB7XG4gICAgICAgICBjZS5jb250YWN0LkZsYWdGb3JGaWx0ZXJpbmcoKTtcbiAgICAgIH1cbiAgIH1cbiAgIGIyQm9keS5wcm90b3R5cGUuR2V0VHlwZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fdHlwZTtcbiAgIH1cbiAgIGIyQm9keS5wcm90b3R5cGUuU2V0QnVsbGV0ID0gZnVuY3Rpb24gKGZsYWcpIHtcbiAgICAgIGlmIChmbGFnKSB7XG4gICAgICAgICB0aGlzLm1fZmxhZ3MgfD0gYjJCb2R5LmVfYnVsbGV0RmxhZztcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICAgdGhpcy5tX2ZsYWdzICY9IH5iMkJvZHkuZV9idWxsZXRGbGFnO1xuICAgICAgfVxuICAgfVxuICAgYjJCb2R5LnByb3RvdHlwZS5Jc0J1bGxldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiAodGhpcy5tX2ZsYWdzICYgYjJCb2R5LmVfYnVsbGV0RmxhZykgPT0gYjJCb2R5LmVfYnVsbGV0RmxhZztcbiAgIH1cbiAgIGIyQm9keS5wcm90b3R5cGUuU2V0U2xlZXBpbmdBbGxvd2VkID0gZnVuY3Rpb24gKGZsYWcpIHtcbiAgICAgIGlmIChmbGFnKSB7XG4gICAgICAgICB0aGlzLm1fZmxhZ3MgfD0gYjJCb2R5LmVfYWxsb3dTbGVlcEZsYWc7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgIHRoaXMubV9mbGFncyAmPSB+YjJCb2R5LmVfYWxsb3dTbGVlcEZsYWc7XG4gICAgICAgICB0aGlzLlNldEF3YWtlKHRydWUpO1xuICAgICAgfVxuICAgfVxuICAgYjJCb2R5LnByb3RvdHlwZS5TZXRBd2FrZSA9IGZ1bmN0aW9uIChmbGFnKSB7XG4gICAgICBpZiAoZmxhZykge1xuICAgICAgICAgdGhpcy5tX2ZsYWdzIHw9IGIyQm9keS5lX2F3YWtlRmxhZztcbiAgICAgICAgIHRoaXMubV9zbGVlcFRpbWUgPSAwLjA7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgIHRoaXMubV9mbGFncyAmPSB+YjJCb2R5LmVfYXdha2VGbGFnO1xuICAgICAgICAgdGhpcy5tX3NsZWVwVGltZSA9IDAuMDtcbiAgICAgICAgIHRoaXMubV9saW5lYXJWZWxvY2l0eS5TZXRaZXJvKCk7XG4gICAgICAgICB0aGlzLm1fYW5ndWxhclZlbG9jaXR5ID0gMC4wO1xuICAgICAgICAgdGhpcy5tX2ZvcmNlLlNldFplcm8oKTtcbiAgICAgICAgIHRoaXMubV90b3JxdWUgPSAwLjA7XG4gICAgICB9XG4gICB9XG4gICBiMkJvZHkucHJvdG90eXBlLklzQXdha2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gKHRoaXMubV9mbGFncyAmIGIyQm9keS5lX2F3YWtlRmxhZykgPT0gYjJCb2R5LmVfYXdha2VGbGFnO1xuICAgfVxuICAgYjJCb2R5LnByb3RvdHlwZS5TZXRGaXhlZFJvdGF0aW9uID0gZnVuY3Rpb24gKGZpeGVkKSB7XG4gICAgICBpZiAoZml4ZWQpIHtcbiAgICAgICAgIHRoaXMubV9mbGFncyB8PSBiMkJvZHkuZV9maXhlZFJvdGF0aW9uRmxhZztcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICAgdGhpcy5tX2ZsYWdzICY9IH5iMkJvZHkuZV9maXhlZFJvdGF0aW9uRmxhZztcbiAgICAgIH1cbiAgICAgIHRoaXMuUmVzZXRNYXNzRGF0YSgpO1xuICAgfVxuICAgYjJCb2R5LnByb3RvdHlwZS5Jc0ZpeGVkUm90YXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gKHRoaXMubV9mbGFncyAmIGIyQm9keS5lX2ZpeGVkUm90YXRpb25GbGFnKSA9PSBiMkJvZHkuZV9maXhlZFJvdGF0aW9uRmxhZztcbiAgIH1cbiAgIGIyQm9keS5wcm90b3R5cGUuU2V0QWN0aXZlID0gZnVuY3Rpb24gKGZsYWcpIHtcbiAgICAgIGlmIChmbGFnID09IHRoaXMuSXNBY3RpdmUoKSkge1xuICAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdmFyIGJyb2FkUGhhc2U7XG4gICAgICB2YXIgZjtcbiAgICAgIGlmIChmbGFnKSB7XG4gICAgICAgICB0aGlzLm1fZmxhZ3MgfD0gYjJCb2R5LmVfYWN0aXZlRmxhZztcbiAgICAgICAgIGJyb2FkUGhhc2UgPSB0aGlzLm1fd29ybGQubV9jb250YWN0TWFuYWdlci5tX2Jyb2FkUGhhc2U7XG4gICAgICAgICBmb3IgKGYgPSB0aGlzLm1fZml4dHVyZUxpc3Q7XG4gICAgICAgICBmOyBmID0gZi5tX25leHQpIHtcbiAgICAgICAgICAgIGYuQ3JlYXRlUHJveHkoYnJvYWRQaGFzZSwgdGhpcy5tX3hmKTtcbiAgICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICAgdGhpcy5tX2ZsYWdzICY9IH5iMkJvZHkuZV9hY3RpdmVGbGFnO1xuICAgICAgICAgYnJvYWRQaGFzZSA9IHRoaXMubV93b3JsZC5tX2NvbnRhY3RNYW5hZ2VyLm1fYnJvYWRQaGFzZTtcbiAgICAgICAgIGZvciAoZiA9IHRoaXMubV9maXh0dXJlTGlzdDtcbiAgICAgICAgIGY7IGYgPSBmLm1fbmV4dCkge1xuICAgICAgICAgICAgZi5EZXN0cm95UHJveHkoYnJvYWRQaGFzZSk7XG4gICAgICAgICB9XG4gICAgICAgICB2YXIgY2UgPSB0aGlzLm1fY29udGFjdExpc3Q7XG4gICAgICAgICB3aGlsZSAoY2UpIHtcbiAgICAgICAgICAgIHZhciBjZTAgPSBjZTtcbiAgICAgICAgICAgIGNlID0gY2UubmV4dDtcbiAgICAgICAgICAgIHRoaXMubV93b3JsZC5tX2NvbnRhY3RNYW5hZ2VyLkRlc3Ryb3koY2UwLmNvbnRhY3QpO1xuICAgICAgICAgfVxuICAgICAgICAgdGhpcy5tX2NvbnRhY3RMaXN0ID0gbnVsbDtcbiAgICAgIH1cbiAgIH1cbiAgIGIyQm9keS5wcm90b3R5cGUuSXNBY3RpdmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gKHRoaXMubV9mbGFncyAmIGIyQm9keS5lX2FjdGl2ZUZsYWcpID09IGIyQm9keS5lX2FjdGl2ZUZsYWc7XG4gICB9XG4gICBiMkJvZHkucHJvdG90eXBlLklzU2xlZXBpbmdBbGxvd2VkID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuICh0aGlzLm1fZmxhZ3MgJiBiMkJvZHkuZV9hbGxvd1NsZWVwRmxhZykgPT0gYjJCb2R5LmVfYWxsb3dTbGVlcEZsYWc7XG4gICB9XG4gICBiMkJvZHkucHJvdG90eXBlLkdldEZpeHR1cmVMaXN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV9maXh0dXJlTGlzdDtcbiAgIH1cbiAgIGIyQm9keS5wcm90b3R5cGUuR2V0Sm9pbnRMaXN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV9qb2ludExpc3Q7XG4gICB9XG4gICBiMkJvZHkucHJvdG90eXBlLkdldENvbnRyb2xsZXJMaXN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV9jb250cm9sbGVyTGlzdDtcbiAgIH1cbiAgIGIyQm9keS5wcm90b3R5cGUuR2V0Q29udGFjdExpc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX2NvbnRhY3RMaXN0O1xuICAgfVxuICAgYjJCb2R5LnByb3RvdHlwZS5HZXROZXh0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV9uZXh0O1xuICAgfVxuICAgYjJCb2R5LnByb3RvdHlwZS5HZXRVc2VyRGF0YSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fdXNlckRhdGE7XG4gICB9XG4gICBiMkJvZHkucHJvdG90eXBlLlNldFVzZXJEYXRhID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgIHRoaXMubV91c2VyRGF0YSA9IGRhdGE7XG4gICB9XG4gICBiMkJvZHkucHJvdG90eXBlLkdldFdvcmxkID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV93b3JsZDtcbiAgIH1cbiAgIGIyQm9keS5wcm90b3R5cGUuYjJCb2R5ID0gZnVuY3Rpb24gKGJkLCB3b3JsZCkge1xuICAgICAgdGhpcy5tX2ZsYWdzID0gMDtcbiAgICAgIGlmIChiZC5idWxsZXQpIHtcbiAgICAgICAgIHRoaXMubV9mbGFncyB8PSBiMkJvZHkuZV9idWxsZXRGbGFnO1xuICAgICAgfVxuICAgICAgaWYgKGJkLmZpeGVkUm90YXRpb24pIHtcbiAgICAgICAgIHRoaXMubV9mbGFncyB8PSBiMkJvZHkuZV9maXhlZFJvdGF0aW9uRmxhZztcbiAgICAgIH1cbiAgICAgIGlmIChiZC5hbGxvd1NsZWVwKSB7XG4gICAgICAgICB0aGlzLm1fZmxhZ3MgfD0gYjJCb2R5LmVfYWxsb3dTbGVlcEZsYWc7XG4gICAgICB9XG4gICAgICBpZiAoYmQuYXdha2UpIHtcbiAgICAgICAgIHRoaXMubV9mbGFncyB8PSBiMkJvZHkuZV9hd2FrZUZsYWc7XG4gICAgICB9XG4gICAgICBpZiAoYmQuYWN0aXZlKSB7XG4gICAgICAgICB0aGlzLm1fZmxhZ3MgfD0gYjJCb2R5LmVfYWN0aXZlRmxhZztcbiAgICAgIH1cbiAgICAgIHRoaXMubV93b3JsZCA9IHdvcmxkO1xuICAgICAgdGhpcy5tX3hmLnBvc2l0aW9uLlNldFYoYmQucG9zaXRpb24pO1xuICAgICAgdGhpcy5tX3hmLlIuU2V0KGJkLmFuZ2xlKTtcbiAgICAgIHRoaXMubV9zd2VlcC5sb2NhbENlbnRlci5TZXRaZXJvKCk7XG4gICAgICB0aGlzLm1fc3dlZXAudDAgPSAxLjA7XG4gICAgICB0aGlzLm1fc3dlZXAuYTAgPSB0aGlzLm1fc3dlZXAuYSA9IGJkLmFuZ2xlO1xuICAgICAgdmFyIHRNYXQgPSB0aGlzLm1feGYuUjtcbiAgICAgIHZhciB0VmVjID0gdGhpcy5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xuICAgICAgdGhpcy5tX3N3ZWVwLmMueCA9ICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcbiAgICAgIHRoaXMubV9zd2VlcC5jLnkgPSAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XG4gICAgICB0aGlzLm1fc3dlZXAuYy54ICs9IHRoaXMubV94Zi5wb3NpdGlvbi54O1xuICAgICAgdGhpcy5tX3N3ZWVwLmMueSArPSB0aGlzLm1feGYucG9zaXRpb24ueTtcbiAgICAgIHRoaXMubV9zd2VlcC5jMC5TZXRWKHRoaXMubV9zd2VlcC5jKTtcbiAgICAgIHRoaXMubV9qb2ludExpc3QgPSBudWxsO1xuICAgICAgdGhpcy5tX2NvbnRyb2xsZXJMaXN0ID0gbnVsbDtcbiAgICAgIHRoaXMubV9jb250YWN0TGlzdCA9IG51bGw7XG4gICAgICB0aGlzLm1fY29udHJvbGxlckNvdW50ID0gMDtcbiAgICAgIHRoaXMubV9wcmV2ID0gbnVsbDtcbiAgICAgIHRoaXMubV9uZXh0ID0gbnVsbDtcbiAgICAgIHRoaXMubV9saW5lYXJWZWxvY2l0eS5TZXRWKGJkLmxpbmVhclZlbG9jaXR5KTtcbiAgICAgIHRoaXMubV9hbmd1bGFyVmVsb2NpdHkgPSBiZC5hbmd1bGFyVmVsb2NpdHk7XG4gICAgICB0aGlzLm1fbGluZWFyRGFtcGluZyA9IGJkLmxpbmVhckRhbXBpbmc7XG4gICAgICB0aGlzLm1fYW5ndWxhckRhbXBpbmcgPSBiZC5hbmd1bGFyRGFtcGluZztcbiAgICAgIHRoaXMubV9mb3JjZS5TZXQoMC4wLCAwLjApO1xuICAgICAgdGhpcy5tX3RvcnF1ZSA9IDAuMDtcbiAgICAgIHRoaXMubV9zbGVlcFRpbWUgPSAwLjA7XG4gICAgICB0aGlzLm1fdHlwZSA9IGJkLnR5cGU7XG4gICAgICBpZiAodGhpcy5tX3R5cGUgPT0gYjJCb2R5LmIyX2R5bmFtaWNCb2R5KSB7XG4gICAgICAgICB0aGlzLm1fbWFzcyA9IDEuMDtcbiAgICAgICAgIHRoaXMubV9pbnZNYXNzID0gMS4wO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgICB0aGlzLm1fbWFzcyA9IDAuMDtcbiAgICAgICAgIHRoaXMubV9pbnZNYXNzID0gMC4wO1xuICAgICAgfVxuICAgICAgdGhpcy5tX0kgPSAwLjA7XG4gICAgICB0aGlzLm1faW52SSA9IDAuMDtcbiAgICAgIHRoaXMubV9pbmVydGlhU2NhbGUgPSBiZC5pbmVydGlhU2NhbGU7XG4gICAgICB0aGlzLm1fdXNlckRhdGEgPSBiZC51c2VyRGF0YTtcbiAgICAgIHRoaXMubV9maXh0dXJlTGlzdCA9IG51bGw7XG4gICAgICB0aGlzLm1fZml4dHVyZUNvdW50ID0gMDtcbiAgIH1cbiAgIGIyQm9keS5wcm90b3R5cGUuU3luY2hyb25pemVGaXh0dXJlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB4ZjEgPSBiMkJvZHkuc194ZjE7XG4gICAgICB4ZjEuUi5TZXQodGhpcy5tX3N3ZWVwLmEwKTtcbiAgICAgIHZhciB0TWF0ID0geGYxLlI7XG4gICAgICB2YXIgdFZlYyA9IHRoaXMubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgIHhmMS5wb3NpdGlvbi54ID0gdGhpcy5tX3N3ZWVwLmMwLnggLSAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XG4gICAgICB4ZjEucG9zaXRpb24ueSA9IHRoaXMubV9zd2VlcC5jMC55IC0gKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xuICAgICAgdmFyIGY7XG4gICAgICB2YXIgYnJvYWRQaGFzZSA9IHRoaXMubV93b3JsZC5tX2NvbnRhY3RNYW5hZ2VyLm1fYnJvYWRQaGFzZTtcbiAgICAgIGZvciAoZiA9IHRoaXMubV9maXh0dXJlTGlzdDtcbiAgICAgIGY7IGYgPSBmLm1fbmV4dCkge1xuICAgICAgICAgZi5TeW5jaHJvbml6ZShicm9hZFBoYXNlLCB4ZjEsIHRoaXMubV94Zik7XG4gICAgICB9XG4gICB9XG4gICBiMkJvZHkucHJvdG90eXBlLlN5bmNocm9uaXplVHJhbnNmb3JtID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5tX3hmLlIuU2V0KHRoaXMubV9zd2VlcC5hKTtcbiAgICAgIHZhciB0TWF0ID0gdGhpcy5tX3hmLlI7XG4gICAgICB2YXIgdFZlYyA9IHRoaXMubV9zd2VlcC5sb2NhbENlbnRlcjtcbiAgICAgIHRoaXMubV94Zi5wb3NpdGlvbi54ID0gdGhpcy5tX3N3ZWVwLmMueCAtICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcbiAgICAgIHRoaXMubV94Zi5wb3NpdGlvbi55ID0gdGhpcy5tX3N3ZWVwLmMueSAtICh0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55KTtcbiAgIH1cbiAgIGIyQm9keS5wcm90b3R5cGUuU2hvdWxkQ29sbGlkZSA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgICAgaWYgKHRoaXMubV90eXBlICE9IGIyQm9keS5iMl9keW5hbWljQm9keSAmJiBvdGhlci5tX3R5cGUgIT0gYjJCb2R5LmIyX2R5bmFtaWNCb2R5KSB7XG4gICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBmb3IgKHZhciBqbiA9IHRoaXMubV9qb2ludExpc3Q7IGpuOyBqbiA9IGpuLm5leHQpIHtcbiAgICAgICAgIGlmIChqbi5vdGhlciA9PSBvdGhlcikgaWYgKGpuLmpvaW50Lm1fY29sbGlkZUNvbm5lY3RlZCA9PSBmYWxzZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICB9XG4gICBiMkJvZHkucHJvdG90eXBlLkFkdmFuY2UgPSBmdW5jdGlvbiAodCkge1xuICAgICAgaWYgKHQgPT09IHVuZGVmaW5lZCkgdCA9IDA7XG4gICAgICB0aGlzLm1fc3dlZXAuQWR2YW5jZSh0KTtcbiAgICAgIHRoaXMubV9zd2VlcC5jLlNldFYodGhpcy5tX3N3ZWVwLmMwKTtcbiAgICAgIHRoaXMubV9zd2VlcC5hID0gdGhpcy5tX3N3ZWVwLmEwO1xuICAgICAgdGhpcy5TeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xuICAgfVxuICAgQm94MkQucG9zdERlZnMucHVzaChmdW5jdGlvbiAoKSB7XG4gICAgICBCb3gyRC5EeW5hbWljcy5iMkJvZHkuc194ZjEgPSBuZXcgYjJUcmFuc2Zvcm0oKTtcbiAgICAgIEJveDJELkR5bmFtaWNzLmIyQm9keS5lX2lzbGFuZEZsYWcgPSAweDAwMDE7XG4gICAgICBCb3gyRC5EeW5hbWljcy5iMkJvZHkuZV9hd2FrZUZsYWcgPSAweDAwMDI7XG4gICAgICBCb3gyRC5EeW5hbWljcy5iMkJvZHkuZV9hbGxvd1NsZWVwRmxhZyA9IDB4MDAwNDtcbiAgICAgIEJveDJELkR5bmFtaWNzLmIyQm9keS5lX2J1bGxldEZsYWcgPSAweDAwMDg7XG4gICAgICBCb3gyRC5EeW5hbWljcy5iMkJvZHkuZV9maXhlZFJvdGF0aW9uRmxhZyA9IDB4MDAxMDtcbiAgICAgIEJveDJELkR5bmFtaWNzLmIyQm9keS5lX2FjdGl2ZUZsYWcgPSAweDAwMjA7XG4gICAgICBCb3gyRC5EeW5hbWljcy5iMkJvZHkuYjJfc3RhdGljQm9keSA9IDA7XG4gICAgICBCb3gyRC5EeW5hbWljcy5iMkJvZHkuYjJfa2luZW1hdGljQm9keSA9IDE7XG4gICAgICBCb3gyRC5EeW5hbWljcy5iMkJvZHkuYjJfZHluYW1pY0JvZHkgPSAyO1xuICAgfSk7XG4gICBiMkJvZHlEZWYuYjJCb2R5RGVmID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5wb3NpdGlvbiA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIHRoaXMubGluZWFyVmVsb2NpdHkgPSBuZXcgYjJWZWMyKCk7XG4gICB9O1xuICAgYjJCb2R5RGVmLnByb3RvdHlwZS5iMkJvZHlEZWYgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLnVzZXJEYXRhID0gbnVsbDtcbiAgICAgIHRoaXMucG9zaXRpb24uU2V0KDAuMCwgMC4wKTtcbiAgICAgIHRoaXMuYW5nbGUgPSAwLjA7XG4gICAgICB0aGlzLmxpbmVhclZlbG9jaXR5LlNldCgwLCAwKTtcbiAgICAgIHRoaXMuYW5ndWxhclZlbG9jaXR5ID0gMC4wO1xuICAgICAgdGhpcy5saW5lYXJEYW1waW5nID0gMC4wO1xuICAgICAgdGhpcy5hbmd1bGFyRGFtcGluZyA9IDAuMDtcbiAgICAgIHRoaXMuYWxsb3dTbGVlcCA9IHRydWU7XG4gICAgICB0aGlzLmF3YWtlID0gdHJ1ZTtcbiAgICAgIHRoaXMuZml4ZWRSb3RhdGlvbiA9IGZhbHNlO1xuICAgICAgdGhpcy5idWxsZXQgPSBmYWxzZTtcbiAgICAgIHRoaXMudHlwZSA9IGIyQm9keS5iMl9zdGF0aWNCb2R5O1xuICAgICAgdGhpcy5hY3RpdmUgPSB0cnVlO1xuICAgICAgdGhpcy5pbmVydGlhU2NhbGUgPSAxLjA7XG4gICB9XG4gICBiMkNvbnRhY3RGaWx0ZXIuYjJDb250YWN0RmlsdGVyID0gZnVuY3Rpb24gKCkge307XG4gICBiMkNvbnRhY3RGaWx0ZXIucHJvdG90eXBlLlNob3VsZENvbGxpZGUgPSBmdW5jdGlvbiAoZml4dHVyZUEsIGZpeHR1cmVCKSB7XG4gICAgICB2YXIgZmlsdGVyMSA9IGZpeHR1cmVBLkdldEZpbHRlckRhdGEoKTtcbiAgICAgIHZhciBmaWx0ZXIyID0gZml4dHVyZUIuR2V0RmlsdGVyRGF0YSgpO1xuICAgICAgaWYgKGZpbHRlcjEuZ3JvdXBJbmRleCA9PSBmaWx0ZXIyLmdyb3VwSW5kZXggJiYgZmlsdGVyMS5ncm91cEluZGV4ICE9IDApIHtcbiAgICAgICAgIHJldHVybiBmaWx0ZXIxLmdyb3VwSW5kZXggPiAwO1xuICAgICAgfVxuICAgICAgdmFyIGNvbGxpZGUgPSAoZmlsdGVyMS5tYXNrQml0cyAmIGZpbHRlcjIuY2F0ZWdvcnlCaXRzKSAhPSAwICYmIChmaWx0ZXIxLmNhdGVnb3J5Qml0cyAmIGZpbHRlcjIubWFza0JpdHMpICE9IDA7XG4gICAgICByZXR1cm4gY29sbGlkZTtcbiAgIH1cbiAgIGIyQ29udGFjdEZpbHRlci5wcm90b3R5cGUuUmF5Q29sbGlkZSA9IGZ1bmN0aW9uICh1c2VyRGF0YSwgZml4dHVyZSkge1xuICAgICAgaWYgKCF1c2VyRGF0YSkgcmV0dXJuIHRydWU7XG4gICAgICByZXR1cm4gdGhpcy5TaG91bGRDb2xsaWRlKCh1c2VyRGF0YSBpbnN0YW5jZW9mIGIyRml4dHVyZSA/IHVzZXJEYXRhIDogbnVsbCksIGZpeHR1cmUpO1xuICAgfVxuICAgQm94MkQucG9zdERlZnMucHVzaChmdW5jdGlvbiAoKSB7XG4gICAgICBCb3gyRC5EeW5hbWljcy5iMkNvbnRhY3RGaWx0ZXIuYjJfZGVmYXVsdEZpbHRlciA9IG5ldyBiMkNvbnRhY3RGaWx0ZXIoKTtcbiAgIH0pO1xuICAgYjJDb250YWN0SW1wdWxzZS5iMkNvbnRhY3RJbXB1bHNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5ub3JtYWxJbXB1bHNlcyA9IG5ldyBWZWN0b3JfYTJqX051bWJlcihiMlNldHRpbmdzLmIyX21heE1hbmlmb2xkUG9pbnRzKTtcbiAgICAgIHRoaXMudGFuZ2VudEltcHVsc2VzID0gbmV3IFZlY3Rvcl9hMmpfTnVtYmVyKGIyU2V0dGluZ3MuYjJfbWF4TWFuaWZvbGRQb2ludHMpO1xuICAgfTtcbiAgIGIyQ29udGFjdExpc3RlbmVyLmIyQ29udGFjdExpc3RlbmVyID0gZnVuY3Rpb24gKCkge307XG4gICBiMkNvbnRhY3RMaXN0ZW5lci5wcm90b3R5cGUuQmVnaW5Db250YWN0ID0gZnVuY3Rpb24gKGNvbnRhY3QpIHt9XG4gICBiMkNvbnRhY3RMaXN0ZW5lci5wcm90b3R5cGUuRW5kQ29udGFjdCA9IGZ1bmN0aW9uIChjb250YWN0KSB7fVxuICAgYjJDb250YWN0TGlzdGVuZXIucHJvdG90eXBlLlByZVNvbHZlID0gZnVuY3Rpb24gKGNvbnRhY3QsIG9sZE1hbmlmb2xkKSB7fVxuICAgYjJDb250YWN0TGlzdGVuZXIucHJvdG90eXBlLlBvc3RTb2x2ZSA9IGZ1bmN0aW9uIChjb250YWN0LCBpbXB1bHNlKSB7fVxuICAgQm94MkQucG9zdERlZnMucHVzaChmdW5jdGlvbiAoKSB7XG4gICAgICBCb3gyRC5EeW5hbWljcy5iMkNvbnRhY3RMaXN0ZW5lci5iMl9kZWZhdWx0TGlzdGVuZXIgPSBuZXcgYjJDb250YWN0TGlzdGVuZXIoKTtcbiAgIH0pO1xuICAgYjJDb250YWN0TWFuYWdlci5iMkNvbnRhY3RNYW5hZ2VyID0gZnVuY3Rpb24gKCkge307XG4gICBiMkNvbnRhY3RNYW5hZ2VyLnByb3RvdHlwZS5iMkNvbnRhY3RNYW5hZ2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5tX3dvcmxkID0gbnVsbDtcbiAgICAgIHRoaXMubV9jb250YWN0Q291bnQgPSAwO1xuICAgICAgdGhpcy5tX2NvbnRhY3RGaWx0ZXIgPSBiMkNvbnRhY3RGaWx0ZXIuYjJfZGVmYXVsdEZpbHRlcjtcbiAgICAgIHRoaXMubV9jb250YWN0TGlzdGVuZXIgPSBiMkNvbnRhY3RMaXN0ZW5lci5iMl9kZWZhdWx0TGlzdGVuZXI7XG4gICAgICB0aGlzLm1fY29udGFjdEZhY3RvcnkgPSBuZXcgYjJDb250YWN0RmFjdG9yeSh0aGlzLm1fYWxsb2NhdG9yKTtcbiAgICAgIHRoaXMubV9icm9hZFBoYXNlID0gbmV3IGIyRHluYW1pY1RyZWVCcm9hZFBoYXNlKCk7XG4gICB9XG4gICBiMkNvbnRhY3RNYW5hZ2VyLnByb3RvdHlwZS5BZGRQYWlyID0gZnVuY3Rpb24gKHByb3h5VXNlckRhdGFBLCBwcm94eVVzZXJEYXRhQikge1xuICAgICAgdmFyIGZpeHR1cmVBID0gKHByb3h5VXNlckRhdGFBIGluc3RhbmNlb2YgYjJGaXh0dXJlID8gcHJveHlVc2VyRGF0YUEgOiBudWxsKTtcbiAgICAgIHZhciBmaXh0dXJlQiA9IChwcm94eVVzZXJEYXRhQiBpbnN0YW5jZW9mIGIyRml4dHVyZSA/IHByb3h5VXNlckRhdGFCIDogbnVsbCk7XG4gICAgICB2YXIgYm9keUEgPSBmaXh0dXJlQS5HZXRCb2R5KCk7XG4gICAgICB2YXIgYm9keUIgPSBmaXh0dXJlQi5HZXRCb2R5KCk7XG4gICAgICBpZiAoYm9keUEgPT0gYm9keUIpIHJldHVybjtcbiAgICAgIHZhciBlZGdlID0gYm9keUIuR2V0Q29udGFjdExpc3QoKTtcbiAgICAgIHdoaWxlIChlZGdlKSB7XG4gICAgICAgICBpZiAoZWRnZS5vdGhlciA9PSBib2R5QSkge1xuICAgICAgICAgICAgdmFyIGZBID0gZWRnZS5jb250YWN0LkdldEZpeHR1cmVBKCk7XG4gICAgICAgICAgICB2YXIgZkIgPSBlZGdlLmNvbnRhY3QuR2V0Rml4dHVyZUIoKTtcbiAgICAgICAgICAgIGlmIChmQSA9PSBmaXh0dXJlQSAmJiBmQiA9PSBmaXh0dXJlQikgcmV0dXJuO1xuICAgICAgICAgICAgaWYgKGZBID09IGZpeHR1cmVCICYmIGZCID09IGZpeHR1cmVBKSByZXR1cm47XG4gICAgICAgICB9XG4gICAgICAgICBlZGdlID0gZWRnZS5uZXh0O1xuICAgICAgfVxuICAgICAgaWYgKGJvZHlCLlNob3VsZENvbGxpZGUoYm9keUEpID09IGZhbHNlKSB7XG4gICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5tX2NvbnRhY3RGaWx0ZXIuU2hvdWxkQ29sbGlkZShmaXh0dXJlQSwgZml4dHVyZUIpID09IGZhbHNlKSB7XG4gICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YXIgYyA9IHRoaXMubV9jb250YWN0RmFjdG9yeS5DcmVhdGUoZml4dHVyZUEsIGZpeHR1cmVCKTtcbiAgICAgIGZpeHR1cmVBID0gYy5HZXRGaXh0dXJlQSgpO1xuICAgICAgZml4dHVyZUIgPSBjLkdldEZpeHR1cmVCKCk7XG4gICAgICBib2R5QSA9IGZpeHR1cmVBLm1fYm9keTtcbiAgICAgIGJvZHlCID0gZml4dHVyZUIubV9ib2R5O1xuICAgICAgYy5tX3ByZXYgPSBudWxsO1xuICAgICAgYy5tX25leHQgPSB0aGlzLm1fd29ybGQubV9jb250YWN0TGlzdDtcbiAgICAgIGlmICh0aGlzLm1fd29ybGQubV9jb250YWN0TGlzdCAhPSBudWxsKSB7XG4gICAgICAgICB0aGlzLm1fd29ybGQubV9jb250YWN0TGlzdC5tX3ByZXYgPSBjO1xuICAgICAgfVxuICAgICAgdGhpcy5tX3dvcmxkLm1fY29udGFjdExpc3QgPSBjO1xuICAgICAgYy5tX25vZGVBLmNvbnRhY3QgPSBjO1xuICAgICAgYy5tX25vZGVBLm90aGVyID0gYm9keUI7XG4gICAgICBjLm1fbm9kZUEucHJldiA9IG51bGw7XG4gICAgICBjLm1fbm9kZUEubmV4dCA9IGJvZHlBLm1fY29udGFjdExpc3Q7XG4gICAgICBpZiAoYm9keUEubV9jb250YWN0TGlzdCAhPSBudWxsKSB7XG4gICAgICAgICBib2R5QS5tX2NvbnRhY3RMaXN0LnByZXYgPSBjLm1fbm9kZUE7XG4gICAgICB9XG4gICAgICBib2R5QS5tX2NvbnRhY3RMaXN0ID0gYy5tX25vZGVBO1xuICAgICAgYy5tX25vZGVCLmNvbnRhY3QgPSBjO1xuICAgICAgYy5tX25vZGVCLm90aGVyID0gYm9keUE7XG4gICAgICBjLm1fbm9kZUIucHJldiA9IG51bGw7XG4gICAgICBjLm1fbm9kZUIubmV4dCA9IGJvZHlCLm1fY29udGFjdExpc3Q7XG4gICAgICBpZiAoYm9keUIubV9jb250YWN0TGlzdCAhPSBudWxsKSB7XG4gICAgICAgICBib2R5Qi5tX2NvbnRhY3RMaXN0LnByZXYgPSBjLm1fbm9kZUI7XG4gICAgICB9XG4gICAgICBib2R5Qi5tX2NvbnRhY3RMaXN0ID0gYy5tX25vZGVCO1xuICAgICAgKyt0aGlzLm1fd29ybGQubV9jb250YWN0Q291bnQ7XG4gICAgICByZXR1cm47XG4gICB9XG4gICBiMkNvbnRhY3RNYW5hZ2VyLnByb3RvdHlwZS5GaW5kTmV3Q29udGFjdHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLm1fYnJvYWRQaGFzZS5VcGRhdGVQYWlycyhCb3gyRC5nZW5lcmF0ZUNhbGxiYWNrKHRoaXMsIHRoaXMuQWRkUGFpcikpO1xuICAgfVxuICAgYjJDb250YWN0TWFuYWdlci5wcm90b3R5cGUuRGVzdHJveSA9IGZ1bmN0aW9uIChjKSB7XG4gICAgICB2YXIgZml4dHVyZUEgPSBjLkdldEZpeHR1cmVBKCk7XG4gICAgICB2YXIgZml4dHVyZUIgPSBjLkdldEZpeHR1cmVCKCk7XG4gICAgICB2YXIgYm9keUEgPSBmaXh0dXJlQS5HZXRCb2R5KCk7XG4gICAgICB2YXIgYm9keUIgPSBmaXh0dXJlQi5HZXRCb2R5KCk7XG4gICAgICBpZiAoYy5Jc1RvdWNoaW5nKCkpIHtcbiAgICAgICAgIHRoaXMubV9jb250YWN0TGlzdGVuZXIuRW5kQ29udGFjdChjKTtcbiAgICAgIH1cbiAgICAgIGlmIChjLm1fcHJldikge1xuICAgICAgICAgYy5tX3ByZXYubV9uZXh0ID0gYy5tX25leHQ7XG4gICAgICB9XG4gICAgICBpZiAoYy5tX25leHQpIHtcbiAgICAgICAgIGMubV9uZXh0Lm1fcHJldiA9IGMubV9wcmV2O1xuICAgICAgfVxuICAgICAgaWYgKGMgPT0gdGhpcy5tX3dvcmxkLm1fY29udGFjdExpc3QpIHtcbiAgICAgICAgIHRoaXMubV93b3JsZC5tX2NvbnRhY3RMaXN0ID0gYy5tX25leHQ7XG4gICAgICB9XG4gICAgICBpZiAoYy5tX25vZGVBLnByZXYpIHtcbiAgICAgICAgIGMubV9ub2RlQS5wcmV2Lm5leHQgPSBjLm1fbm9kZUEubmV4dDtcbiAgICAgIH1cbiAgICAgIGlmIChjLm1fbm9kZUEubmV4dCkge1xuICAgICAgICAgYy5tX25vZGVBLm5leHQucHJldiA9IGMubV9ub2RlQS5wcmV2O1xuICAgICAgfVxuICAgICAgaWYgKGMubV9ub2RlQSA9PSBib2R5QS5tX2NvbnRhY3RMaXN0KSB7XG4gICAgICAgICBib2R5QS5tX2NvbnRhY3RMaXN0ID0gYy5tX25vZGVBLm5leHQ7XG4gICAgICB9XG4gICAgICBpZiAoYy5tX25vZGVCLnByZXYpIHtcbiAgICAgICAgIGMubV9ub2RlQi5wcmV2Lm5leHQgPSBjLm1fbm9kZUIubmV4dDtcbiAgICAgIH1cbiAgICAgIGlmIChjLm1fbm9kZUIubmV4dCkge1xuICAgICAgICAgYy5tX25vZGVCLm5leHQucHJldiA9IGMubV9ub2RlQi5wcmV2O1xuICAgICAgfVxuICAgICAgaWYgKGMubV9ub2RlQiA9PSBib2R5Qi5tX2NvbnRhY3RMaXN0KSB7XG4gICAgICAgICBib2R5Qi5tX2NvbnRhY3RMaXN0ID0gYy5tX25vZGVCLm5leHQ7XG4gICAgICB9XG4gICAgICB0aGlzLm1fY29udGFjdEZhY3RvcnkuRGVzdHJveShjKTtcbiAgICAgIC0tdGhpcy5tX2NvbnRhY3RDb3VudDtcbiAgIH1cbiAgIGIyQ29udGFjdE1hbmFnZXIucHJvdG90eXBlLkNvbGxpZGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgYyA9IHRoaXMubV93b3JsZC5tX2NvbnRhY3RMaXN0O1xuICAgICAgd2hpbGUgKGMpIHtcbiAgICAgICAgIHZhciBmaXh0dXJlQSA9IGMuR2V0Rml4dHVyZUEoKTtcbiAgICAgICAgIHZhciBmaXh0dXJlQiA9IGMuR2V0Rml4dHVyZUIoKTtcbiAgICAgICAgIHZhciBib2R5QSA9IGZpeHR1cmVBLkdldEJvZHkoKTtcbiAgICAgICAgIHZhciBib2R5QiA9IGZpeHR1cmVCLkdldEJvZHkoKTtcbiAgICAgICAgIGlmIChib2R5QS5Jc0F3YWtlKCkgPT0gZmFsc2UgJiYgYm9keUIuSXNBd2FrZSgpID09IGZhbHNlKSB7XG4gICAgICAgICAgICBjID0gYy5HZXROZXh0KCk7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgIH1cbiAgICAgICAgIGlmIChjLm1fZmxhZ3MgJiBiMkNvbnRhY3QuZV9maWx0ZXJGbGFnKSB7XG4gICAgICAgICAgICBpZiAoYm9keUIuU2hvdWxkQ29sbGlkZShib2R5QSkgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgIHZhciBjTnVrZSA9IGM7XG4gICAgICAgICAgICAgICBjID0gY051a2UuR2V0TmV4dCgpO1xuICAgICAgICAgICAgICAgdGhpcy5EZXN0cm95KGNOdWtlKTtcbiAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMubV9jb250YWN0RmlsdGVyLlNob3VsZENvbGxpZGUoZml4dHVyZUEsIGZpeHR1cmVCKSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgY051a2UgPSBjO1xuICAgICAgICAgICAgICAgYyA9IGNOdWtlLkdldE5leHQoKTtcbiAgICAgICAgICAgICAgIHRoaXMuRGVzdHJveShjTnVrZSk7XG4gICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGMubV9mbGFncyAmPSB+YjJDb250YWN0LmVfZmlsdGVyRmxhZztcbiAgICAgICAgIH1cbiAgICAgICAgIHZhciBwcm94eUEgPSBmaXh0dXJlQS5tX3Byb3h5O1xuICAgICAgICAgdmFyIHByb3h5QiA9IGZpeHR1cmVCLm1fcHJveHk7XG4gICAgICAgICB2YXIgb3ZlcmxhcCA9IHRoaXMubV9icm9hZFBoYXNlLlRlc3RPdmVybGFwKHByb3h5QSwgcHJveHlCKTtcbiAgICAgICAgIGlmIChvdmVybGFwID09IGZhbHNlKSB7XG4gICAgICAgICAgICBjTnVrZSA9IGM7XG4gICAgICAgICAgICBjID0gY051a2UuR2V0TmV4dCgpO1xuICAgICAgICAgICAgdGhpcy5EZXN0cm95KGNOdWtlKTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgfVxuICAgICAgICAgYy5VcGRhdGUodGhpcy5tX2NvbnRhY3RMaXN0ZW5lcik7XG4gICAgICAgICBjID0gYy5HZXROZXh0KCk7XG4gICAgICB9XG4gICB9XG4gICBCb3gyRC5wb3N0RGVmcy5wdXNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIEJveDJELkR5bmFtaWNzLmIyQ29udGFjdE1hbmFnZXIuc19ldmFsQ1AgPSBuZXcgYjJDb250YWN0UG9pbnQoKTtcbiAgIH0pO1xuICAgYjJEZWJ1Z0RyYXcuYjJEZWJ1Z0RyYXcgPSBmdW5jdGlvbiAoKSB7fTtcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5iMkRlYnVnRHJhdyA9IGZ1bmN0aW9uICgpIHt9XG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuU2V0RmxhZ3MgPSBmdW5jdGlvbiAoZmxhZ3MpIHtcbiAgICAgIGlmIChmbGFncyA9PT0gdW5kZWZpbmVkKSBmbGFncyA9IDA7XG4gICB9XG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuR2V0RmxhZ3MgPSBmdW5jdGlvbiAoKSB7fVxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLkFwcGVuZEZsYWdzID0gZnVuY3Rpb24gKGZsYWdzKSB7XG4gICAgICBpZiAoZmxhZ3MgPT09IHVuZGVmaW5lZCkgZmxhZ3MgPSAwO1xuICAgfVxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLkNsZWFyRmxhZ3MgPSBmdW5jdGlvbiAoZmxhZ3MpIHtcbiAgICAgIGlmIChmbGFncyA9PT0gdW5kZWZpbmVkKSBmbGFncyA9IDA7XG4gICB9XG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuU2V0U3ByaXRlID0gZnVuY3Rpb24gKHNwcml0ZSkge31cbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5HZXRTcHJpdGUgPSBmdW5jdGlvbiAoKSB7fVxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLlNldERyYXdTY2FsZSA9IGZ1bmN0aW9uIChkcmF3U2NhbGUpIHtcbiAgICAgIGlmIChkcmF3U2NhbGUgPT09IHVuZGVmaW5lZCkgZHJhd1NjYWxlID0gMDtcbiAgIH1cbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5HZXREcmF3U2NhbGUgPSBmdW5jdGlvbiAoKSB7fVxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLlNldExpbmVUaGlja25lc3MgPSBmdW5jdGlvbiAobGluZVRoaWNrbmVzcykge1xuICAgICAgaWYgKGxpbmVUaGlja25lc3MgPT09IHVuZGVmaW5lZCkgbGluZVRoaWNrbmVzcyA9IDA7XG4gICB9XG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuR2V0TGluZVRoaWNrbmVzcyA9IGZ1bmN0aW9uICgpIHt9XG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuU2V0QWxwaGEgPSBmdW5jdGlvbiAoYWxwaGEpIHtcbiAgICAgIGlmIChhbHBoYSA9PT0gdW5kZWZpbmVkKSBhbHBoYSA9IDA7XG4gICB9XG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuR2V0QWxwaGEgPSBmdW5jdGlvbiAoKSB7fVxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLlNldEZpbGxBbHBoYSA9IGZ1bmN0aW9uIChhbHBoYSkge1xuICAgICAgaWYgKGFscGhhID09PSB1bmRlZmluZWQpIGFscGhhID0gMDtcbiAgIH1cbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5HZXRGaWxsQWxwaGEgPSBmdW5jdGlvbiAoKSB7fVxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLlNldFhGb3JtU2NhbGUgPSBmdW5jdGlvbiAoeGZvcm1TY2FsZSkge1xuICAgICAgaWYgKHhmb3JtU2NhbGUgPT09IHVuZGVmaW5lZCkgeGZvcm1TY2FsZSA9IDA7XG4gICB9XG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuR2V0WEZvcm1TY2FsZSA9IGZ1bmN0aW9uICgpIHt9XG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuRHJhd1BvbHlnb24gPSBmdW5jdGlvbiAodmVydGljZXMsIHZlcnRleENvdW50LCBjb2xvcikge1xuICAgICAgaWYgKHZlcnRleENvdW50ID09PSB1bmRlZmluZWQpIHZlcnRleENvdW50ID0gMDtcbiAgIH1cbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5EcmF3U29saWRQb2x5Z29uID0gZnVuY3Rpb24gKHZlcnRpY2VzLCB2ZXJ0ZXhDb3VudCwgY29sb3IpIHtcbiAgICAgIGlmICh2ZXJ0ZXhDb3VudCA9PT0gdW5kZWZpbmVkKSB2ZXJ0ZXhDb3VudCA9IDA7XG4gICB9XG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuRHJhd0NpcmNsZSA9IGZ1bmN0aW9uIChjZW50ZXIsIHJhZGl1cywgY29sb3IpIHtcbiAgICAgIGlmIChyYWRpdXMgPT09IHVuZGVmaW5lZCkgcmFkaXVzID0gMDtcbiAgIH1cbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5EcmF3U29saWRDaXJjbGUgPSBmdW5jdGlvbiAoY2VudGVyLCByYWRpdXMsIGF4aXMsIGNvbG9yKSB7XG4gICAgICBpZiAocmFkaXVzID09PSB1bmRlZmluZWQpIHJhZGl1cyA9IDA7XG4gICB9XG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuRHJhd1NlZ21lbnQgPSBmdW5jdGlvbiAocDEsIHAyLCBjb2xvcikge31cbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5EcmF3VHJhbnNmb3JtID0gZnVuY3Rpb24gKHhmKSB7fVxuICAgQm94MkQucG9zdERlZnMucHVzaChmdW5jdGlvbiAoKSB7XG4gICAgICBCb3gyRC5EeW5hbWljcy5iMkRlYnVnRHJhdy5lX3NoYXBlQml0ID0gMHgwMDAxO1xuICAgICAgQm94MkQuRHluYW1pY3MuYjJEZWJ1Z0RyYXcuZV9qb2ludEJpdCA9IDB4MDAwMjtcbiAgICAgIEJveDJELkR5bmFtaWNzLmIyRGVidWdEcmF3LmVfYWFiYkJpdCA9IDB4MDAwNDtcbiAgICAgIEJveDJELkR5bmFtaWNzLmIyRGVidWdEcmF3LmVfcGFpckJpdCA9IDB4MDAwODtcbiAgICAgIEJveDJELkR5bmFtaWNzLmIyRGVidWdEcmF3LmVfY2VudGVyT2ZNYXNzQml0ID0gMHgwMDEwO1xuICAgICAgQm94MkQuRHluYW1pY3MuYjJEZWJ1Z0RyYXcuZV9jb250cm9sbGVyQml0ID0gMHgwMDIwO1xuICAgfSk7XG4gICBiMkRlc3RydWN0aW9uTGlzdGVuZXIuYjJEZXN0cnVjdGlvbkxpc3RlbmVyID0gZnVuY3Rpb24gKCkge307XG4gICBiMkRlc3RydWN0aW9uTGlzdGVuZXIucHJvdG90eXBlLlNheUdvb2RieWVKb2ludCA9IGZ1bmN0aW9uIChqb2ludCkge31cbiAgIGIyRGVzdHJ1Y3Rpb25MaXN0ZW5lci5wcm90b3R5cGUuU2F5R29vZGJ5ZUZpeHR1cmUgPSBmdW5jdGlvbiAoZml4dHVyZSkge31cbiAgIGIyRmlsdGVyRGF0YS5iMkZpbHRlckRhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLmNhdGVnb3J5Qml0cyA9IDB4MDAwMTtcbiAgICAgIHRoaXMubWFza0JpdHMgPSAweEZGRkY7XG4gICAgICB0aGlzLmdyb3VwSW5kZXggPSAwO1xuICAgfTtcbiAgIGIyRmlsdGVyRGF0YS5wcm90b3R5cGUuQ29weSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBjb3B5ID0gbmV3IGIyRmlsdGVyRGF0YSgpO1xuICAgICAgY29weS5jYXRlZ29yeUJpdHMgPSB0aGlzLmNhdGVnb3J5Qml0cztcbiAgICAgIGNvcHkubWFza0JpdHMgPSB0aGlzLm1hc2tCaXRzO1xuICAgICAgY29weS5ncm91cEluZGV4ID0gdGhpcy5ncm91cEluZGV4O1xuICAgICAgcmV0dXJuIGNvcHk7XG4gICB9XG4gICBiMkZpeHR1cmUuYjJGaXh0dXJlID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5tX2ZpbHRlciA9IG5ldyBiMkZpbHRlckRhdGEoKTtcbiAgIH07XG4gICBiMkZpeHR1cmUucHJvdG90eXBlLkdldFR5cGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX3NoYXBlLkdldFR5cGUoKTtcbiAgIH1cbiAgIGIyRml4dHVyZS5wcm90b3R5cGUuR2V0U2hhcGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX3NoYXBlO1xuICAgfVxuICAgYjJGaXh0dXJlLnByb3RvdHlwZS5TZXRTZW5zb3IgPSBmdW5jdGlvbiAoc2Vuc29yKSB7XG4gICAgICBpZiAodGhpcy5tX2lzU2Vuc29yID09IHNlbnNvcikgcmV0dXJuO1xuICAgICAgdGhpcy5tX2lzU2Vuc29yID0gc2Vuc29yO1xuICAgICAgaWYgKHRoaXMubV9ib2R5ID09IG51bGwpIHJldHVybjtcbiAgICAgIHZhciBlZGdlID0gdGhpcy5tX2JvZHkuR2V0Q29udGFjdExpc3QoKTtcbiAgICAgIHdoaWxlIChlZGdlKSB7XG4gICAgICAgICB2YXIgY29udGFjdCA9IGVkZ2UuY29udGFjdDtcbiAgICAgICAgIHZhciBmaXh0dXJlQSA9IGNvbnRhY3QuR2V0Rml4dHVyZUEoKTtcbiAgICAgICAgIHZhciBmaXh0dXJlQiA9IGNvbnRhY3QuR2V0Rml4dHVyZUIoKTtcbiAgICAgICAgIGlmIChmaXh0dXJlQSA9PSB0aGlzIHx8IGZpeHR1cmVCID09IHRoaXMpIGNvbnRhY3QuU2V0U2Vuc29yKGZpeHR1cmVBLklzU2Vuc29yKCkgfHwgZml4dHVyZUIuSXNTZW5zb3IoKSk7XG4gICAgICAgICBlZGdlID0gZWRnZS5uZXh0O1xuICAgICAgfVxuICAgfVxuICAgYjJGaXh0dXJlLnByb3RvdHlwZS5Jc1NlbnNvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1faXNTZW5zb3I7XG4gICB9XG4gICBiMkZpeHR1cmUucHJvdG90eXBlLlNldEZpbHRlckRhdGEgPSBmdW5jdGlvbiAoZmlsdGVyKSB7XG4gICAgICB0aGlzLm1fZmlsdGVyID0gZmlsdGVyLkNvcHkoKTtcbiAgICAgIGlmICh0aGlzLm1fYm9keSkgcmV0dXJuO1xuICAgICAgdmFyIGVkZ2UgPSB0aGlzLm1fYm9keS5HZXRDb250YWN0TGlzdCgpO1xuICAgICAgd2hpbGUgKGVkZ2UpIHtcbiAgICAgICAgIHZhciBjb250YWN0ID0gZWRnZS5jb250YWN0O1xuICAgICAgICAgdmFyIGZpeHR1cmVBID0gY29udGFjdC5HZXRGaXh0dXJlQSgpO1xuICAgICAgICAgdmFyIGZpeHR1cmVCID0gY29udGFjdC5HZXRGaXh0dXJlQigpO1xuICAgICAgICAgaWYgKGZpeHR1cmVBID09IHRoaXMgfHwgZml4dHVyZUIgPT0gdGhpcykgY29udGFjdC5GbGFnRm9yRmlsdGVyaW5nKCk7XG4gICAgICAgICBlZGdlID0gZWRnZS5uZXh0O1xuICAgICAgfVxuICAgfVxuICAgYjJGaXh0dXJlLnByb3RvdHlwZS5HZXRGaWx0ZXJEYXRhID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV9maWx0ZXIuQ29weSgpO1xuICAgfVxuICAgYjJGaXh0dXJlLnByb3RvdHlwZS5HZXRCb2R5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV9ib2R5O1xuICAgfVxuICAgYjJGaXh0dXJlLnByb3RvdHlwZS5HZXROZXh0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV9uZXh0O1xuICAgfVxuICAgYjJGaXh0dXJlLnByb3RvdHlwZS5HZXRVc2VyRGF0YSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fdXNlckRhdGE7XG4gICB9XG4gICBiMkZpeHR1cmUucHJvdG90eXBlLlNldFVzZXJEYXRhID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgIHRoaXMubV91c2VyRGF0YSA9IGRhdGE7XG4gICB9XG4gICBiMkZpeHR1cmUucHJvdG90eXBlLlRlc3RQb2ludCA9IGZ1bmN0aW9uIChwKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX3NoYXBlLlRlc3RQb2ludCh0aGlzLm1fYm9keS5HZXRUcmFuc2Zvcm0oKSwgcCk7XG4gICB9XG4gICBiMkZpeHR1cmUucHJvdG90eXBlLlJheUNhc3QgPSBmdW5jdGlvbiAob3V0cHV0LCBpbnB1dCkge1xuICAgICAgcmV0dXJuIHRoaXMubV9zaGFwZS5SYXlDYXN0KG91dHB1dCwgaW5wdXQsIHRoaXMubV9ib2R5LkdldFRyYW5zZm9ybSgpKTtcbiAgIH1cbiAgIGIyRml4dHVyZS5wcm90b3R5cGUuR2V0TWFzc0RhdGEgPSBmdW5jdGlvbiAobWFzc0RhdGEpIHtcbiAgICAgIGlmIChtYXNzRGF0YSA9PT0gdW5kZWZpbmVkKSBtYXNzRGF0YSA9IG51bGw7XG4gICAgICBpZiAobWFzc0RhdGEgPT0gbnVsbCkge1xuICAgICAgICAgbWFzc0RhdGEgPSBuZXcgYjJNYXNzRGF0YSgpO1xuICAgICAgfVxuICAgICAgdGhpcy5tX3NoYXBlLkNvbXB1dGVNYXNzKG1hc3NEYXRhLCB0aGlzLm1fZGVuc2l0eSk7XG4gICAgICByZXR1cm4gbWFzc0RhdGE7XG4gICB9XG4gICBiMkZpeHR1cmUucHJvdG90eXBlLlNldERlbnNpdHkgPSBmdW5jdGlvbiAoZGVuc2l0eSkge1xuICAgICAgaWYgKGRlbnNpdHkgPT09IHVuZGVmaW5lZCkgZGVuc2l0eSA9IDA7XG4gICAgICB0aGlzLm1fZGVuc2l0eSA9IGRlbnNpdHk7XG4gICB9XG4gICBiMkZpeHR1cmUucHJvdG90eXBlLkdldERlbnNpdHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX2RlbnNpdHk7XG4gICB9XG4gICBiMkZpeHR1cmUucHJvdG90eXBlLkdldEZyaWN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV9mcmljdGlvbjtcbiAgIH1cbiAgIGIyRml4dHVyZS5wcm90b3R5cGUuU2V0RnJpY3Rpb24gPSBmdW5jdGlvbiAoZnJpY3Rpb24pIHtcbiAgICAgIGlmIChmcmljdGlvbiA9PT0gdW5kZWZpbmVkKSBmcmljdGlvbiA9IDA7XG4gICAgICB0aGlzLm1fZnJpY3Rpb24gPSBmcmljdGlvbjtcbiAgIH1cbiAgIGIyRml4dHVyZS5wcm90b3R5cGUuR2V0UmVzdGl0dXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX3Jlc3RpdHV0aW9uO1xuICAgfVxuICAgYjJGaXh0dXJlLnByb3RvdHlwZS5TZXRSZXN0aXR1dGlvbiA9IGZ1bmN0aW9uIChyZXN0aXR1dGlvbikge1xuICAgICAgaWYgKHJlc3RpdHV0aW9uID09PSB1bmRlZmluZWQpIHJlc3RpdHV0aW9uID0gMDtcbiAgICAgIHRoaXMubV9yZXN0aXR1dGlvbiA9IHJlc3RpdHV0aW9uO1xuICAgfVxuICAgYjJGaXh0dXJlLnByb3RvdHlwZS5HZXRBQUJCID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV9hYWJiO1xuICAgfVxuICAgYjJGaXh0dXJlLnByb3RvdHlwZS5iMkZpeHR1cmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLm1fYWFiYiA9IG5ldyBiMkFBQkIoKTtcbiAgICAgIHRoaXMubV91c2VyRGF0YSA9IG51bGw7XG4gICAgICB0aGlzLm1fYm9keSA9IG51bGw7XG4gICAgICB0aGlzLm1fbmV4dCA9IG51bGw7XG4gICAgICB0aGlzLm1fc2hhcGUgPSBudWxsO1xuICAgICAgdGhpcy5tX2RlbnNpdHkgPSAwLjA7XG4gICAgICB0aGlzLm1fZnJpY3Rpb24gPSAwLjA7XG4gICAgICB0aGlzLm1fcmVzdGl0dXRpb24gPSAwLjA7XG4gICB9XG4gICBiMkZpeHR1cmUucHJvdG90eXBlLkNyZWF0ZSA9IGZ1bmN0aW9uIChib2R5LCB4ZiwgZGVmKSB7XG4gICAgICB0aGlzLm1fdXNlckRhdGEgPSBkZWYudXNlckRhdGE7XG4gICAgICB0aGlzLm1fZnJpY3Rpb24gPSBkZWYuZnJpY3Rpb247XG4gICAgICB0aGlzLm1fcmVzdGl0dXRpb24gPSBkZWYucmVzdGl0dXRpb247XG4gICAgICB0aGlzLm1fYm9keSA9IGJvZHk7XG4gICAgICB0aGlzLm1fbmV4dCA9IG51bGw7XG4gICAgICB0aGlzLm1fZmlsdGVyID0gZGVmLmZpbHRlci5Db3B5KCk7XG4gICAgICB0aGlzLm1faXNTZW5zb3IgPSBkZWYuaXNTZW5zb3I7XG4gICAgICB0aGlzLm1fc2hhcGUgPSBkZWYuc2hhcGUuQ29weSgpO1xuICAgICAgdGhpcy5tX2RlbnNpdHkgPSBkZWYuZGVuc2l0eTtcbiAgIH1cbiAgIGIyRml4dHVyZS5wcm90b3R5cGUuRGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMubV9zaGFwZSA9IG51bGw7XG4gICB9XG4gICBiMkZpeHR1cmUucHJvdG90eXBlLkNyZWF0ZVByb3h5ID0gZnVuY3Rpb24gKGJyb2FkUGhhc2UsIHhmKSB7XG4gICAgICB0aGlzLm1fc2hhcGUuQ29tcHV0ZUFBQkIodGhpcy5tX2FhYmIsIHhmKTtcbiAgICAgIHRoaXMubV9wcm94eSA9IGJyb2FkUGhhc2UuQ3JlYXRlUHJveHkodGhpcy5tX2FhYmIsIHRoaXMpO1xuICAgfVxuICAgYjJGaXh0dXJlLnByb3RvdHlwZS5EZXN0cm95UHJveHkgPSBmdW5jdGlvbiAoYnJvYWRQaGFzZSkge1xuICAgICAgaWYgKHRoaXMubV9wcm94eSA9PSBudWxsKSB7XG4gICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBicm9hZFBoYXNlLkRlc3Ryb3lQcm94eSh0aGlzLm1fcHJveHkpO1xuICAgICAgdGhpcy5tX3Byb3h5ID0gbnVsbDtcbiAgIH1cbiAgIGIyRml4dHVyZS5wcm90b3R5cGUuU3luY2hyb25pemUgPSBmdW5jdGlvbiAoYnJvYWRQaGFzZSwgdHJhbnNmb3JtMSwgdHJhbnNmb3JtMikge1xuICAgICAgaWYgKCF0aGlzLm1fcHJveHkpIHJldHVybjtcbiAgICAgIHZhciBhYWJiMSA9IG5ldyBiMkFBQkIoKTtcbiAgICAgIHZhciBhYWJiMiA9IG5ldyBiMkFBQkIoKTtcbiAgICAgIHRoaXMubV9zaGFwZS5Db21wdXRlQUFCQihhYWJiMSwgdHJhbnNmb3JtMSk7XG4gICAgICB0aGlzLm1fc2hhcGUuQ29tcHV0ZUFBQkIoYWFiYjIsIHRyYW5zZm9ybTIpO1xuICAgICAgdGhpcy5tX2FhYmIuQ29tYmluZShhYWJiMSwgYWFiYjIpO1xuICAgICAgdmFyIGRpc3BsYWNlbWVudCA9IGIyTWF0aC5TdWJ0cmFjdFZWKHRyYW5zZm9ybTIucG9zaXRpb24sIHRyYW5zZm9ybTEucG9zaXRpb24pO1xuICAgICAgYnJvYWRQaGFzZS5Nb3ZlUHJveHkodGhpcy5tX3Byb3h5LCB0aGlzLm1fYWFiYiwgZGlzcGxhY2VtZW50KTtcbiAgIH1cbiAgIGIyRml4dHVyZURlZi5iMkZpeHR1cmVEZWYgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLmZpbHRlciA9IG5ldyBiMkZpbHRlckRhdGEoKTtcbiAgIH07XG4gICBiMkZpeHR1cmVEZWYucHJvdG90eXBlLmIyRml4dHVyZURlZiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuc2hhcGUgPSBudWxsO1xuICAgICAgdGhpcy51c2VyRGF0YSA9IG51bGw7XG4gICAgICB0aGlzLmZyaWN0aW9uID0gMC4yO1xuICAgICAgdGhpcy5yZXN0aXR1dGlvbiA9IDAuMDtcbiAgICAgIHRoaXMuZGVuc2l0eSA9IDAuMDtcbiAgICAgIHRoaXMuZmlsdGVyLmNhdGVnb3J5Qml0cyA9IDB4MDAwMTtcbiAgICAgIHRoaXMuZmlsdGVyLm1hc2tCaXRzID0gMHhGRkZGO1xuICAgICAgdGhpcy5maWx0ZXIuZ3JvdXBJbmRleCA9IDA7XG4gICAgICB0aGlzLmlzU2Vuc29yID0gZmFsc2U7XG4gICB9XG4gICBiMklzbGFuZC5iMklzbGFuZCA9IGZ1bmN0aW9uICgpIHt9O1xuICAgYjJJc2xhbmQucHJvdG90eXBlLmIySXNsYW5kID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5tX2JvZGllcyA9IG5ldyBWZWN0b3IoKTtcbiAgICAgIHRoaXMubV9jb250YWN0cyA9IG5ldyBWZWN0b3IoKTtcbiAgICAgIHRoaXMubV9qb2ludHMgPSBuZXcgVmVjdG9yKCk7XG4gICB9XG4gICBiMklzbGFuZC5wcm90b3R5cGUuSW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIChib2R5Q2FwYWNpdHksIGNvbnRhY3RDYXBhY2l0eSwgam9pbnRDYXBhY2l0eSwgYWxsb2NhdG9yLCBsaXN0ZW5lciwgY29udGFjdFNvbHZlcikge1xuICAgICAgaWYgKGJvZHlDYXBhY2l0eSA9PT0gdW5kZWZpbmVkKSBib2R5Q2FwYWNpdHkgPSAwO1xuICAgICAgaWYgKGNvbnRhY3RDYXBhY2l0eSA9PT0gdW5kZWZpbmVkKSBjb250YWN0Q2FwYWNpdHkgPSAwO1xuICAgICAgaWYgKGpvaW50Q2FwYWNpdHkgPT09IHVuZGVmaW5lZCkgam9pbnRDYXBhY2l0eSA9IDA7XG4gICAgICB2YXIgaSA9IDA7XG4gICAgICB0aGlzLm1fYm9keUNhcGFjaXR5ID0gYm9keUNhcGFjaXR5O1xuICAgICAgdGhpcy5tX2NvbnRhY3RDYXBhY2l0eSA9IGNvbnRhY3RDYXBhY2l0eTtcbiAgICAgIHRoaXMubV9qb2ludENhcGFjaXR5ID0gam9pbnRDYXBhY2l0eTtcbiAgICAgIHRoaXMubV9ib2R5Q291bnQgPSAwO1xuICAgICAgdGhpcy5tX2NvbnRhY3RDb3VudCA9IDA7XG4gICAgICB0aGlzLm1fam9pbnRDb3VudCA9IDA7XG4gICAgICB0aGlzLm1fYWxsb2NhdG9yID0gYWxsb2NhdG9yO1xuICAgICAgdGhpcy5tX2xpc3RlbmVyID0gbGlzdGVuZXI7XG4gICAgICB0aGlzLm1fY29udGFjdFNvbHZlciA9IGNvbnRhY3RTb2x2ZXI7XG4gICAgICBmb3IgKGkgPSB0aGlzLm1fYm9kaWVzLmxlbmd0aDtcbiAgICAgIGkgPCBib2R5Q2FwYWNpdHk7IGkrKylcbiAgICAgIHRoaXMubV9ib2RpZXNbaV0gPSBudWxsO1xuICAgICAgZm9yIChpID0gdGhpcy5tX2NvbnRhY3RzLmxlbmd0aDtcbiAgICAgIGkgPCBjb250YWN0Q2FwYWNpdHk7IGkrKylcbiAgICAgIHRoaXMubV9jb250YWN0c1tpXSA9IG51bGw7XG4gICAgICBmb3IgKGkgPSB0aGlzLm1fam9pbnRzLmxlbmd0aDtcbiAgICAgIGkgPCBqb2ludENhcGFjaXR5OyBpKyspXG4gICAgICB0aGlzLm1fam9pbnRzW2ldID0gbnVsbDtcbiAgIH1cbiAgIGIySXNsYW5kLnByb3RvdHlwZS5DbGVhciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMubV9ib2R5Q291bnQgPSAwO1xuICAgICAgdGhpcy5tX2NvbnRhY3RDb3VudCA9IDA7XG4gICAgICB0aGlzLm1fam9pbnRDb3VudCA9IDA7XG4gICB9XG4gICBiMklzbGFuZC5wcm90b3R5cGUuU29sdmUgPSBmdW5jdGlvbiAoc3RlcCwgZ3Jhdml0eSwgYWxsb3dTbGVlcCkge1xuICAgICAgdmFyIGkgPSAwO1xuICAgICAgdmFyIGogPSAwO1xuICAgICAgdmFyIGI7XG4gICAgICB2YXIgam9pbnQ7XG4gICAgICBmb3IgKGkgPSAwO1xuICAgICAgaSA8IHRoaXMubV9ib2R5Q291bnQ7ICsraSkge1xuICAgICAgICAgYiA9IHRoaXMubV9ib2RpZXNbaV07XG4gICAgICAgICBpZiAoYi5HZXRUeXBlKCkgIT0gYjJCb2R5LmIyX2R5bmFtaWNCb2R5KSBjb250aW51ZTtcbiAgICAgICAgIGIubV9saW5lYXJWZWxvY2l0eS54ICs9IHN0ZXAuZHQgKiAoZ3Jhdml0eS54ICsgYi5tX2ludk1hc3MgKiBiLm1fZm9yY2UueCk7XG4gICAgICAgICBiLm1fbGluZWFyVmVsb2NpdHkueSArPSBzdGVwLmR0ICogKGdyYXZpdHkueSArIGIubV9pbnZNYXNzICogYi5tX2ZvcmNlLnkpO1xuICAgICAgICAgYi5tX2FuZ3VsYXJWZWxvY2l0eSArPSBzdGVwLmR0ICogYi5tX2ludkkgKiBiLm1fdG9ycXVlO1xuICAgICAgICAgYi5tX2xpbmVhclZlbG9jaXR5Lk11bHRpcGx5KGIyTWF0aC5DbGFtcCgxLjAgLSBzdGVwLmR0ICogYi5tX2xpbmVhckRhbXBpbmcsIDAuMCwgMS4wKSk7XG4gICAgICAgICBiLm1fYW5ndWxhclZlbG9jaXR5ICo9IGIyTWF0aC5DbGFtcCgxLjAgLSBzdGVwLmR0ICogYi5tX2FuZ3VsYXJEYW1waW5nLCAwLjAsIDEuMCk7XG4gICAgICB9XG4gICAgICB0aGlzLm1fY29udGFjdFNvbHZlci5Jbml0aWFsaXplKHN0ZXAsIHRoaXMubV9jb250YWN0cywgdGhpcy5tX2NvbnRhY3RDb3VudCwgdGhpcy5tX2FsbG9jYXRvcik7XG4gICAgICB2YXIgY29udGFjdFNvbHZlciA9IHRoaXMubV9jb250YWN0U29sdmVyO1xuICAgICAgY29udGFjdFNvbHZlci5Jbml0VmVsb2NpdHlDb25zdHJhaW50cyhzdGVwKTtcbiAgICAgIGZvciAoaSA9IDA7XG4gICAgICBpIDwgdGhpcy5tX2pvaW50Q291bnQ7ICsraSkge1xuICAgICAgICAgam9pbnQgPSB0aGlzLm1fam9pbnRzW2ldO1xuICAgICAgICAgam9pbnQuSW5pdFZlbG9jaXR5Q29uc3RyYWludHMoc3RlcCk7XG4gICAgICB9XG4gICAgICBmb3IgKGkgPSAwO1xuICAgICAgaSA8IHN0ZXAudmVsb2NpdHlJdGVyYXRpb25zOyArK2kpIHtcbiAgICAgICAgIGZvciAoaiA9IDA7XG4gICAgICAgICBqIDwgdGhpcy5tX2pvaW50Q291bnQ7ICsraikge1xuICAgICAgICAgICAgam9pbnQgPSB0aGlzLm1fam9pbnRzW2pdO1xuICAgICAgICAgICAgam9pbnQuU29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzKHN0ZXApO1xuICAgICAgICAgfVxuICAgICAgICAgY29udGFjdFNvbHZlci5Tb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMoKTtcbiAgICAgIH1cbiAgICAgIGZvciAoaSA9IDA7XG4gICAgICBpIDwgdGhpcy5tX2pvaW50Q291bnQ7ICsraSkge1xuICAgICAgICAgam9pbnQgPSB0aGlzLm1fam9pbnRzW2ldO1xuICAgICAgICAgam9pbnQuRmluYWxpemVWZWxvY2l0eUNvbnN0cmFpbnRzKCk7XG4gICAgICB9XG4gICAgICBjb250YWN0U29sdmVyLkZpbmFsaXplVmVsb2NpdHlDb25zdHJhaW50cygpO1xuICAgICAgZm9yIChpID0gMDtcbiAgICAgIGkgPCB0aGlzLm1fYm9keUNvdW50OyArK2kpIHtcbiAgICAgICAgIGIgPSB0aGlzLm1fYm9kaWVzW2ldO1xuICAgICAgICAgaWYgKGIuR2V0VHlwZSgpID09IGIyQm9keS5iMl9zdGF0aWNCb2R5KSBjb250aW51ZTtcbiAgICAgICAgIHZhciB0cmFuc2xhdGlvblggPSBzdGVwLmR0ICogYi5tX2xpbmVhclZlbG9jaXR5Lng7XG4gICAgICAgICB2YXIgdHJhbnNsYXRpb25ZID0gc3RlcC5kdCAqIGIubV9saW5lYXJWZWxvY2l0eS55O1xuICAgICAgICAgaWYgKCh0cmFuc2xhdGlvblggKiB0cmFuc2xhdGlvblggKyB0cmFuc2xhdGlvblkgKiB0cmFuc2xhdGlvblkpID4gYjJTZXR0aW5ncy5iMl9tYXhUcmFuc2xhdGlvblNxdWFyZWQpIHtcbiAgICAgICAgICAgIGIubV9saW5lYXJWZWxvY2l0eS5Ob3JtYWxpemUoKTtcbiAgICAgICAgICAgIGIubV9saW5lYXJWZWxvY2l0eS54ICo9IGIyU2V0dGluZ3MuYjJfbWF4VHJhbnNsYXRpb24gKiBzdGVwLmludl9kdDtcbiAgICAgICAgICAgIGIubV9saW5lYXJWZWxvY2l0eS55ICo9IGIyU2V0dGluZ3MuYjJfbWF4VHJhbnNsYXRpb24gKiBzdGVwLmludl9kdDtcbiAgICAgICAgIH1cbiAgICAgICAgIHZhciByb3RhdGlvbiA9IHN0ZXAuZHQgKiBiLm1fYW5ndWxhclZlbG9jaXR5O1xuICAgICAgICAgaWYgKHJvdGF0aW9uICogcm90YXRpb24gPiBiMlNldHRpbmdzLmIyX21heFJvdGF0aW9uU3F1YXJlZCkge1xuICAgICAgICAgICAgaWYgKGIubV9hbmd1bGFyVmVsb2NpdHkgPCAwLjApIHtcbiAgICAgICAgICAgICAgIGIubV9hbmd1bGFyVmVsb2NpdHkgPSAoLWIyU2V0dGluZ3MuYjJfbWF4Um90YXRpb24gKiBzdGVwLmludl9kdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgIGIubV9hbmd1bGFyVmVsb2NpdHkgPSBiMlNldHRpbmdzLmIyX21heFJvdGF0aW9uICogc3RlcC5pbnZfZHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICB9XG4gICAgICAgICBiLm1fc3dlZXAuYzAuU2V0VihiLm1fc3dlZXAuYyk7XG4gICAgICAgICBiLm1fc3dlZXAuYTAgPSBiLm1fc3dlZXAuYTtcbiAgICAgICAgIGIubV9zd2VlcC5jLnggKz0gc3RlcC5kdCAqIGIubV9saW5lYXJWZWxvY2l0eS54O1xuICAgICAgICAgYi5tX3N3ZWVwLmMueSArPSBzdGVwLmR0ICogYi5tX2xpbmVhclZlbG9jaXR5Lnk7XG4gICAgICAgICBiLm1fc3dlZXAuYSArPSBzdGVwLmR0ICogYi5tX2FuZ3VsYXJWZWxvY2l0eTtcbiAgICAgICAgIGIuU3luY2hyb25pemVUcmFuc2Zvcm0oKTtcbiAgICAgIH1cbiAgICAgIGZvciAoaSA9IDA7XG4gICAgICBpIDwgc3RlcC5wb3NpdGlvbkl0ZXJhdGlvbnM7ICsraSkge1xuICAgICAgICAgdmFyIGNvbnRhY3RzT2theSA9IGNvbnRhY3RTb2x2ZXIuU29sdmVQb3NpdGlvbkNvbnN0cmFpbnRzKGIyU2V0dGluZ3MuYjJfY29udGFjdEJhdW1nYXJ0ZSk7XG4gICAgICAgICB2YXIgam9pbnRzT2theSA9IHRydWU7XG4gICAgICAgICBmb3IgKGogPSAwO1xuICAgICAgICAgaiA8IHRoaXMubV9qb2ludENvdW50OyArK2opIHtcbiAgICAgICAgICAgIGpvaW50ID0gdGhpcy5tX2pvaW50c1tqXTtcbiAgICAgICAgICAgIHZhciBqb2ludE9rYXkgPSBqb2ludC5Tb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMoYjJTZXR0aW5ncy5iMl9jb250YWN0QmF1bWdhcnRlKTtcbiAgICAgICAgICAgIGpvaW50c09rYXkgPSBqb2ludHNPa2F5ICYmIGpvaW50T2theTtcbiAgICAgICAgIH1cbiAgICAgICAgIGlmIChjb250YWN0c09rYXkgJiYgam9pbnRzT2theSkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICB9XG4gICAgICB9XG4gICAgICB0aGlzLlJlcG9ydChjb250YWN0U29sdmVyLm1fY29uc3RyYWludHMpO1xuICAgICAgaWYgKGFsbG93U2xlZXApIHtcbiAgICAgICAgIHZhciBtaW5TbGVlcFRpbWUgPSBOdW1iZXIuTUFYX1ZBTFVFO1xuICAgICAgICAgdmFyIGxpblRvbFNxciA9IGIyU2V0dGluZ3MuYjJfbGluZWFyU2xlZXBUb2xlcmFuY2UgKiBiMlNldHRpbmdzLmIyX2xpbmVhclNsZWVwVG9sZXJhbmNlO1xuICAgICAgICAgdmFyIGFuZ1RvbFNxciA9IGIyU2V0dGluZ3MuYjJfYW5ndWxhclNsZWVwVG9sZXJhbmNlICogYjJTZXR0aW5ncy5iMl9hbmd1bGFyU2xlZXBUb2xlcmFuY2U7XG4gICAgICAgICBmb3IgKGkgPSAwO1xuICAgICAgICAgaSA8IHRoaXMubV9ib2R5Q291bnQ7ICsraSkge1xuICAgICAgICAgICAgYiA9IHRoaXMubV9ib2RpZXNbaV07XG4gICAgICAgICAgICBpZiAoYi5HZXRUeXBlKCkgPT0gYjJCb2R5LmIyX3N0YXRpY0JvZHkpIHtcbiAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKChiLm1fZmxhZ3MgJiBiMkJvZHkuZV9hbGxvd1NsZWVwRmxhZykgPT0gMCkge1xuICAgICAgICAgICAgICAgYi5tX3NsZWVwVGltZSA9IDAuMDtcbiAgICAgICAgICAgICAgIG1pblNsZWVwVGltZSA9IDAuMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgoYi5tX2ZsYWdzICYgYjJCb2R5LmVfYWxsb3dTbGVlcEZsYWcpID09IDAgfHwgYi5tX2FuZ3VsYXJWZWxvY2l0eSAqIGIubV9hbmd1bGFyVmVsb2NpdHkgPiBhbmdUb2xTcXIgfHwgYjJNYXRoLkRvdChiLm1fbGluZWFyVmVsb2NpdHksIGIubV9saW5lYXJWZWxvY2l0eSkgPiBsaW5Ub2xTcXIpIHtcbiAgICAgICAgICAgICAgIGIubV9zbGVlcFRpbWUgPSAwLjA7XG4gICAgICAgICAgICAgICBtaW5TbGVlcFRpbWUgPSAwLjA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgIGIubV9zbGVlcFRpbWUgKz0gc3RlcC5kdDtcbiAgICAgICAgICAgICAgIG1pblNsZWVwVGltZSA9IGIyTWF0aC5NaW4obWluU2xlZXBUaW1lLCBiLm1fc2xlZXBUaW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgIH1cbiAgICAgICAgIGlmIChtaW5TbGVlcFRpbWUgPj0gYjJTZXR0aW5ncy5iMl90aW1lVG9TbGVlcCkge1xuICAgICAgICAgICAgZm9yIChpID0gMDtcbiAgICAgICAgICAgIGkgPCB0aGlzLm1fYm9keUNvdW50OyArK2kpIHtcbiAgICAgICAgICAgICAgIGIgPSB0aGlzLm1fYm9kaWVzW2ldO1xuICAgICAgICAgICAgICAgYi5TZXRBd2FrZShmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICB9XG4gICAgICB9XG4gICB9XG4gICBiMklzbGFuZC5wcm90b3R5cGUuU29sdmVUT0kgPSBmdW5jdGlvbiAoc3ViU3RlcCkge1xuICAgICAgdmFyIGkgPSAwO1xuICAgICAgdmFyIGogPSAwO1xuICAgICAgdGhpcy5tX2NvbnRhY3RTb2x2ZXIuSW5pdGlhbGl6ZShzdWJTdGVwLCB0aGlzLm1fY29udGFjdHMsIHRoaXMubV9jb250YWN0Q291bnQsIHRoaXMubV9hbGxvY2F0b3IpO1xuICAgICAgdmFyIGNvbnRhY3RTb2x2ZXIgPSB0aGlzLm1fY29udGFjdFNvbHZlcjtcbiAgICAgIGZvciAoaSA9IDA7XG4gICAgICBpIDwgdGhpcy5tX2pvaW50Q291bnQ7ICsraSkge1xuICAgICAgICAgdGhpcy5tX2pvaW50c1tpXS5Jbml0VmVsb2NpdHlDb25zdHJhaW50cyhzdWJTdGVwKTtcbiAgICAgIH1cbiAgICAgIGZvciAoaSA9IDA7XG4gICAgICBpIDwgc3ViU3RlcC52ZWxvY2l0eUl0ZXJhdGlvbnM7ICsraSkge1xuICAgICAgICAgY29udGFjdFNvbHZlci5Tb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMoKTtcbiAgICAgICAgIGZvciAoaiA9IDA7XG4gICAgICAgICBqIDwgdGhpcy5tX2pvaW50Q291bnQ7ICsraikge1xuICAgICAgICAgICAgdGhpcy5tX2pvaW50c1tqXS5Tb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMoc3ViU3RlcCk7XG4gICAgICAgICB9XG4gICAgICB9XG4gICAgICBmb3IgKGkgPSAwO1xuICAgICAgaSA8IHRoaXMubV9ib2R5Q291bnQ7ICsraSkge1xuICAgICAgICAgdmFyIGIgPSB0aGlzLm1fYm9kaWVzW2ldO1xuICAgICAgICAgaWYgKGIuR2V0VHlwZSgpID09IGIyQm9keS5iMl9zdGF0aWNCb2R5KSBjb250aW51ZTtcbiAgICAgICAgIHZhciB0cmFuc2xhdGlvblggPSBzdWJTdGVwLmR0ICogYi5tX2xpbmVhclZlbG9jaXR5Lng7XG4gICAgICAgICB2YXIgdHJhbnNsYXRpb25ZID0gc3ViU3RlcC5kdCAqIGIubV9saW5lYXJWZWxvY2l0eS55O1xuICAgICAgICAgaWYgKCh0cmFuc2xhdGlvblggKiB0cmFuc2xhdGlvblggKyB0cmFuc2xhdGlvblkgKiB0cmFuc2xhdGlvblkpID4gYjJTZXR0aW5ncy5iMl9tYXhUcmFuc2xhdGlvblNxdWFyZWQpIHtcbiAgICAgICAgICAgIGIubV9saW5lYXJWZWxvY2l0eS5Ob3JtYWxpemUoKTtcbiAgICAgICAgICAgIGIubV9saW5lYXJWZWxvY2l0eS54ICo9IGIyU2V0dGluZ3MuYjJfbWF4VHJhbnNsYXRpb24gKiBzdWJTdGVwLmludl9kdDtcbiAgICAgICAgICAgIGIubV9saW5lYXJWZWxvY2l0eS55ICo9IGIyU2V0dGluZ3MuYjJfbWF4VHJhbnNsYXRpb24gKiBzdWJTdGVwLmludl9kdDtcbiAgICAgICAgIH1cbiAgICAgICAgIHZhciByb3RhdGlvbiA9IHN1YlN0ZXAuZHQgKiBiLm1fYW5ndWxhclZlbG9jaXR5O1xuICAgICAgICAgaWYgKHJvdGF0aW9uICogcm90YXRpb24gPiBiMlNldHRpbmdzLmIyX21heFJvdGF0aW9uU3F1YXJlZCkge1xuICAgICAgICAgICAgaWYgKGIubV9hbmd1bGFyVmVsb2NpdHkgPCAwLjApIHtcbiAgICAgICAgICAgICAgIGIubV9hbmd1bGFyVmVsb2NpdHkgPSAoLWIyU2V0dGluZ3MuYjJfbWF4Um90YXRpb24gKiBzdWJTdGVwLmludl9kdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgIGIubV9hbmd1bGFyVmVsb2NpdHkgPSBiMlNldHRpbmdzLmIyX21heFJvdGF0aW9uICogc3ViU3RlcC5pbnZfZHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICB9XG4gICAgICAgICBiLm1fc3dlZXAuYzAuU2V0VihiLm1fc3dlZXAuYyk7XG4gICAgICAgICBiLm1fc3dlZXAuYTAgPSBiLm1fc3dlZXAuYTtcbiAgICAgICAgIGIubV9zd2VlcC5jLnggKz0gc3ViU3RlcC5kdCAqIGIubV9saW5lYXJWZWxvY2l0eS54O1xuICAgICAgICAgYi5tX3N3ZWVwLmMueSArPSBzdWJTdGVwLmR0ICogYi5tX2xpbmVhclZlbG9jaXR5Lnk7XG4gICAgICAgICBiLm1fc3dlZXAuYSArPSBzdWJTdGVwLmR0ICogYi5tX2FuZ3VsYXJWZWxvY2l0eTtcbiAgICAgICAgIGIuU3luY2hyb25pemVUcmFuc2Zvcm0oKTtcbiAgICAgIH1cbiAgICAgIHZhciBrX3RvaUJhdW1nYXJ0ZSA9IDAuNzU7XG4gICAgICBmb3IgKGkgPSAwO1xuICAgICAgaSA8IHN1YlN0ZXAucG9zaXRpb25JdGVyYXRpb25zOyArK2kpIHtcbiAgICAgICAgIHZhciBjb250YWN0c09rYXkgPSBjb250YWN0U29sdmVyLlNvbHZlUG9zaXRpb25Db25zdHJhaW50cyhrX3RvaUJhdW1nYXJ0ZSk7XG4gICAgICAgICB2YXIgam9pbnRzT2theSA9IHRydWU7XG4gICAgICAgICBmb3IgKGogPSAwO1xuICAgICAgICAgaiA8IHRoaXMubV9qb2ludENvdW50OyArK2opIHtcbiAgICAgICAgICAgIHZhciBqb2ludE9rYXkgPSB0aGlzLm1fam9pbnRzW2pdLlNvbHZlUG9zaXRpb25Db25zdHJhaW50cyhiMlNldHRpbmdzLmIyX2NvbnRhY3RCYXVtZ2FydGUpO1xuICAgICAgICAgICAgam9pbnRzT2theSA9IGpvaW50c09rYXkgJiYgam9pbnRPa2F5O1xuICAgICAgICAgfVxuICAgICAgICAgaWYgKGNvbnRhY3RzT2theSAmJiBqb2ludHNPa2F5KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHRoaXMuUmVwb3J0KGNvbnRhY3RTb2x2ZXIubV9jb25zdHJhaW50cyk7XG4gICB9XG4gICBiMklzbGFuZC5wcm90b3R5cGUuUmVwb3J0ID0gZnVuY3Rpb24gKGNvbnN0cmFpbnRzKSB7XG4gICAgICBpZiAodGhpcy5tX2xpc3RlbmVyID09IG51bGwpIHtcbiAgICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2NvbnRhY3RDb3VudDsgKytpKSB7XG4gICAgICAgICB2YXIgYyA9IHRoaXMubV9jb250YWN0c1tpXTtcbiAgICAgICAgIHZhciBjYyA9IGNvbnN0cmFpbnRzW2ldO1xuICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBjYy5wb2ludENvdW50OyArK2opIHtcbiAgICAgICAgICAgIGIySXNsYW5kLnNfaW1wdWxzZS5ub3JtYWxJbXB1bHNlc1tqXSA9IGNjLnBvaW50c1tqXS5ub3JtYWxJbXB1bHNlO1xuICAgICAgICAgICAgYjJJc2xhbmQuc19pbXB1bHNlLnRhbmdlbnRJbXB1bHNlc1tqXSA9IGNjLnBvaW50c1tqXS50YW5nZW50SW1wdWxzZTtcbiAgICAgICAgIH1cbiAgICAgICAgIHRoaXMubV9saXN0ZW5lci5Qb3N0U29sdmUoYywgYjJJc2xhbmQuc19pbXB1bHNlKTtcbiAgICAgIH1cbiAgIH1cbiAgIGIySXNsYW5kLnByb3RvdHlwZS5BZGRCb2R5ID0gZnVuY3Rpb24gKGJvZHkpIHtcbiAgICAgIGJvZHkubV9pc2xhbmRJbmRleCA9IHRoaXMubV9ib2R5Q291bnQ7XG4gICAgICB0aGlzLm1fYm9kaWVzW3RoaXMubV9ib2R5Q291bnQrK10gPSBib2R5O1xuICAgfVxuICAgYjJJc2xhbmQucHJvdG90eXBlLkFkZENvbnRhY3QgPSBmdW5jdGlvbiAoY29udGFjdCkge1xuICAgICAgdGhpcy5tX2NvbnRhY3RzW3RoaXMubV9jb250YWN0Q291bnQrK10gPSBjb250YWN0O1xuICAgfVxuICAgYjJJc2xhbmQucHJvdG90eXBlLkFkZEpvaW50ID0gZnVuY3Rpb24gKGpvaW50KSB7XG4gICAgICB0aGlzLm1fam9pbnRzW3RoaXMubV9qb2ludENvdW50KytdID0gam9pbnQ7XG4gICB9XG4gICBCb3gyRC5wb3N0RGVmcy5wdXNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIEJveDJELkR5bmFtaWNzLmIySXNsYW5kLnNfaW1wdWxzZSA9IG5ldyBiMkNvbnRhY3RJbXB1bHNlKCk7XG4gICB9KTtcbiAgIGIyVGltZVN0ZXAuYjJUaW1lU3RlcCA9IGZ1bmN0aW9uICgpIHt9O1xuICAgYjJUaW1lU3RlcC5wcm90b3R5cGUuU2V0ID0gZnVuY3Rpb24gKHN0ZXApIHtcbiAgICAgIHRoaXMuZHQgPSBzdGVwLmR0O1xuICAgICAgdGhpcy5pbnZfZHQgPSBzdGVwLmludl9kdDtcbiAgICAgIHRoaXMucG9zaXRpb25JdGVyYXRpb25zID0gc3RlcC5wb3NpdGlvbkl0ZXJhdGlvbnM7XG4gICAgICB0aGlzLnZlbG9jaXR5SXRlcmF0aW9ucyA9IHN0ZXAudmVsb2NpdHlJdGVyYXRpb25zO1xuICAgICAgdGhpcy53YXJtU3RhcnRpbmcgPSBzdGVwLndhcm1TdGFydGluZztcbiAgIH1cbiAgIGIyV29ybGQuYjJXb3JsZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuc19zdGFjayA9IG5ldyBWZWN0b3IoKTtcbiAgICAgIHRoaXMubV9jb250YWN0TWFuYWdlciA9IG5ldyBiMkNvbnRhY3RNYW5hZ2VyKCk7XG4gICAgICB0aGlzLm1fY29udGFjdFNvbHZlciA9IG5ldyBiMkNvbnRhY3RTb2x2ZXIoKTtcbiAgICAgIHRoaXMubV9pc2xhbmQgPSBuZXcgYjJJc2xhbmQoKTtcbiAgIH07XG4gICBiMldvcmxkLnByb3RvdHlwZS5iMldvcmxkID0gZnVuY3Rpb24gKGdyYXZpdHksIGRvU2xlZXApIHtcbiAgICAgIHRoaXMubV9kZXN0cnVjdGlvbkxpc3RlbmVyID0gbnVsbDtcbiAgICAgIHRoaXMubV9kZWJ1Z0RyYXcgPSBudWxsO1xuICAgICAgdGhpcy5tX2JvZHlMaXN0ID0gbnVsbDtcbiAgICAgIHRoaXMubV9jb250YWN0TGlzdCA9IG51bGw7XG4gICAgICB0aGlzLm1fam9pbnRMaXN0ID0gbnVsbDtcbiAgICAgIHRoaXMubV9jb250cm9sbGVyTGlzdCA9IG51bGw7XG4gICAgICB0aGlzLm1fYm9keUNvdW50ID0gMDtcbiAgICAgIHRoaXMubV9jb250YWN0Q291bnQgPSAwO1xuICAgICAgdGhpcy5tX2pvaW50Q291bnQgPSAwO1xuICAgICAgdGhpcy5tX2NvbnRyb2xsZXJDb3VudCA9IDA7XG4gICAgICBiMldvcmxkLm1fd2FybVN0YXJ0aW5nID0gdHJ1ZTtcbiAgICAgIGIyV29ybGQubV9jb250aW51b3VzUGh5c2ljcyA9IHRydWU7XG4gICAgICB0aGlzLm1fYWxsb3dTbGVlcCA9IGRvU2xlZXA7XG4gICAgICB0aGlzLm1fZ3Jhdml0eSA9IGdyYXZpdHk7XG4gICAgICB0aGlzLm1faW52X2R0MCA9IDAuMDtcbiAgICAgIHRoaXMubV9jb250YWN0TWFuYWdlci5tX3dvcmxkID0gdGhpcztcbiAgICAgIHZhciBiZCA9IG5ldyBiMkJvZHlEZWYoKTtcbiAgICAgIHRoaXMubV9ncm91bmRCb2R5ID0gdGhpcy5DcmVhdGVCb2R5KGJkKTtcbiAgIH1cbiAgIGIyV29ybGQucHJvdG90eXBlLlNldERlc3RydWN0aW9uTGlzdGVuZXIgPSBmdW5jdGlvbiAobGlzdGVuZXIpIHtcbiAgICAgIHRoaXMubV9kZXN0cnVjdGlvbkxpc3RlbmVyID0gbGlzdGVuZXI7XG4gICB9XG4gICBiMldvcmxkLnByb3RvdHlwZS5TZXRDb250YWN0RmlsdGVyID0gZnVuY3Rpb24gKGZpbHRlcikge1xuICAgICAgdGhpcy5tX2NvbnRhY3RNYW5hZ2VyLm1fY29udGFjdEZpbHRlciA9IGZpbHRlcjtcbiAgIH1cbiAgIGIyV29ybGQucHJvdG90eXBlLlNldENvbnRhY3RMaXN0ZW5lciA9IGZ1bmN0aW9uIChsaXN0ZW5lcikge1xuICAgICAgdGhpcy5tX2NvbnRhY3RNYW5hZ2VyLm1fY29udGFjdExpc3RlbmVyID0gbGlzdGVuZXI7XG4gICB9XG4gICBiMldvcmxkLnByb3RvdHlwZS5TZXREZWJ1Z0RyYXcgPSBmdW5jdGlvbiAoZGVidWdEcmF3KSB7XG4gICAgICB0aGlzLm1fZGVidWdEcmF3ID0gZGVidWdEcmF3O1xuICAgfVxuICAgYjJXb3JsZC5wcm90b3R5cGUuU2V0QnJvYWRQaGFzZSA9IGZ1bmN0aW9uIChicm9hZFBoYXNlKSB7XG4gICAgICB2YXIgb2xkQnJvYWRQaGFzZSA9IHRoaXMubV9jb250YWN0TWFuYWdlci5tX2Jyb2FkUGhhc2U7XG4gICAgICB0aGlzLm1fY29udGFjdE1hbmFnZXIubV9icm9hZFBoYXNlID0gYnJvYWRQaGFzZTtcbiAgICAgIGZvciAodmFyIGIgPSB0aGlzLm1fYm9keUxpc3Q7IGI7IGIgPSBiLm1fbmV4dCkge1xuICAgICAgICAgZm9yICh2YXIgZiA9IGIubV9maXh0dXJlTGlzdDsgZjsgZiA9IGYubV9uZXh0KSB7XG4gICAgICAgICAgICBmLm1fcHJveHkgPSBicm9hZFBoYXNlLkNyZWF0ZVByb3h5KG9sZEJyb2FkUGhhc2UuR2V0RmF0QUFCQihmLm1fcHJveHkpLCBmKTtcbiAgICAgICAgIH1cbiAgICAgIH1cbiAgIH1cbiAgIGIyV29ybGQucHJvdG90eXBlLlZhbGlkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5tX2NvbnRhY3RNYW5hZ2VyLm1fYnJvYWRQaGFzZS5WYWxpZGF0ZSgpO1xuICAgfVxuICAgYjJXb3JsZC5wcm90b3R5cGUuR2V0UHJveHlDb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fY29udGFjdE1hbmFnZXIubV9icm9hZFBoYXNlLkdldFByb3h5Q291bnQoKTtcbiAgIH1cbiAgIGIyV29ybGQucHJvdG90eXBlLkNyZWF0ZUJvZHkgPSBmdW5jdGlvbiAoZGVmKSB7XG4gICAgICBpZiAodGhpcy5Jc0xvY2tlZCgpID09IHRydWUpIHtcbiAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgdmFyIGIgPSBuZXcgYjJCb2R5KGRlZiwgdGhpcyk7XG4gICAgICBiLm1fcHJldiA9IG51bGw7XG4gICAgICBiLm1fbmV4dCA9IHRoaXMubV9ib2R5TGlzdDtcbiAgICAgIGlmICh0aGlzLm1fYm9keUxpc3QpIHtcbiAgICAgICAgIHRoaXMubV9ib2R5TGlzdC5tX3ByZXYgPSBiO1xuICAgICAgfVxuICAgICAgdGhpcy5tX2JvZHlMaXN0ID0gYjtcbiAgICAgICsrdGhpcy5tX2JvZHlDb3VudDtcbiAgICAgIHJldHVybiBiO1xuICAgfVxuICAgYjJXb3JsZC5wcm90b3R5cGUuRGVzdHJveUJvZHkgPSBmdW5jdGlvbiAoYikge1xuICAgICAgaWYgKHRoaXMuSXNMb2NrZWQoKSA9PSB0cnVlKSB7XG4gICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YXIgam4gPSBiLm1fam9pbnRMaXN0O1xuICAgICAgd2hpbGUgKGpuKSB7XG4gICAgICAgICB2YXIgam4wID0gam47XG4gICAgICAgICBqbiA9IGpuLm5leHQ7XG4gICAgICAgICBpZiAodGhpcy5tX2Rlc3RydWN0aW9uTGlzdGVuZXIpIHtcbiAgICAgICAgICAgIHRoaXMubV9kZXN0cnVjdGlvbkxpc3RlbmVyLlNheUdvb2RieWVKb2ludChqbjAuam9pbnQpO1xuICAgICAgICAgfVxuICAgICAgICAgdGhpcy5EZXN0cm95Sm9pbnQoam4wLmpvaW50KTtcbiAgICAgIH1cbiAgICAgIHZhciBjb2UgPSBiLm1fY29udHJvbGxlckxpc3Q7XG4gICAgICB3aGlsZSAoY29lKSB7XG4gICAgICAgICB2YXIgY29lMCA9IGNvZTtcbiAgICAgICAgIGNvZSA9IGNvZS5uZXh0Q29udHJvbGxlcjtcbiAgICAgICAgIGNvZTAuY29udHJvbGxlci5SZW1vdmVCb2R5KGIpO1xuICAgICAgfVxuICAgICAgdmFyIGNlID0gYi5tX2NvbnRhY3RMaXN0O1xuICAgICAgd2hpbGUgKGNlKSB7XG4gICAgICAgICB2YXIgY2UwID0gY2U7XG4gICAgICAgICBjZSA9IGNlLm5leHQ7XG4gICAgICAgICB0aGlzLm1fY29udGFjdE1hbmFnZXIuRGVzdHJveShjZTAuY29udGFjdCk7XG4gICAgICB9XG4gICAgICBiLm1fY29udGFjdExpc3QgPSBudWxsO1xuICAgICAgdmFyIGYgPSBiLm1fZml4dHVyZUxpc3Q7XG4gICAgICB3aGlsZSAoZikge1xuICAgICAgICAgdmFyIGYwID0gZjtcbiAgICAgICAgIGYgPSBmLm1fbmV4dDtcbiAgICAgICAgIGlmICh0aGlzLm1fZGVzdHJ1Y3Rpb25MaXN0ZW5lcikge1xuICAgICAgICAgICAgdGhpcy5tX2Rlc3RydWN0aW9uTGlzdGVuZXIuU2F5R29vZGJ5ZUZpeHR1cmUoZjApO1xuICAgICAgICAgfVxuICAgICAgICAgZjAuRGVzdHJveVByb3h5KHRoaXMubV9jb250YWN0TWFuYWdlci5tX2Jyb2FkUGhhc2UpO1xuICAgICAgICAgZjAuRGVzdHJveSgpO1xuICAgICAgfVxuICAgICAgYi5tX2ZpeHR1cmVMaXN0ID0gbnVsbDtcbiAgICAgIGIubV9maXh0dXJlQ291bnQgPSAwO1xuICAgICAgaWYgKGIubV9wcmV2KSB7XG4gICAgICAgICBiLm1fcHJldi5tX25leHQgPSBiLm1fbmV4dDtcbiAgICAgIH1cbiAgICAgIGlmIChiLm1fbmV4dCkge1xuICAgICAgICAgYi5tX25leHQubV9wcmV2ID0gYi5tX3ByZXY7XG4gICAgICB9XG4gICAgICBpZiAoYiA9PSB0aGlzLm1fYm9keUxpc3QpIHtcbiAgICAgICAgIHRoaXMubV9ib2R5TGlzdCA9IGIubV9uZXh0O1xuICAgICAgfS0tdGhpcy5tX2JvZHlDb3VudDtcbiAgIH1cbiAgIGIyV29ybGQucHJvdG90eXBlLkNyZWF0ZUpvaW50ID0gZnVuY3Rpb24gKGRlZikge1xuICAgICAgdmFyIGogPSBiMkpvaW50LkNyZWF0ZShkZWYsIG51bGwpO1xuICAgICAgai5tX3ByZXYgPSBudWxsO1xuICAgICAgai5tX25leHQgPSB0aGlzLm1fam9pbnRMaXN0O1xuICAgICAgaWYgKHRoaXMubV9qb2ludExpc3QpIHtcbiAgICAgICAgIHRoaXMubV9qb2ludExpc3QubV9wcmV2ID0gajtcbiAgICAgIH1cbiAgICAgIHRoaXMubV9qb2ludExpc3QgPSBqO1xuICAgICAgKyt0aGlzLm1fam9pbnRDb3VudDtcbiAgICAgIGoubV9lZGdlQS5qb2ludCA9IGo7XG4gICAgICBqLm1fZWRnZUEub3RoZXIgPSBqLm1fYm9keUI7XG4gICAgICBqLm1fZWRnZUEucHJldiA9IG51bGw7XG4gICAgICBqLm1fZWRnZUEubmV4dCA9IGoubV9ib2R5QS5tX2pvaW50TGlzdDtcbiAgICAgIGlmIChqLm1fYm9keUEubV9qb2ludExpc3QpIGoubV9ib2R5QS5tX2pvaW50TGlzdC5wcmV2ID0gai5tX2VkZ2VBO1xuICAgICAgai5tX2JvZHlBLm1fam9pbnRMaXN0ID0gai5tX2VkZ2VBO1xuICAgICAgai5tX2VkZ2VCLmpvaW50ID0gajtcbiAgICAgIGoubV9lZGdlQi5vdGhlciA9IGoubV9ib2R5QTtcbiAgICAgIGoubV9lZGdlQi5wcmV2ID0gbnVsbDtcbiAgICAgIGoubV9lZGdlQi5uZXh0ID0gai5tX2JvZHlCLm1fam9pbnRMaXN0O1xuICAgICAgaWYgKGoubV9ib2R5Qi5tX2pvaW50TGlzdCkgai5tX2JvZHlCLm1fam9pbnRMaXN0LnByZXYgPSBqLm1fZWRnZUI7XG4gICAgICBqLm1fYm9keUIubV9qb2ludExpc3QgPSBqLm1fZWRnZUI7XG4gICAgICB2YXIgYm9keUEgPSBkZWYuYm9keUE7XG4gICAgICB2YXIgYm9keUIgPSBkZWYuYm9keUI7XG4gICAgICBpZiAoZGVmLmNvbGxpZGVDb25uZWN0ZWQgPT0gZmFsc2UpIHtcbiAgICAgICAgIHZhciBlZGdlID0gYm9keUIuR2V0Q29udGFjdExpc3QoKTtcbiAgICAgICAgIHdoaWxlIChlZGdlKSB7XG4gICAgICAgICAgICBpZiAoZWRnZS5vdGhlciA9PSBib2R5QSkge1xuICAgICAgICAgICAgICAgZWRnZS5jb250YWN0LkZsYWdGb3JGaWx0ZXJpbmcoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVkZ2UgPSBlZGdlLm5leHQ7XG4gICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gajtcbiAgIH1cbiAgIGIyV29ybGQucHJvdG90eXBlLkRlc3Ryb3lKb2ludCA9IGZ1bmN0aW9uIChqKSB7XG4gICAgICB2YXIgY29sbGlkZUNvbm5lY3RlZCA9IGoubV9jb2xsaWRlQ29ubmVjdGVkO1xuICAgICAgaWYgKGoubV9wcmV2KSB7XG4gICAgICAgICBqLm1fcHJldi5tX25leHQgPSBqLm1fbmV4dDtcbiAgICAgIH1cbiAgICAgIGlmIChqLm1fbmV4dCkge1xuICAgICAgICAgai5tX25leHQubV9wcmV2ID0gai5tX3ByZXY7XG4gICAgICB9XG4gICAgICBpZiAoaiA9PSB0aGlzLm1fam9pbnRMaXN0KSB7XG4gICAgICAgICB0aGlzLm1fam9pbnRMaXN0ID0gai5tX25leHQ7XG4gICAgICB9XG4gICAgICB2YXIgYm9keUEgPSBqLm1fYm9keUE7XG4gICAgICB2YXIgYm9keUIgPSBqLm1fYm9keUI7XG4gICAgICBib2R5QS5TZXRBd2FrZSh0cnVlKTtcbiAgICAgIGJvZHlCLlNldEF3YWtlKHRydWUpO1xuICAgICAgaWYgKGoubV9lZGdlQS5wcmV2KSB7XG4gICAgICAgICBqLm1fZWRnZUEucHJldi5uZXh0ID0gai5tX2VkZ2VBLm5leHQ7XG4gICAgICB9XG4gICAgICBpZiAoai5tX2VkZ2VBLm5leHQpIHtcbiAgICAgICAgIGoubV9lZGdlQS5uZXh0LnByZXYgPSBqLm1fZWRnZUEucHJldjtcbiAgICAgIH1cbiAgICAgIGlmIChqLm1fZWRnZUEgPT0gYm9keUEubV9qb2ludExpc3QpIHtcbiAgICAgICAgIGJvZHlBLm1fam9pbnRMaXN0ID0gai5tX2VkZ2VBLm5leHQ7XG4gICAgICB9XG4gICAgICBqLm1fZWRnZUEucHJldiA9IG51bGw7XG4gICAgICBqLm1fZWRnZUEubmV4dCA9IG51bGw7XG4gICAgICBpZiAoai5tX2VkZ2VCLnByZXYpIHtcbiAgICAgICAgIGoubV9lZGdlQi5wcmV2Lm5leHQgPSBqLm1fZWRnZUIubmV4dDtcbiAgICAgIH1cbiAgICAgIGlmIChqLm1fZWRnZUIubmV4dCkge1xuICAgICAgICAgai5tX2VkZ2VCLm5leHQucHJldiA9IGoubV9lZGdlQi5wcmV2O1xuICAgICAgfVxuICAgICAgaWYgKGoubV9lZGdlQiA9PSBib2R5Qi5tX2pvaW50TGlzdCkge1xuICAgICAgICAgYm9keUIubV9qb2ludExpc3QgPSBqLm1fZWRnZUIubmV4dDtcbiAgICAgIH1cbiAgICAgIGoubV9lZGdlQi5wcmV2ID0gbnVsbDtcbiAgICAgIGoubV9lZGdlQi5uZXh0ID0gbnVsbDtcbiAgICAgIGIySm9pbnQuRGVzdHJveShqLCBudWxsKTtcbiAgICAgIC0tdGhpcy5tX2pvaW50Q291bnQ7XG4gICAgICBpZiAoY29sbGlkZUNvbm5lY3RlZCA9PSBmYWxzZSkge1xuICAgICAgICAgdmFyIGVkZ2UgPSBib2R5Qi5HZXRDb250YWN0TGlzdCgpO1xuICAgICAgICAgd2hpbGUgKGVkZ2UpIHtcbiAgICAgICAgICAgIGlmIChlZGdlLm90aGVyID09IGJvZHlBKSB7XG4gICAgICAgICAgICAgICBlZGdlLmNvbnRhY3QuRmxhZ0ZvckZpbHRlcmluZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWRnZSA9IGVkZ2UubmV4dDtcbiAgICAgICAgIH1cbiAgICAgIH1cbiAgIH1cbiAgIGIyV29ybGQucHJvdG90eXBlLkFkZENvbnRyb2xsZXIgPSBmdW5jdGlvbiAoYykge1xuICAgICAgYy5tX25leHQgPSB0aGlzLm1fY29udHJvbGxlckxpc3Q7XG4gICAgICBjLm1fcHJldiA9IG51bGw7XG4gICAgICB0aGlzLm1fY29udHJvbGxlckxpc3QgPSBjO1xuICAgICAgYy5tX3dvcmxkID0gdGhpcztcbiAgICAgIHRoaXMubV9jb250cm9sbGVyQ291bnQrKztcbiAgICAgIHJldHVybiBjO1xuICAgfVxuICAgYjJXb3JsZC5wcm90b3R5cGUuUmVtb3ZlQ29udHJvbGxlciA9IGZ1bmN0aW9uIChjKSB7XG4gICAgICBpZiAoYy5tX3ByZXYpIGMubV9wcmV2Lm1fbmV4dCA9IGMubV9uZXh0O1xuICAgICAgaWYgKGMubV9uZXh0KSBjLm1fbmV4dC5tX3ByZXYgPSBjLm1fcHJldjtcbiAgICAgIGlmICh0aGlzLm1fY29udHJvbGxlckxpc3QgPT0gYykgdGhpcy5tX2NvbnRyb2xsZXJMaXN0ID0gYy5tX25leHQ7XG4gICAgICB0aGlzLm1fY29udHJvbGxlckNvdW50LS07XG4gICB9XG4gICBiMldvcmxkLnByb3RvdHlwZS5DcmVhdGVDb250cm9sbGVyID0gZnVuY3Rpb24gKGNvbnRyb2xsZXIpIHtcbiAgICAgIGlmIChjb250cm9sbGVyLm1fd29ybGQgIT0gdGhpcykgdGhyb3cgbmV3IEVycm9yKFwiQ29udHJvbGxlciBjYW4gb25seSBiZSBhIG1lbWJlciBvZiBvbmUgd29ybGRcIik7XG4gICAgICBjb250cm9sbGVyLm1fbmV4dCA9IHRoaXMubV9jb250cm9sbGVyTGlzdDtcbiAgICAgIGNvbnRyb2xsZXIubV9wcmV2ID0gbnVsbDtcbiAgICAgIGlmICh0aGlzLm1fY29udHJvbGxlckxpc3QpIHRoaXMubV9jb250cm9sbGVyTGlzdC5tX3ByZXYgPSBjb250cm9sbGVyO1xuICAgICAgdGhpcy5tX2NvbnRyb2xsZXJMaXN0ID0gY29udHJvbGxlcjtcbiAgICAgICsrdGhpcy5tX2NvbnRyb2xsZXJDb3VudDtcbiAgICAgIGNvbnRyb2xsZXIubV93b3JsZCA9IHRoaXM7XG4gICAgICByZXR1cm4gY29udHJvbGxlcjtcbiAgIH1cbiAgIGIyV29ybGQucHJvdG90eXBlLkRlc3Ryb3lDb250cm9sbGVyID0gZnVuY3Rpb24gKGNvbnRyb2xsZXIpIHtcbiAgICAgIGNvbnRyb2xsZXIuQ2xlYXIoKTtcbiAgICAgIGlmIChjb250cm9sbGVyLm1fbmV4dCkgY29udHJvbGxlci5tX25leHQubV9wcmV2ID0gY29udHJvbGxlci5tX3ByZXY7XG4gICAgICBpZiAoY29udHJvbGxlci5tX3ByZXYpIGNvbnRyb2xsZXIubV9wcmV2Lm1fbmV4dCA9IGNvbnRyb2xsZXIubV9uZXh0O1xuICAgICAgaWYgKGNvbnRyb2xsZXIgPT0gdGhpcy5tX2NvbnRyb2xsZXJMaXN0KSB0aGlzLm1fY29udHJvbGxlckxpc3QgPSBjb250cm9sbGVyLm1fbmV4dDtcbiAgICAgIC0tdGhpcy5tX2NvbnRyb2xsZXJDb3VudDtcbiAgIH1cbiAgIGIyV29ybGQucHJvdG90eXBlLlNldFdhcm1TdGFydGluZyA9IGZ1bmN0aW9uIChmbGFnKSB7XG4gICAgICBiMldvcmxkLm1fd2FybVN0YXJ0aW5nID0gZmxhZztcbiAgIH1cbiAgIGIyV29ybGQucHJvdG90eXBlLlNldENvbnRpbnVvdXNQaHlzaWNzID0gZnVuY3Rpb24gKGZsYWcpIHtcbiAgICAgIGIyV29ybGQubV9jb250aW51b3VzUGh5c2ljcyA9IGZsYWc7XG4gICB9XG4gICBiMldvcmxkLnByb3RvdHlwZS5HZXRCb2R5Q291bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlDb3VudDtcbiAgIH1cbiAgIGIyV29ybGQucHJvdG90eXBlLkdldEpvaW50Q291bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX2pvaW50Q291bnQ7XG4gICB9XG4gICBiMldvcmxkLnByb3RvdHlwZS5HZXRDb250YWN0Q291bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX2NvbnRhY3RDb3VudDtcbiAgIH1cbiAgIGIyV29ybGQucHJvdG90eXBlLlNldEdyYXZpdHkgPSBmdW5jdGlvbiAoZ3Jhdml0eSkge1xuICAgICAgdGhpcy5tX2dyYXZpdHkgPSBncmF2aXR5O1xuICAgfVxuICAgYjJXb3JsZC5wcm90b3R5cGUuR2V0R3Jhdml0eSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fZ3Jhdml0eTtcbiAgIH1cbiAgIGIyV29ybGQucHJvdG90eXBlLkdldEdyb3VuZEJvZHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX2dyb3VuZEJvZHk7XG4gICB9XG4gICBiMldvcmxkLnByb3RvdHlwZS5TdGVwID0gZnVuY3Rpb24gKGR0LCB2ZWxvY2l0eUl0ZXJhdGlvbnMsIHBvc2l0aW9uSXRlcmF0aW9ucykge1xuICAgICAgaWYgKGR0ID09PSB1bmRlZmluZWQpIGR0ID0gMDtcbiAgICAgIGlmICh2ZWxvY2l0eUl0ZXJhdGlvbnMgPT09IHVuZGVmaW5lZCkgdmVsb2NpdHlJdGVyYXRpb25zID0gMDtcbiAgICAgIGlmIChwb3NpdGlvbkl0ZXJhdGlvbnMgPT09IHVuZGVmaW5lZCkgcG9zaXRpb25JdGVyYXRpb25zID0gMDtcbiAgICAgIGlmICh0aGlzLm1fZmxhZ3MgJiBiMldvcmxkLmVfbmV3Rml4dHVyZSkge1xuICAgICAgICAgdGhpcy5tX2NvbnRhY3RNYW5hZ2VyLkZpbmROZXdDb250YWN0cygpO1xuICAgICAgICAgdGhpcy5tX2ZsYWdzICY9IH5iMldvcmxkLmVfbmV3Rml4dHVyZTtcbiAgICAgIH1cbiAgICAgIHRoaXMubV9mbGFncyB8PSBiMldvcmxkLmVfbG9ja2VkO1xuICAgICAgdmFyIHN0ZXAgPSBiMldvcmxkLnNfdGltZXN0ZXAyO1xuICAgICAgc3RlcC5kdCA9IGR0O1xuICAgICAgc3RlcC52ZWxvY2l0eUl0ZXJhdGlvbnMgPSB2ZWxvY2l0eUl0ZXJhdGlvbnM7XG4gICAgICBzdGVwLnBvc2l0aW9uSXRlcmF0aW9ucyA9IHBvc2l0aW9uSXRlcmF0aW9ucztcbiAgICAgIGlmIChkdCA+IDAuMCkge1xuICAgICAgICAgc3RlcC5pbnZfZHQgPSAxLjAgLyBkdDtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICAgc3RlcC5pbnZfZHQgPSAwLjA7XG4gICAgICB9XG4gICAgICBzdGVwLmR0UmF0aW8gPSB0aGlzLm1faW52X2R0MCAqIGR0O1xuICAgICAgc3RlcC53YXJtU3RhcnRpbmcgPSBiMldvcmxkLm1fd2FybVN0YXJ0aW5nO1xuICAgICAgdGhpcy5tX2NvbnRhY3RNYW5hZ2VyLkNvbGxpZGUoKTtcbiAgICAgIGlmIChzdGVwLmR0ID4gMC4wKSB7XG4gICAgICAgICB0aGlzLlNvbHZlKHN0ZXApO1xuICAgICAgfVxuICAgICAgaWYgKGIyV29ybGQubV9jb250aW51b3VzUGh5c2ljcyAmJiBzdGVwLmR0ID4gMC4wKSB7XG4gICAgICAgICB0aGlzLlNvbHZlVE9JKHN0ZXApO1xuICAgICAgfVxuICAgICAgaWYgKHN0ZXAuZHQgPiAwLjApIHtcbiAgICAgICAgIHRoaXMubV9pbnZfZHQwID0gc3RlcC5pbnZfZHQ7XG4gICAgICB9XG4gICAgICB0aGlzLm1fZmxhZ3MgJj0gfmIyV29ybGQuZV9sb2NrZWQ7XG4gICB9XG4gICBiMldvcmxkLnByb3RvdHlwZS5DbGVhckZvcmNlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGZvciAodmFyIGJvZHkgPSB0aGlzLm1fYm9keUxpc3Q7IGJvZHk7IGJvZHkgPSBib2R5Lm1fbmV4dCkge1xuICAgICAgICAgYm9keS5tX2ZvcmNlLlNldFplcm8oKTtcbiAgICAgICAgIGJvZHkubV90b3JxdWUgPSAwLjA7XG4gICAgICB9XG4gICB9XG4gICBiMldvcmxkLnByb3RvdHlwZS5EcmF3RGVidWdEYXRhID0gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKHRoaXMubV9kZWJ1Z0RyYXcgPT0gbnVsbCkge1xuICAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy5tX2RlYnVnRHJhdy5tX3Nwcml0ZS5ncmFwaGljcy5jbGVhcigpO1xuICAgICAgdmFyIGZsYWdzID0gdGhpcy5tX2RlYnVnRHJhdy5HZXRGbGFncygpO1xuICAgICAgdmFyIGkgPSAwO1xuICAgICAgdmFyIGI7XG4gICAgICB2YXIgZjtcbiAgICAgIHZhciBzO1xuICAgICAgdmFyIGo7XG4gICAgICB2YXIgYnA7XG4gICAgICB2YXIgaW52USA9IG5ldyBiMlZlYzI7XG4gICAgICB2YXIgeDEgPSBuZXcgYjJWZWMyO1xuICAgICAgdmFyIHgyID0gbmV3IGIyVmVjMjtcbiAgICAgIHZhciB4ZjtcbiAgICAgIHZhciBiMSA9IG5ldyBiMkFBQkIoKTtcbiAgICAgIHZhciBiMiA9IG5ldyBiMkFBQkIoKTtcbiAgICAgIHZhciB2cyA9IFtuZXcgYjJWZWMyKCksIG5ldyBiMlZlYzIoKSwgbmV3IGIyVmVjMigpLCBuZXcgYjJWZWMyKCldO1xuICAgICAgdmFyIGNvbG9yID0gbmV3IGIyQ29sb3IoMCwgMCwgMCk7XG4gICAgICBpZiAoZmxhZ3MgJiBiMkRlYnVnRHJhdy5lX3NoYXBlQml0KSB7XG4gICAgICAgICBmb3IgKGIgPSB0aGlzLm1fYm9keUxpc3Q7XG4gICAgICAgICBiOyBiID0gYi5tX25leHQpIHtcbiAgICAgICAgICAgIHhmID0gYi5tX3hmO1xuICAgICAgICAgICAgZm9yIChmID0gYi5HZXRGaXh0dXJlTGlzdCgpO1xuICAgICAgICAgICAgZjsgZiA9IGYubV9uZXh0KSB7XG4gICAgICAgICAgICAgICBzID0gZi5HZXRTaGFwZSgpO1xuICAgICAgICAgICAgICAgaWYgKGIuSXNBY3RpdmUoKSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgY29sb3IuU2V0KDAuNSwgMC41LCAwLjMpO1xuICAgICAgICAgICAgICAgICAgdGhpcy5EcmF3U2hhcGUocywgeGYsIGNvbG9yKTtcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgIGVsc2UgaWYgKGIuR2V0VHlwZSgpID09IGIyQm9keS5iMl9zdGF0aWNCb2R5KSB7XG4gICAgICAgICAgICAgICAgICBjb2xvci5TZXQoMC41LCAwLjksIDAuNSk7XG4gICAgICAgICAgICAgICAgICB0aGlzLkRyYXdTaGFwZShzLCB4ZiwgY29sb3IpO1xuICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgZWxzZSBpZiAoYi5HZXRUeXBlKCkgPT0gYjJCb2R5LmIyX2tpbmVtYXRpY0JvZHkpIHtcbiAgICAgICAgICAgICAgICAgIGNvbG9yLlNldCgwLjUsIDAuNSwgMC45KTtcbiAgICAgICAgICAgICAgICAgIHRoaXMuRHJhd1NoYXBlKHMsIHhmLCBjb2xvcik7XG4gICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICBlbHNlIGlmIChiLklzQXdha2UoKSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgY29sb3IuU2V0KDAuNiwgMC42LCAwLjYpO1xuICAgICAgICAgICAgICAgICAgdGhpcy5EcmF3U2hhcGUocywgeGYsIGNvbG9yKTtcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgY29sb3IuU2V0KDAuOSwgMC43LCAwLjcpO1xuICAgICAgICAgICAgICAgICAgdGhpcy5EcmF3U2hhcGUocywgeGYsIGNvbG9yKTtcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChmbGFncyAmIGIyRGVidWdEcmF3LmVfam9pbnRCaXQpIHtcbiAgICAgICAgIGZvciAoaiA9IHRoaXMubV9qb2ludExpc3Q7XG4gICAgICAgICBqOyBqID0gai5tX25leHQpIHtcbiAgICAgICAgICAgIHRoaXMuRHJhd0pvaW50KGopO1xuICAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKGZsYWdzICYgYjJEZWJ1Z0RyYXcuZV9jb250cm9sbGVyQml0KSB7XG4gICAgICAgICBmb3IgKHZhciBjID0gdGhpcy5tX2NvbnRyb2xsZXJMaXN0OyBjOyBjID0gYy5tX25leHQpIHtcbiAgICAgICAgICAgIGMuRHJhdyh0aGlzLm1fZGVidWdEcmF3KTtcbiAgICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChmbGFncyAmIGIyRGVidWdEcmF3LmVfcGFpckJpdCkge1xuICAgICAgICAgY29sb3IuU2V0KDAuMywgMC45LCAwLjkpO1xuICAgICAgICAgZm9yICh2YXIgY29udGFjdCA9IHRoaXMubV9jb250YWN0TWFuYWdlci5tX2NvbnRhY3RMaXN0OyBjb250YWN0OyBjb250YWN0ID0gY29udGFjdC5HZXROZXh0KCkpIHtcbiAgICAgICAgICAgIHZhciBmaXh0dXJlQSA9IGNvbnRhY3QuR2V0Rml4dHVyZUEoKTtcbiAgICAgICAgICAgIHZhciBmaXh0dXJlQiA9IGNvbnRhY3QuR2V0Rml4dHVyZUIoKTtcbiAgICAgICAgICAgIHZhciBjQSA9IGZpeHR1cmVBLkdldEFBQkIoKS5HZXRDZW50ZXIoKTtcbiAgICAgICAgICAgIHZhciBjQiA9IGZpeHR1cmVCLkdldEFBQkIoKS5HZXRDZW50ZXIoKTtcbiAgICAgICAgICAgIHRoaXMubV9kZWJ1Z0RyYXcuRHJhd1NlZ21lbnQoY0EsIGNCLCBjb2xvcik7XG4gICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoZmxhZ3MgJiBiMkRlYnVnRHJhdy5lX2FhYmJCaXQpIHtcbiAgICAgICAgIGJwID0gdGhpcy5tX2NvbnRhY3RNYW5hZ2VyLm1fYnJvYWRQaGFzZTtcbiAgICAgICAgIHZzID0gW25ldyBiMlZlYzIoKSwgbmV3IGIyVmVjMigpLCBuZXcgYjJWZWMyKCksIG5ldyBiMlZlYzIoKV07XG4gICAgICAgICBmb3IgKGIgPSB0aGlzLm1fYm9keUxpc3Q7XG4gICAgICAgICBiOyBiID0gYi5HZXROZXh0KCkpIHtcbiAgICAgICAgICAgIGlmIChiLklzQWN0aXZlKCkgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChmID0gYi5HZXRGaXh0dXJlTGlzdCgpO1xuICAgICAgICAgICAgZjsgZiA9IGYuR2V0TmV4dCgpKSB7XG4gICAgICAgICAgICAgICB2YXIgYWFiYiA9IGJwLkdldEZhdEFBQkIoZi5tX3Byb3h5KTtcbiAgICAgICAgICAgICAgIHZzWzBdLlNldChhYWJiLmxvd2VyQm91bmQueCwgYWFiYi5sb3dlckJvdW5kLnkpO1xuICAgICAgICAgICAgICAgdnNbMV0uU2V0KGFhYmIudXBwZXJCb3VuZC54LCBhYWJiLmxvd2VyQm91bmQueSk7XG4gICAgICAgICAgICAgICB2c1syXS5TZXQoYWFiYi51cHBlckJvdW5kLngsIGFhYmIudXBwZXJCb3VuZC55KTtcbiAgICAgICAgICAgICAgIHZzWzNdLlNldChhYWJiLmxvd2VyQm91bmQueCwgYWFiYi51cHBlckJvdW5kLnkpO1xuICAgICAgICAgICAgICAgdGhpcy5tX2RlYnVnRHJhdy5EcmF3UG9seWdvbih2cywgNCwgY29sb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKGZsYWdzICYgYjJEZWJ1Z0RyYXcuZV9jZW50ZXJPZk1hc3NCaXQpIHtcbiAgICAgICAgIGZvciAoYiA9IHRoaXMubV9ib2R5TGlzdDtcbiAgICAgICAgIGI7IGIgPSBiLm1fbmV4dCkge1xuICAgICAgICAgICAgeGYgPSBiMldvcmxkLnNfeGY7XG4gICAgICAgICAgICB4Zi5SID0gYi5tX3hmLlI7XG4gICAgICAgICAgICB4Zi5wb3NpdGlvbiA9IGIuR2V0V29ybGRDZW50ZXIoKTtcbiAgICAgICAgICAgIHRoaXMubV9kZWJ1Z0RyYXcuRHJhd1RyYW5zZm9ybSh4Zik7XG4gICAgICAgICB9XG4gICAgICB9XG4gICB9XG4gICBiMldvcmxkLnByb3RvdHlwZS5RdWVyeUFBQkIgPSBmdW5jdGlvbiAoY2FsbGJhY2ssIGFhYmIpIHtcbiAgICAgIHZhciBfX3RoaXMgPSB0aGlzO1xuICAgICAgdmFyIGJyb2FkUGhhc2UgPSBfX3RoaXMubV9jb250YWN0TWFuYWdlci5tX2Jyb2FkUGhhc2U7XG5cbiAgICAgIGZ1bmN0aW9uIFdvcmxkUXVlcnlXcmFwcGVyKHByb3h5KSB7XG4gICAgICAgICByZXR1cm4gY2FsbGJhY2soYnJvYWRQaGFzZS5HZXRVc2VyRGF0YShwcm94eSkpO1xuICAgICAgfTtcbiAgICAgIGJyb2FkUGhhc2UuUXVlcnkoV29ybGRRdWVyeVdyYXBwZXIsIGFhYmIpO1xuICAgfVxuICAgYjJXb3JsZC5wcm90b3R5cGUuUXVlcnlTaGFwZSA9IGZ1bmN0aW9uIChjYWxsYmFjaywgc2hhcGUsIHRyYW5zZm9ybSkge1xuICAgICAgdmFyIF9fdGhpcyA9IHRoaXM7XG4gICAgICBpZiAodHJhbnNmb3JtID09PSB1bmRlZmluZWQpIHRyYW5zZm9ybSA9IG51bGw7XG4gICAgICBpZiAodHJhbnNmb3JtID09IG51bGwpIHtcbiAgICAgICAgIHRyYW5zZm9ybSA9IG5ldyBiMlRyYW5zZm9ybSgpO1xuICAgICAgICAgdHJhbnNmb3JtLlNldElkZW50aXR5KCk7XG4gICAgICB9XG4gICAgICB2YXIgYnJvYWRQaGFzZSA9IF9fdGhpcy5tX2NvbnRhY3RNYW5hZ2VyLm1fYnJvYWRQaGFzZTtcblxuICAgICAgZnVuY3Rpb24gV29ybGRRdWVyeVdyYXBwZXIocHJveHkpIHtcbiAgICAgICAgIHZhciBmaXh0dXJlID0gKGJyb2FkUGhhc2UuR2V0VXNlckRhdGEocHJveHkpIGluc3RhbmNlb2YgYjJGaXh0dXJlID8gYnJvYWRQaGFzZS5HZXRVc2VyRGF0YShwcm94eSkgOiBudWxsKTtcbiAgICAgICAgIGlmIChiMlNoYXBlLlRlc3RPdmVybGFwKHNoYXBlLCB0cmFuc2Zvcm0sIGZpeHR1cmUuR2V0U2hhcGUoKSwgZml4dHVyZS5HZXRCb2R5KCkuR2V0VHJhbnNmb3JtKCkpKSByZXR1cm4gY2FsbGJhY2soZml4dHVyZSk7XG4gICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH07XG4gICAgICB2YXIgYWFiYiA9IG5ldyBiMkFBQkIoKTtcbiAgICAgIHNoYXBlLkNvbXB1dGVBQUJCKGFhYmIsIHRyYW5zZm9ybSk7XG4gICAgICBicm9hZFBoYXNlLlF1ZXJ5KFdvcmxkUXVlcnlXcmFwcGVyLCBhYWJiKTtcbiAgIH1cbiAgIGIyV29ybGQucHJvdG90eXBlLlF1ZXJ5UG9pbnQgPSBmdW5jdGlvbiAoY2FsbGJhY2ssIHApIHtcbiAgICAgIHZhciBfX3RoaXMgPSB0aGlzO1xuICAgICAgdmFyIGJyb2FkUGhhc2UgPSBfX3RoaXMubV9jb250YWN0TWFuYWdlci5tX2Jyb2FkUGhhc2U7XG5cbiAgICAgIGZ1bmN0aW9uIFdvcmxkUXVlcnlXcmFwcGVyKHByb3h5KSB7XG4gICAgICAgICB2YXIgZml4dHVyZSA9IChicm9hZFBoYXNlLkdldFVzZXJEYXRhKHByb3h5KSBpbnN0YW5jZW9mIGIyRml4dHVyZSA/IGJyb2FkUGhhc2UuR2V0VXNlckRhdGEocHJveHkpIDogbnVsbCk7XG4gICAgICAgICBpZiAoZml4dHVyZS5UZXN0UG9pbnQocCkpIHJldHVybiBjYWxsYmFjayhmaXh0dXJlKTtcbiAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfTtcbiAgICAgIHZhciBhYWJiID0gbmV3IGIyQUFCQigpO1xuICAgICAgYWFiYi5sb3dlckJvdW5kLlNldChwLnggLSBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3AsIHAueSAtIGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCk7XG4gICAgICBhYWJiLnVwcGVyQm91bmQuU2V0KHAueCArIGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCwgcC55ICsgYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wKTtcbiAgICAgIGJyb2FkUGhhc2UuUXVlcnkoV29ybGRRdWVyeVdyYXBwZXIsIGFhYmIpO1xuICAgfVxuICAgYjJXb3JsZC5wcm90b3R5cGUuUmF5Q2FzdCA9IGZ1bmN0aW9uIChjYWxsYmFjaywgcG9pbnQxLCBwb2ludDIpIHtcbiAgICAgIHZhciBfX3RoaXMgPSB0aGlzO1xuICAgICAgdmFyIGJyb2FkUGhhc2UgPSBfX3RoaXMubV9jb250YWN0TWFuYWdlci5tX2Jyb2FkUGhhc2U7XG4gICAgICB2YXIgb3V0cHV0ID0gbmV3IGIyUmF5Q2FzdE91dHB1dDtcblxuICAgICAgZnVuY3Rpb24gUmF5Q2FzdFdyYXBwZXIoaW5wdXQsIHByb3h5KSB7XG4gICAgICAgICB2YXIgdXNlckRhdGEgPSBicm9hZFBoYXNlLkdldFVzZXJEYXRhKHByb3h5KTtcbiAgICAgICAgIHZhciBmaXh0dXJlID0gKHVzZXJEYXRhIGluc3RhbmNlb2YgYjJGaXh0dXJlID8gdXNlckRhdGEgOiBudWxsKTtcbiAgICAgICAgIHZhciBoaXQgPSBmaXh0dXJlLlJheUNhc3Qob3V0cHV0LCBpbnB1dCk7XG4gICAgICAgICBpZiAoaGl0KSB7XG4gICAgICAgICAgICB2YXIgZnJhY3Rpb24gPSBvdXRwdXQuZnJhY3Rpb247XG4gICAgICAgICAgICB2YXIgcG9pbnQgPSBuZXcgYjJWZWMyKCgxLjAgLSBmcmFjdGlvbikgKiBwb2ludDEueCArIGZyYWN0aW9uICogcG9pbnQyLngsICgxLjAgLSBmcmFjdGlvbikgKiBwb2ludDEueSArIGZyYWN0aW9uICogcG9pbnQyLnkpO1xuICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKGZpeHR1cmUsIHBvaW50LCBvdXRwdXQubm9ybWFsLCBmcmFjdGlvbik7XG4gICAgICAgICB9XG4gICAgICAgICByZXR1cm4gaW5wdXQubWF4RnJhY3Rpb247XG4gICAgICB9O1xuICAgICAgdmFyIGlucHV0ID0gbmV3IGIyUmF5Q2FzdElucHV0KHBvaW50MSwgcG9pbnQyKTtcbiAgICAgIGJyb2FkUGhhc2UuUmF5Q2FzdChSYXlDYXN0V3JhcHBlciwgaW5wdXQpO1xuICAgfVxuICAgYjJXb3JsZC5wcm90b3R5cGUuUmF5Q2FzdE9uZSA9IGZ1bmN0aW9uIChwb2ludDEsIHBvaW50Mikge1xuICAgICAgdmFyIF9fdGhpcyA9IHRoaXM7XG4gICAgICB2YXIgcmVzdWx0O1xuXG4gICAgICBmdW5jdGlvbiBSYXlDYXN0T25lV3JhcHBlcihmaXh0dXJlLCBwb2ludCwgbm9ybWFsLCBmcmFjdGlvbikge1xuICAgICAgICAgaWYgKGZyYWN0aW9uID09PSB1bmRlZmluZWQpIGZyYWN0aW9uID0gMDtcbiAgICAgICAgIHJlc3VsdCA9IGZpeHR1cmU7XG4gICAgICAgICByZXR1cm4gZnJhY3Rpb247XG4gICAgICB9O1xuICAgICAgX190aGlzLlJheUNhc3QoUmF5Q2FzdE9uZVdyYXBwZXIsIHBvaW50MSwgcG9pbnQyKTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICB9XG4gICBiMldvcmxkLnByb3RvdHlwZS5SYXlDYXN0QWxsID0gZnVuY3Rpb24gKHBvaW50MSwgcG9pbnQyKSB7XG4gICAgICB2YXIgX190aGlzID0gdGhpcztcbiAgICAgIHZhciByZXN1bHQgPSBuZXcgVmVjdG9yKCk7XG5cbiAgICAgIGZ1bmN0aW9uIFJheUNhc3RBbGxXcmFwcGVyKGZpeHR1cmUsIHBvaW50LCBub3JtYWwsIGZyYWN0aW9uKSB7XG4gICAgICAgICBpZiAoZnJhY3Rpb24gPT09IHVuZGVmaW5lZCkgZnJhY3Rpb24gPSAwO1xuICAgICAgICAgcmVzdWx0W3Jlc3VsdC5sZW5ndGhdID0gZml4dHVyZTtcbiAgICAgICAgIHJldHVybiAxO1xuICAgICAgfTtcbiAgICAgIF9fdGhpcy5SYXlDYXN0KFJheUNhc3RBbGxXcmFwcGVyLCBwb2ludDEsIHBvaW50Mik7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgfVxuICAgYjJXb3JsZC5wcm90b3R5cGUuR2V0Qm9keUxpc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlMaXN0O1xuICAgfVxuICAgYjJXb3JsZC5wcm90b3R5cGUuR2V0Sm9pbnRMaXN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV9qb2ludExpc3Q7XG4gICB9XG4gICBiMldvcmxkLnByb3RvdHlwZS5HZXRDb250YWN0TGlzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fY29udGFjdExpc3Q7XG4gICB9XG4gICBiMldvcmxkLnByb3RvdHlwZS5Jc0xvY2tlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiAodGhpcy5tX2ZsYWdzICYgYjJXb3JsZC5lX2xvY2tlZCkgPiAwO1xuICAgfVxuICAgYjJXb3JsZC5wcm90b3R5cGUuU29sdmUgPSBmdW5jdGlvbiAoc3RlcCkge1xuICAgICAgdmFyIGI7XG4gICAgICBmb3IgKHZhciBjb250cm9sbGVyID0gdGhpcy5tX2NvbnRyb2xsZXJMaXN0OyBjb250cm9sbGVyOyBjb250cm9sbGVyID0gY29udHJvbGxlci5tX25leHQpIHtcbiAgICAgICAgIGNvbnRyb2xsZXIuU3RlcChzdGVwKTtcbiAgICAgIH1cbiAgICAgIHZhciBpc2xhbmQgPSB0aGlzLm1faXNsYW5kO1xuICAgICAgaXNsYW5kLkluaXRpYWxpemUodGhpcy5tX2JvZHlDb3VudCwgdGhpcy5tX2NvbnRhY3RDb3VudCwgdGhpcy5tX2pvaW50Q291bnQsIG51bGwsIHRoaXMubV9jb250YWN0TWFuYWdlci5tX2NvbnRhY3RMaXN0ZW5lciwgdGhpcy5tX2NvbnRhY3RTb2x2ZXIpO1xuICAgICAgZm9yIChiID0gdGhpcy5tX2JvZHlMaXN0O1xuICAgICAgYjsgYiA9IGIubV9uZXh0KSB7XG4gICAgICAgICBiLm1fZmxhZ3MgJj0gfmIyQm9keS5lX2lzbGFuZEZsYWc7XG4gICAgICB9XG4gICAgICBmb3IgKHZhciBjID0gdGhpcy5tX2NvbnRhY3RMaXN0OyBjOyBjID0gYy5tX25leHQpIHtcbiAgICAgICAgIGMubV9mbGFncyAmPSB+YjJDb250YWN0LmVfaXNsYW5kRmxhZztcbiAgICAgIH1cbiAgICAgIGZvciAodmFyIGogPSB0aGlzLm1fam9pbnRMaXN0OyBqOyBqID0gai5tX25leHQpIHtcbiAgICAgICAgIGoubV9pc2xhbmRGbGFnID0gZmFsc2U7XG4gICAgICB9XG4gICAgICB2YXIgc3RhY2tTaXplID0gcGFyc2VJbnQodGhpcy5tX2JvZHlDb3VudCk7XG4gICAgICB2YXIgc3RhY2sgPSB0aGlzLnNfc3RhY2s7XG4gICAgICBmb3IgKHZhciBzZWVkID0gdGhpcy5tX2JvZHlMaXN0OyBzZWVkOyBzZWVkID0gc2VlZC5tX25leHQpIHtcbiAgICAgICAgIGlmIChzZWVkLm1fZmxhZ3MgJiBiMkJvZHkuZV9pc2xhbmRGbGFnKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgIH1cbiAgICAgICAgIGlmIChzZWVkLklzQXdha2UoKSA9PSBmYWxzZSB8fCBzZWVkLklzQWN0aXZlKCkgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgfVxuICAgICAgICAgaWYgKHNlZWQuR2V0VHlwZSgpID09IGIyQm9keS5iMl9zdGF0aWNCb2R5KSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgIH1cbiAgICAgICAgIGlzbGFuZC5DbGVhcigpO1xuICAgICAgICAgdmFyIHN0YWNrQ291bnQgPSAwO1xuICAgICAgICAgc3RhY2tbc3RhY2tDb3VudCsrXSA9IHNlZWQ7XG4gICAgICAgICBzZWVkLm1fZmxhZ3MgfD0gYjJCb2R5LmVfaXNsYW5kRmxhZztcbiAgICAgICAgIHdoaWxlIChzdGFja0NvdW50ID4gMCkge1xuICAgICAgICAgICAgYiA9IHN0YWNrWy0tc3RhY2tDb3VudF07XG4gICAgICAgICAgICBpc2xhbmQuQWRkQm9keShiKTtcbiAgICAgICAgICAgIGlmIChiLklzQXdha2UoKSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgYi5TZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChiLkdldFR5cGUoKSA9PSBiMkJvZHkuYjJfc3RhdGljQm9keSkge1xuICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgb3RoZXI7XG4gICAgICAgICAgICBmb3IgKHZhciBjZSA9IGIubV9jb250YWN0TGlzdDsgY2U7IGNlID0gY2UubmV4dCkge1xuICAgICAgICAgICAgICAgaWYgKGNlLmNvbnRhY3QubV9mbGFncyAmIGIyQ29udGFjdC5lX2lzbGFuZEZsYWcpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgaWYgKGNlLmNvbnRhY3QuSXNTZW5zb3IoKSA9PSB0cnVlIHx8IGNlLmNvbnRhY3QuSXNFbmFibGVkKCkgPT0gZmFsc2UgfHwgY2UuY29udGFjdC5Jc1RvdWNoaW5nKCkgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgaXNsYW5kLkFkZENvbnRhY3QoY2UuY29udGFjdCk7XG4gICAgICAgICAgICAgICBjZS5jb250YWN0Lm1fZmxhZ3MgfD0gYjJDb250YWN0LmVfaXNsYW5kRmxhZztcbiAgICAgICAgICAgICAgIG90aGVyID0gY2Uub3RoZXI7XG4gICAgICAgICAgICAgICBpZiAob3RoZXIubV9mbGFncyAmIGIyQm9keS5lX2lzbGFuZEZsYWcpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgc3RhY2tbc3RhY2tDb3VudCsrXSA9IG90aGVyO1xuICAgICAgICAgICAgICAgb3RoZXIubV9mbGFncyB8PSBiMkJvZHkuZV9pc2xhbmRGbGFnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgam4gPSBiLm1fam9pbnRMaXN0OyBqbjsgam4gPSBqbi5uZXh0KSB7XG4gICAgICAgICAgICAgICBpZiAoam4uam9pbnQubV9pc2xhbmRGbGFnID09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgb3RoZXIgPSBqbi5vdGhlcjtcbiAgICAgICAgICAgICAgIGlmIChvdGhlci5Jc0FjdGl2ZSgpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgIGlzbGFuZC5BZGRKb2ludChqbi5qb2ludCk7XG4gICAgICAgICAgICAgICBqbi5qb2ludC5tX2lzbGFuZEZsYWcgPSB0cnVlO1xuICAgICAgICAgICAgICAgaWYgKG90aGVyLm1fZmxhZ3MgJiBiMkJvZHkuZV9pc2xhbmRGbGFnKSB7XG4gICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgIHN0YWNrW3N0YWNrQ291bnQrK10gPSBvdGhlcjtcbiAgICAgICAgICAgICAgIG90aGVyLm1fZmxhZ3MgfD0gYjJCb2R5LmVfaXNsYW5kRmxhZztcbiAgICAgICAgICAgIH1cbiAgICAgICAgIH1cbiAgICAgICAgIGlzbGFuZC5Tb2x2ZShzdGVwLCB0aGlzLm1fZ3Jhdml0eSwgdGhpcy5tX2FsbG93U2xlZXApO1xuICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpc2xhbmQubV9ib2R5Q291bnQ7ICsraSkge1xuICAgICAgICAgICAgYiA9IGlzbGFuZC5tX2JvZGllc1tpXTtcbiAgICAgICAgICAgIGlmIChiLkdldFR5cGUoKSA9PSBiMkJvZHkuYjJfc3RhdGljQm9keSkge1xuICAgICAgICAgICAgICAgYi5tX2ZsYWdzICY9IH5iMkJvZHkuZV9pc2xhbmRGbGFnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgfVxuICAgICAgfVxuICAgICAgZm9yIChpID0gMDtcbiAgICAgIGkgPCBzdGFjay5sZW5ndGg7ICsraSkge1xuICAgICAgICAgaWYgKCFzdGFja1tpXSkgYnJlYWs7XG4gICAgICAgICBzdGFja1tpXSA9IG51bGw7XG4gICAgICB9XG4gICAgICBmb3IgKGIgPSB0aGlzLm1fYm9keUxpc3Q7XG4gICAgICBiOyBiID0gYi5tX25leHQpIHtcbiAgICAgICAgIGlmIChiLklzQXdha2UoKSA9PSBmYWxzZSB8fCBiLklzQWN0aXZlKCkgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgfVxuICAgICAgICAgaWYgKGIuR2V0VHlwZSgpID09IGIyQm9keS5iMl9zdGF0aWNCb2R5KSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgIH1cbiAgICAgICAgIGIuU3luY2hyb25pemVGaXh0dXJlcygpO1xuICAgICAgfVxuICAgICAgdGhpcy5tX2NvbnRhY3RNYW5hZ2VyLkZpbmROZXdDb250YWN0cygpO1xuICAgfVxuICAgYjJXb3JsZC5wcm90b3R5cGUuU29sdmVUT0kgPSBmdW5jdGlvbiAoc3RlcCkge1xuICAgICAgdmFyIGI7XG4gICAgICB2YXIgZkE7XG4gICAgICB2YXIgZkI7XG4gICAgICB2YXIgYkE7XG4gICAgICB2YXIgYkI7XG4gICAgICB2YXIgY0VkZ2U7XG4gICAgICB2YXIgajtcbiAgICAgIHZhciBpc2xhbmQgPSB0aGlzLm1faXNsYW5kO1xuICAgICAgaXNsYW5kLkluaXRpYWxpemUodGhpcy5tX2JvZHlDb3VudCwgYjJTZXR0aW5ncy5iMl9tYXhUT0lDb250YWN0c1BlcklzbGFuZCwgYjJTZXR0aW5ncy5iMl9tYXhUT0lKb2ludHNQZXJJc2xhbmQsIG51bGwsIHRoaXMubV9jb250YWN0TWFuYWdlci5tX2NvbnRhY3RMaXN0ZW5lciwgdGhpcy5tX2NvbnRhY3RTb2x2ZXIpO1xuICAgICAgdmFyIHF1ZXVlID0gYjJXb3JsZC5zX3F1ZXVlO1xuICAgICAgZm9yIChiID0gdGhpcy5tX2JvZHlMaXN0O1xuICAgICAgYjsgYiA9IGIubV9uZXh0KSB7XG4gICAgICAgICBiLm1fZmxhZ3MgJj0gfmIyQm9keS5lX2lzbGFuZEZsYWc7XG4gICAgICAgICBiLm1fc3dlZXAudDAgPSAwLjA7XG4gICAgICB9XG4gICAgICB2YXIgYztcbiAgICAgIGZvciAoYyA9IHRoaXMubV9jb250YWN0TGlzdDtcbiAgICAgIGM7IGMgPSBjLm1fbmV4dCkge1xuICAgICAgICAgYy5tX2ZsYWdzICY9IH4gKGIyQ29udGFjdC5lX3RvaUZsYWcgfCBiMkNvbnRhY3QuZV9pc2xhbmRGbGFnKTtcbiAgICAgIH1cbiAgICAgIGZvciAoaiA9IHRoaXMubV9qb2ludExpc3Q7XG4gICAgICBqOyBqID0gai5tX25leHQpIHtcbiAgICAgICAgIGoubV9pc2xhbmRGbGFnID0gZmFsc2U7XG4gICAgICB9XG4gICAgICBmb3IgKDs7KSB7XG4gICAgICAgICB2YXIgbWluQ29udGFjdCA9IG51bGw7XG4gICAgICAgICB2YXIgbWluVE9JID0gMS4wO1xuICAgICAgICAgZm9yIChjID0gdGhpcy5tX2NvbnRhY3RMaXN0O1xuICAgICAgICAgYzsgYyA9IGMubV9uZXh0KSB7XG4gICAgICAgICAgICBpZiAoYy5Jc1NlbnNvcigpID09IHRydWUgfHwgYy5Jc0VuYWJsZWQoKSA9PSBmYWxzZSB8fCBjLklzQ29udGludW91cygpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB0b2kgPSAxLjA7XG4gICAgICAgICAgICBpZiAoYy5tX2ZsYWdzICYgYjJDb250YWN0LmVfdG9pRmxhZykge1xuICAgICAgICAgICAgICAgdG9pID0gYy5tX3RvaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgZkEgPSBjLm1fZml4dHVyZUE7XG4gICAgICAgICAgICAgICBmQiA9IGMubV9maXh0dXJlQjtcbiAgICAgICAgICAgICAgIGJBID0gZkEubV9ib2R5O1xuICAgICAgICAgICAgICAgYkIgPSBmQi5tX2JvZHk7XG4gICAgICAgICAgICAgICBpZiAoKGJBLkdldFR5cGUoKSAhPSBiMkJvZHkuYjJfZHluYW1pY0JvZHkgfHwgYkEuSXNBd2FrZSgpID09IGZhbHNlKSAmJiAoYkIuR2V0VHlwZSgpICE9IGIyQm9keS5iMl9keW5hbWljQm9keSB8fCBiQi5Jc0F3YWtlKCkgPT0gZmFsc2UpKSB7XG4gICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgIHZhciB0MCA9IGJBLm1fc3dlZXAudDA7XG4gICAgICAgICAgICAgICBpZiAoYkEubV9zd2VlcC50MCA8IGJCLm1fc3dlZXAudDApIHtcbiAgICAgICAgICAgICAgICAgIHQwID0gYkIubV9zd2VlcC50MDtcbiAgICAgICAgICAgICAgICAgIGJBLm1fc3dlZXAuQWR2YW5jZSh0MCk7XG4gICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICBlbHNlIGlmIChiQi5tX3N3ZWVwLnQwIDwgYkEubV9zd2VlcC50MCkge1xuICAgICAgICAgICAgICAgICAgdDAgPSBiQS5tX3N3ZWVwLnQwO1xuICAgICAgICAgICAgICAgICAgYkIubV9zd2VlcC5BZHZhbmNlKHQwKTtcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgIHRvaSA9IGMuQ29tcHV0ZVRPSShiQS5tX3N3ZWVwLCBiQi5tX3N3ZWVwKTtcbiAgICAgICAgICAgICAgIGIyU2V0dGluZ3MuYjJBc3NlcnQoMC4wIDw9IHRvaSAmJiB0b2kgPD0gMS4wKTtcbiAgICAgICAgICAgICAgIGlmICh0b2kgPiAwLjAgJiYgdG9pIDwgMS4wKSB7XG4gICAgICAgICAgICAgICAgICB0b2kgPSAoMS4wIC0gdG9pKSAqIHQwICsgdG9pO1xuICAgICAgICAgICAgICAgICAgaWYgKHRvaSA+IDEpIHRvaSA9IDE7XG4gICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICBjLm1fdG9pID0gdG9pO1xuICAgICAgICAgICAgICAgYy5tX2ZsYWdzIHw9IGIyQ29udGFjdC5lX3RvaUZsYWc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoTnVtYmVyLk1JTl9WQUxVRSA8IHRvaSAmJiB0b2kgPCBtaW5UT0kpIHtcbiAgICAgICAgICAgICAgIG1pbkNvbnRhY3QgPSBjO1xuICAgICAgICAgICAgICAgbWluVE9JID0gdG9pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgfVxuICAgICAgICAgaWYgKG1pbkNvbnRhY3QgPT0gbnVsbCB8fCAxLjAgLSAxMDAuMCAqIE51bWJlci5NSU5fVkFMVUUgPCBtaW5UT0kpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgfVxuICAgICAgICAgZkEgPSBtaW5Db250YWN0Lm1fZml4dHVyZUE7XG4gICAgICAgICBmQiA9IG1pbkNvbnRhY3QubV9maXh0dXJlQjtcbiAgICAgICAgIGJBID0gZkEubV9ib2R5O1xuICAgICAgICAgYkIgPSBmQi5tX2JvZHk7XG4gICAgICAgICBiMldvcmxkLnNfYmFja3VwQS5TZXQoYkEubV9zd2VlcCk7XG4gICAgICAgICBiMldvcmxkLnNfYmFja3VwQi5TZXQoYkIubV9zd2VlcCk7XG4gICAgICAgICBiQS5BZHZhbmNlKG1pblRPSSk7XG4gICAgICAgICBiQi5BZHZhbmNlKG1pblRPSSk7XG4gICAgICAgICBtaW5Db250YWN0LlVwZGF0ZSh0aGlzLm1fY29udGFjdE1hbmFnZXIubV9jb250YWN0TGlzdGVuZXIpO1xuICAgICAgICAgbWluQ29udGFjdC5tX2ZsYWdzICY9IH5iMkNvbnRhY3QuZV90b2lGbGFnO1xuICAgICAgICAgaWYgKG1pbkNvbnRhY3QuSXNTZW5zb3IoKSA9PSB0cnVlIHx8IG1pbkNvbnRhY3QuSXNFbmFibGVkKCkgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgIGJBLm1fc3dlZXAuU2V0KGIyV29ybGQuc19iYWNrdXBBKTtcbiAgICAgICAgICAgIGJCLm1fc3dlZXAuU2V0KGIyV29ybGQuc19iYWNrdXBCKTtcbiAgICAgICAgICAgIGJBLlN5bmNocm9uaXplVHJhbnNmb3JtKCk7XG4gICAgICAgICAgICBiQi5TeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICB9XG4gICAgICAgICBpZiAobWluQ29udGFjdC5Jc1RvdWNoaW5nKCkgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgfVxuICAgICAgICAgdmFyIHNlZWQgPSBiQTtcbiAgICAgICAgIGlmIChzZWVkLkdldFR5cGUoKSAhPSBiMkJvZHkuYjJfZHluYW1pY0JvZHkpIHtcbiAgICAgICAgICAgIHNlZWQgPSBiQjtcbiAgICAgICAgIH1cbiAgICAgICAgIGlzbGFuZC5DbGVhcigpO1xuICAgICAgICAgdmFyIHF1ZXVlU3RhcnQgPSAwO1xuICAgICAgICAgdmFyIHF1ZXVlU2l6ZSA9IDA7XG4gICAgICAgICBxdWV1ZVtxdWV1ZVN0YXJ0ICsgcXVldWVTaXplKytdID0gc2VlZDtcbiAgICAgICAgIHNlZWQubV9mbGFncyB8PSBiMkJvZHkuZV9pc2xhbmRGbGFnO1xuICAgICAgICAgd2hpbGUgKHF1ZXVlU2l6ZSA+IDApIHtcbiAgICAgICAgICAgIGIgPSBxdWV1ZVtxdWV1ZVN0YXJ0KytdO1xuICAgICAgICAgICAgLS1xdWV1ZVNpemU7XG4gICAgICAgICAgICBpc2xhbmQuQWRkQm9keShiKTtcbiAgICAgICAgICAgIGlmIChiLklzQXdha2UoKSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgYi5TZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChiLkdldFR5cGUoKSAhPSBiMkJvZHkuYjJfZHluYW1pY0JvZHkpIHtcbiAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChjRWRnZSA9IGIubV9jb250YWN0TGlzdDtcbiAgICAgICAgICAgIGNFZGdlOyBjRWRnZSA9IGNFZGdlLm5leHQpIHtcbiAgICAgICAgICAgICAgIGlmIChpc2xhbmQubV9jb250YWN0Q291bnQgPT0gaXNsYW5kLm1fY29udGFjdENhcGFjaXR5KSB7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgIGlmIChjRWRnZS5jb250YWN0Lm1fZmxhZ3MgJiBiMkNvbnRhY3QuZV9pc2xhbmRGbGFnKSB7XG4gICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgIGlmIChjRWRnZS5jb250YWN0LklzU2Vuc29yKCkgPT0gdHJ1ZSB8fCBjRWRnZS5jb250YWN0LklzRW5hYmxlZCgpID09IGZhbHNlIHx8IGNFZGdlLmNvbnRhY3QuSXNUb3VjaGluZygpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgIGlzbGFuZC5BZGRDb250YWN0KGNFZGdlLmNvbnRhY3QpO1xuICAgICAgICAgICAgICAgY0VkZ2UuY29udGFjdC5tX2ZsYWdzIHw9IGIyQ29udGFjdC5lX2lzbGFuZEZsYWc7XG4gICAgICAgICAgICAgICB2YXIgb3RoZXIgPSBjRWRnZS5vdGhlcjtcbiAgICAgICAgICAgICAgIGlmIChvdGhlci5tX2ZsYWdzICYgYjJCb2R5LmVfaXNsYW5kRmxhZykge1xuICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICBpZiAob3RoZXIuR2V0VHlwZSgpICE9IGIyQm9keS5iMl9zdGF0aWNCb2R5KSB7XG4gICAgICAgICAgICAgICAgICBvdGhlci5BZHZhbmNlKG1pblRPSSk7XG4gICAgICAgICAgICAgICAgICBvdGhlci5TZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgIHF1ZXVlW3F1ZXVlU3RhcnQgKyBxdWV1ZVNpemVdID0gb3RoZXI7XG4gICAgICAgICAgICAgICArK3F1ZXVlU2l6ZTtcbiAgICAgICAgICAgICAgIG90aGVyLm1fZmxhZ3MgfD0gYjJCb2R5LmVfaXNsYW5kRmxhZztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIGpFZGdlID0gYi5tX2pvaW50TGlzdDsgakVkZ2U7IGpFZGdlID0gakVkZ2UubmV4dCkge1xuICAgICAgICAgICAgICAgaWYgKGlzbGFuZC5tX2pvaW50Q291bnQgPT0gaXNsYW5kLm1fam9pbnRDYXBhY2l0eSkgY29udGludWU7XG4gICAgICAgICAgICAgICBpZiAoakVkZ2Uuam9pbnQubV9pc2xhbmRGbGFnID09IHRydWUpIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgb3RoZXIgPSBqRWRnZS5vdGhlcjtcbiAgICAgICAgICAgICAgIGlmIChvdGhlci5Jc0FjdGl2ZSgpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgIGlzbGFuZC5BZGRKb2ludChqRWRnZS5qb2ludCk7XG4gICAgICAgICAgICAgICBqRWRnZS5qb2ludC5tX2lzbGFuZEZsYWcgPSB0cnVlO1xuICAgICAgICAgICAgICAgaWYgKG90aGVyLm1fZmxhZ3MgJiBiMkJvZHkuZV9pc2xhbmRGbGFnKSBjb250aW51ZTtcbiAgICAgICAgICAgICAgIGlmIChvdGhlci5HZXRUeXBlKCkgIT0gYjJCb2R5LmIyX3N0YXRpY0JvZHkpIHtcbiAgICAgICAgICAgICAgICAgIG90aGVyLkFkdmFuY2UobWluVE9JKTtcbiAgICAgICAgICAgICAgICAgIG90aGVyLlNldEF3YWtlKHRydWUpO1xuICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgcXVldWVbcXVldWVTdGFydCArIHF1ZXVlU2l6ZV0gPSBvdGhlcjtcbiAgICAgICAgICAgICAgICsrcXVldWVTaXplO1xuICAgICAgICAgICAgICAgb3RoZXIubV9mbGFncyB8PSBiMkJvZHkuZV9pc2xhbmRGbGFnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgfVxuICAgICAgICAgdmFyIHN1YlN0ZXAgPSBiMldvcmxkLnNfdGltZXN0ZXA7XG4gICAgICAgICBzdWJTdGVwLndhcm1TdGFydGluZyA9IGZhbHNlO1xuICAgICAgICAgc3ViU3RlcC5kdCA9ICgxLjAgLSBtaW5UT0kpICogc3RlcC5kdDtcbiAgICAgICAgIHN1YlN0ZXAuaW52X2R0ID0gMS4wIC8gc3ViU3RlcC5kdDtcbiAgICAgICAgIHN1YlN0ZXAuZHRSYXRpbyA9IDAuMDtcbiAgICAgICAgIHN1YlN0ZXAudmVsb2NpdHlJdGVyYXRpb25zID0gc3RlcC52ZWxvY2l0eUl0ZXJhdGlvbnM7XG4gICAgICAgICBzdWJTdGVwLnBvc2l0aW9uSXRlcmF0aW9ucyA9IHN0ZXAucG9zaXRpb25JdGVyYXRpb25zO1xuICAgICAgICAgaXNsYW5kLlNvbHZlVE9JKHN1YlN0ZXApO1xuICAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICAgZm9yIChpID0gMDtcbiAgICAgICAgIGkgPCBpc2xhbmQubV9ib2R5Q291bnQ7ICsraSkge1xuICAgICAgICAgICAgYiA9IGlzbGFuZC5tX2JvZGllc1tpXTtcbiAgICAgICAgICAgIGIubV9mbGFncyAmPSB+YjJCb2R5LmVfaXNsYW5kRmxhZztcbiAgICAgICAgICAgIGlmIChiLklzQXdha2UoKSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYi5HZXRUeXBlKCkgIT0gYjJCb2R5LmIyX2R5bmFtaWNCb2R5KSB7XG4gICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGIuU3luY2hyb25pemVGaXh0dXJlcygpO1xuICAgICAgICAgICAgZm9yIChjRWRnZSA9IGIubV9jb250YWN0TGlzdDtcbiAgICAgICAgICAgIGNFZGdlOyBjRWRnZSA9IGNFZGdlLm5leHQpIHtcbiAgICAgICAgICAgICAgIGNFZGdlLmNvbnRhY3QubV9mbGFncyAmPSB+YjJDb250YWN0LmVfdG9pRmxhZztcbiAgICAgICAgICAgIH1cbiAgICAgICAgIH1cbiAgICAgICAgIGZvciAoaSA9IDA7XG4gICAgICAgICBpIDwgaXNsYW5kLm1fY29udGFjdENvdW50OyArK2kpIHtcbiAgICAgICAgICAgIGMgPSBpc2xhbmQubV9jb250YWN0c1tpXTtcbiAgICAgICAgICAgIGMubV9mbGFncyAmPSB+IChiMkNvbnRhY3QuZV90b2lGbGFnIHwgYjJDb250YWN0LmVfaXNsYW5kRmxhZyk7XG4gICAgICAgICB9XG4gICAgICAgICBmb3IgKGkgPSAwO1xuICAgICAgICAgaSA8IGlzbGFuZC5tX2pvaW50Q291bnQ7ICsraSkge1xuICAgICAgICAgICAgaiA9IGlzbGFuZC5tX2pvaW50c1tpXTtcbiAgICAgICAgICAgIGoubV9pc2xhbmRGbGFnID0gZmFsc2U7XG4gICAgICAgICB9XG4gICAgICAgICB0aGlzLm1fY29udGFjdE1hbmFnZXIuRmluZE5ld0NvbnRhY3RzKCk7XG4gICAgICB9XG4gICB9XG4gICBiMldvcmxkLnByb3RvdHlwZS5EcmF3Sm9pbnQgPSBmdW5jdGlvbiAoam9pbnQpIHtcbiAgICAgIHZhciBiMSA9IGpvaW50LkdldEJvZHlBKCk7XG4gICAgICB2YXIgYjIgPSBqb2ludC5HZXRCb2R5QigpO1xuICAgICAgdmFyIHhmMSA9IGIxLm1feGY7XG4gICAgICB2YXIgeGYyID0gYjIubV94ZjtcbiAgICAgIHZhciB4MSA9IHhmMS5wb3NpdGlvbjtcbiAgICAgIHZhciB4MiA9IHhmMi5wb3NpdGlvbjtcbiAgICAgIHZhciBwMSA9IGpvaW50LkdldEFuY2hvckEoKTtcbiAgICAgIHZhciBwMiA9IGpvaW50LkdldEFuY2hvckIoKTtcbiAgICAgIHZhciBjb2xvciA9IGIyV29ybGQuc19qb2ludENvbG9yO1xuICAgICAgc3dpdGNoIChqb2ludC5tX3R5cGUpIHtcbiAgICAgIGNhc2UgYjJKb2ludC5lX2Rpc3RhbmNlSm9pbnQ6XG4gICAgICAgICB0aGlzLm1fZGVidWdEcmF3LkRyYXdTZWdtZW50KHAxLCBwMiwgY29sb3IpO1xuICAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIGIySm9pbnQuZV9wdWxsZXlKb2ludDpcbiAgICAgICAgIHtcbiAgICAgICAgICAgIHZhciBwdWxsZXkgPSAoKGpvaW50IGluc3RhbmNlb2YgYjJQdWxsZXlKb2ludCA/IGpvaW50IDogbnVsbCkpO1xuICAgICAgICAgICAgdmFyIHMxID0gcHVsbGV5LkdldEdyb3VuZEFuY2hvckEoKTtcbiAgICAgICAgICAgIHZhciBzMiA9IHB1bGxleS5HZXRHcm91bmRBbmNob3JCKCk7XG4gICAgICAgICAgICB0aGlzLm1fZGVidWdEcmF3LkRyYXdTZWdtZW50KHMxLCBwMSwgY29sb3IpO1xuICAgICAgICAgICAgdGhpcy5tX2RlYnVnRHJhdy5EcmF3U2VnbWVudChzMiwgcDIsIGNvbG9yKTtcbiAgICAgICAgICAgIHRoaXMubV9kZWJ1Z0RyYXcuRHJhd1NlZ21lbnQoczEsIHMyLCBjb2xvcik7XG4gICAgICAgICB9XG4gICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgYjJKb2ludC5lX21vdXNlSm9pbnQ6XG4gICAgICAgICB0aGlzLm1fZGVidWdEcmF3LkRyYXdTZWdtZW50KHAxLCBwMiwgY29sb3IpO1xuICAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICAgaWYgKGIxICE9IHRoaXMubV9ncm91bmRCb2R5KSB0aGlzLm1fZGVidWdEcmF3LkRyYXdTZWdtZW50KHgxLCBwMSwgY29sb3IpO1xuICAgICAgICAgdGhpcy5tX2RlYnVnRHJhdy5EcmF3U2VnbWVudChwMSwgcDIsIGNvbG9yKTtcbiAgICAgICAgIGlmIChiMiAhPSB0aGlzLm1fZ3JvdW5kQm9keSkgdGhpcy5tX2RlYnVnRHJhdy5EcmF3U2VnbWVudCh4MiwgcDIsIGNvbG9yKTtcbiAgICAgIH1cbiAgIH1cbiAgIGIyV29ybGQucHJvdG90eXBlLkRyYXdTaGFwZSA9IGZ1bmN0aW9uIChzaGFwZSwgeGYsIGNvbG9yKSB7XG4gICAgICBzd2l0Y2ggKHNoYXBlLm1fdHlwZSkge1xuICAgICAgY2FzZSBiMlNoYXBlLmVfY2lyY2xlU2hhcGU6XG4gICAgICAgICB7XG4gICAgICAgICAgICB2YXIgY2lyY2xlID0gKChzaGFwZSBpbnN0YW5jZW9mIGIyQ2lyY2xlU2hhcGUgPyBzaGFwZSA6IG51bGwpKTtcbiAgICAgICAgICAgIHZhciBjZW50ZXIgPSBiMk1hdGguTXVsWCh4ZiwgY2lyY2xlLm1fcCk7XG4gICAgICAgICAgICB2YXIgcmFkaXVzID0gY2lyY2xlLm1fcmFkaXVzO1xuICAgICAgICAgICAgdmFyIGF4aXMgPSB4Zi5SLmNvbDE7XG4gICAgICAgICAgICB0aGlzLm1fZGVidWdEcmF3LkRyYXdTb2xpZENpcmNsZShjZW50ZXIsIHJhZGl1cywgYXhpcywgY29sb3IpO1xuICAgICAgICAgfVxuICAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIGIyU2hhcGUuZV9wb2x5Z29uU2hhcGU6XG4gICAgICAgICB7XG4gICAgICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgICAgICB2YXIgcG9seSA9ICgoc2hhcGUgaW5zdGFuY2VvZiBiMlBvbHlnb25TaGFwZSA/IHNoYXBlIDogbnVsbCkpO1xuICAgICAgICAgICAgdmFyIHZlcnRleENvdW50ID0gcGFyc2VJbnQocG9seS5HZXRWZXJ0ZXhDb3VudCgpKTtcbiAgICAgICAgICAgIHZhciBsb2NhbFZlcnRpY2VzID0gcG9seS5HZXRWZXJ0aWNlcygpO1xuICAgICAgICAgICAgdmFyIHZlcnRpY2VzID0gbmV3IFZlY3Rvcih2ZXJ0ZXhDb3VudCk7XG4gICAgICAgICAgICBmb3IgKGkgPSAwO1xuICAgICAgICAgICAgaSA8IHZlcnRleENvdW50OyArK2kpIHtcbiAgICAgICAgICAgICAgIHZlcnRpY2VzW2ldID0gYjJNYXRoLk11bFgoeGYsIGxvY2FsVmVydGljZXNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5tX2RlYnVnRHJhdy5EcmF3U29saWRQb2x5Z29uKHZlcnRpY2VzLCB2ZXJ0ZXhDb3VudCwgY29sb3IpO1xuICAgICAgICAgfVxuICAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIGIyU2hhcGUuZV9lZGdlU2hhcGU6XG4gICAgICAgICB7XG4gICAgICAgICAgICB2YXIgZWRnZSA9IChzaGFwZSBpbnN0YW5jZW9mIGIyRWRnZVNoYXBlID8gc2hhcGUgOiBudWxsKTtcbiAgICAgICAgICAgIHRoaXMubV9kZWJ1Z0RyYXcuRHJhd1NlZ21lbnQoYjJNYXRoLk11bFgoeGYsIGVkZ2UuR2V0VmVydGV4MSgpKSwgYjJNYXRoLk11bFgoeGYsIGVkZ2UuR2V0VmVydGV4MigpKSwgY29sb3IpO1xuICAgICAgICAgfVxuICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICB9XG4gICBCb3gyRC5wb3N0RGVmcy5wdXNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIEJveDJELkR5bmFtaWNzLmIyV29ybGQuc190aW1lc3RlcDIgPSBuZXcgYjJUaW1lU3RlcCgpO1xuICAgICAgQm94MkQuRHluYW1pY3MuYjJXb3JsZC5zX3hmID0gbmV3IGIyVHJhbnNmb3JtKCk7XG4gICAgICBCb3gyRC5EeW5hbWljcy5iMldvcmxkLnNfYmFja3VwQSA9IG5ldyBiMlN3ZWVwKCk7XG4gICAgICBCb3gyRC5EeW5hbWljcy5iMldvcmxkLnNfYmFja3VwQiA9IG5ldyBiMlN3ZWVwKCk7XG4gICAgICBCb3gyRC5EeW5hbWljcy5iMldvcmxkLnNfdGltZXN0ZXAgPSBuZXcgYjJUaW1lU3RlcCgpO1xuICAgICAgQm94MkQuRHluYW1pY3MuYjJXb3JsZC5zX3F1ZXVlID0gbmV3IFZlY3RvcigpO1xuICAgICAgQm94MkQuRHluYW1pY3MuYjJXb3JsZC5zX2pvaW50Q29sb3IgPSBuZXcgYjJDb2xvcigwLjUsIDAuOCwgMC44KTtcbiAgICAgIEJveDJELkR5bmFtaWNzLmIyV29ybGQuZV9uZXdGaXh0dXJlID0gMHgwMDAxO1xuICAgICAgQm94MkQuRHluYW1pY3MuYjJXb3JsZC5lX2xvY2tlZCA9IDB4MDAwMjtcbiAgIH0pO1xufSkoKTtcbihmdW5jdGlvbiAoKSB7XG4gICB2YXIgYjJDaXJjbGVTaGFwZSA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJDaXJjbGVTaGFwZSxcbiAgICAgIGIyRWRnZUNoYWluRGVmID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMkVkZ2VDaGFpbkRlZixcbiAgICAgIGIyRWRnZVNoYXBlID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMkVkZ2VTaGFwZSxcbiAgICAgIGIyTWFzc0RhdGEgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyTWFzc0RhdGEsXG4gICAgICBiMlBvbHlnb25TaGFwZSA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJQb2x5Z29uU2hhcGUsXG4gICAgICBiMlNoYXBlID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlNoYXBlLFxuICAgICAgYjJDaXJjbGVDb250YWN0ID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDaXJjbGVDb250YWN0LFxuICAgICAgYjJDb250YWN0ID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0LFxuICAgICAgYjJDb250YWN0Q29uc3RyYWludCA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdENvbnN0cmFpbnQsXG4gICAgICBiMkNvbnRhY3RDb25zdHJhaW50UG9pbnQgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3RDb25zdHJhaW50UG9pbnQsXG4gICAgICBiMkNvbnRhY3RFZGdlID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0RWRnZSxcbiAgICAgIGIyQ29udGFjdEZhY3RvcnkgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3RGYWN0b3J5LFxuICAgICAgYjJDb250YWN0UmVnaXN0ZXIgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3RSZWdpc3RlcixcbiAgICAgIGIyQ29udGFjdFJlc3VsdCA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdFJlc3VsdCxcbiAgICAgIGIyQ29udGFjdFNvbHZlciA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdFNvbHZlcixcbiAgICAgIGIyRWRnZUFuZENpcmNsZUNvbnRhY3QgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkVkZ2VBbmRDaXJjbGVDb250YWN0LFxuICAgICAgYjJOdWxsQ29udGFjdCA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyTnVsbENvbnRhY3QsXG4gICAgICBiMlBvbHlBbmRDaXJjbGVDb250YWN0ID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJQb2x5QW5kQ2lyY2xlQ29udGFjdCxcbiAgICAgIGIyUG9seUFuZEVkZ2VDb250YWN0ID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJQb2x5QW5kRWRnZUNvbnRhY3QsXG4gICAgICBiMlBvbHlnb25Db250YWN0ID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJQb2x5Z29uQ29udGFjdCxcbiAgICAgIGIyUG9zaXRpb25Tb2x2ZXJNYW5pZm9sZCA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyUG9zaXRpb25Tb2x2ZXJNYW5pZm9sZCxcbiAgICAgIGIyQm9keSA9IEJveDJELkR5bmFtaWNzLmIyQm9keSxcbiAgICAgIGIyQm9keURlZiA9IEJveDJELkR5bmFtaWNzLmIyQm9keURlZixcbiAgICAgIGIyQ29udGFjdEZpbHRlciA9IEJveDJELkR5bmFtaWNzLmIyQ29udGFjdEZpbHRlcixcbiAgICAgIGIyQ29udGFjdEltcHVsc2UgPSBCb3gyRC5EeW5hbWljcy5iMkNvbnRhY3RJbXB1bHNlLFxuICAgICAgYjJDb250YWN0TGlzdGVuZXIgPSBCb3gyRC5EeW5hbWljcy5iMkNvbnRhY3RMaXN0ZW5lcixcbiAgICAgIGIyQ29udGFjdE1hbmFnZXIgPSBCb3gyRC5EeW5hbWljcy5iMkNvbnRhY3RNYW5hZ2VyLFxuICAgICAgYjJEZWJ1Z0RyYXcgPSBCb3gyRC5EeW5hbWljcy5iMkRlYnVnRHJhdyxcbiAgICAgIGIyRGVzdHJ1Y3Rpb25MaXN0ZW5lciA9IEJveDJELkR5bmFtaWNzLmIyRGVzdHJ1Y3Rpb25MaXN0ZW5lcixcbiAgICAgIGIyRmlsdGVyRGF0YSA9IEJveDJELkR5bmFtaWNzLmIyRmlsdGVyRGF0YSxcbiAgICAgIGIyRml4dHVyZSA9IEJveDJELkR5bmFtaWNzLmIyRml4dHVyZSxcbiAgICAgIGIyRml4dHVyZURlZiA9IEJveDJELkR5bmFtaWNzLmIyRml4dHVyZURlZixcbiAgICAgIGIySXNsYW5kID0gQm94MkQuRHluYW1pY3MuYjJJc2xhbmQsXG4gICAgICBiMlRpbWVTdGVwID0gQm94MkQuRHluYW1pY3MuYjJUaW1lU3RlcCxcbiAgICAgIGIyV29ybGQgPSBCb3gyRC5EeW5hbWljcy5iMldvcmxkLFxuICAgICAgYjJDb2xvciA9IEJveDJELkNvbW1vbi5iMkNvbG9yLFxuICAgICAgYjJpbnRlcm5hbCA9IEJveDJELkNvbW1vbi5iMmludGVybmFsLFxuICAgICAgYjJTZXR0aW5ncyA9IEJveDJELkNvbW1vbi5iMlNldHRpbmdzLFxuICAgICAgYjJNYXQyMiA9IEJveDJELkNvbW1vbi5NYXRoLmIyTWF0MjIsXG4gICAgICBiMk1hdDMzID0gQm94MkQuQ29tbW9uLk1hdGguYjJNYXQzMyxcbiAgICAgIGIyTWF0aCA9IEJveDJELkNvbW1vbi5NYXRoLmIyTWF0aCxcbiAgICAgIGIyU3dlZXAgPSBCb3gyRC5Db21tb24uTWF0aC5iMlN3ZWVwLFxuICAgICAgYjJUcmFuc2Zvcm0gPSBCb3gyRC5Db21tb24uTWF0aC5iMlRyYW5zZm9ybSxcbiAgICAgIGIyVmVjMiA9IEJveDJELkNvbW1vbi5NYXRoLmIyVmVjMixcbiAgICAgIGIyVmVjMyA9IEJveDJELkNvbW1vbi5NYXRoLmIyVmVjMyxcbiAgICAgIGIyQUFCQiA9IEJveDJELkNvbGxpc2lvbi5iMkFBQkIsXG4gICAgICBiMkJvdW5kID0gQm94MkQuQ29sbGlzaW9uLmIyQm91bmQsXG4gICAgICBiMkJvdW5kVmFsdWVzID0gQm94MkQuQ29sbGlzaW9uLmIyQm91bmRWYWx1ZXMsXG4gICAgICBiMkNvbGxpc2lvbiA9IEJveDJELkNvbGxpc2lvbi5iMkNvbGxpc2lvbixcbiAgICAgIGIyQ29udGFjdElEID0gQm94MkQuQ29sbGlzaW9uLmIyQ29udGFjdElELFxuICAgICAgYjJDb250YWN0UG9pbnQgPSBCb3gyRC5Db2xsaXNpb24uYjJDb250YWN0UG9pbnQsXG4gICAgICBiMkRpc3RhbmNlID0gQm94MkQuQ29sbGlzaW9uLmIyRGlzdGFuY2UsXG4gICAgICBiMkRpc3RhbmNlSW5wdXQgPSBCb3gyRC5Db2xsaXNpb24uYjJEaXN0YW5jZUlucHV0LFxuICAgICAgYjJEaXN0YW5jZU91dHB1dCA9IEJveDJELkNvbGxpc2lvbi5iMkRpc3RhbmNlT3V0cHV0LFxuICAgICAgYjJEaXN0YW5jZVByb3h5ID0gQm94MkQuQ29sbGlzaW9uLmIyRGlzdGFuY2VQcm94eSxcbiAgICAgIGIyRHluYW1pY1RyZWUgPSBCb3gyRC5Db2xsaXNpb24uYjJEeW5hbWljVHJlZSxcbiAgICAgIGIyRHluYW1pY1RyZWVCcm9hZFBoYXNlID0gQm94MkQuQ29sbGlzaW9uLmIyRHluYW1pY1RyZWVCcm9hZFBoYXNlLFxuICAgICAgYjJEeW5hbWljVHJlZU5vZGUgPSBCb3gyRC5Db2xsaXNpb24uYjJEeW5hbWljVHJlZU5vZGUsXG4gICAgICBiMkR5bmFtaWNUcmVlUGFpciA9IEJveDJELkNvbGxpc2lvbi5iMkR5bmFtaWNUcmVlUGFpcixcbiAgICAgIGIyTWFuaWZvbGQgPSBCb3gyRC5Db2xsaXNpb24uYjJNYW5pZm9sZCxcbiAgICAgIGIyTWFuaWZvbGRQb2ludCA9IEJveDJELkNvbGxpc2lvbi5iMk1hbmlmb2xkUG9pbnQsXG4gICAgICBiMlBvaW50ID0gQm94MkQuQ29sbGlzaW9uLmIyUG9pbnQsXG4gICAgICBiMlJheUNhc3RJbnB1dCA9IEJveDJELkNvbGxpc2lvbi5iMlJheUNhc3RJbnB1dCxcbiAgICAgIGIyUmF5Q2FzdE91dHB1dCA9IEJveDJELkNvbGxpc2lvbi5iMlJheUNhc3RPdXRwdXQsXG4gICAgICBiMlNlZ21lbnQgPSBCb3gyRC5Db2xsaXNpb24uYjJTZWdtZW50LFxuICAgICAgYjJTZXBhcmF0aW9uRnVuY3Rpb24gPSBCb3gyRC5Db2xsaXNpb24uYjJTZXBhcmF0aW9uRnVuY3Rpb24sXG4gICAgICBiMlNpbXBsZXggPSBCb3gyRC5Db2xsaXNpb24uYjJTaW1wbGV4LFxuICAgICAgYjJTaW1wbGV4Q2FjaGUgPSBCb3gyRC5Db2xsaXNpb24uYjJTaW1wbGV4Q2FjaGUsXG4gICAgICBiMlNpbXBsZXhWZXJ0ZXggPSBCb3gyRC5Db2xsaXNpb24uYjJTaW1wbGV4VmVydGV4LFxuICAgICAgYjJUaW1lT2ZJbXBhY3QgPSBCb3gyRC5Db2xsaXNpb24uYjJUaW1lT2ZJbXBhY3QsXG4gICAgICBiMlRPSUlucHV0ID0gQm94MkQuQ29sbGlzaW9uLmIyVE9JSW5wdXQsXG4gICAgICBiMldvcmxkTWFuaWZvbGQgPSBCb3gyRC5Db2xsaXNpb24uYjJXb3JsZE1hbmlmb2xkLFxuICAgICAgQ2xpcFZlcnRleCA9IEJveDJELkNvbGxpc2lvbi5DbGlwVmVydGV4LFxuICAgICAgRmVhdHVyZXMgPSBCb3gyRC5Db2xsaXNpb24uRmVhdHVyZXMsXG4gICAgICBJQnJvYWRQaGFzZSA9IEJveDJELkNvbGxpc2lvbi5JQnJvYWRQaGFzZTtcblxuICAgQm94MkQuaW5oZXJpdChiMkNpcmNsZUNvbnRhY3QsIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdCk7XG4gICBiMkNpcmNsZUNvbnRhY3QucHJvdG90eXBlLl9fc3VwZXIgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3QucHJvdG90eXBlO1xuICAgYjJDaXJjbGVDb250YWN0LmIyQ2lyY2xlQ29udGFjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdC5iMkNvbnRhY3QuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBiMkNpcmNsZUNvbnRhY3QuQ3JlYXRlID0gZnVuY3Rpb24gKGFsbG9jYXRvcikge1xuICAgICAgcmV0dXJuIG5ldyBiMkNpcmNsZUNvbnRhY3QoKTtcbiAgIH1cbiAgIGIyQ2lyY2xlQ29udGFjdC5EZXN0cm95ID0gZnVuY3Rpb24gKGNvbnRhY3QsIGFsbG9jYXRvcikge31cbiAgIGIyQ2lyY2xlQ29udGFjdC5wcm90b3R5cGUuUmVzZXQgPSBmdW5jdGlvbiAoZml4dHVyZUEsIGZpeHR1cmVCKSB7XG4gICAgICB0aGlzLl9fc3VwZXIuUmVzZXQuY2FsbCh0aGlzLCBmaXh0dXJlQSwgZml4dHVyZUIpO1xuICAgfVxuICAgYjJDaXJjbGVDb250YWN0LnByb3RvdHlwZS5FdmFsdWF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBiQSA9IHRoaXMubV9maXh0dXJlQS5HZXRCb2R5KCk7XG4gICAgICB2YXIgYkIgPSB0aGlzLm1fZml4dHVyZUIuR2V0Qm9keSgpO1xuICAgICAgYjJDb2xsaXNpb24uQ29sbGlkZUNpcmNsZXModGhpcy5tX21hbmlmb2xkLCAodGhpcy5tX2ZpeHR1cmVBLkdldFNoYXBlKCkgaW5zdGFuY2VvZiBiMkNpcmNsZVNoYXBlID8gdGhpcy5tX2ZpeHR1cmVBLkdldFNoYXBlKCkgOiBudWxsKSwgYkEubV94ZiwgKHRoaXMubV9maXh0dXJlQi5HZXRTaGFwZSgpIGluc3RhbmNlb2YgYjJDaXJjbGVTaGFwZSA/IHRoaXMubV9maXh0dXJlQi5HZXRTaGFwZSgpIDogbnVsbCksIGJCLm1feGYpO1xuICAgfVxuICAgYjJDb250YWN0LmIyQ29udGFjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMubV9ub2RlQSA9IG5ldyBiMkNvbnRhY3RFZGdlKCk7XG4gICAgICB0aGlzLm1fbm9kZUIgPSBuZXcgYjJDb250YWN0RWRnZSgpO1xuICAgICAgdGhpcy5tX21hbmlmb2xkID0gbmV3IGIyTWFuaWZvbGQoKTtcbiAgICAgIHRoaXMubV9vbGRNYW5pZm9sZCA9IG5ldyBiMk1hbmlmb2xkKCk7XG4gICB9O1xuICAgYjJDb250YWN0LnByb3RvdHlwZS5HZXRNYW5pZm9sZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fbWFuaWZvbGQ7XG4gICB9XG4gICBiMkNvbnRhY3QucHJvdG90eXBlLkdldFdvcmxkTWFuaWZvbGQgPSBmdW5jdGlvbiAod29ybGRNYW5pZm9sZCkge1xuICAgICAgdmFyIGJvZHlBID0gdGhpcy5tX2ZpeHR1cmVBLkdldEJvZHkoKTtcbiAgICAgIHZhciBib2R5QiA9IHRoaXMubV9maXh0dXJlQi5HZXRCb2R5KCk7XG4gICAgICB2YXIgc2hhcGVBID0gdGhpcy5tX2ZpeHR1cmVBLkdldFNoYXBlKCk7XG4gICAgICB2YXIgc2hhcGVCID0gdGhpcy5tX2ZpeHR1cmVCLkdldFNoYXBlKCk7XG4gICAgICB3b3JsZE1hbmlmb2xkLkluaXRpYWxpemUodGhpcy5tX21hbmlmb2xkLCBib2R5QS5HZXRUcmFuc2Zvcm0oKSwgc2hhcGVBLm1fcmFkaXVzLCBib2R5Qi5HZXRUcmFuc2Zvcm0oKSwgc2hhcGVCLm1fcmFkaXVzKTtcbiAgIH1cbiAgIGIyQ29udGFjdC5wcm90b3R5cGUuSXNUb3VjaGluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiAodGhpcy5tX2ZsYWdzICYgYjJDb250YWN0LmVfdG91Y2hpbmdGbGFnKSA9PSBiMkNvbnRhY3QuZV90b3VjaGluZ0ZsYWc7XG4gICB9XG4gICBiMkNvbnRhY3QucHJvdG90eXBlLklzQ29udGludW91cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiAodGhpcy5tX2ZsYWdzICYgYjJDb250YWN0LmVfY29udGludW91c0ZsYWcpID09IGIyQ29udGFjdC5lX2NvbnRpbnVvdXNGbGFnO1xuICAgfVxuICAgYjJDb250YWN0LnByb3RvdHlwZS5TZXRTZW5zb3IgPSBmdW5jdGlvbiAoc2Vuc29yKSB7XG4gICAgICBpZiAoc2Vuc29yKSB7XG4gICAgICAgICB0aGlzLm1fZmxhZ3MgfD0gYjJDb250YWN0LmVfc2Vuc29yRmxhZztcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICAgdGhpcy5tX2ZsYWdzICY9IH5iMkNvbnRhY3QuZV9zZW5zb3JGbGFnO1xuICAgICAgfVxuICAgfVxuICAgYjJDb250YWN0LnByb3RvdHlwZS5Jc1NlbnNvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiAodGhpcy5tX2ZsYWdzICYgYjJDb250YWN0LmVfc2Vuc29yRmxhZykgPT0gYjJDb250YWN0LmVfc2Vuc29yRmxhZztcbiAgIH1cbiAgIGIyQ29udGFjdC5wcm90b3R5cGUuU2V0RW5hYmxlZCA9IGZ1bmN0aW9uIChmbGFnKSB7XG4gICAgICBpZiAoZmxhZykge1xuICAgICAgICAgdGhpcy5tX2ZsYWdzIHw9IGIyQ29udGFjdC5lX2VuYWJsZWRGbGFnO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgICB0aGlzLm1fZmxhZ3MgJj0gfmIyQ29udGFjdC5lX2VuYWJsZWRGbGFnO1xuICAgICAgfVxuICAgfVxuICAgYjJDb250YWN0LnByb3RvdHlwZS5Jc0VuYWJsZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gKHRoaXMubV9mbGFncyAmIGIyQ29udGFjdC5lX2VuYWJsZWRGbGFnKSA9PSBiMkNvbnRhY3QuZV9lbmFibGVkRmxhZztcbiAgIH1cbiAgIGIyQ29udGFjdC5wcm90b3R5cGUuR2V0TmV4dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fbmV4dDtcbiAgIH1cbiAgIGIyQ29udGFjdC5wcm90b3R5cGUuR2V0Rml4dHVyZUEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX2ZpeHR1cmVBO1xuICAgfVxuICAgYjJDb250YWN0LnByb3RvdHlwZS5HZXRGaXh0dXJlQiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fZml4dHVyZUI7XG4gICB9XG4gICBiMkNvbnRhY3QucHJvdG90eXBlLkZsYWdGb3JGaWx0ZXJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLm1fZmxhZ3MgfD0gYjJDb250YWN0LmVfZmlsdGVyRmxhZztcbiAgIH1cbiAgIGIyQ29udGFjdC5wcm90b3R5cGUuYjJDb250YWN0ID0gZnVuY3Rpb24gKCkge31cbiAgIGIyQ29udGFjdC5wcm90b3R5cGUuUmVzZXQgPSBmdW5jdGlvbiAoZml4dHVyZUEsIGZpeHR1cmVCKSB7XG4gICAgICBpZiAoZml4dHVyZUEgPT09IHVuZGVmaW5lZCkgZml4dHVyZUEgPSBudWxsO1xuICAgICAgaWYgKGZpeHR1cmVCID09PSB1bmRlZmluZWQpIGZpeHR1cmVCID0gbnVsbDtcbiAgICAgIHRoaXMubV9mbGFncyA9IGIyQ29udGFjdC5lX2VuYWJsZWRGbGFnO1xuICAgICAgaWYgKCFmaXh0dXJlQSB8fCAhZml4dHVyZUIpIHtcbiAgICAgICAgIHRoaXMubV9maXh0dXJlQSA9IG51bGw7XG4gICAgICAgICB0aGlzLm1fZml4dHVyZUIgPSBudWxsO1xuICAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKGZpeHR1cmVBLklzU2Vuc29yKCkgfHwgZml4dHVyZUIuSXNTZW5zb3IoKSkge1xuICAgICAgICAgdGhpcy5tX2ZsYWdzIHw9IGIyQ29udGFjdC5lX3NlbnNvckZsYWc7XG4gICAgICB9XG4gICAgICB2YXIgYm9keUEgPSBmaXh0dXJlQS5HZXRCb2R5KCk7XG4gICAgICB2YXIgYm9keUIgPSBmaXh0dXJlQi5HZXRCb2R5KCk7XG4gICAgICBpZiAoYm9keUEuR2V0VHlwZSgpICE9IGIyQm9keS5iMl9keW5hbWljQm9keSB8fCBib2R5QS5Jc0J1bGxldCgpIHx8IGJvZHlCLkdldFR5cGUoKSAhPSBiMkJvZHkuYjJfZHluYW1pY0JvZHkgfHwgYm9keUIuSXNCdWxsZXQoKSkge1xuICAgICAgICAgdGhpcy5tX2ZsYWdzIHw9IGIyQ29udGFjdC5lX2NvbnRpbnVvdXNGbGFnO1xuICAgICAgfVxuICAgICAgdGhpcy5tX2ZpeHR1cmVBID0gZml4dHVyZUE7XG4gICAgICB0aGlzLm1fZml4dHVyZUIgPSBmaXh0dXJlQjtcbiAgICAgIHRoaXMubV9tYW5pZm9sZC5tX3BvaW50Q291bnQgPSAwO1xuICAgICAgdGhpcy5tX3ByZXYgPSBudWxsO1xuICAgICAgdGhpcy5tX25leHQgPSBudWxsO1xuICAgICAgdGhpcy5tX25vZGVBLmNvbnRhY3QgPSBudWxsO1xuICAgICAgdGhpcy5tX25vZGVBLnByZXYgPSBudWxsO1xuICAgICAgdGhpcy5tX25vZGVBLm5leHQgPSBudWxsO1xuICAgICAgdGhpcy5tX25vZGVBLm90aGVyID0gbnVsbDtcbiAgICAgIHRoaXMubV9ub2RlQi5jb250YWN0ID0gbnVsbDtcbiAgICAgIHRoaXMubV9ub2RlQi5wcmV2ID0gbnVsbDtcbiAgICAgIHRoaXMubV9ub2RlQi5uZXh0ID0gbnVsbDtcbiAgICAgIHRoaXMubV9ub2RlQi5vdGhlciA9IG51bGw7XG4gICB9XG4gICBiMkNvbnRhY3QucHJvdG90eXBlLlVwZGF0ZSA9IGZ1bmN0aW9uIChsaXN0ZW5lcikge1xuICAgICAgdmFyIHRNYW5pZm9sZCA9IHRoaXMubV9vbGRNYW5pZm9sZDtcbiAgICAgIHRoaXMubV9vbGRNYW5pZm9sZCA9IHRoaXMubV9tYW5pZm9sZDtcbiAgICAgIHRoaXMubV9tYW5pZm9sZCA9IHRNYW5pZm9sZDtcbiAgICAgIHRoaXMubV9mbGFncyB8PSBiMkNvbnRhY3QuZV9lbmFibGVkRmxhZztcbiAgICAgIHZhciB0b3VjaGluZyA9IGZhbHNlO1xuICAgICAgdmFyIHdhc1RvdWNoaW5nID0gKHRoaXMubV9mbGFncyAmIGIyQ29udGFjdC5lX3RvdWNoaW5nRmxhZykgPT0gYjJDb250YWN0LmVfdG91Y2hpbmdGbGFnO1xuICAgICAgdmFyIGJvZHlBID0gdGhpcy5tX2ZpeHR1cmVBLm1fYm9keTtcbiAgICAgIHZhciBib2R5QiA9IHRoaXMubV9maXh0dXJlQi5tX2JvZHk7XG4gICAgICB2YXIgYWFiYk92ZXJsYXAgPSB0aGlzLm1fZml4dHVyZUEubV9hYWJiLlRlc3RPdmVybGFwKHRoaXMubV9maXh0dXJlQi5tX2FhYmIpO1xuICAgICAgaWYgKHRoaXMubV9mbGFncyAmIGIyQ29udGFjdC5lX3NlbnNvckZsYWcpIHtcbiAgICAgICAgIGlmIChhYWJiT3ZlcmxhcCkge1xuICAgICAgICAgICAgdmFyIHNoYXBlQSA9IHRoaXMubV9maXh0dXJlQS5HZXRTaGFwZSgpO1xuICAgICAgICAgICAgdmFyIHNoYXBlQiA9IHRoaXMubV9maXh0dXJlQi5HZXRTaGFwZSgpO1xuICAgICAgICAgICAgdmFyIHhmQSA9IGJvZHlBLkdldFRyYW5zZm9ybSgpO1xuICAgICAgICAgICAgdmFyIHhmQiA9IGJvZHlCLkdldFRyYW5zZm9ybSgpO1xuICAgICAgICAgICAgdG91Y2hpbmcgPSBiMlNoYXBlLlRlc3RPdmVybGFwKHNoYXBlQSwgeGZBLCBzaGFwZUIsIHhmQik7XG4gICAgICAgICB9XG4gICAgICAgICB0aGlzLm1fbWFuaWZvbGQubV9wb2ludENvdW50ID0gMDtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICAgaWYgKGJvZHlBLkdldFR5cGUoKSAhPSBiMkJvZHkuYjJfZHluYW1pY0JvZHkgfHwgYm9keUEuSXNCdWxsZXQoKSB8fCBib2R5Qi5HZXRUeXBlKCkgIT0gYjJCb2R5LmIyX2R5bmFtaWNCb2R5IHx8IGJvZHlCLklzQnVsbGV0KCkpIHtcbiAgICAgICAgICAgIHRoaXMubV9mbGFncyB8PSBiMkNvbnRhY3QuZV9jb250aW51b3VzRmxhZztcbiAgICAgICAgIH1cbiAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5tX2ZsYWdzICY9IH5iMkNvbnRhY3QuZV9jb250aW51b3VzRmxhZztcbiAgICAgICAgIH1cbiAgICAgICAgIGlmIChhYWJiT3ZlcmxhcCkge1xuICAgICAgICAgICAgdGhpcy5FdmFsdWF0ZSgpO1xuICAgICAgICAgICAgdG91Y2hpbmcgPSB0aGlzLm1fbWFuaWZvbGQubV9wb2ludENvdW50ID4gMDtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX21hbmlmb2xkLm1fcG9pbnRDb3VudDsgKytpKSB7XG4gICAgICAgICAgICAgICB2YXIgbXAyID0gdGhpcy5tX21hbmlmb2xkLm1fcG9pbnRzW2ldO1xuICAgICAgICAgICAgICAgbXAyLm1fbm9ybWFsSW1wdWxzZSA9IDAuMDtcbiAgICAgICAgICAgICAgIG1wMi5tX3RhbmdlbnRJbXB1bHNlID0gMC4wO1xuICAgICAgICAgICAgICAgdmFyIGlkMiA9IG1wMi5tX2lkO1xuICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLm1fb2xkTWFuaWZvbGQubV9wb2ludENvdW50OyArK2opIHtcbiAgICAgICAgICAgICAgICAgIHZhciBtcDEgPSB0aGlzLm1fb2xkTWFuaWZvbGQubV9wb2ludHNbal07XG4gICAgICAgICAgICAgICAgICBpZiAobXAxLm1faWQua2V5ID09IGlkMi5rZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgIG1wMi5tX25vcm1hbEltcHVsc2UgPSBtcDEubV9ub3JtYWxJbXB1bHNlO1xuICAgICAgICAgICAgICAgICAgICAgbXAyLm1fdGFuZ2VudEltcHVsc2UgPSBtcDEubV90YW5nZW50SW1wdWxzZTtcbiAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgfVxuICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm1fbWFuaWZvbGQubV9wb2ludENvdW50ID0gMDtcbiAgICAgICAgIH1cbiAgICAgICAgIGlmICh0b3VjaGluZyAhPSB3YXNUb3VjaGluZykge1xuICAgICAgICAgICAgYm9keUEuU2V0QXdha2UodHJ1ZSk7XG4gICAgICAgICAgICBib2R5Qi5TZXRBd2FrZSh0cnVlKTtcbiAgICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICh0b3VjaGluZykge1xuICAgICAgICAgdGhpcy5tX2ZsYWdzIHw9IGIyQ29udGFjdC5lX3RvdWNoaW5nRmxhZztcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICAgdGhpcy5tX2ZsYWdzICY9IH5iMkNvbnRhY3QuZV90b3VjaGluZ0ZsYWc7XG4gICAgICB9XG4gICAgICBpZiAod2FzVG91Y2hpbmcgPT0gZmFsc2UgJiYgdG91Y2hpbmcgPT0gdHJ1ZSkge1xuICAgICAgICAgbGlzdGVuZXIuQmVnaW5Db250YWN0KHRoaXMpO1xuICAgICAgfVxuICAgICAgaWYgKHdhc1RvdWNoaW5nID09IHRydWUgJiYgdG91Y2hpbmcgPT0gZmFsc2UpIHtcbiAgICAgICAgIGxpc3RlbmVyLkVuZENvbnRhY3QodGhpcyk7XG4gICAgICB9XG4gICAgICBpZiAoKHRoaXMubV9mbGFncyAmIGIyQ29udGFjdC5lX3NlbnNvckZsYWcpID09IDApIHtcbiAgICAgICAgIGxpc3RlbmVyLlByZVNvbHZlKHRoaXMsIHRoaXMubV9vbGRNYW5pZm9sZCk7XG4gICAgICB9XG4gICB9XG4gICBiMkNvbnRhY3QucHJvdG90eXBlLkV2YWx1YXRlID0gZnVuY3Rpb24gKCkge31cbiAgIGIyQ29udGFjdC5wcm90b3R5cGUuQ29tcHV0ZVRPSSA9IGZ1bmN0aW9uIChzd2VlcEEsIHN3ZWVwQikge1xuICAgICAgYjJDb250YWN0LnNfaW5wdXQucHJveHlBLlNldCh0aGlzLm1fZml4dHVyZUEuR2V0U2hhcGUoKSk7XG4gICAgICBiMkNvbnRhY3Quc19pbnB1dC5wcm94eUIuU2V0KHRoaXMubV9maXh0dXJlQi5HZXRTaGFwZSgpKTtcbiAgICAgIGIyQ29udGFjdC5zX2lucHV0LnN3ZWVwQSA9IHN3ZWVwQTtcbiAgICAgIGIyQ29udGFjdC5zX2lucHV0LnN3ZWVwQiA9IHN3ZWVwQjtcbiAgICAgIGIyQ29udGFjdC5zX2lucHV0LnRvbGVyYW5jZSA9IGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcDtcbiAgICAgIHJldHVybiBiMlRpbWVPZkltcGFjdC5UaW1lT2ZJbXBhY3QoYjJDb250YWN0LnNfaW5wdXQpO1xuICAgfVxuICAgQm94MkQucG9zdERlZnMucHVzaChmdW5jdGlvbiAoKSB7XG4gICAgICBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3QuZV9zZW5zb3JGbGFnID0gMHgwMDAxO1xuICAgICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0LmVfY29udGludW91c0ZsYWcgPSAweDAwMDI7XG4gICAgICBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3QuZV9pc2xhbmRGbGFnID0gMHgwMDA0O1xuICAgICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0LmVfdG9pRmxhZyA9IDB4MDAwODtcbiAgICAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdC5lX3RvdWNoaW5nRmxhZyA9IDB4MDAxMDtcbiAgICAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdC5lX2VuYWJsZWRGbGFnID0gMHgwMDIwO1xuICAgICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0LmVfZmlsdGVyRmxhZyA9IDB4MDA0MDtcbiAgICAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdC5zX2lucHV0ID0gbmV3IGIyVE9JSW5wdXQoKTtcbiAgIH0pO1xuICAgYjJDb250YWN0Q29uc3RyYWludC5iMkNvbnRhY3RDb25zdHJhaW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5sb2NhbFBsYW5lTm9ybWFsID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy5sb2NhbFBvaW50ID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy5ub3JtYWwgPSBuZXcgYjJWZWMyKCk7XG4gICAgICB0aGlzLm5vcm1hbE1hc3MgPSBuZXcgYjJNYXQyMigpO1xuICAgICAgdGhpcy5LID0gbmV3IGIyTWF0MjIoKTtcbiAgIH07XG4gICBiMkNvbnRhY3RDb25zdHJhaW50LnByb3RvdHlwZS5iMkNvbnRhY3RDb25zdHJhaW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5wb2ludHMgPSBuZXcgVmVjdG9yKGIyU2V0dGluZ3MuYjJfbWF4TWFuaWZvbGRQb2ludHMpO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBiMlNldHRpbmdzLmIyX21heE1hbmlmb2xkUG9pbnRzOyBpKyspIHtcbiAgICAgICAgIHRoaXMucG9pbnRzW2ldID0gbmV3IGIyQ29udGFjdENvbnN0cmFpbnRQb2ludCgpO1xuICAgICAgfVxuICAgfVxuICAgYjJDb250YWN0Q29uc3RyYWludFBvaW50LmIyQ29udGFjdENvbnN0cmFpbnRQb2ludCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMubG9jYWxQb2ludCA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIHRoaXMuckEgPSBuZXcgYjJWZWMyKCk7XG4gICAgICB0aGlzLnJCID0gbmV3IGIyVmVjMigpO1xuICAgfTtcbiAgIGIyQ29udGFjdEVkZ2UuYjJDb250YWN0RWRnZSA9IGZ1bmN0aW9uICgpIHt9O1xuICAgYjJDb250YWN0RmFjdG9yeS5iMkNvbnRhY3RGYWN0b3J5ID0gZnVuY3Rpb24gKCkge307XG4gICBiMkNvbnRhY3RGYWN0b3J5LnByb3RvdHlwZS5iMkNvbnRhY3RGYWN0b3J5ID0gZnVuY3Rpb24gKGFsbG9jYXRvcikge1xuICAgICAgdGhpcy5tX2FsbG9jYXRvciA9IGFsbG9jYXRvcjtcbiAgICAgIHRoaXMuSW5pdGlhbGl6ZVJlZ2lzdGVycygpO1xuICAgfVxuICAgYjJDb250YWN0RmFjdG9yeS5wcm90b3R5cGUuQWRkVHlwZSA9IGZ1bmN0aW9uIChjcmVhdGVGY24sIGRlc3Ryb3lGY24sIHR5cGUxLCB0eXBlMikge1xuICAgICAgaWYgKHR5cGUxID09PSB1bmRlZmluZWQpIHR5cGUxID0gMDtcbiAgICAgIGlmICh0eXBlMiA9PT0gdW5kZWZpbmVkKSB0eXBlMiA9IDA7XG4gICAgICB0aGlzLm1fcmVnaXN0ZXJzW3R5cGUxXVt0eXBlMl0uY3JlYXRlRmNuID0gY3JlYXRlRmNuO1xuICAgICAgdGhpcy5tX3JlZ2lzdGVyc1t0eXBlMV1bdHlwZTJdLmRlc3Ryb3lGY24gPSBkZXN0cm95RmNuO1xuICAgICAgdGhpcy5tX3JlZ2lzdGVyc1t0eXBlMV1bdHlwZTJdLnByaW1hcnkgPSB0cnVlO1xuICAgICAgaWYgKHR5cGUxICE9IHR5cGUyKSB7XG4gICAgICAgICB0aGlzLm1fcmVnaXN0ZXJzW3R5cGUyXVt0eXBlMV0uY3JlYXRlRmNuID0gY3JlYXRlRmNuO1xuICAgICAgICAgdGhpcy5tX3JlZ2lzdGVyc1t0eXBlMl1bdHlwZTFdLmRlc3Ryb3lGY24gPSBkZXN0cm95RmNuO1xuICAgICAgICAgdGhpcy5tX3JlZ2lzdGVyc1t0eXBlMl1bdHlwZTFdLnByaW1hcnkgPSBmYWxzZTtcbiAgICAgIH1cbiAgIH1cbiAgIGIyQ29udGFjdEZhY3RvcnkucHJvdG90eXBlLkluaXRpYWxpemVSZWdpc3RlcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLm1fcmVnaXN0ZXJzID0gbmV3IFZlY3RvcihiMlNoYXBlLmVfc2hhcGVUeXBlQ291bnQpO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBiMlNoYXBlLmVfc2hhcGVUeXBlQ291bnQ7IGkrKykge1xuICAgICAgICAgdGhpcy5tX3JlZ2lzdGVyc1tpXSA9IG5ldyBWZWN0b3IoYjJTaGFwZS5lX3NoYXBlVHlwZUNvdW50KTtcbiAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgYjJTaGFwZS5lX3NoYXBlVHlwZUNvdW50OyBqKyspIHtcbiAgICAgICAgICAgIHRoaXMubV9yZWdpc3RlcnNbaV1bal0gPSBuZXcgYjJDb250YWN0UmVnaXN0ZXIoKTtcbiAgICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHRoaXMuQWRkVHlwZShiMkNpcmNsZUNvbnRhY3QuQ3JlYXRlLCBiMkNpcmNsZUNvbnRhY3QuRGVzdHJveSwgYjJTaGFwZS5lX2NpcmNsZVNoYXBlLCBiMlNoYXBlLmVfY2lyY2xlU2hhcGUpO1xuICAgICAgdGhpcy5BZGRUeXBlKGIyUG9seUFuZENpcmNsZUNvbnRhY3QuQ3JlYXRlLCBiMlBvbHlBbmRDaXJjbGVDb250YWN0LkRlc3Ryb3ksIGIyU2hhcGUuZV9wb2x5Z29uU2hhcGUsIGIyU2hhcGUuZV9jaXJjbGVTaGFwZSk7XG4gICAgICB0aGlzLkFkZFR5cGUoYjJQb2x5Z29uQ29udGFjdC5DcmVhdGUsIGIyUG9seWdvbkNvbnRhY3QuRGVzdHJveSwgYjJTaGFwZS5lX3BvbHlnb25TaGFwZSwgYjJTaGFwZS5lX3BvbHlnb25TaGFwZSk7XG4gICAgICB0aGlzLkFkZFR5cGUoYjJFZGdlQW5kQ2lyY2xlQ29udGFjdC5DcmVhdGUsIGIyRWRnZUFuZENpcmNsZUNvbnRhY3QuRGVzdHJveSwgYjJTaGFwZS5lX2VkZ2VTaGFwZSwgYjJTaGFwZS5lX2NpcmNsZVNoYXBlKTtcbiAgICAgIHRoaXMuQWRkVHlwZShiMlBvbHlBbmRFZGdlQ29udGFjdC5DcmVhdGUsIGIyUG9seUFuZEVkZ2VDb250YWN0LkRlc3Ryb3ksIGIyU2hhcGUuZV9wb2x5Z29uU2hhcGUsIGIyU2hhcGUuZV9lZGdlU2hhcGUpO1xuICAgfVxuICAgYjJDb250YWN0RmFjdG9yeS5wcm90b3R5cGUuQ3JlYXRlID0gZnVuY3Rpb24gKGZpeHR1cmVBLCBmaXh0dXJlQikge1xuICAgICAgdmFyIHR5cGUxID0gcGFyc2VJbnQoZml4dHVyZUEuR2V0VHlwZSgpKTtcbiAgICAgIHZhciB0eXBlMiA9IHBhcnNlSW50KGZpeHR1cmVCLkdldFR5cGUoKSk7XG4gICAgICB2YXIgcmVnID0gdGhpcy5tX3JlZ2lzdGVyc1t0eXBlMV1bdHlwZTJdO1xuICAgICAgdmFyIGM7XG4gICAgICBpZiAocmVnLnBvb2wpIHtcbiAgICAgICAgIGMgPSByZWcucG9vbDtcbiAgICAgICAgIHJlZy5wb29sID0gYy5tX25leHQ7XG4gICAgICAgICByZWcucG9vbENvdW50LS07XG4gICAgICAgICBjLlJlc2V0KGZpeHR1cmVBLCBmaXh0dXJlQik7XG4gICAgICAgICByZXR1cm4gYztcbiAgICAgIH1cbiAgICAgIHZhciBjcmVhdGVGY24gPSByZWcuY3JlYXRlRmNuO1xuICAgICAgaWYgKGNyZWF0ZUZjbiAhPSBudWxsKSB7XG4gICAgICAgICBpZiAocmVnLnByaW1hcnkpIHtcbiAgICAgICAgICAgIGMgPSBjcmVhdGVGY24odGhpcy5tX2FsbG9jYXRvcik7XG4gICAgICAgICAgICBjLlJlc2V0KGZpeHR1cmVBLCBmaXh0dXJlQik7XG4gICAgICAgICAgICByZXR1cm4gYztcbiAgICAgICAgIH1cbiAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgYyA9IGNyZWF0ZUZjbih0aGlzLm1fYWxsb2NhdG9yKTtcbiAgICAgICAgICAgIGMuUmVzZXQoZml4dHVyZUIsIGZpeHR1cmVBKTtcbiAgICAgICAgICAgIHJldHVybiBjO1xuICAgICAgICAgfVxuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgIH1cbiAgIGIyQ29udGFjdEZhY3RvcnkucHJvdG90eXBlLkRlc3Ryb3kgPSBmdW5jdGlvbiAoY29udGFjdCkge1xuICAgICAgaWYgKGNvbnRhY3QubV9tYW5pZm9sZC5tX3BvaW50Q291bnQgPiAwKSB7XG4gICAgICAgICBjb250YWN0Lm1fZml4dHVyZUEubV9ib2R5LlNldEF3YWtlKHRydWUpO1xuICAgICAgICAgY29udGFjdC5tX2ZpeHR1cmVCLm1fYm9keS5TZXRBd2FrZSh0cnVlKTtcbiAgICAgIH1cbiAgICAgIHZhciB0eXBlMSA9IHBhcnNlSW50KGNvbnRhY3QubV9maXh0dXJlQS5HZXRUeXBlKCkpO1xuICAgICAgdmFyIHR5cGUyID0gcGFyc2VJbnQoY29udGFjdC5tX2ZpeHR1cmVCLkdldFR5cGUoKSk7XG4gICAgICB2YXIgcmVnID0gdGhpcy5tX3JlZ2lzdGVyc1t0eXBlMV1bdHlwZTJdO1xuICAgICAgaWYgKHRydWUpIHtcbiAgICAgICAgIHJlZy5wb29sQ291bnQrKztcbiAgICAgICAgIGNvbnRhY3QubV9uZXh0ID0gcmVnLnBvb2w7XG4gICAgICAgICByZWcucG9vbCA9IGNvbnRhY3Q7XG4gICAgICB9XG4gICAgICB2YXIgZGVzdHJveUZjbiA9IHJlZy5kZXN0cm95RmNuO1xuICAgICAgZGVzdHJveUZjbihjb250YWN0LCB0aGlzLm1fYWxsb2NhdG9yKTtcbiAgIH1cbiAgIGIyQ29udGFjdFJlZ2lzdGVyLmIyQ29udGFjdFJlZ2lzdGVyID0gZnVuY3Rpb24gKCkge307XG4gICBiMkNvbnRhY3RSZXN1bHQuYjJDb250YWN0UmVzdWx0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5wb3NpdGlvbiA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIHRoaXMubm9ybWFsID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy5pZCA9IG5ldyBiMkNvbnRhY3RJRCgpO1xuICAgfTtcbiAgIGIyQ29udGFjdFNvbHZlci5iMkNvbnRhY3RTb2x2ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLm1fc3RlcCA9IG5ldyBiMlRpbWVTdGVwKCk7XG4gICAgICB0aGlzLm1fY29uc3RyYWludHMgPSBuZXcgVmVjdG9yKCk7XG4gICB9O1xuICAgYjJDb250YWN0U29sdmVyLnByb3RvdHlwZS5iMkNvbnRhY3RTb2x2ZXIgPSBmdW5jdGlvbiAoKSB7fVxuICAgYjJDb250YWN0U29sdmVyLnByb3RvdHlwZS5Jbml0aWFsaXplID0gZnVuY3Rpb24gKHN0ZXAsIGNvbnRhY3RzLCBjb250YWN0Q291bnQsIGFsbG9jYXRvcikge1xuICAgICAgaWYgKGNvbnRhY3RDb3VudCA9PT0gdW5kZWZpbmVkKSBjb250YWN0Q291bnQgPSAwO1xuICAgICAgdmFyIGNvbnRhY3Q7XG4gICAgICB0aGlzLm1fc3RlcC5TZXQoc3RlcCk7XG4gICAgICB0aGlzLm1fYWxsb2NhdG9yID0gYWxsb2NhdG9yO1xuICAgICAgdmFyIGkgPSAwO1xuICAgICAgdmFyIHRWZWM7XG4gICAgICB2YXIgdE1hdDtcbiAgICAgIHRoaXMubV9jb25zdHJhaW50Q291bnQgPSBjb250YWN0Q291bnQ7XG4gICAgICB3aGlsZSAodGhpcy5tX2NvbnN0cmFpbnRzLmxlbmd0aCA8IHRoaXMubV9jb25zdHJhaW50Q291bnQpIHtcbiAgICAgICAgIHRoaXMubV9jb25zdHJhaW50c1t0aGlzLm1fY29uc3RyYWludHMubGVuZ3RoXSA9IG5ldyBiMkNvbnRhY3RDb25zdHJhaW50KCk7XG4gICAgICB9XG4gICAgICBmb3IgKGkgPSAwO1xuICAgICAgaSA8IGNvbnRhY3RDb3VudDsgKytpKSB7XG4gICAgICAgICBjb250YWN0ID0gY29udGFjdHNbaV07XG4gICAgICAgICB2YXIgZml4dHVyZUEgPSBjb250YWN0Lm1fZml4dHVyZUE7XG4gICAgICAgICB2YXIgZml4dHVyZUIgPSBjb250YWN0Lm1fZml4dHVyZUI7XG4gICAgICAgICB2YXIgc2hhcGVBID0gZml4dHVyZUEubV9zaGFwZTtcbiAgICAgICAgIHZhciBzaGFwZUIgPSBmaXh0dXJlQi5tX3NoYXBlO1xuICAgICAgICAgdmFyIHJhZGl1c0EgPSBzaGFwZUEubV9yYWRpdXM7XG4gICAgICAgICB2YXIgcmFkaXVzQiA9IHNoYXBlQi5tX3JhZGl1cztcbiAgICAgICAgIHZhciBib2R5QSA9IGZpeHR1cmVBLm1fYm9keTtcbiAgICAgICAgIHZhciBib2R5QiA9IGZpeHR1cmVCLm1fYm9keTtcbiAgICAgICAgIHZhciBtYW5pZm9sZCA9IGNvbnRhY3QuR2V0TWFuaWZvbGQoKTtcbiAgICAgICAgIHZhciBmcmljdGlvbiA9IGIyU2V0dGluZ3MuYjJNaXhGcmljdGlvbihmaXh0dXJlQS5HZXRGcmljdGlvbigpLCBmaXh0dXJlQi5HZXRGcmljdGlvbigpKTtcbiAgICAgICAgIHZhciByZXN0aXR1dGlvbiA9IGIyU2V0dGluZ3MuYjJNaXhSZXN0aXR1dGlvbihmaXh0dXJlQS5HZXRSZXN0aXR1dGlvbigpLCBmaXh0dXJlQi5HZXRSZXN0aXR1dGlvbigpKTtcbiAgICAgICAgIHZhciB2QVggPSBib2R5QS5tX2xpbmVhclZlbG9jaXR5Lng7XG4gICAgICAgICB2YXIgdkFZID0gYm9keUEubV9saW5lYXJWZWxvY2l0eS55O1xuICAgICAgICAgdmFyIHZCWCA9IGJvZHlCLm1fbGluZWFyVmVsb2NpdHkueDtcbiAgICAgICAgIHZhciB2QlkgPSBib2R5Qi5tX2xpbmVhclZlbG9jaXR5Lnk7XG4gICAgICAgICB2YXIgd0EgPSBib2R5QS5tX2FuZ3VsYXJWZWxvY2l0eTtcbiAgICAgICAgIHZhciB3QiA9IGJvZHlCLm1fYW5ndWxhclZlbG9jaXR5O1xuICAgICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydChtYW5pZm9sZC5tX3BvaW50Q291bnQgPiAwKTtcbiAgICAgICAgIGIyQ29udGFjdFNvbHZlci5zX3dvcmxkTWFuaWZvbGQuSW5pdGlhbGl6ZShtYW5pZm9sZCwgYm9keUEubV94ZiwgcmFkaXVzQSwgYm9keUIubV94ZiwgcmFkaXVzQik7XG4gICAgICAgICB2YXIgbm9ybWFsWCA9IGIyQ29udGFjdFNvbHZlci5zX3dvcmxkTWFuaWZvbGQubV9ub3JtYWwueDtcbiAgICAgICAgIHZhciBub3JtYWxZID0gYjJDb250YWN0U29sdmVyLnNfd29ybGRNYW5pZm9sZC5tX25vcm1hbC55O1xuICAgICAgICAgdmFyIGNjID0gdGhpcy5tX2NvbnN0cmFpbnRzW2ldO1xuICAgICAgICAgY2MuYm9keUEgPSBib2R5QTtcbiAgICAgICAgIGNjLmJvZHlCID0gYm9keUI7XG4gICAgICAgICBjYy5tYW5pZm9sZCA9IG1hbmlmb2xkO1xuICAgICAgICAgY2Mubm9ybWFsLnggPSBub3JtYWxYO1xuICAgICAgICAgY2Mubm9ybWFsLnkgPSBub3JtYWxZO1xuICAgICAgICAgY2MucG9pbnRDb3VudCA9IG1hbmlmb2xkLm1fcG9pbnRDb3VudDtcbiAgICAgICAgIGNjLmZyaWN0aW9uID0gZnJpY3Rpb247XG4gICAgICAgICBjYy5yZXN0aXR1dGlvbiA9IHJlc3RpdHV0aW9uO1xuICAgICAgICAgY2MubG9jYWxQbGFuZU5vcm1hbC54ID0gbWFuaWZvbGQubV9sb2NhbFBsYW5lTm9ybWFsLng7XG4gICAgICAgICBjYy5sb2NhbFBsYW5lTm9ybWFsLnkgPSBtYW5pZm9sZC5tX2xvY2FsUGxhbmVOb3JtYWwueTtcbiAgICAgICAgIGNjLmxvY2FsUG9pbnQueCA9IG1hbmlmb2xkLm1fbG9jYWxQb2ludC54O1xuICAgICAgICAgY2MubG9jYWxQb2ludC55ID0gbWFuaWZvbGQubV9sb2NhbFBvaW50Lnk7XG4gICAgICAgICBjYy5yYWRpdXMgPSByYWRpdXNBICsgcmFkaXVzQjtcbiAgICAgICAgIGNjLnR5cGUgPSBtYW5pZm9sZC5tX3R5cGU7XG4gICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IGNjLnBvaW50Q291bnQ7ICsraykge1xuICAgICAgICAgICAgdmFyIGNwID0gbWFuaWZvbGQubV9wb2ludHNba107XG4gICAgICAgICAgICB2YXIgY2NwID0gY2MucG9pbnRzW2tdO1xuICAgICAgICAgICAgY2NwLm5vcm1hbEltcHVsc2UgPSBjcC5tX25vcm1hbEltcHVsc2U7XG4gICAgICAgICAgICBjY3AudGFuZ2VudEltcHVsc2UgPSBjcC5tX3RhbmdlbnRJbXB1bHNlO1xuICAgICAgICAgICAgY2NwLmxvY2FsUG9pbnQuU2V0VihjcC5tX2xvY2FsUG9pbnQpO1xuICAgICAgICAgICAgdmFyIHJBWCA9IGNjcC5yQS54ID0gYjJDb250YWN0U29sdmVyLnNfd29ybGRNYW5pZm9sZC5tX3BvaW50c1trXS54IC0gYm9keUEubV9zd2VlcC5jLng7XG4gICAgICAgICAgICB2YXIgckFZID0gY2NwLnJBLnkgPSBiMkNvbnRhY3RTb2x2ZXIuc193b3JsZE1hbmlmb2xkLm1fcG9pbnRzW2tdLnkgLSBib2R5QS5tX3N3ZWVwLmMueTtcbiAgICAgICAgICAgIHZhciByQlggPSBjY3AuckIueCA9IGIyQ29udGFjdFNvbHZlci5zX3dvcmxkTWFuaWZvbGQubV9wb2ludHNba10ueCAtIGJvZHlCLm1fc3dlZXAuYy54O1xuICAgICAgICAgICAgdmFyIHJCWSA9IGNjcC5yQi55ID0gYjJDb250YWN0U29sdmVyLnNfd29ybGRNYW5pZm9sZC5tX3BvaW50c1trXS55IC0gYm9keUIubV9zd2VlcC5jLnk7XG4gICAgICAgICAgICB2YXIgcm5BID0gckFYICogbm9ybWFsWSAtIHJBWSAqIG5vcm1hbFg7XG4gICAgICAgICAgICB2YXIgcm5CID0gckJYICogbm9ybWFsWSAtIHJCWSAqIG5vcm1hbFg7XG4gICAgICAgICAgICBybkEgKj0gcm5BO1xuICAgICAgICAgICAgcm5CICo9IHJuQjtcbiAgICAgICAgICAgIHZhciBrTm9ybWFsID0gYm9keUEubV9pbnZNYXNzICsgYm9keUIubV9pbnZNYXNzICsgYm9keUEubV9pbnZJICogcm5BICsgYm9keUIubV9pbnZJICogcm5CO1xuICAgICAgICAgICAgY2NwLm5vcm1hbE1hc3MgPSAxLjAgLyBrTm9ybWFsO1xuICAgICAgICAgICAgdmFyIGtFcXVhbGl6ZWQgPSBib2R5QS5tX21hc3MgKiBib2R5QS5tX2ludk1hc3MgKyBib2R5Qi5tX21hc3MgKiBib2R5Qi5tX2ludk1hc3M7XG4gICAgICAgICAgICBrRXF1YWxpemVkICs9IGJvZHlBLm1fbWFzcyAqIGJvZHlBLm1faW52SSAqIHJuQSArIGJvZHlCLm1fbWFzcyAqIGJvZHlCLm1faW52SSAqIHJuQjtcbiAgICAgICAgICAgIGNjcC5lcXVhbGl6ZWRNYXNzID0gMS4wIC8ga0VxdWFsaXplZDtcbiAgICAgICAgICAgIHZhciB0YW5nZW50WCA9IG5vcm1hbFk7XG4gICAgICAgICAgICB2YXIgdGFuZ2VudFkgPSAoLW5vcm1hbFgpO1xuICAgICAgICAgICAgdmFyIHJ0QSA9IHJBWCAqIHRhbmdlbnRZIC0gckFZICogdGFuZ2VudFg7XG4gICAgICAgICAgICB2YXIgcnRCID0gckJYICogdGFuZ2VudFkgLSByQlkgKiB0YW5nZW50WDtcbiAgICAgICAgICAgIHJ0QSAqPSBydEE7XG4gICAgICAgICAgICBydEIgKj0gcnRCO1xuICAgICAgICAgICAgdmFyIGtUYW5nZW50ID0gYm9keUEubV9pbnZNYXNzICsgYm9keUIubV9pbnZNYXNzICsgYm9keUEubV9pbnZJICogcnRBICsgYm9keUIubV9pbnZJICogcnRCO1xuICAgICAgICAgICAgY2NwLnRhbmdlbnRNYXNzID0gMS4wIC8ga1RhbmdlbnQ7XG4gICAgICAgICAgICBjY3AudmVsb2NpdHlCaWFzID0gMC4wO1xuICAgICAgICAgICAgdmFyIHRYID0gdkJYICsgKCgtd0IgKiByQlkpKSAtIHZBWCAtICgoLXdBICogckFZKSk7XG4gICAgICAgICAgICB2YXIgdFkgPSB2QlkgKyAod0IgKiByQlgpIC0gdkFZIC0gKHdBICogckFYKTtcbiAgICAgICAgICAgIHZhciB2UmVsID0gY2Mubm9ybWFsLnggKiB0WCArIGNjLm5vcm1hbC55ICogdFk7XG4gICAgICAgICAgICBpZiAodlJlbCA8ICgtYjJTZXR0aW5ncy5iMl92ZWxvY2l0eVRocmVzaG9sZCkpIHtcbiAgICAgICAgICAgICAgIGNjcC52ZWxvY2l0eUJpYXMgKz0gKC1jYy5yZXN0aXR1dGlvbiAqIHZSZWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgfVxuICAgICAgICAgaWYgKGNjLnBvaW50Q291bnQgPT0gMikge1xuICAgICAgICAgICAgdmFyIGNjcDEgPSBjYy5wb2ludHNbMF07XG4gICAgICAgICAgICB2YXIgY2NwMiA9IGNjLnBvaW50c1sxXTtcbiAgICAgICAgICAgIHZhciBpbnZNYXNzQSA9IGJvZHlBLm1faW52TWFzcztcbiAgICAgICAgICAgIHZhciBpbnZJQSA9IGJvZHlBLm1faW52STtcbiAgICAgICAgICAgIHZhciBpbnZNYXNzQiA9IGJvZHlCLm1faW52TWFzcztcbiAgICAgICAgICAgIHZhciBpbnZJQiA9IGJvZHlCLm1faW52STtcbiAgICAgICAgICAgIHZhciBybjFBID0gY2NwMS5yQS54ICogbm9ybWFsWSAtIGNjcDEuckEueSAqIG5vcm1hbFg7XG4gICAgICAgICAgICB2YXIgcm4xQiA9IGNjcDEuckIueCAqIG5vcm1hbFkgLSBjY3AxLnJCLnkgKiBub3JtYWxYO1xuICAgICAgICAgICAgdmFyIHJuMkEgPSBjY3AyLnJBLnggKiBub3JtYWxZIC0gY2NwMi5yQS55ICogbm9ybWFsWDtcbiAgICAgICAgICAgIHZhciBybjJCID0gY2NwMi5yQi54ICogbm9ybWFsWSAtIGNjcDIuckIueSAqIG5vcm1hbFg7XG4gICAgICAgICAgICB2YXIgazExID0gaW52TWFzc0EgKyBpbnZNYXNzQiArIGludklBICogcm4xQSAqIHJuMUEgKyBpbnZJQiAqIHJuMUIgKiBybjFCO1xuICAgICAgICAgICAgdmFyIGsyMiA9IGludk1hc3NBICsgaW52TWFzc0IgKyBpbnZJQSAqIHJuMkEgKiBybjJBICsgaW52SUIgKiBybjJCICogcm4yQjtcbiAgICAgICAgICAgIHZhciBrMTIgPSBpbnZNYXNzQSArIGludk1hc3NCICsgaW52SUEgKiBybjFBICogcm4yQSArIGludklCICogcm4xQiAqIHJuMkI7XG4gICAgICAgICAgICB2YXIga19tYXhDb25kaXRpb25OdW1iZXIgPSAxMDAuMDtcbiAgICAgICAgICAgIGlmIChrMTEgKiBrMTEgPCBrX21heENvbmRpdGlvbk51bWJlciAqIChrMTEgKiBrMjIgLSBrMTIgKiBrMTIpKSB7XG4gICAgICAgICAgICAgICBjYy5LLmNvbDEuU2V0KGsxMSwgazEyKTtcbiAgICAgICAgICAgICAgIGNjLksuY29sMi5TZXQoazEyLCBrMjIpO1xuICAgICAgICAgICAgICAgY2MuSy5HZXRJbnZlcnNlKGNjLm5vcm1hbE1hc3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICBjYy5wb2ludENvdW50ID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgIH1cbiAgICAgIH1cbiAgIH1cbiAgIGIyQ29udGFjdFNvbHZlci5wcm90b3R5cGUuSW5pdFZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbiAoc3RlcCkge1xuICAgICAgdmFyIHRWZWM7XG4gICAgICB2YXIgdFZlYzI7XG4gICAgICB2YXIgdE1hdDtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2NvbnN0cmFpbnRDb3VudDsgKytpKSB7XG4gICAgICAgICB2YXIgYyA9IHRoaXMubV9jb25zdHJhaW50c1tpXTtcbiAgICAgICAgIHZhciBib2R5QSA9IGMuYm9keUE7XG4gICAgICAgICB2YXIgYm9keUIgPSBjLmJvZHlCO1xuICAgICAgICAgdmFyIGludk1hc3NBID0gYm9keUEubV9pbnZNYXNzO1xuICAgICAgICAgdmFyIGludklBID0gYm9keUEubV9pbnZJO1xuICAgICAgICAgdmFyIGludk1hc3NCID0gYm9keUIubV9pbnZNYXNzO1xuICAgICAgICAgdmFyIGludklCID0gYm9keUIubV9pbnZJO1xuICAgICAgICAgdmFyIG5vcm1hbFggPSBjLm5vcm1hbC54O1xuICAgICAgICAgdmFyIG5vcm1hbFkgPSBjLm5vcm1hbC55O1xuICAgICAgICAgdmFyIHRhbmdlbnRYID0gbm9ybWFsWTtcbiAgICAgICAgIHZhciB0YW5nZW50WSA9ICgtbm9ybWFsWCk7XG4gICAgICAgICB2YXIgdFggPSAwO1xuICAgICAgICAgdmFyIGogPSAwO1xuICAgICAgICAgdmFyIHRDb3VudCA9IDA7XG4gICAgICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcbiAgICAgICAgICAgIHRDb3VudCA9IGMucG9pbnRDb3VudDtcbiAgICAgICAgICAgIGZvciAoaiA9IDA7XG4gICAgICAgICAgICBqIDwgdENvdW50OyArK2opIHtcbiAgICAgICAgICAgICAgIHZhciBjY3AgPSBjLnBvaW50c1tqXTtcbiAgICAgICAgICAgICAgIGNjcC5ub3JtYWxJbXB1bHNlICo9IHN0ZXAuZHRSYXRpbztcbiAgICAgICAgICAgICAgIGNjcC50YW5nZW50SW1wdWxzZSAqPSBzdGVwLmR0UmF0aW87XG4gICAgICAgICAgICAgICB2YXIgUFggPSBjY3Aubm9ybWFsSW1wdWxzZSAqIG5vcm1hbFggKyBjY3AudGFuZ2VudEltcHVsc2UgKiB0YW5nZW50WDtcbiAgICAgICAgICAgICAgIHZhciBQWSA9IGNjcC5ub3JtYWxJbXB1bHNlICogbm9ybWFsWSArIGNjcC50YW5nZW50SW1wdWxzZSAqIHRhbmdlbnRZO1xuICAgICAgICAgICAgICAgYm9keUEubV9hbmd1bGFyVmVsb2NpdHkgLT0gaW52SUEgKiAoY2NwLnJBLnggKiBQWSAtIGNjcC5yQS55ICogUFgpO1xuICAgICAgICAgICAgICAgYm9keUEubV9saW5lYXJWZWxvY2l0eS54IC09IGludk1hc3NBICogUFg7XG4gICAgICAgICAgICAgICBib2R5QS5tX2xpbmVhclZlbG9jaXR5LnkgLT0gaW52TWFzc0EgKiBQWTtcbiAgICAgICAgICAgICAgIGJvZHlCLm1fYW5ndWxhclZlbG9jaXR5ICs9IGludklCICogKGNjcC5yQi54ICogUFkgLSBjY3AuckIueSAqIFBYKTtcbiAgICAgICAgICAgICAgIGJvZHlCLm1fbGluZWFyVmVsb2NpdHkueCArPSBpbnZNYXNzQiAqIFBYO1xuICAgICAgICAgICAgICAgYm9keUIubV9saW5lYXJWZWxvY2l0eS55ICs9IGludk1hc3NCICogUFk7XG4gICAgICAgICAgICB9XG4gICAgICAgICB9XG4gICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRDb3VudCA9IGMucG9pbnRDb3VudDtcbiAgICAgICAgICAgIGZvciAoaiA9IDA7XG4gICAgICAgICAgICBqIDwgdENvdW50OyArK2opIHtcbiAgICAgICAgICAgICAgIHZhciBjY3AyID0gYy5wb2ludHNbal07XG4gICAgICAgICAgICAgICBjY3AyLm5vcm1hbEltcHVsc2UgPSAwLjA7XG4gICAgICAgICAgICAgICBjY3AyLnRhbmdlbnRJbXB1bHNlID0gMC4wO1xuICAgICAgICAgICAgfVxuICAgICAgICAgfVxuICAgICAgfVxuICAgfVxuICAgYjJDb250YWN0U29sdmVyLnByb3RvdHlwZS5Tb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgaiA9IDA7XG4gICAgICB2YXIgY2NwO1xuICAgICAgdmFyIHJBWCA9IDA7XG4gICAgICB2YXIgckFZID0gMDtcbiAgICAgIHZhciByQlggPSAwO1xuICAgICAgdmFyIHJCWSA9IDA7XG4gICAgICB2YXIgZHZYID0gMDtcbiAgICAgIHZhciBkdlkgPSAwO1xuICAgICAgdmFyIHZuID0gMDtcbiAgICAgIHZhciB2dCA9IDA7XG4gICAgICB2YXIgbGFtYmRhID0gMDtcbiAgICAgIHZhciBtYXhGcmljdGlvbiA9IDA7XG4gICAgICB2YXIgbmV3SW1wdWxzZSA9IDA7XG4gICAgICB2YXIgUFggPSAwO1xuICAgICAgdmFyIFBZID0gMDtcbiAgICAgIHZhciBkWCA9IDA7XG4gICAgICB2YXIgZFkgPSAwO1xuICAgICAgdmFyIFAxWCA9IDA7XG4gICAgICB2YXIgUDFZID0gMDtcbiAgICAgIHZhciBQMlggPSAwO1xuICAgICAgdmFyIFAyWSA9IDA7XG4gICAgICB2YXIgdE1hdDtcbiAgICAgIHZhciB0VmVjO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY29uc3RyYWludENvdW50OyArK2kpIHtcbiAgICAgICAgIHZhciBjID0gdGhpcy5tX2NvbnN0cmFpbnRzW2ldO1xuICAgICAgICAgdmFyIGJvZHlBID0gYy5ib2R5QTtcbiAgICAgICAgIHZhciBib2R5QiA9IGMuYm9keUI7XG4gICAgICAgICB2YXIgd0EgPSBib2R5QS5tX2FuZ3VsYXJWZWxvY2l0eTtcbiAgICAgICAgIHZhciB3QiA9IGJvZHlCLm1fYW5ndWxhclZlbG9jaXR5O1xuICAgICAgICAgdmFyIHZBID0gYm9keUEubV9saW5lYXJWZWxvY2l0eTtcbiAgICAgICAgIHZhciB2QiA9IGJvZHlCLm1fbGluZWFyVmVsb2NpdHk7XG4gICAgICAgICB2YXIgaW52TWFzc0EgPSBib2R5QS5tX2ludk1hc3M7XG4gICAgICAgICB2YXIgaW52SUEgPSBib2R5QS5tX2ludkk7XG4gICAgICAgICB2YXIgaW52TWFzc0IgPSBib2R5Qi5tX2ludk1hc3M7XG4gICAgICAgICB2YXIgaW52SUIgPSBib2R5Qi5tX2ludkk7XG4gICAgICAgICB2YXIgbm9ybWFsWCA9IGMubm9ybWFsLng7XG4gICAgICAgICB2YXIgbm9ybWFsWSA9IGMubm9ybWFsLnk7XG4gICAgICAgICB2YXIgdGFuZ2VudFggPSBub3JtYWxZO1xuICAgICAgICAgdmFyIHRhbmdlbnRZID0gKC1ub3JtYWxYKTtcbiAgICAgICAgIHZhciBmcmljdGlvbiA9IGMuZnJpY3Rpb247XG4gICAgICAgICB2YXIgdFggPSAwO1xuICAgICAgICAgZm9yIChqID0gMDtcbiAgICAgICAgIGogPCBjLnBvaW50Q291bnQ7IGorKykge1xuICAgICAgICAgICAgY2NwID0gYy5wb2ludHNbal07XG4gICAgICAgICAgICBkdlggPSB2Qi54IC0gd0IgKiBjY3AuckIueSAtIHZBLnggKyB3QSAqIGNjcC5yQS55O1xuICAgICAgICAgICAgZHZZID0gdkIueSArIHdCICogY2NwLnJCLnggLSB2QS55IC0gd0EgKiBjY3AuckEueDtcbiAgICAgICAgICAgIHZ0ID0gZHZYICogdGFuZ2VudFggKyBkdlkgKiB0YW5nZW50WTtcbiAgICAgICAgICAgIGxhbWJkYSA9IGNjcC50YW5nZW50TWFzcyAqICgtdnQpO1xuICAgICAgICAgICAgbWF4RnJpY3Rpb24gPSBmcmljdGlvbiAqIGNjcC5ub3JtYWxJbXB1bHNlO1xuICAgICAgICAgICAgbmV3SW1wdWxzZSA9IGIyTWF0aC5DbGFtcChjY3AudGFuZ2VudEltcHVsc2UgKyBsYW1iZGEsICgtbWF4RnJpY3Rpb24pLCBtYXhGcmljdGlvbik7XG4gICAgICAgICAgICBsYW1iZGEgPSBuZXdJbXB1bHNlIC0gY2NwLnRhbmdlbnRJbXB1bHNlO1xuICAgICAgICAgICAgUFggPSBsYW1iZGEgKiB0YW5nZW50WDtcbiAgICAgICAgICAgIFBZID0gbGFtYmRhICogdGFuZ2VudFk7XG4gICAgICAgICAgICB2QS54IC09IGludk1hc3NBICogUFg7XG4gICAgICAgICAgICB2QS55IC09IGludk1hc3NBICogUFk7XG4gICAgICAgICAgICB3QSAtPSBpbnZJQSAqIChjY3AuckEueCAqIFBZIC0gY2NwLnJBLnkgKiBQWCk7XG4gICAgICAgICAgICB2Qi54ICs9IGludk1hc3NCICogUFg7XG4gICAgICAgICAgICB2Qi55ICs9IGludk1hc3NCICogUFk7XG4gICAgICAgICAgICB3QiArPSBpbnZJQiAqIChjY3AuckIueCAqIFBZIC0gY2NwLnJCLnkgKiBQWCk7XG4gICAgICAgICAgICBjY3AudGFuZ2VudEltcHVsc2UgPSBuZXdJbXB1bHNlO1xuICAgICAgICAgfVxuICAgICAgICAgdmFyIHRDb3VudCA9IHBhcnNlSW50KGMucG9pbnRDb3VudCk7XG4gICAgICAgICBpZiAoYy5wb2ludENvdW50ID09IDEpIHtcbiAgICAgICAgICAgIGNjcCA9IGMucG9pbnRzWzBdO1xuICAgICAgICAgICAgZHZYID0gdkIueCArICgoLXdCICogY2NwLnJCLnkpKSAtIHZBLnggLSAoKC13QSAqIGNjcC5yQS55KSk7XG4gICAgICAgICAgICBkdlkgPSB2Qi55ICsgKHdCICogY2NwLnJCLngpIC0gdkEueSAtICh3QSAqIGNjcC5yQS54KTtcbiAgICAgICAgICAgIHZuID0gZHZYICogbm9ybWFsWCArIGR2WSAqIG5vcm1hbFk7XG4gICAgICAgICAgICBsYW1iZGEgPSAoLWNjcC5ub3JtYWxNYXNzICogKHZuIC0gY2NwLnZlbG9jaXR5QmlhcykpO1xuICAgICAgICAgICAgbmV3SW1wdWxzZSA9IGNjcC5ub3JtYWxJbXB1bHNlICsgbGFtYmRhO1xuICAgICAgICAgICAgbmV3SW1wdWxzZSA9IG5ld0ltcHVsc2UgPiAwID8gbmV3SW1wdWxzZSA6IDAuMDtcbiAgICAgICAgICAgIGxhbWJkYSA9IG5ld0ltcHVsc2UgLSBjY3Aubm9ybWFsSW1wdWxzZTtcbiAgICAgICAgICAgIFBYID0gbGFtYmRhICogbm9ybWFsWDtcbiAgICAgICAgICAgIFBZID0gbGFtYmRhICogbm9ybWFsWTtcbiAgICAgICAgICAgIHZBLnggLT0gaW52TWFzc0EgKiBQWDtcbiAgICAgICAgICAgIHZBLnkgLT0gaW52TWFzc0EgKiBQWTtcbiAgICAgICAgICAgIHdBIC09IGludklBICogKGNjcC5yQS54ICogUFkgLSBjY3AuckEueSAqIFBYKTtcbiAgICAgICAgICAgIHZCLnggKz0gaW52TWFzc0IgKiBQWDtcbiAgICAgICAgICAgIHZCLnkgKz0gaW52TWFzc0IgKiBQWTtcbiAgICAgICAgICAgIHdCICs9IGludklCICogKGNjcC5yQi54ICogUFkgLSBjY3AuckIueSAqIFBYKTtcbiAgICAgICAgICAgIGNjcC5ub3JtYWxJbXB1bHNlID0gbmV3SW1wdWxzZTtcbiAgICAgICAgIH1cbiAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIGNwMSA9IGMucG9pbnRzWzBdO1xuICAgICAgICAgICAgdmFyIGNwMiA9IGMucG9pbnRzWzFdO1xuICAgICAgICAgICAgdmFyIGFYID0gY3AxLm5vcm1hbEltcHVsc2U7XG4gICAgICAgICAgICB2YXIgYVkgPSBjcDIubm9ybWFsSW1wdWxzZTtcbiAgICAgICAgICAgIHZhciBkdjFYID0gdkIueCAtIHdCICogY3AxLnJCLnkgLSB2QS54ICsgd0EgKiBjcDEuckEueTtcbiAgICAgICAgICAgIHZhciBkdjFZID0gdkIueSArIHdCICogY3AxLnJCLnggLSB2QS55IC0gd0EgKiBjcDEuckEueDtcbiAgICAgICAgICAgIHZhciBkdjJYID0gdkIueCAtIHdCICogY3AyLnJCLnkgLSB2QS54ICsgd0EgKiBjcDIuckEueTtcbiAgICAgICAgICAgIHZhciBkdjJZID0gdkIueSArIHdCICogY3AyLnJCLnggLSB2QS55IC0gd0EgKiBjcDIuckEueDtcbiAgICAgICAgICAgIHZhciB2bjEgPSBkdjFYICogbm9ybWFsWCArIGR2MVkgKiBub3JtYWxZO1xuICAgICAgICAgICAgdmFyIHZuMiA9IGR2MlggKiBub3JtYWxYICsgZHYyWSAqIG5vcm1hbFk7XG4gICAgICAgICAgICB2YXIgYlggPSB2bjEgLSBjcDEudmVsb2NpdHlCaWFzO1xuICAgICAgICAgICAgdmFyIGJZID0gdm4yIC0gY3AyLnZlbG9jaXR5QmlhcztcbiAgICAgICAgICAgIHRNYXQgPSBjLks7XG4gICAgICAgICAgICBiWCAtPSB0TWF0LmNvbDEueCAqIGFYICsgdE1hdC5jb2wyLnggKiBhWTtcbiAgICAgICAgICAgIGJZIC09IHRNYXQuY29sMS55ICogYVggKyB0TWF0LmNvbDIueSAqIGFZO1xuICAgICAgICAgICAgdmFyIGtfZXJyb3JUb2wgPSAwLjAwMTtcbiAgICAgICAgICAgIGZvciAoOzspIHtcbiAgICAgICAgICAgICAgIHRNYXQgPSBjLm5vcm1hbE1hc3M7XG4gICAgICAgICAgICAgICB2YXIgeFggPSAoLSh0TWF0LmNvbDEueCAqIGJYICsgdE1hdC5jb2wyLnggKiBiWSkpO1xuICAgICAgICAgICAgICAgdmFyIHhZID0gKC0odE1hdC5jb2wxLnkgKiBiWCArIHRNYXQuY29sMi55ICogYlkpKTtcbiAgICAgICAgICAgICAgIGlmICh4WCA+PSAwLjAgJiYgeFkgPj0gMC4wKSB7XG4gICAgICAgICAgICAgICAgICBkWCA9IHhYIC0gYVg7XG4gICAgICAgICAgICAgICAgICBkWSA9IHhZIC0gYVk7XG4gICAgICAgICAgICAgICAgICBQMVggPSBkWCAqIG5vcm1hbFg7XG4gICAgICAgICAgICAgICAgICBQMVkgPSBkWCAqIG5vcm1hbFk7XG4gICAgICAgICAgICAgICAgICBQMlggPSBkWSAqIG5vcm1hbFg7XG4gICAgICAgICAgICAgICAgICBQMlkgPSBkWSAqIG5vcm1hbFk7XG4gICAgICAgICAgICAgICAgICB2QS54IC09IGludk1hc3NBICogKFAxWCArIFAyWCk7XG4gICAgICAgICAgICAgICAgICB2QS55IC09IGludk1hc3NBICogKFAxWSArIFAyWSk7XG4gICAgICAgICAgICAgICAgICB3QSAtPSBpbnZJQSAqIChjcDEuckEueCAqIFAxWSAtIGNwMS5yQS55ICogUDFYICsgY3AyLnJBLnggKiBQMlkgLSBjcDIuckEueSAqIFAyWCk7XG4gICAgICAgICAgICAgICAgICB2Qi54ICs9IGludk1hc3NCICogKFAxWCArIFAyWCk7XG4gICAgICAgICAgICAgICAgICB2Qi55ICs9IGludk1hc3NCICogKFAxWSArIFAyWSk7XG4gICAgICAgICAgICAgICAgICB3QiArPSBpbnZJQiAqIChjcDEuckIueCAqIFAxWSAtIGNwMS5yQi55ICogUDFYICsgY3AyLnJCLnggKiBQMlkgLSBjcDIuckIueSAqIFAyWCk7XG4gICAgICAgICAgICAgICAgICBjcDEubm9ybWFsSW1wdWxzZSA9IHhYO1xuICAgICAgICAgICAgICAgICAgY3AyLm5vcm1hbEltcHVsc2UgPSB4WTtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgeFggPSAoLWNwMS5ub3JtYWxNYXNzICogYlgpO1xuICAgICAgICAgICAgICAgeFkgPSAwLjA7XG4gICAgICAgICAgICAgICB2bjEgPSAwLjA7XG4gICAgICAgICAgICAgICB2bjIgPSBjLksuY29sMS55ICogeFggKyBiWTtcbiAgICAgICAgICAgICAgIGlmICh4WCA+PSAwLjAgJiYgdm4yID49IDAuMCkge1xuICAgICAgICAgICAgICAgICAgZFggPSB4WCAtIGFYO1xuICAgICAgICAgICAgICAgICAgZFkgPSB4WSAtIGFZO1xuICAgICAgICAgICAgICAgICAgUDFYID0gZFggKiBub3JtYWxYO1xuICAgICAgICAgICAgICAgICAgUDFZID0gZFggKiBub3JtYWxZO1xuICAgICAgICAgICAgICAgICAgUDJYID0gZFkgKiBub3JtYWxYO1xuICAgICAgICAgICAgICAgICAgUDJZID0gZFkgKiBub3JtYWxZO1xuICAgICAgICAgICAgICAgICAgdkEueCAtPSBpbnZNYXNzQSAqIChQMVggKyBQMlgpO1xuICAgICAgICAgICAgICAgICAgdkEueSAtPSBpbnZNYXNzQSAqIChQMVkgKyBQMlkpO1xuICAgICAgICAgICAgICAgICAgd0EgLT0gaW52SUEgKiAoY3AxLnJBLnggKiBQMVkgLSBjcDEuckEueSAqIFAxWCArIGNwMi5yQS54ICogUDJZIC0gY3AyLnJBLnkgKiBQMlgpO1xuICAgICAgICAgICAgICAgICAgdkIueCArPSBpbnZNYXNzQiAqIChQMVggKyBQMlgpO1xuICAgICAgICAgICAgICAgICAgdkIueSArPSBpbnZNYXNzQiAqIChQMVkgKyBQMlkpO1xuICAgICAgICAgICAgICAgICAgd0IgKz0gaW52SUIgKiAoY3AxLnJCLnggKiBQMVkgLSBjcDEuckIueSAqIFAxWCArIGNwMi5yQi54ICogUDJZIC0gY3AyLnJCLnkgKiBQMlgpO1xuICAgICAgICAgICAgICAgICAgY3AxLm5vcm1hbEltcHVsc2UgPSB4WDtcbiAgICAgICAgICAgICAgICAgIGNwMi5ub3JtYWxJbXB1bHNlID0geFk7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgIHhYID0gMC4wO1xuICAgICAgICAgICAgICAgeFkgPSAoLWNwMi5ub3JtYWxNYXNzICogYlkpO1xuICAgICAgICAgICAgICAgdm4xID0gYy5LLmNvbDIueCAqIHhZICsgYlg7XG4gICAgICAgICAgICAgICB2bjIgPSAwLjA7XG4gICAgICAgICAgICAgICBpZiAoeFkgPj0gMC4wICYmIHZuMSA+PSAwLjApIHtcbiAgICAgICAgICAgICAgICAgIGRYID0geFggLSBhWDtcbiAgICAgICAgICAgICAgICAgIGRZID0geFkgLSBhWTtcbiAgICAgICAgICAgICAgICAgIFAxWCA9IGRYICogbm9ybWFsWDtcbiAgICAgICAgICAgICAgICAgIFAxWSA9IGRYICogbm9ybWFsWTtcbiAgICAgICAgICAgICAgICAgIFAyWCA9IGRZICogbm9ybWFsWDtcbiAgICAgICAgICAgICAgICAgIFAyWSA9IGRZICogbm9ybWFsWTtcbiAgICAgICAgICAgICAgICAgIHZBLnggLT0gaW52TWFzc0EgKiAoUDFYICsgUDJYKTtcbiAgICAgICAgICAgICAgICAgIHZBLnkgLT0gaW52TWFzc0EgKiAoUDFZICsgUDJZKTtcbiAgICAgICAgICAgICAgICAgIHdBIC09IGludklBICogKGNwMS5yQS54ICogUDFZIC0gY3AxLnJBLnkgKiBQMVggKyBjcDIuckEueCAqIFAyWSAtIGNwMi5yQS55ICogUDJYKTtcbiAgICAgICAgICAgICAgICAgIHZCLnggKz0gaW52TWFzc0IgKiAoUDFYICsgUDJYKTtcbiAgICAgICAgICAgICAgICAgIHZCLnkgKz0gaW52TWFzc0IgKiAoUDFZICsgUDJZKTtcbiAgICAgICAgICAgICAgICAgIHdCICs9IGludklCICogKGNwMS5yQi54ICogUDFZIC0gY3AxLnJCLnkgKiBQMVggKyBjcDIuckIueCAqIFAyWSAtIGNwMi5yQi55ICogUDJYKTtcbiAgICAgICAgICAgICAgICAgIGNwMS5ub3JtYWxJbXB1bHNlID0geFg7XG4gICAgICAgICAgICAgICAgICBjcDIubm9ybWFsSW1wdWxzZSA9IHhZO1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICB4WCA9IDAuMDtcbiAgICAgICAgICAgICAgIHhZID0gMC4wO1xuICAgICAgICAgICAgICAgdm4xID0gYlg7XG4gICAgICAgICAgICAgICB2bjIgPSBiWTtcbiAgICAgICAgICAgICAgIGlmICh2bjEgPj0gMC4wICYmIHZuMiA+PSAwLjApIHtcbiAgICAgICAgICAgICAgICAgIGRYID0geFggLSBhWDtcbiAgICAgICAgICAgICAgICAgIGRZID0geFkgLSBhWTtcbiAgICAgICAgICAgICAgICAgIFAxWCA9IGRYICogbm9ybWFsWDtcbiAgICAgICAgICAgICAgICAgIFAxWSA9IGRYICogbm9ybWFsWTtcbiAgICAgICAgICAgICAgICAgIFAyWCA9IGRZICogbm9ybWFsWDtcbiAgICAgICAgICAgICAgICAgIFAyWSA9IGRZICogbm9ybWFsWTtcbiAgICAgICAgICAgICAgICAgIHZBLnggLT0gaW52TWFzc0EgKiAoUDFYICsgUDJYKTtcbiAgICAgICAgICAgICAgICAgIHZBLnkgLT0gaW52TWFzc0EgKiAoUDFZICsgUDJZKTtcbiAgICAgICAgICAgICAgICAgIHdBIC09IGludklBICogKGNwMS5yQS54ICogUDFZIC0gY3AxLnJBLnkgKiBQMVggKyBjcDIuckEueCAqIFAyWSAtIGNwMi5yQS55ICogUDJYKTtcbiAgICAgICAgICAgICAgICAgIHZCLnggKz0gaW52TWFzc0IgKiAoUDFYICsgUDJYKTtcbiAgICAgICAgICAgICAgICAgIHZCLnkgKz0gaW52TWFzc0IgKiAoUDFZICsgUDJZKTtcbiAgICAgICAgICAgICAgICAgIHdCICs9IGludklCICogKGNwMS5yQi54ICogUDFZIC0gY3AxLnJCLnkgKiBQMVggKyBjcDIuckIueCAqIFAyWSAtIGNwMi5yQi55ICogUDJYKTtcbiAgICAgICAgICAgICAgICAgIGNwMS5ub3JtYWxJbXB1bHNlID0geFg7XG4gICAgICAgICAgICAgICAgICBjcDIubm9ybWFsSW1wdWxzZSA9IHhZO1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgIH1cbiAgICAgICAgIGJvZHlBLm1fYW5ndWxhclZlbG9jaXR5ID0gd0E7XG4gICAgICAgICBib2R5Qi5tX2FuZ3VsYXJWZWxvY2l0eSA9IHdCO1xuICAgICAgfVxuICAgfVxuICAgYjJDb250YWN0U29sdmVyLnByb3RvdHlwZS5GaW5hbGl6ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb25zdHJhaW50Q291bnQ7ICsraSkge1xuICAgICAgICAgdmFyIGMgPSB0aGlzLm1fY29uc3RyYWludHNbaV07XG4gICAgICAgICB2YXIgbSA9IGMubWFuaWZvbGQ7XG4gICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGMucG9pbnRDb3VudDsgKytqKSB7XG4gICAgICAgICAgICB2YXIgcG9pbnQxID0gbS5tX3BvaW50c1tqXTtcbiAgICAgICAgICAgIHZhciBwb2ludDIgPSBjLnBvaW50c1tqXTtcbiAgICAgICAgICAgIHBvaW50MS5tX25vcm1hbEltcHVsc2UgPSBwb2ludDIubm9ybWFsSW1wdWxzZTtcbiAgICAgICAgICAgIHBvaW50MS5tX3RhbmdlbnRJbXB1bHNlID0gcG9pbnQyLnRhbmdlbnRJbXB1bHNlO1xuICAgICAgICAgfVxuICAgICAgfVxuICAgfVxuICAgYjJDb250YWN0U29sdmVyLnByb3RvdHlwZS5Tb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMgPSBmdW5jdGlvbiAoYmF1bWdhcnRlKSB7XG4gICAgICBpZiAoYmF1bWdhcnRlID09PSB1bmRlZmluZWQpIGJhdW1nYXJ0ZSA9IDA7XG4gICAgICB2YXIgbWluU2VwYXJhdGlvbiA9IDAuMDtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2NvbnN0cmFpbnRDb3VudDsgaSsrKSB7XG4gICAgICAgICB2YXIgYyA9IHRoaXMubV9jb25zdHJhaW50c1tpXTtcbiAgICAgICAgIHZhciBib2R5QSA9IGMuYm9keUE7XG4gICAgICAgICB2YXIgYm9keUIgPSBjLmJvZHlCO1xuICAgICAgICAgdmFyIGludk1hc3NBID0gYm9keUEubV9tYXNzICogYm9keUEubV9pbnZNYXNzO1xuICAgICAgICAgdmFyIGludklBID0gYm9keUEubV9tYXNzICogYm9keUEubV9pbnZJO1xuICAgICAgICAgdmFyIGludk1hc3NCID0gYm9keUIubV9tYXNzICogYm9keUIubV9pbnZNYXNzO1xuICAgICAgICAgdmFyIGludklCID0gYm9keUIubV9tYXNzICogYm9keUIubV9pbnZJO1xuICAgICAgICAgYjJDb250YWN0U29sdmVyLnNfcHNtLkluaXRpYWxpemUoYyk7XG4gICAgICAgICB2YXIgbm9ybWFsID0gYjJDb250YWN0U29sdmVyLnNfcHNtLm1fbm9ybWFsO1xuICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBjLnBvaW50Q291bnQ7IGorKykge1xuICAgICAgICAgICAgdmFyIGNjcCA9IGMucG9pbnRzW2pdO1xuICAgICAgICAgICAgdmFyIHBvaW50ID0gYjJDb250YWN0U29sdmVyLnNfcHNtLm1fcG9pbnRzW2pdO1xuICAgICAgICAgICAgdmFyIHNlcGFyYXRpb24gPSBiMkNvbnRhY3RTb2x2ZXIuc19wc20ubV9zZXBhcmF0aW9uc1tqXTtcbiAgICAgICAgICAgIHZhciByQVggPSBwb2ludC54IC0gYm9keUEubV9zd2VlcC5jLng7XG4gICAgICAgICAgICB2YXIgckFZID0gcG9pbnQueSAtIGJvZHlBLm1fc3dlZXAuYy55O1xuICAgICAgICAgICAgdmFyIHJCWCA9IHBvaW50LnggLSBib2R5Qi5tX3N3ZWVwLmMueDtcbiAgICAgICAgICAgIHZhciByQlkgPSBwb2ludC55IC0gYm9keUIubV9zd2VlcC5jLnk7XG4gICAgICAgICAgICBtaW5TZXBhcmF0aW9uID0gbWluU2VwYXJhdGlvbiA8IHNlcGFyYXRpb24gPyBtaW5TZXBhcmF0aW9uIDogc2VwYXJhdGlvbjtcbiAgICAgICAgICAgIHZhciBDID0gYjJNYXRoLkNsYW1wKGJhdW1nYXJ0ZSAqIChzZXBhcmF0aW9uICsgYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wKSwgKC1iMlNldHRpbmdzLmIyX21heExpbmVhckNvcnJlY3Rpb24pLCAwLjApO1xuICAgICAgICAgICAgdmFyIGltcHVsc2UgPSAoLWNjcC5lcXVhbGl6ZWRNYXNzICogQyk7XG4gICAgICAgICAgICB2YXIgUFggPSBpbXB1bHNlICogbm9ybWFsLng7XG4gICAgICAgICAgICB2YXIgUFkgPSBpbXB1bHNlICogbm9ybWFsLnk7Ym9keUEubV9zd2VlcC5jLnggLT0gaW52TWFzc0EgKiBQWDtcbiAgICAgICAgICAgIGJvZHlBLm1fc3dlZXAuYy55IC09IGludk1hc3NBICogUFk7XG4gICAgICAgICAgICBib2R5QS5tX3N3ZWVwLmEgLT0gaW52SUEgKiAockFYICogUFkgLSByQVkgKiBQWCk7XG4gICAgICAgICAgICBib2R5QS5TeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xuICAgICAgICAgICAgYm9keUIubV9zd2VlcC5jLnggKz0gaW52TWFzc0IgKiBQWDtcbiAgICAgICAgICAgIGJvZHlCLm1fc3dlZXAuYy55ICs9IGludk1hc3NCICogUFk7XG4gICAgICAgICAgICBib2R5Qi5tX3N3ZWVwLmEgKz0gaW52SUIgKiAockJYICogUFkgLSByQlkgKiBQWCk7XG4gICAgICAgICAgICBib2R5Qi5TeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xuICAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG1pblNlcGFyYXRpb24gPiAoLTEuNSAqIGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCk7XG4gICB9XG4gICBCb3gyRC5wb3N0RGVmcy5wdXNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdFNvbHZlci5zX3dvcmxkTWFuaWZvbGQgPSBuZXcgYjJXb3JsZE1hbmlmb2xkKCk7XG4gICAgICBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3RTb2x2ZXIuc19wc20gPSBuZXcgYjJQb3NpdGlvblNvbHZlck1hbmlmb2xkKCk7XG4gICB9KTtcbiAgIEJveDJELmluaGVyaXQoYjJFZGdlQW5kQ2lyY2xlQ29udGFjdCwgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0KTtcbiAgIGIyRWRnZUFuZENpcmNsZUNvbnRhY3QucHJvdG90eXBlLl9fc3VwZXIgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3QucHJvdG90eXBlO1xuICAgYjJFZGdlQW5kQ2lyY2xlQ29udGFjdC5iMkVkZ2VBbmRDaXJjbGVDb250YWN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0LmIyQ29udGFjdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIGIyRWRnZUFuZENpcmNsZUNvbnRhY3QuQ3JlYXRlID0gZnVuY3Rpb24gKGFsbG9jYXRvcikge1xuICAgICAgcmV0dXJuIG5ldyBiMkVkZ2VBbmRDaXJjbGVDb250YWN0KCk7XG4gICB9XG4gICBiMkVkZ2VBbmRDaXJjbGVDb250YWN0LkRlc3Ryb3kgPSBmdW5jdGlvbiAoY29udGFjdCwgYWxsb2NhdG9yKSB7fVxuICAgYjJFZGdlQW5kQ2lyY2xlQ29udGFjdC5wcm90b3R5cGUuUmVzZXQgPSBmdW5jdGlvbiAoZml4dHVyZUEsIGZpeHR1cmVCKSB7XG4gICAgICB0aGlzLl9fc3VwZXIuUmVzZXQuY2FsbCh0aGlzLCBmaXh0dXJlQSwgZml4dHVyZUIpO1xuICAgfVxuICAgYjJFZGdlQW5kQ2lyY2xlQ29udGFjdC5wcm90b3R5cGUuRXZhbHVhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgYkEgPSB0aGlzLm1fZml4dHVyZUEuR2V0Qm9keSgpO1xuICAgICAgdmFyIGJCID0gdGhpcy5tX2ZpeHR1cmVCLkdldEJvZHkoKTtcbiAgICAgIHRoaXMuYjJDb2xsaWRlRWRnZUFuZENpcmNsZSh0aGlzLm1fbWFuaWZvbGQsICh0aGlzLm1fZml4dHVyZUEuR2V0U2hhcGUoKSBpbnN0YW5jZW9mIGIyRWRnZVNoYXBlID8gdGhpcy5tX2ZpeHR1cmVBLkdldFNoYXBlKCkgOiBudWxsKSwgYkEubV94ZiwgKHRoaXMubV9maXh0dXJlQi5HZXRTaGFwZSgpIGluc3RhbmNlb2YgYjJDaXJjbGVTaGFwZSA/IHRoaXMubV9maXh0dXJlQi5HZXRTaGFwZSgpIDogbnVsbCksIGJCLm1feGYpO1xuICAgfVxuICAgYjJFZGdlQW5kQ2lyY2xlQ29udGFjdC5wcm90b3R5cGUuYjJDb2xsaWRlRWRnZUFuZENpcmNsZSA9IGZ1bmN0aW9uIChtYW5pZm9sZCwgZWRnZSwgeGYxLCBjaXJjbGUsIHhmMikge31cbiAgIEJveDJELmluaGVyaXQoYjJOdWxsQ29udGFjdCwgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0KTtcbiAgIGIyTnVsbENvbnRhY3QucHJvdG90eXBlLl9fc3VwZXIgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3QucHJvdG90eXBlO1xuICAgYjJOdWxsQ29udGFjdC5iMk51bGxDb250YWN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0LmIyQ29udGFjdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIGIyTnVsbENvbnRhY3QucHJvdG90eXBlLmIyTnVsbENvbnRhY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLl9fc3VwZXIuYjJDb250YWN0LmNhbGwodGhpcyk7XG4gICB9XG4gICBiMk51bGxDb250YWN0LnByb3RvdHlwZS5FdmFsdWF0ZSA9IGZ1bmN0aW9uICgpIHt9XG4gICBCb3gyRC5pbmhlcml0KGIyUG9seUFuZENpcmNsZUNvbnRhY3QsIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdCk7XG4gICBiMlBvbHlBbmRDaXJjbGVDb250YWN0LnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0LnByb3RvdHlwZTtcbiAgIGIyUG9seUFuZENpcmNsZUNvbnRhY3QuYjJQb2x5QW5kQ2lyY2xlQ29udGFjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdC5iMkNvbnRhY3QuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgIH07XG4gICBiMlBvbHlBbmRDaXJjbGVDb250YWN0LkNyZWF0ZSA9IGZ1bmN0aW9uIChhbGxvY2F0b3IpIHtcbiAgICAgIHJldHVybiBuZXcgYjJQb2x5QW5kQ2lyY2xlQ29udGFjdCgpO1xuICAgfVxuICAgYjJQb2x5QW5kQ2lyY2xlQ29udGFjdC5EZXN0cm95ID0gZnVuY3Rpb24gKGNvbnRhY3QsIGFsbG9jYXRvcikge31cbiAgIGIyUG9seUFuZENpcmNsZUNvbnRhY3QucHJvdG90eXBlLlJlc2V0ID0gZnVuY3Rpb24gKGZpeHR1cmVBLCBmaXh0dXJlQikge1xuICAgICAgdGhpcy5fX3N1cGVyLlJlc2V0LmNhbGwodGhpcywgZml4dHVyZUEsIGZpeHR1cmVCKTtcbiAgICAgIGIyU2V0dGluZ3MuYjJBc3NlcnQoZml4dHVyZUEuR2V0VHlwZSgpID09IGIyU2hhcGUuZV9wb2x5Z29uU2hhcGUpO1xuICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydChmaXh0dXJlQi5HZXRUeXBlKCkgPT0gYjJTaGFwZS5lX2NpcmNsZVNoYXBlKTtcbiAgIH1cbiAgIGIyUG9seUFuZENpcmNsZUNvbnRhY3QucHJvdG90eXBlLkV2YWx1YXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIGJBID0gdGhpcy5tX2ZpeHR1cmVBLm1fYm9keTtcbiAgICAgIHZhciBiQiA9IHRoaXMubV9maXh0dXJlQi5tX2JvZHk7XG4gICAgICBiMkNvbGxpc2lvbi5Db2xsaWRlUG9seWdvbkFuZENpcmNsZSh0aGlzLm1fbWFuaWZvbGQsICh0aGlzLm1fZml4dHVyZUEuR2V0U2hhcGUoKSBpbnN0YW5jZW9mIGIyUG9seWdvblNoYXBlID8gdGhpcy5tX2ZpeHR1cmVBLkdldFNoYXBlKCkgOiBudWxsKSwgYkEubV94ZiwgKHRoaXMubV9maXh0dXJlQi5HZXRTaGFwZSgpIGluc3RhbmNlb2YgYjJDaXJjbGVTaGFwZSA/IHRoaXMubV9maXh0dXJlQi5HZXRTaGFwZSgpIDogbnVsbCksIGJCLm1feGYpO1xuICAgfVxuICAgQm94MkQuaW5oZXJpdChiMlBvbHlBbmRFZGdlQ29udGFjdCwgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0KTtcbiAgIGIyUG9seUFuZEVkZ2VDb250YWN0LnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0LnByb3RvdHlwZTtcbiAgIGIyUG9seUFuZEVkZ2VDb250YWN0LmIyUG9seUFuZEVkZ2VDb250YWN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0LmIyQ29udGFjdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgfTtcbiAgIGIyUG9seUFuZEVkZ2VDb250YWN0LkNyZWF0ZSA9IGZ1bmN0aW9uIChhbGxvY2F0b3IpIHtcbiAgICAgIHJldHVybiBuZXcgYjJQb2x5QW5kRWRnZUNvbnRhY3QoKTtcbiAgIH1cbiAgIGIyUG9seUFuZEVkZ2VDb250YWN0LkRlc3Ryb3kgPSBmdW5jdGlvbiAoY29udGFjdCwgYWxsb2NhdG9yKSB7fVxuICAgYjJQb2x5QW5kRWRnZUNvbnRhY3QucHJvdG90eXBlLlJlc2V0ID0gZnVuY3Rpb24gKGZpeHR1cmVBLCBmaXh0dXJlQikge1xuICAgICAgdGhpcy5fX3N1cGVyLlJlc2V0LmNhbGwodGhpcywgZml4dHVyZUEsIGZpeHR1cmVCKTtcbiAgICAgIGIyU2V0dGluZ3MuYjJBc3NlcnQoZml4dHVyZUEuR2V0VHlwZSgpID09IGIyU2hhcGUuZV9wb2x5Z29uU2hhcGUpO1xuICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydChmaXh0dXJlQi5HZXRUeXBlKCkgPT0gYjJTaGFwZS5lX2VkZ2VTaGFwZSk7XG4gICB9XG4gICBiMlBvbHlBbmRFZGdlQ29udGFjdC5wcm90b3R5cGUuRXZhbHVhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgYkEgPSB0aGlzLm1fZml4dHVyZUEuR2V0Qm9keSgpO1xuICAgICAgdmFyIGJCID0gdGhpcy5tX2ZpeHR1cmVCLkdldEJvZHkoKTtcbiAgICAgIHRoaXMuYjJDb2xsaWRlUG9seUFuZEVkZ2UodGhpcy5tX21hbmlmb2xkLCAodGhpcy5tX2ZpeHR1cmVBLkdldFNoYXBlKCkgaW5zdGFuY2VvZiBiMlBvbHlnb25TaGFwZSA/IHRoaXMubV9maXh0dXJlQS5HZXRTaGFwZSgpIDogbnVsbCksIGJBLm1feGYsICh0aGlzLm1fZml4dHVyZUIuR2V0U2hhcGUoKSBpbnN0YW5jZW9mIGIyRWRnZVNoYXBlID8gdGhpcy5tX2ZpeHR1cmVCLkdldFNoYXBlKCkgOiBudWxsKSwgYkIubV94Zik7XG4gICB9XG4gICBiMlBvbHlBbmRFZGdlQ29udGFjdC5wcm90b3R5cGUuYjJDb2xsaWRlUG9seUFuZEVkZ2UgPSBmdW5jdGlvbiAobWFuaWZvbGQsIHBvbHlnb24sIHhmMSwgZWRnZSwgeGYyKSB7fVxuICAgQm94MkQuaW5oZXJpdChiMlBvbHlnb25Db250YWN0LCBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3QpO1xuICAgYjJQb2x5Z29uQ29udGFjdC5wcm90b3R5cGUuX19zdXBlciA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdC5wcm90b3R5cGU7XG4gICBiMlBvbHlnb25Db250YWN0LmIyUG9seWdvbkNvbnRhY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3QuYjJDb250YWN0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgYjJQb2x5Z29uQ29udGFjdC5DcmVhdGUgPSBmdW5jdGlvbiAoYWxsb2NhdG9yKSB7XG4gICAgICByZXR1cm4gbmV3IGIyUG9seWdvbkNvbnRhY3QoKTtcbiAgIH1cbiAgIGIyUG9seWdvbkNvbnRhY3QuRGVzdHJveSA9IGZ1bmN0aW9uIChjb250YWN0LCBhbGxvY2F0b3IpIHt9XG4gICBiMlBvbHlnb25Db250YWN0LnByb3RvdHlwZS5SZXNldCA9IGZ1bmN0aW9uIChmaXh0dXJlQSwgZml4dHVyZUIpIHtcbiAgICAgIHRoaXMuX19zdXBlci5SZXNldC5jYWxsKHRoaXMsIGZpeHR1cmVBLCBmaXh0dXJlQik7XG4gICB9XG4gICBiMlBvbHlnb25Db250YWN0LnByb3RvdHlwZS5FdmFsdWF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBiQSA9IHRoaXMubV9maXh0dXJlQS5HZXRCb2R5KCk7XG4gICAgICB2YXIgYkIgPSB0aGlzLm1fZml4dHVyZUIuR2V0Qm9keSgpO1xuICAgICAgYjJDb2xsaXNpb24uQ29sbGlkZVBvbHlnb25zKHRoaXMubV9tYW5pZm9sZCwgKHRoaXMubV9maXh0dXJlQS5HZXRTaGFwZSgpIGluc3RhbmNlb2YgYjJQb2x5Z29uU2hhcGUgPyB0aGlzLm1fZml4dHVyZUEuR2V0U2hhcGUoKSA6IG51bGwpLCBiQS5tX3hmLCAodGhpcy5tX2ZpeHR1cmVCLkdldFNoYXBlKCkgaW5zdGFuY2VvZiBiMlBvbHlnb25TaGFwZSA/IHRoaXMubV9maXh0dXJlQi5HZXRTaGFwZSgpIDogbnVsbCksIGJCLm1feGYpO1xuICAgfVxuICAgYjJQb3NpdGlvblNvbHZlck1hbmlmb2xkLmIyUG9zaXRpb25Tb2x2ZXJNYW5pZm9sZCA9IGZ1bmN0aW9uICgpIHt9O1xuICAgYjJQb3NpdGlvblNvbHZlck1hbmlmb2xkLnByb3RvdHlwZS5iMlBvc2l0aW9uU29sdmVyTWFuaWZvbGQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLm1fbm9ybWFsID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy5tX3NlcGFyYXRpb25zID0gbmV3IFZlY3Rvcl9hMmpfTnVtYmVyKGIyU2V0dGluZ3MuYjJfbWF4TWFuaWZvbGRQb2ludHMpO1xuICAgICAgdGhpcy5tX3BvaW50cyA9IG5ldyBWZWN0b3IoYjJTZXR0aW5ncy5iMl9tYXhNYW5pZm9sZFBvaW50cyk7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGIyU2V0dGluZ3MuYjJfbWF4TWFuaWZvbGRQb2ludHM7IGkrKykge1xuICAgICAgICAgdGhpcy5tX3BvaW50c1tpXSA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIH1cbiAgIH1cbiAgIGIyUG9zaXRpb25Tb2x2ZXJNYW5pZm9sZC5wcm90b3R5cGUuSW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIChjYykge1xuICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydChjYy5wb2ludENvdW50ID4gMCk7XG4gICAgICB2YXIgaSA9IDA7XG4gICAgICB2YXIgY2xpcFBvaW50WCA9IDA7XG4gICAgICB2YXIgY2xpcFBvaW50WSA9IDA7XG4gICAgICB2YXIgdE1hdDtcbiAgICAgIHZhciB0VmVjO1xuICAgICAgdmFyIHBsYW5lUG9pbnRYID0gMDtcbiAgICAgIHZhciBwbGFuZVBvaW50WSA9IDA7XG4gICAgICBzd2l0Y2ggKGNjLnR5cGUpIHtcbiAgICAgIGNhc2UgYjJNYW5pZm9sZC5lX2NpcmNsZXM6XG4gICAgICAgICB7XG4gICAgICAgICAgICB0TWF0ID0gY2MuYm9keUEubV94Zi5SO1xuICAgICAgICAgICAgdFZlYyA9IGNjLmxvY2FsUG9pbnQ7XG4gICAgICAgICAgICB2YXIgcG9pbnRBWCA9IGNjLmJvZHlBLm1feGYucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcbiAgICAgICAgICAgIHZhciBwb2ludEFZID0gY2MuYm9keUEubV94Zi5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xuICAgICAgICAgICAgdE1hdCA9IGNjLmJvZHlCLm1feGYuUjtcbiAgICAgICAgICAgIHRWZWMgPSBjYy5wb2ludHNbMF0ubG9jYWxQb2ludDtcbiAgICAgICAgICAgIHZhciBwb2ludEJYID0gY2MuYm9keUIubV94Zi5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xuICAgICAgICAgICAgdmFyIHBvaW50QlkgPSBjYy5ib2R5Qi5tX3hmLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XG4gICAgICAgICAgICB2YXIgZFggPSBwb2ludEJYIC0gcG9pbnRBWDtcbiAgICAgICAgICAgIHZhciBkWSA9IHBvaW50QlkgLSBwb2ludEFZO1xuICAgICAgICAgICAgdmFyIGQyID0gZFggKiBkWCArIGRZICogZFk7XG4gICAgICAgICAgICBpZiAoZDIgPiBOdW1iZXIuTUlOX1ZBTFVFICogTnVtYmVyLk1JTl9WQUxVRSkge1xuICAgICAgICAgICAgICAgdmFyIGQgPSBNYXRoLnNxcnQoZDIpO1xuICAgICAgICAgICAgICAgdGhpcy5tX25vcm1hbC54ID0gZFggLyBkO1xuICAgICAgICAgICAgICAgdGhpcy5tX25vcm1hbC55ID0gZFkgLyBkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICB0aGlzLm1fbm9ybWFsLnggPSAxLjA7XG4gICAgICAgICAgICAgICB0aGlzLm1fbm9ybWFsLnkgPSAwLjA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm1fcG9pbnRzWzBdLnggPSAwLjUgKiAocG9pbnRBWCArIHBvaW50QlgpO1xuICAgICAgICAgICAgdGhpcy5tX3BvaW50c1swXS55ID0gMC41ICogKHBvaW50QVkgKyBwb2ludEJZKTtcbiAgICAgICAgICAgIHRoaXMubV9zZXBhcmF0aW9uc1swXSA9IGRYICogdGhpcy5tX25vcm1hbC54ICsgZFkgKiB0aGlzLm1fbm9ybWFsLnkgLSBjYy5yYWRpdXM7XG4gICAgICAgICB9XG4gICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgYjJNYW5pZm9sZC5lX2ZhY2VBOlxuICAgICAgICAge1xuICAgICAgICAgICAgdE1hdCA9IGNjLmJvZHlBLm1feGYuUjtcbiAgICAgICAgICAgIHRWZWMgPSBjYy5sb2NhbFBsYW5lTm9ybWFsO1xuICAgICAgICAgICAgdGhpcy5tX25vcm1hbC54ID0gdE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueTtcbiAgICAgICAgICAgIHRoaXMubV9ub3JtYWwueSA9IHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnk7XG4gICAgICAgICAgICB0TWF0ID0gY2MuYm9keUEubV94Zi5SO1xuICAgICAgICAgICAgdFZlYyA9IGNjLmxvY2FsUG9pbnQ7XG4gICAgICAgICAgICBwbGFuZVBvaW50WCA9IGNjLmJvZHlBLm1feGYucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcbiAgICAgICAgICAgIHBsYW5lUG9pbnRZID0gY2MuYm9keUEubV94Zi5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xuICAgICAgICAgICAgdE1hdCA9IGNjLmJvZHlCLm1feGYuUjtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7XG4gICAgICAgICAgICBpIDwgY2MucG9pbnRDb3VudDsgKytpKSB7XG4gICAgICAgICAgICAgICB0VmVjID0gY2MucG9pbnRzW2ldLmxvY2FsUG9pbnQ7XG4gICAgICAgICAgICAgICBjbGlwUG9pbnRYID0gY2MuYm9keUIubV94Zi5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xuICAgICAgICAgICAgICAgY2xpcFBvaW50WSA9IGNjLmJvZHlCLm1feGYucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55KTtcbiAgICAgICAgICAgICAgIHRoaXMubV9zZXBhcmF0aW9uc1tpXSA9IChjbGlwUG9pbnRYIC0gcGxhbmVQb2ludFgpICogdGhpcy5tX25vcm1hbC54ICsgKGNsaXBQb2ludFkgLSBwbGFuZVBvaW50WSkgKiB0aGlzLm1fbm9ybWFsLnkgLSBjYy5yYWRpdXM7XG4gICAgICAgICAgICAgICB0aGlzLm1fcG9pbnRzW2ldLnggPSBjbGlwUG9pbnRYO1xuICAgICAgICAgICAgICAgdGhpcy5tX3BvaW50c1tpXS55ID0gY2xpcFBvaW50WTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgIH1cbiAgICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBiMk1hbmlmb2xkLmVfZmFjZUI6XG4gICAgICAgICB7XG4gICAgICAgICAgICB0TWF0ID0gY2MuYm9keUIubV94Zi5SO1xuICAgICAgICAgICAgdFZlYyA9IGNjLmxvY2FsUGxhbmVOb3JtYWw7XG4gICAgICAgICAgICB0aGlzLm1fbm9ybWFsLnggPSB0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55O1xuICAgICAgICAgICAgdGhpcy5tX25vcm1hbC55ID0gdE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueTtcbiAgICAgICAgICAgIHRNYXQgPSBjYy5ib2R5Qi5tX3hmLlI7XG4gICAgICAgICAgICB0VmVjID0gY2MubG9jYWxQb2ludDtcbiAgICAgICAgICAgIHBsYW5lUG9pbnRYID0gY2MuYm9keUIubV94Zi5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xuICAgICAgICAgICAgcGxhbmVQb2ludFkgPSBjYy5ib2R5Qi5tX3hmLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XG4gICAgICAgICAgICB0TWF0ID0gY2MuYm9keUEubV94Zi5SO1xuICAgICAgICAgICAgZm9yIChpID0gMDtcbiAgICAgICAgICAgIGkgPCBjYy5wb2ludENvdW50OyArK2kpIHtcbiAgICAgICAgICAgICAgIHRWZWMgPSBjYy5wb2ludHNbaV0ubG9jYWxQb2ludDtcbiAgICAgICAgICAgICAgIGNsaXBQb2ludFggPSBjYy5ib2R5QS5tX3hmLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XG4gICAgICAgICAgICAgICBjbGlwUG9pbnRZID0gY2MuYm9keUEubV94Zi5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xuICAgICAgICAgICAgICAgdGhpcy5tX3NlcGFyYXRpb25zW2ldID0gKGNsaXBQb2ludFggLSBwbGFuZVBvaW50WCkgKiB0aGlzLm1fbm9ybWFsLnggKyAoY2xpcFBvaW50WSAtIHBsYW5lUG9pbnRZKSAqIHRoaXMubV9ub3JtYWwueSAtIGNjLnJhZGl1cztcbiAgICAgICAgICAgICAgIHRoaXMubV9wb2ludHNbaV0uU2V0KGNsaXBQb2ludFgsIGNsaXBQb2ludFkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5tX25vcm1hbC54ICo9ICgtMSk7XG4gICAgICAgICAgICB0aGlzLm1fbm9ybWFsLnkgKj0gKC0xKTtcbiAgICAgICAgIH1cbiAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgfVxuICAgQm94MkQucG9zdERlZnMucHVzaChmdW5jdGlvbiAoKSB7XG4gICAgICBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMlBvc2l0aW9uU29sdmVyTWFuaWZvbGQuY2lyY2xlUG9pbnRBID0gbmV3IGIyVmVjMigpO1xuICAgICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJQb3NpdGlvblNvbHZlck1hbmlmb2xkLmNpcmNsZVBvaW50QiA9IG5ldyBiMlZlYzIoKTtcbiAgIH0pO1xufSkoKTtcbihmdW5jdGlvbiAoKSB7XG4gICB2YXIgYjJCb2R5ID0gQm94MkQuRHluYW1pY3MuYjJCb2R5LFxuICAgICAgYjJCb2R5RGVmID0gQm94MkQuRHluYW1pY3MuYjJCb2R5RGVmLFxuICAgICAgYjJDb250YWN0RmlsdGVyID0gQm94MkQuRHluYW1pY3MuYjJDb250YWN0RmlsdGVyLFxuICAgICAgYjJDb250YWN0SW1wdWxzZSA9IEJveDJELkR5bmFtaWNzLmIyQ29udGFjdEltcHVsc2UsXG4gICAgICBiMkNvbnRhY3RMaXN0ZW5lciA9IEJveDJELkR5bmFtaWNzLmIyQ29udGFjdExpc3RlbmVyLFxuICAgICAgYjJDb250YWN0TWFuYWdlciA9IEJveDJELkR5bmFtaWNzLmIyQ29udGFjdE1hbmFnZXIsXG4gICAgICBiMkRlYnVnRHJhdyA9IEJveDJELkR5bmFtaWNzLmIyRGVidWdEcmF3LFxuICAgICAgYjJEZXN0cnVjdGlvbkxpc3RlbmVyID0gQm94MkQuRHluYW1pY3MuYjJEZXN0cnVjdGlvbkxpc3RlbmVyLFxuICAgICAgYjJGaWx0ZXJEYXRhID0gQm94MkQuRHluYW1pY3MuYjJGaWx0ZXJEYXRhLFxuICAgICAgYjJGaXh0dXJlID0gQm94MkQuRHluYW1pY3MuYjJGaXh0dXJlLFxuICAgICAgYjJGaXh0dXJlRGVmID0gQm94MkQuRHluYW1pY3MuYjJGaXh0dXJlRGVmLFxuICAgICAgYjJJc2xhbmQgPSBCb3gyRC5EeW5hbWljcy5iMklzbGFuZCxcbiAgICAgIGIyVGltZVN0ZXAgPSBCb3gyRC5EeW5hbWljcy5iMlRpbWVTdGVwLFxuICAgICAgYjJXb3JsZCA9IEJveDJELkR5bmFtaWNzLmIyV29ybGQsXG4gICAgICBiMk1hdDIyID0gQm94MkQuQ29tbW9uLk1hdGguYjJNYXQyMixcbiAgICAgIGIyTWF0MzMgPSBCb3gyRC5Db21tb24uTWF0aC5iMk1hdDMzLFxuICAgICAgYjJNYXRoID0gQm94MkQuQ29tbW9uLk1hdGguYjJNYXRoLFxuICAgICAgYjJTd2VlcCA9IEJveDJELkNvbW1vbi5NYXRoLmIyU3dlZXAsXG4gICAgICBiMlRyYW5zZm9ybSA9IEJveDJELkNvbW1vbi5NYXRoLmIyVHJhbnNmb3JtLFxuICAgICAgYjJWZWMyID0gQm94MkQuQ29tbW9uLk1hdGguYjJWZWMyLFxuICAgICAgYjJWZWMzID0gQm94MkQuQ29tbW9uLk1hdGguYjJWZWMzLFxuICAgICAgYjJDb2xvciA9IEJveDJELkNvbW1vbi5iMkNvbG9yLFxuICAgICAgYjJpbnRlcm5hbCA9IEJveDJELkNvbW1vbi5iMmludGVybmFsLFxuICAgICAgYjJTZXR0aW5ncyA9IEJveDJELkNvbW1vbi5iMlNldHRpbmdzLFxuICAgICAgYjJDaXJjbGVTaGFwZSA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJDaXJjbGVTaGFwZSxcbiAgICAgIGIyRWRnZUNoYWluRGVmID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMkVkZ2VDaGFpbkRlZixcbiAgICAgIGIyRWRnZVNoYXBlID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMkVkZ2VTaGFwZSxcbiAgICAgIGIyTWFzc0RhdGEgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyTWFzc0RhdGEsXG4gICAgICBiMlBvbHlnb25TaGFwZSA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJQb2x5Z29uU2hhcGUsXG4gICAgICBiMlNoYXBlID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlNoYXBlLFxuICAgICAgYjJCdW95YW5jeUNvbnRyb2xsZXIgPSBCb3gyRC5EeW5hbWljcy5Db250cm9sbGVycy5iMkJ1b3lhbmN5Q29udHJvbGxlcixcbiAgICAgIGIyQ29uc3RhbnRBY2NlbENvbnRyb2xsZXIgPSBCb3gyRC5EeW5hbWljcy5Db250cm9sbGVycy5iMkNvbnN0YW50QWNjZWxDb250cm9sbGVyLFxuICAgICAgYjJDb25zdGFudEZvcmNlQ29udHJvbGxlciA9IEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyQ29uc3RhbnRGb3JjZUNvbnRyb2xsZXIsXG4gICAgICBiMkNvbnRyb2xsZXIgPSBCb3gyRC5EeW5hbWljcy5Db250cm9sbGVycy5iMkNvbnRyb2xsZXIsXG4gICAgICBiMkNvbnRyb2xsZXJFZGdlID0gQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJDb250cm9sbGVyRWRnZSxcbiAgICAgIGIyR3Jhdml0eUNvbnRyb2xsZXIgPSBCb3gyRC5EeW5hbWljcy5Db250cm9sbGVycy5iMkdyYXZpdHlDb250cm9sbGVyLFxuICAgICAgYjJUZW5zb3JEYW1waW5nQ29udHJvbGxlciA9IEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyVGVuc29yRGFtcGluZ0NvbnRyb2xsZXI7XG5cbiAgIEJveDJELmluaGVyaXQoYjJCdW95YW5jeUNvbnRyb2xsZXIsIEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyQ29udHJvbGxlcik7XG4gICBiMkJ1b3lhbmN5Q29udHJvbGxlci5wcm90b3R5cGUuX19zdXBlciA9IEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyQ29udHJvbGxlci5wcm90b3R5cGU7XG4gICBiMkJ1b3lhbmN5Q29udHJvbGxlci5iMkJ1b3lhbmN5Q29udHJvbGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyQ29udHJvbGxlci5iMkNvbnRyb2xsZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIHRoaXMubm9ybWFsID0gbmV3IGIyVmVjMigwLCAoLTEpKTtcbiAgICAgIHRoaXMub2Zmc2V0ID0gMDtcbiAgICAgIHRoaXMuZGVuc2l0eSA9IDA7XG4gICAgICB0aGlzLnZlbG9jaXR5ID0gbmV3IGIyVmVjMigwLCAwKTtcbiAgICAgIHRoaXMubGluZWFyRHJhZyA9IDI7XG4gICAgICB0aGlzLmFuZ3VsYXJEcmFnID0gMTtcbiAgICAgIHRoaXMudXNlRGVuc2l0eSA9IGZhbHNlO1xuICAgICAgdGhpcy51c2VXb3JsZEdyYXZpdHkgPSB0cnVlO1xuICAgICAgdGhpcy5ncmF2aXR5ID0gbnVsbDtcbiAgIH07XG4gICBiMkJ1b3lhbmN5Q29udHJvbGxlci5wcm90b3R5cGUuU3RlcCA9IGZ1bmN0aW9uIChzdGVwKSB7XG4gICAgICBpZiAoIXRoaXMubV9ib2R5TGlzdCkgcmV0dXJuO1xuICAgICAgaWYgKHRoaXMudXNlV29ybGRHcmF2aXR5KSB7XG4gICAgICAgICB0aGlzLmdyYXZpdHkgPSB0aGlzLkdldFdvcmxkKCkuR2V0R3Jhdml0eSgpLkNvcHkoKTtcbiAgICAgIH1cbiAgICAgIGZvciAodmFyIGkgPSB0aGlzLm1fYm9keUxpc3Q7IGk7IGkgPSBpLm5leHRCb2R5KSB7XG4gICAgICAgICB2YXIgYm9keSA9IGkuYm9keTtcbiAgICAgICAgIGlmIChib2R5LklzQXdha2UoKSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICB9XG4gICAgICAgICB2YXIgYXJlYWMgPSBuZXcgYjJWZWMyKCk7XG4gICAgICAgICB2YXIgbWFzc2MgPSBuZXcgYjJWZWMyKCk7XG4gICAgICAgICB2YXIgYXJlYSA9IDAuMDtcbiAgICAgICAgIHZhciBtYXNzID0gMC4wO1xuICAgICAgICAgZm9yICh2YXIgZml4dHVyZSA9IGJvZHkuR2V0Rml4dHVyZUxpc3QoKTsgZml4dHVyZTsgZml4dHVyZSA9IGZpeHR1cmUuR2V0TmV4dCgpKSB7XG4gICAgICAgICAgICB2YXIgc2MgPSBuZXcgYjJWZWMyKCk7XG4gICAgICAgICAgICB2YXIgc2FyZWEgPSBmaXh0dXJlLkdldFNoYXBlKCkuQ29tcHV0ZVN1Ym1lcmdlZEFyZWEodGhpcy5ub3JtYWwsIHRoaXMub2Zmc2V0LCBib2R5LkdldFRyYW5zZm9ybSgpLCBzYyk7XG4gICAgICAgICAgICBhcmVhICs9IHNhcmVhO1xuICAgICAgICAgICAgYXJlYWMueCArPSBzYXJlYSAqIHNjLng7XG4gICAgICAgICAgICBhcmVhYy55ICs9IHNhcmVhICogc2MueTtcbiAgICAgICAgICAgIHZhciBzaGFwZURlbnNpdHkgPSAwO1xuICAgICAgICAgICAgaWYgKHRoaXMudXNlRGVuc2l0eSkge1xuICAgICAgICAgICAgICAgc2hhcGVEZW5zaXR5ID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgc2hhcGVEZW5zaXR5ID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1hc3MgKz0gc2FyZWEgKiBzaGFwZURlbnNpdHk7XG4gICAgICAgICAgICBtYXNzYy54ICs9IHNhcmVhICogc2MueCAqIHNoYXBlRGVuc2l0eTtcbiAgICAgICAgICAgIG1hc3NjLnkgKz0gc2FyZWEgKiBzYy55ICogc2hhcGVEZW5zaXR5O1xuICAgICAgICAgfVxuICAgICAgICAgYXJlYWMueCAvPSBhcmVhO1xuICAgICAgICAgYXJlYWMueSAvPSBhcmVhO1xuICAgICAgICAgbWFzc2MueCAvPSBtYXNzO1xuICAgICAgICAgbWFzc2MueSAvPSBtYXNzO1xuICAgICAgICAgaWYgKGFyZWEgPCBOdW1iZXIuTUlOX1ZBTFVFKSBjb250aW51ZTtcbiAgICAgICAgIHZhciBidW95YW5jeUZvcmNlID0gdGhpcy5ncmF2aXR5LkdldE5lZ2F0aXZlKCk7XG4gICAgICAgICBidW95YW5jeUZvcmNlLk11bHRpcGx5KHRoaXMuZGVuc2l0eSAqIGFyZWEpO1xuICAgICAgICAgYm9keS5BcHBseUZvcmNlKGJ1b3lhbmN5Rm9yY2UsIG1hc3NjKTtcbiAgICAgICAgIHZhciBkcmFnRm9yY2UgPSBib2R5LkdldExpbmVhclZlbG9jaXR5RnJvbVdvcmxkUG9pbnQoYXJlYWMpO1xuICAgICAgICAgZHJhZ0ZvcmNlLlN1YnRyYWN0KHRoaXMudmVsb2NpdHkpO1xuICAgICAgICAgZHJhZ0ZvcmNlLk11bHRpcGx5KCgtdGhpcy5saW5lYXJEcmFnICogYXJlYSkpO1xuICAgICAgICAgYm9keS5BcHBseUZvcmNlKGRyYWdGb3JjZSwgYXJlYWMpO1xuICAgICAgICAgYm9keS5BcHBseVRvcnF1ZSgoLWJvZHkuR2V0SW5lcnRpYSgpIC8gYm9keS5HZXRNYXNzKCkgKiBhcmVhICogYm9keS5HZXRBbmd1bGFyVmVsb2NpdHkoKSAqIHRoaXMuYW5ndWxhckRyYWcpKTtcbiAgICAgIH1cbiAgIH1cbiAgIGIyQnVveWFuY3lDb250cm9sbGVyLnByb3RvdHlwZS5EcmF3ID0gZnVuY3Rpb24gKGRlYnVnRHJhdykge1xuICAgICAgdmFyIHIgPSAxMDAwO1xuICAgICAgdmFyIHAxID0gbmV3IGIyVmVjMigpO1xuICAgICAgdmFyIHAyID0gbmV3IGIyVmVjMigpO1xuICAgICAgcDEueCA9IHRoaXMubm9ybWFsLnggKiB0aGlzLm9mZnNldCArIHRoaXMubm9ybWFsLnkgKiByO1xuICAgICAgcDEueSA9IHRoaXMubm9ybWFsLnkgKiB0aGlzLm9mZnNldCAtIHRoaXMubm9ybWFsLnggKiByO1xuICAgICAgcDIueCA9IHRoaXMubm9ybWFsLnggKiB0aGlzLm9mZnNldCAtIHRoaXMubm9ybWFsLnkgKiByO1xuICAgICAgcDIueSA9IHRoaXMubm9ybWFsLnkgKiB0aGlzLm9mZnNldCArIHRoaXMubm9ybWFsLnggKiByO1xuICAgICAgdmFyIGNvbG9yID0gbmV3IGIyQ29sb3IoMCwgMCwgMSk7XG4gICAgICBkZWJ1Z0RyYXcuRHJhd1NlZ21lbnQocDEsIHAyLCBjb2xvcik7XG4gICB9XG4gICBCb3gyRC5pbmhlcml0KGIyQ29uc3RhbnRBY2NlbENvbnRyb2xsZXIsIEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyQ29udHJvbGxlcik7XG4gICBiMkNvbnN0YW50QWNjZWxDb250cm9sbGVyLnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJDb250cm9sbGVyLnByb3RvdHlwZTtcbiAgIGIyQ29uc3RhbnRBY2NlbENvbnRyb2xsZXIuYjJDb25zdGFudEFjY2VsQ29udHJvbGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyQ29udHJvbGxlci5iMkNvbnRyb2xsZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIHRoaXMuQSA9IG5ldyBiMlZlYzIoMCwgMCk7XG4gICB9O1xuICAgYjJDb25zdGFudEFjY2VsQ29udHJvbGxlci5wcm90b3R5cGUuU3RlcCA9IGZ1bmN0aW9uIChzdGVwKSB7XG4gICAgICB2YXIgc21hbGxBID0gbmV3IGIyVmVjMih0aGlzLkEueCAqIHN0ZXAuZHQsIHRoaXMuQS55ICogc3RlcC5kdCk7XG4gICAgICBmb3IgKHZhciBpID0gdGhpcy5tX2JvZHlMaXN0OyBpOyBpID0gaS5uZXh0Qm9keSkge1xuICAgICAgICAgdmFyIGJvZHkgPSBpLmJvZHk7XG4gICAgICAgICBpZiAoIWJvZHkuSXNBd2FrZSgpKSBjb250aW51ZTtcbiAgICAgICAgIGJvZHkuU2V0TGluZWFyVmVsb2NpdHkobmV3IGIyVmVjMihib2R5LkdldExpbmVhclZlbG9jaXR5KCkueCArIHNtYWxsQS54LCBib2R5LkdldExpbmVhclZlbG9jaXR5KCkueSArIHNtYWxsQS55KSk7XG4gICAgICB9XG4gICB9XG4gICBCb3gyRC5pbmhlcml0KGIyQ29uc3RhbnRGb3JjZUNvbnRyb2xsZXIsIEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyQ29udHJvbGxlcik7XG4gICBiMkNvbnN0YW50Rm9yY2VDb250cm9sbGVyLnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJDb250cm9sbGVyLnByb3RvdHlwZTtcbiAgIGIyQ29uc3RhbnRGb3JjZUNvbnRyb2xsZXIuYjJDb25zdGFudEZvcmNlQ29udHJvbGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyQ29udHJvbGxlci5iMkNvbnRyb2xsZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIHRoaXMuRiA9IG5ldyBiMlZlYzIoMCwgMCk7XG4gICB9O1xuICAgYjJDb25zdGFudEZvcmNlQ29udHJvbGxlci5wcm90b3R5cGUuU3RlcCA9IGZ1bmN0aW9uIChzdGVwKSB7XG4gICAgICBmb3IgKHZhciBpID0gdGhpcy5tX2JvZHlMaXN0OyBpOyBpID0gaS5uZXh0Qm9keSkge1xuICAgICAgICAgdmFyIGJvZHkgPSBpLmJvZHk7XG4gICAgICAgICBpZiAoIWJvZHkuSXNBd2FrZSgpKSBjb250aW51ZTtcbiAgICAgICAgIGJvZHkuQXBwbHlGb3JjZSh0aGlzLkYsIGJvZHkuR2V0V29ybGRDZW50ZXIoKSk7XG4gICAgICB9XG4gICB9XG4gICBiMkNvbnRyb2xsZXIuYjJDb250cm9sbGVyID0gZnVuY3Rpb24gKCkge307XG4gICBiMkNvbnRyb2xsZXIucHJvdG90eXBlLlN0ZXAgPSBmdW5jdGlvbiAoc3RlcCkge31cbiAgIGIyQ29udHJvbGxlci5wcm90b3R5cGUuRHJhdyA9IGZ1bmN0aW9uIChkZWJ1Z0RyYXcpIHt9XG4gICBiMkNvbnRyb2xsZXIucHJvdG90eXBlLkFkZEJvZHkgPSBmdW5jdGlvbiAoYm9keSkge1xuICAgICAgdmFyIGVkZ2UgPSBuZXcgYjJDb250cm9sbGVyRWRnZSgpO1xuICAgICAgZWRnZS5jb250cm9sbGVyID0gdGhpcztcbiAgICAgIGVkZ2UuYm9keSA9IGJvZHk7XG4gICAgICBlZGdlLm5leHRCb2R5ID0gdGhpcy5tX2JvZHlMaXN0O1xuICAgICAgZWRnZS5wcmV2Qm9keSA9IG51bGw7XG4gICAgICB0aGlzLm1fYm9keUxpc3QgPSBlZGdlO1xuICAgICAgaWYgKGVkZ2UubmV4dEJvZHkpIGVkZ2UubmV4dEJvZHkucHJldkJvZHkgPSBlZGdlO1xuICAgICAgdGhpcy5tX2JvZHlDb3VudCsrO1xuICAgICAgZWRnZS5uZXh0Q29udHJvbGxlciA9IGJvZHkubV9jb250cm9sbGVyTGlzdDtcbiAgICAgIGVkZ2UucHJldkNvbnRyb2xsZXIgPSBudWxsO1xuICAgICAgYm9keS5tX2NvbnRyb2xsZXJMaXN0ID0gZWRnZTtcbiAgICAgIGlmIChlZGdlLm5leHRDb250cm9sbGVyKSBlZGdlLm5leHRDb250cm9sbGVyLnByZXZDb250cm9sbGVyID0gZWRnZTtcbiAgICAgIGJvZHkubV9jb250cm9sbGVyQ291bnQrKztcbiAgIH1cbiAgIGIyQ29udHJvbGxlci5wcm90b3R5cGUuUmVtb3ZlQm9keSA9IGZ1bmN0aW9uIChib2R5KSB7XG4gICAgICB2YXIgZWRnZSA9IGJvZHkubV9jb250cm9sbGVyTGlzdDtcbiAgICAgIHdoaWxlIChlZGdlICYmIGVkZ2UuY29udHJvbGxlciAhPSB0aGlzKVxuICAgICAgZWRnZSA9IGVkZ2UubmV4dENvbnRyb2xsZXI7XG4gICAgICBpZiAoZWRnZS5wcmV2Qm9keSkgZWRnZS5wcmV2Qm9keS5uZXh0Qm9keSA9IGVkZ2UubmV4dEJvZHk7XG4gICAgICBpZiAoZWRnZS5uZXh0Qm9keSkgZWRnZS5uZXh0Qm9keS5wcmV2Qm9keSA9IGVkZ2UucHJldkJvZHk7XG4gICAgICBpZiAoZWRnZS5uZXh0Q29udHJvbGxlcikgZWRnZS5uZXh0Q29udHJvbGxlci5wcmV2Q29udHJvbGxlciA9IGVkZ2UucHJldkNvbnRyb2xsZXI7XG4gICAgICBpZiAoZWRnZS5wcmV2Q29udHJvbGxlcikgZWRnZS5wcmV2Q29udHJvbGxlci5uZXh0Q29udHJvbGxlciA9IGVkZ2UubmV4dENvbnRyb2xsZXI7XG4gICAgICBpZiAodGhpcy5tX2JvZHlMaXN0ID09IGVkZ2UpIHRoaXMubV9ib2R5TGlzdCA9IGVkZ2UubmV4dEJvZHk7XG4gICAgICBpZiAoYm9keS5tX2NvbnRyb2xsZXJMaXN0ID09IGVkZ2UpIGJvZHkubV9jb250cm9sbGVyTGlzdCA9IGVkZ2UubmV4dENvbnRyb2xsZXI7XG4gICAgICBib2R5Lm1fY29udHJvbGxlckNvdW50LS07XG4gICAgICB0aGlzLm1fYm9keUNvdW50LS07XG4gICB9XG4gICBiMkNvbnRyb2xsZXIucHJvdG90eXBlLkNsZWFyID0gZnVuY3Rpb24gKCkge1xuICAgICAgd2hpbGUgKHRoaXMubV9ib2R5TGlzdClcbiAgICAgIHRoaXMuUmVtb3ZlQm9keSh0aGlzLm1fYm9keUxpc3QuYm9keSk7XG4gICB9XG4gICBiMkNvbnRyb2xsZXIucHJvdG90eXBlLkdldE5leHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX25leHQ7XG4gICB9XG4gICBiMkNvbnRyb2xsZXIucHJvdG90eXBlLkdldFdvcmxkID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV93b3JsZDtcbiAgIH1cbiAgIGIyQ29udHJvbGxlci5wcm90b3R5cGUuR2V0Qm9keUxpc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlMaXN0O1xuICAgfVxuICAgYjJDb250cm9sbGVyRWRnZS5iMkNvbnRyb2xsZXJFZGdlID0gZnVuY3Rpb24gKCkge307XG4gICBCb3gyRC5pbmhlcml0KGIyR3Jhdml0eUNvbnRyb2xsZXIsIEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyQ29udHJvbGxlcik7XG4gICBiMkdyYXZpdHlDb250cm9sbGVyLnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJDb250cm9sbGVyLnByb3RvdHlwZTtcbiAgIGIyR3Jhdml0eUNvbnRyb2xsZXIuYjJHcmF2aXR5Q29udHJvbGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyQ29udHJvbGxlci5iMkNvbnRyb2xsZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIHRoaXMuRyA9IDE7XG4gICAgICB0aGlzLmludlNxciA9IHRydWU7XG4gICB9O1xuICAgYjJHcmF2aXR5Q29udHJvbGxlci5wcm90b3R5cGUuU3RlcCA9IGZ1bmN0aW9uIChzdGVwKSB7XG4gICAgICB2YXIgaSA9IG51bGw7XG4gICAgICB2YXIgYm9keTEgPSBudWxsO1xuICAgICAgdmFyIHAxID0gbnVsbDtcbiAgICAgIHZhciBtYXNzMSA9IDA7XG4gICAgICB2YXIgaiA9IG51bGw7XG4gICAgICB2YXIgYm9keTIgPSBudWxsO1xuICAgICAgdmFyIHAyID0gbnVsbDtcbiAgICAgIHZhciBkeCA9IDA7XG4gICAgICB2YXIgZHkgPSAwO1xuICAgICAgdmFyIHIyID0gMDtcbiAgICAgIHZhciBmID0gbnVsbDtcbiAgICAgIGlmICh0aGlzLmludlNxcikge1xuICAgICAgICAgZm9yIChpID0gdGhpcy5tX2JvZHlMaXN0O1xuICAgICAgICAgaTsgaSA9IGkubmV4dEJvZHkpIHtcbiAgICAgICAgICAgIGJvZHkxID0gaS5ib2R5O1xuICAgICAgICAgICAgcDEgPSBib2R5MS5HZXRXb3JsZENlbnRlcigpO1xuICAgICAgICAgICAgbWFzczEgPSBib2R5MS5HZXRNYXNzKCk7XG4gICAgICAgICAgICBmb3IgKGogPSB0aGlzLm1fYm9keUxpc3Q7XG4gICAgICAgICAgICBqICE9IGk7IGogPSBqLm5leHRCb2R5KSB7XG4gICAgICAgICAgICAgICBib2R5MiA9IGouYm9keTtcbiAgICAgICAgICAgICAgIHAyID0gYm9keTIuR2V0V29ybGRDZW50ZXIoKTtcbiAgICAgICAgICAgICAgIGR4ID0gcDIueCAtIHAxLng7XG4gICAgICAgICAgICAgICBkeSA9IHAyLnkgLSBwMS55O1xuICAgICAgICAgICAgICAgcjIgPSBkeCAqIGR4ICsgZHkgKiBkeTtcbiAgICAgICAgICAgICAgIGlmIChyMiA8IE51bWJlci5NSU5fVkFMVUUpIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgZiA9IG5ldyBiMlZlYzIoZHgsIGR5KTtcbiAgICAgICAgICAgICAgIGYuTXVsdGlwbHkodGhpcy5HIC8gcjIgLyBNYXRoLnNxcnQocjIpICogbWFzczEgKiBib2R5Mi5HZXRNYXNzKCkpO1xuICAgICAgICAgICAgICAgaWYgKGJvZHkxLklzQXdha2UoKSkgYm9keTEuQXBwbHlGb3JjZShmLCBwMSk7XG4gICAgICAgICAgICAgICBmLk11bHRpcGx5KCgtMSkpO1xuICAgICAgICAgICAgICAgaWYgKGJvZHkyLklzQXdha2UoKSkgYm9keTIuQXBwbHlGb3JjZShmLCBwMik7XG4gICAgICAgICAgICB9XG4gICAgICAgICB9XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgIGZvciAoaSA9IHRoaXMubV9ib2R5TGlzdDtcbiAgICAgICAgIGk7IGkgPSBpLm5leHRCb2R5KSB7XG4gICAgICAgICAgICBib2R5MSA9IGkuYm9keTtcbiAgICAgICAgICAgIHAxID0gYm9keTEuR2V0V29ybGRDZW50ZXIoKTtcbiAgICAgICAgICAgIG1hc3MxID0gYm9keTEuR2V0TWFzcygpO1xuICAgICAgICAgICAgZm9yIChqID0gdGhpcy5tX2JvZHlMaXN0O1xuICAgICAgICAgICAgaiAhPSBpOyBqID0gai5uZXh0Qm9keSkge1xuICAgICAgICAgICAgICAgYm9keTIgPSBqLmJvZHk7XG4gICAgICAgICAgICAgICBwMiA9IGJvZHkyLkdldFdvcmxkQ2VudGVyKCk7XG4gICAgICAgICAgICAgICBkeCA9IHAyLnggLSBwMS54O1xuICAgICAgICAgICAgICAgZHkgPSBwMi55IC0gcDEueTtcbiAgICAgICAgICAgICAgIHIyID0gZHggKiBkeCArIGR5ICogZHk7XG4gICAgICAgICAgICAgICBpZiAocjIgPCBOdW1iZXIuTUlOX1ZBTFVFKSBjb250aW51ZTtcbiAgICAgICAgICAgICAgIGYgPSBuZXcgYjJWZWMyKGR4LCBkeSk7XG4gICAgICAgICAgICAgICBmLk11bHRpcGx5KHRoaXMuRyAvIHIyICogbWFzczEgKiBib2R5Mi5HZXRNYXNzKCkpO1xuICAgICAgICAgICAgICAgaWYgKGJvZHkxLklzQXdha2UoKSkgYm9keTEuQXBwbHlGb3JjZShmLCBwMSk7XG4gICAgICAgICAgICAgICBmLk11bHRpcGx5KCgtMSkpO1xuICAgICAgICAgICAgICAgaWYgKGJvZHkyLklzQXdha2UoKSkgYm9keTIuQXBwbHlGb3JjZShmLCBwMik7XG4gICAgICAgICAgICB9XG4gICAgICAgICB9XG4gICAgICB9XG4gICB9XG4gICBCb3gyRC5pbmhlcml0KGIyVGVuc29yRGFtcGluZ0NvbnRyb2xsZXIsIEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyQ29udHJvbGxlcik7XG4gICBiMlRlbnNvckRhbXBpbmdDb250cm9sbGVyLnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJDb250cm9sbGVyLnByb3RvdHlwZTtcbiAgIGIyVGVuc29yRGFtcGluZ0NvbnRyb2xsZXIuYjJUZW5zb3JEYW1waW5nQ29udHJvbGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyQ29udHJvbGxlci5iMkNvbnRyb2xsZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIHRoaXMuVCA9IG5ldyBiMk1hdDIyKCk7XG4gICAgICB0aGlzLm1heFRpbWVzdGVwID0gMDtcbiAgIH07XG4gICBiMlRlbnNvckRhbXBpbmdDb250cm9sbGVyLnByb3RvdHlwZS5TZXRBeGlzQWxpZ25lZCA9IGZ1bmN0aW9uICh4RGFtcGluZywgeURhbXBpbmcpIHtcbiAgICAgIGlmICh4RGFtcGluZyA9PT0gdW5kZWZpbmVkKSB4RGFtcGluZyA9IDA7XG4gICAgICBpZiAoeURhbXBpbmcgPT09IHVuZGVmaW5lZCkgeURhbXBpbmcgPSAwO1xuICAgICAgdGhpcy5ULmNvbDEueCA9ICgteERhbXBpbmcpO1xuICAgICAgdGhpcy5ULmNvbDEueSA9IDA7XG4gICAgICB0aGlzLlQuY29sMi54ID0gMDtcbiAgICAgIHRoaXMuVC5jb2wyLnkgPSAoLXlEYW1waW5nKTtcbiAgICAgIGlmICh4RGFtcGluZyA+IDAgfHwgeURhbXBpbmcgPiAwKSB7XG4gICAgICAgICB0aGlzLm1heFRpbWVzdGVwID0gMSAvIE1hdGgubWF4KHhEYW1waW5nLCB5RGFtcGluZyk7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgIHRoaXMubWF4VGltZXN0ZXAgPSAwO1xuICAgICAgfVxuICAgfVxuICAgYjJUZW5zb3JEYW1waW5nQ29udHJvbGxlci5wcm90b3R5cGUuU3RlcCA9IGZ1bmN0aW9uIChzdGVwKSB7XG4gICAgICB2YXIgdGltZXN0ZXAgPSBzdGVwLmR0O1xuICAgICAgaWYgKHRpbWVzdGVwIDw9IE51bWJlci5NSU5fVkFMVUUpIHJldHVybjtcbiAgICAgIGlmICh0aW1lc3RlcCA+IHRoaXMubWF4VGltZXN0ZXAgJiYgdGhpcy5tYXhUaW1lc3RlcCA+IDApIHRpbWVzdGVwID0gdGhpcy5tYXhUaW1lc3RlcDtcbiAgICAgIGZvciAodmFyIGkgPSB0aGlzLm1fYm9keUxpc3Q7IGk7IGkgPSBpLm5leHRCb2R5KSB7XG4gICAgICAgICB2YXIgYm9keSA9IGkuYm9keTtcbiAgICAgICAgIGlmICghYm9keS5Jc0F3YWtlKCkpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgfVxuICAgICAgICAgdmFyIGRhbXBpbmcgPSBib2R5LkdldFdvcmxkVmVjdG9yKGIyTWF0aC5NdWxNVih0aGlzLlQsIGJvZHkuR2V0TG9jYWxWZWN0b3IoYm9keS5HZXRMaW5lYXJWZWxvY2l0eSgpKSkpO1xuICAgICAgICAgYm9keS5TZXRMaW5lYXJWZWxvY2l0eShuZXcgYjJWZWMyKGJvZHkuR2V0TGluZWFyVmVsb2NpdHkoKS54ICsgZGFtcGluZy54ICogdGltZXN0ZXAsIGJvZHkuR2V0TGluZWFyVmVsb2NpdHkoKS55ICsgZGFtcGluZy55ICogdGltZXN0ZXApKTtcbiAgICAgIH1cbiAgIH1cbn0pKCk7XG4oZnVuY3Rpb24gKCkge1xuICAgdmFyIGIyQ29sb3IgPSBCb3gyRC5Db21tb24uYjJDb2xvcixcbiAgICAgIGIyaW50ZXJuYWwgPSBCb3gyRC5Db21tb24uYjJpbnRlcm5hbCxcbiAgICAgIGIyU2V0dGluZ3MgPSBCb3gyRC5Db21tb24uYjJTZXR0aW5ncyxcbiAgICAgIGIyTWF0MjIgPSBCb3gyRC5Db21tb24uTWF0aC5iMk1hdDIyLFxuICAgICAgYjJNYXQzMyA9IEJveDJELkNvbW1vbi5NYXRoLmIyTWF0MzMsXG4gICAgICBiMk1hdGggPSBCb3gyRC5Db21tb24uTWF0aC5iMk1hdGgsXG4gICAgICBiMlN3ZWVwID0gQm94MkQuQ29tbW9uLk1hdGguYjJTd2VlcCxcbiAgICAgIGIyVHJhbnNmb3JtID0gQm94MkQuQ29tbW9uLk1hdGguYjJUcmFuc2Zvcm0sXG4gICAgICBiMlZlYzIgPSBCb3gyRC5Db21tb24uTWF0aC5iMlZlYzIsXG4gICAgICBiMlZlYzMgPSBCb3gyRC5Db21tb24uTWF0aC5iMlZlYzMsXG4gICAgICBiMkRpc3RhbmNlSm9pbnQgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJEaXN0YW5jZUpvaW50LFxuICAgICAgYjJEaXN0YW5jZUpvaW50RGVmID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyRGlzdGFuY2VKb2ludERlZixcbiAgICAgIGIyRnJpY3Rpb25Kb2ludCA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkZyaWN0aW9uSm9pbnQsXG4gICAgICBiMkZyaWN0aW9uSm9pbnREZWYgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJGcmljdGlvbkpvaW50RGVmLFxuICAgICAgYjJHZWFySm9pbnQgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJHZWFySm9pbnQsXG4gICAgICBiMkdlYXJKb2ludERlZiA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkdlYXJKb2ludERlZixcbiAgICAgIGIySmFjb2JpYW4gPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKYWNvYmlhbixcbiAgICAgIGIySm9pbnQgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludCxcbiAgICAgIGIySm9pbnREZWYgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZixcbiAgICAgIGIySm9pbnRFZGdlID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnRFZGdlLFxuICAgICAgYjJMaW5lSm9pbnQgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJMaW5lSm9pbnQsXG4gICAgICBiMkxpbmVKb2ludERlZiA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkxpbmVKb2ludERlZixcbiAgICAgIGIyTW91c2VKb2ludCA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMk1vdXNlSm9pbnQsXG4gICAgICBiMk1vdXNlSm9pbnREZWYgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJNb3VzZUpvaW50RGVmLFxuICAgICAgYjJQcmlzbWF0aWNKb2ludCA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMlByaXNtYXRpY0pvaW50LFxuICAgICAgYjJQcmlzbWF0aWNKb2ludERlZiA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMlByaXNtYXRpY0pvaW50RGVmLFxuICAgICAgYjJQdWxsZXlKb2ludCA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMlB1bGxleUpvaW50LFxuICAgICAgYjJQdWxsZXlKb2ludERlZiA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMlB1bGxleUpvaW50RGVmLFxuICAgICAgYjJSZXZvbHV0ZUpvaW50ID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyUmV2b2x1dGVKb2ludCxcbiAgICAgIGIyUmV2b2x1dGVKb2ludERlZiA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMlJldm9sdXRlSm9pbnREZWYsXG4gICAgICBiMldlbGRKb2ludCA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMldlbGRKb2ludCxcbiAgICAgIGIyV2VsZEpvaW50RGVmID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyV2VsZEpvaW50RGVmLFxuICAgICAgYjJCb2R5ID0gQm94MkQuRHluYW1pY3MuYjJCb2R5LFxuICAgICAgYjJCb2R5RGVmID0gQm94MkQuRHluYW1pY3MuYjJCb2R5RGVmLFxuICAgICAgYjJDb250YWN0RmlsdGVyID0gQm94MkQuRHluYW1pY3MuYjJDb250YWN0RmlsdGVyLFxuICAgICAgYjJDb250YWN0SW1wdWxzZSA9IEJveDJELkR5bmFtaWNzLmIyQ29udGFjdEltcHVsc2UsXG4gICAgICBiMkNvbnRhY3RMaXN0ZW5lciA9IEJveDJELkR5bmFtaWNzLmIyQ29udGFjdExpc3RlbmVyLFxuICAgICAgYjJDb250YWN0TWFuYWdlciA9IEJveDJELkR5bmFtaWNzLmIyQ29udGFjdE1hbmFnZXIsXG4gICAgICBiMkRlYnVnRHJhdyA9IEJveDJELkR5bmFtaWNzLmIyRGVidWdEcmF3LFxuICAgICAgYjJEZXN0cnVjdGlvbkxpc3RlbmVyID0gQm94MkQuRHluYW1pY3MuYjJEZXN0cnVjdGlvbkxpc3RlbmVyLFxuICAgICAgYjJGaWx0ZXJEYXRhID0gQm94MkQuRHluYW1pY3MuYjJGaWx0ZXJEYXRhLFxuICAgICAgYjJGaXh0dXJlID0gQm94MkQuRHluYW1pY3MuYjJGaXh0dXJlLFxuICAgICAgYjJGaXh0dXJlRGVmID0gQm94MkQuRHluYW1pY3MuYjJGaXh0dXJlRGVmLFxuICAgICAgYjJJc2xhbmQgPSBCb3gyRC5EeW5hbWljcy5iMklzbGFuZCxcbiAgICAgIGIyVGltZVN0ZXAgPSBCb3gyRC5EeW5hbWljcy5iMlRpbWVTdGVwLFxuICAgICAgYjJXb3JsZCA9IEJveDJELkR5bmFtaWNzLmIyV29ybGQ7XG5cbiAgIEJveDJELmluaGVyaXQoYjJEaXN0YW5jZUpvaW50LCBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludCk7XG4gICBiMkRpc3RhbmNlSm9pbnQucHJvdG90eXBlLl9fc3VwZXIgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5wcm90b3R5cGU7XG4gICBiMkRpc3RhbmNlSm9pbnQuYjJEaXN0YW5jZUpvaW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQuYjJKb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMSA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvcjIgPSBuZXcgYjJWZWMyKCk7XG4gICAgICB0aGlzLm1fdSA9IG5ldyBiMlZlYzIoKTtcbiAgIH07XG4gICBiMkRpc3RhbmNlSm9pbnQucHJvdG90eXBlLkdldEFuY2hvckEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlBLkdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yMSk7XG4gICB9XG4gICBiMkRpc3RhbmNlSm9pbnQucHJvdG90eXBlLkdldEFuY2hvckIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlCLkdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yMik7XG4gICB9XG4gICBiMkRpc3RhbmNlSm9pbnQucHJvdG90eXBlLkdldFJlYWN0aW9uRm9yY2UgPSBmdW5jdGlvbiAoaW52X2R0KSB7XG4gICAgICBpZiAoaW52X2R0ID09PSB1bmRlZmluZWQpIGludl9kdCA9IDA7XG4gICAgICByZXR1cm4gbmV3IGIyVmVjMihpbnZfZHQgKiB0aGlzLm1faW1wdWxzZSAqIHRoaXMubV91LngsIGludl9kdCAqIHRoaXMubV9pbXB1bHNlICogdGhpcy5tX3UueSk7XG4gICB9XG4gICBiMkRpc3RhbmNlSm9pbnQucHJvdG90eXBlLkdldFJlYWN0aW9uVG9ycXVlID0gZnVuY3Rpb24gKGludl9kdCkge1xuICAgICAgaWYgKGludl9kdCA9PT0gdW5kZWZpbmVkKSBpbnZfZHQgPSAwO1xuICAgICAgcmV0dXJuIDAuMDtcbiAgIH1cbiAgIGIyRGlzdGFuY2VKb2ludC5wcm90b3R5cGUuR2V0TGVuZ3RoID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV9sZW5ndGg7XG4gICB9XG4gICBiMkRpc3RhbmNlSm9pbnQucHJvdG90eXBlLlNldExlbmd0aCA9IGZ1bmN0aW9uIChsZW5ndGgpIHtcbiAgICAgIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCkgbGVuZ3RoID0gMDtcbiAgICAgIHRoaXMubV9sZW5ndGggPSBsZW5ndGg7XG4gICB9XG4gICBiMkRpc3RhbmNlSm9pbnQucHJvdG90eXBlLkdldEZyZXF1ZW5jeSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fZnJlcXVlbmN5SHo7XG4gICB9XG4gICBiMkRpc3RhbmNlSm9pbnQucHJvdG90eXBlLlNldEZyZXF1ZW5jeSA9IGZ1bmN0aW9uIChoeikge1xuICAgICAgaWYgKGh6ID09PSB1bmRlZmluZWQpIGh6ID0gMDtcbiAgICAgIHRoaXMubV9mcmVxdWVuY3lIeiA9IGh6O1xuICAgfVxuICAgYjJEaXN0YW5jZUpvaW50LnByb3RvdHlwZS5HZXREYW1waW5nUmF0aW8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX2RhbXBpbmdSYXRpbztcbiAgIH1cbiAgIGIyRGlzdGFuY2VKb2ludC5wcm90b3R5cGUuU2V0RGFtcGluZ1JhdGlvID0gZnVuY3Rpb24gKHJhdGlvKSB7XG4gICAgICBpZiAocmF0aW8gPT09IHVuZGVmaW5lZCkgcmF0aW8gPSAwO1xuICAgICAgdGhpcy5tX2RhbXBpbmdSYXRpbyA9IHJhdGlvO1xuICAgfVxuICAgYjJEaXN0YW5jZUpvaW50LnByb3RvdHlwZS5iMkRpc3RhbmNlSm9pbnQgPSBmdW5jdGlvbiAoZGVmKSB7XG4gICAgICB0aGlzLl9fc3VwZXIuYjJKb2ludC5jYWxsKHRoaXMsIGRlZik7XG4gICAgICB2YXIgdE1hdDtcbiAgICAgIHZhciB0WCA9IDA7XG4gICAgICB2YXIgdFkgPSAwO1xuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMS5TZXRWKGRlZi5sb2NhbEFuY2hvckEpO1xuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMi5TZXRWKGRlZi5sb2NhbEFuY2hvckIpO1xuICAgICAgdGhpcy5tX2xlbmd0aCA9IGRlZi5sZW5ndGg7XG4gICAgICB0aGlzLm1fZnJlcXVlbmN5SHogPSBkZWYuZnJlcXVlbmN5SHo7XG4gICAgICB0aGlzLm1fZGFtcGluZ1JhdGlvID0gZGVmLmRhbXBpbmdSYXRpbztcbiAgICAgIHRoaXMubV9pbXB1bHNlID0gMC4wO1xuICAgICAgdGhpcy5tX2dhbW1hID0gMC4wO1xuICAgICAgdGhpcy5tX2JpYXMgPSAwLjA7XG4gICB9XG4gICBiMkRpc3RhbmNlSm9pbnQucHJvdG90eXBlLkluaXRWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKHN0ZXApIHtcbiAgICAgIHZhciB0TWF0O1xuICAgICAgdmFyIHRYID0gMDtcbiAgICAgIHZhciBiQSA9IHRoaXMubV9ib2R5QTtcbiAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcbiAgICAgIHRNYXQgPSBiQS5tX3hmLlI7XG4gICAgICB2YXIgcjFYID0gdGhpcy5tX2xvY2FsQW5jaG9yMS54IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci54O1xuICAgICAgdmFyIHIxWSA9IHRoaXMubV9sb2NhbEFuY2hvcjEueSAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcbiAgICAgIHRYID0gKHRNYXQuY29sMS54ICogcjFYICsgdE1hdC5jb2wyLnggKiByMVkpO1xuICAgICAgcjFZID0gKHRNYXQuY29sMS55ICogcjFYICsgdE1hdC5jb2wyLnkgKiByMVkpO1xuICAgICAgcjFYID0gdFg7XG4gICAgICB0TWF0ID0gYkIubV94Zi5SO1xuICAgICAgdmFyIHIyWCA9IHRoaXMubV9sb2NhbEFuY2hvcjIueCAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcbiAgICAgIHZhciByMlkgPSB0aGlzLm1fbG9jYWxBbmNob3IyLnkgLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XG4gICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHIyWCArIHRNYXQuY29sMi54ICogcjJZKTtcbiAgICAgIHIyWSA9ICh0TWF0LmNvbDEueSAqIHIyWCArIHRNYXQuY29sMi55ICogcjJZKTtcbiAgICAgIHIyWCA9IHRYO1xuICAgICAgdGhpcy5tX3UueCA9IGJCLm1fc3dlZXAuYy54ICsgcjJYIC0gYkEubV9zd2VlcC5jLnggLSByMVg7XG4gICAgICB0aGlzLm1fdS55ID0gYkIubV9zd2VlcC5jLnkgKyByMlkgLSBiQS5tX3N3ZWVwLmMueSAtIHIxWTtcbiAgICAgIHZhciBsZW5ndGggPSBNYXRoLnNxcnQodGhpcy5tX3UueCAqIHRoaXMubV91LnggKyB0aGlzLm1fdS55ICogdGhpcy5tX3UueSk7XG4gICAgICBpZiAobGVuZ3RoID4gYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wKSB7XG4gICAgICAgICB0aGlzLm1fdS5NdWx0aXBseSgxLjAgLyBsZW5ndGgpO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgICB0aGlzLm1fdS5TZXRaZXJvKCk7XG4gICAgICB9XG4gICAgICB2YXIgY3IxdSA9IChyMVggKiB0aGlzLm1fdS55IC0gcjFZICogdGhpcy5tX3UueCk7XG4gICAgICB2YXIgY3IydSA9IChyMlggKiB0aGlzLm1fdS55IC0gcjJZICogdGhpcy5tX3UueCk7XG4gICAgICB2YXIgaW52TWFzcyA9IGJBLm1faW52TWFzcyArIGJBLm1faW52SSAqIGNyMXUgKiBjcjF1ICsgYkIubV9pbnZNYXNzICsgYkIubV9pbnZJICogY3IydSAqIGNyMnU7XG4gICAgICB0aGlzLm1fbWFzcyA9IGludk1hc3MgIT0gMC4wID8gMS4wIC8gaW52TWFzcyA6IDAuMDtcbiAgICAgIGlmICh0aGlzLm1fZnJlcXVlbmN5SHogPiAwLjApIHtcbiAgICAgICAgIHZhciBDID0gbGVuZ3RoIC0gdGhpcy5tX2xlbmd0aDtcbiAgICAgICAgIHZhciBvbWVnYSA9IDIuMCAqIE1hdGguUEkgKiB0aGlzLm1fZnJlcXVlbmN5SHo7XG4gICAgICAgICB2YXIgZCA9IDIuMCAqIHRoaXMubV9tYXNzICogdGhpcy5tX2RhbXBpbmdSYXRpbyAqIG9tZWdhO1xuICAgICAgICAgdmFyIGsgPSB0aGlzLm1fbWFzcyAqIG9tZWdhICogb21lZ2E7XG4gICAgICAgICB0aGlzLm1fZ2FtbWEgPSBzdGVwLmR0ICogKGQgKyBzdGVwLmR0ICogayk7XG4gICAgICAgICB0aGlzLm1fZ2FtbWEgPSB0aGlzLm1fZ2FtbWEgIT0gMC4wID8gMSAvIHRoaXMubV9nYW1tYSA6IDAuMDtcbiAgICAgICAgIHRoaXMubV9iaWFzID0gQyAqIHN0ZXAuZHQgKiBrICogdGhpcy5tX2dhbW1hO1xuICAgICAgICAgdGhpcy5tX21hc3MgPSBpbnZNYXNzICsgdGhpcy5tX2dhbW1hO1xuICAgICAgICAgdGhpcy5tX21hc3MgPSB0aGlzLm1fbWFzcyAhPSAwLjAgPyAxLjAgLyB0aGlzLm1fbWFzcyA6IDAuMDtcbiAgICAgIH1cbiAgICAgIGlmIChzdGVwLndhcm1TdGFydGluZykge1xuICAgICAgICAgdGhpcy5tX2ltcHVsc2UgKj0gc3RlcC5kdFJhdGlvO1xuICAgICAgICAgdmFyIFBYID0gdGhpcy5tX2ltcHVsc2UgKiB0aGlzLm1fdS54O1xuICAgICAgICAgdmFyIFBZID0gdGhpcy5tX2ltcHVsc2UgKiB0aGlzLm1fdS55O1xuICAgICAgICAgYkEubV9saW5lYXJWZWxvY2l0eS54IC09IGJBLm1faW52TWFzcyAqIFBYO1xuICAgICAgICAgYkEubV9saW5lYXJWZWxvY2l0eS55IC09IGJBLm1faW52TWFzcyAqIFBZO1xuICAgICAgICAgYkEubV9hbmd1bGFyVmVsb2NpdHkgLT0gYkEubV9pbnZJICogKHIxWCAqIFBZIC0gcjFZICogUFgpO1xuICAgICAgICAgYkIubV9saW5lYXJWZWxvY2l0eS54ICs9IGJCLm1faW52TWFzcyAqIFBYO1xuICAgICAgICAgYkIubV9saW5lYXJWZWxvY2l0eS55ICs9IGJCLm1faW52TWFzcyAqIFBZO1xuICAgICAgICAgYkIubV9hbmd1bGFyVmVsb2NpdHkgKz0gYkIubV9pbnZJICogKHIyWCAqIFBZIC0gcjJZICogUFgpO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgICB0aGlzLm1faW1wdWxzZSA9IDAuMDtcbiAgICAgIH1cbiAgIH1cbiAgIGIyRGlzdGFuY2VKb2ludC5wcm90b3R5cGUuU29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKHN0ZXApIHtcbiAgICAgIHZhciB0TWF0O1xuICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xuICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xuICAgICAgdE1hdCA9IGJBLm1feGYuUjtcbiAgICAgIHZhciByMVggPSB0aGlzLm1fbG9jYWxBbmNob3IxLnggLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XG4gICAgICB2YXIgcjFZID0gdGhpcy5tX2xvY2FsQW5jaG9yMS55IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci55O1xuICAgICAgdmFyIHRYID0gKHRNYXQuY29sMS54ICogcjFYICsgdE1hdC5jb2wyLnggKiByMVkpO1xuICAgICAgcjFZID0gKHRNYXQuY29sMS55ICogcjFYICsgdE1hdC5jb2wyLnkgKiByMVkpO1xuICAgICAgcjFYID0gdFg7XG4gICAgICB0TWF0ID0gYkIubV94Zi5SO1xuICAgICAgdmFyIHIyWCA9IHRoaXMubV9sb2NhbEFuY2hvcjIueCAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcbiAgICAgIHZhciByMlkgPSB0aGlzLm1fbG9jYWxBbmNob3IyLnkgLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XG4gICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHIyWCArIHRNYXQuY29sMi54ICogcjJZKTtcbiAgICAgIHIyWSA9ICh0TWF0LmNvbDEueSAqIHIyWCArIHRNYXQuY29sMi55ICogcjJZKTtcbiAgICAgIHIyWCA9IHRYO1xuICAgICAgdmFyIHYxWCA9IGJBLm1fbGluZWFyVmVsb2NpdHkueCArICgoLWJBLm1fYW5ndWxhclZlbG9jaXR5ICogcjFZKSk7XG4gICAgICB2YXIgdjFZID0gYkEubV9saW5lYXJWZWxvY2l0eS55ICsgKGJBLm1fYW5ndWxhclZlbG9jaXR5ICogcjFYKTtcbiAgICAgIHZhciB2MlggPSBiQi5tX2xpbmVhclZlbG9jaXR5LnggKyAoKC1iQi5tX2FuZ3VsYXJWZWxvY2l0eSAqIHIyWSkpO1xuICAgICAgdmFyIHYyWSA9IGJCLm1fbGluZWFyVmVsb2NpdHkueSArIChiQi5tX2FuZ3VsYXJWZWxvY2l0eSAqIHIyWCk7XG4gICAgICB2YXIgQ2RvdCA9ICh0aGlzLm1fdS54ICogKHYyWCAtIHYxWCkgKyB0aGlzLm1fdS55ICogKHYyWSAtIHYxWSkpO1xuICAgICAgdmFyIGltcHVsc2UgPSAoLXRoaXMubV9tYXNzICogKENkb3QgKyB0aGlzLm1fYmlhcyArIHRoaXMubV9nYW1tYSAqIHRoaXMubV9pbXB1bHNlKSk7XG4gICAgICB0aGlzLm1faW1wdWxzZSArPSBpbXB1bHNlO1xuICAgICAgdmFyIFBYID0gaW1wdWxzZSAqIHRoaXMubV91Lng7XG4gICAgICB2YXIgUFkgPSBpbXB1bHNlICogdGhpcy5tX3UueTtcbiAgICAgIGJBLm1fbGluZWFyVmVsb2NpdHkueCAtPSBiQS5tX2ludk1hc3MgKiBQWDtcbiAgICAgIGJBLm1fbGluZWFyVmVsb2NpdHkueSAtPSBiQS5tX2ludk1hc3MgKiBQWTtcbiAgICAgIGJBLm1fYW5ndWxhclZlbG9jaXR5IC09IGJBLm1faW52SSAqIChyMVggKiBQWSAtIHIxWSAqIFBYKTtcbiAgICAgIGJCLm1fbGluZWFyVmVsb2NpdHkueCArPSBiQi5tX2ludk1hc3MgKiBQWDtcbiAgICAgIGJCLm1fbGluZWFyVmVsb2NpdHkueSArPSBiQi5tX2ludk1hc3MgKiBQWTtcbiAgICAgIGJCLm1fYW5ndWxhclZlbG9jaXR5ICs9IGJCLm1faW52SSAqIChyMlggKiBQWSAtIHIyWSAqIFBYKTtcbiAgIH1cbiAgIGIyRGlzdGFuY2VKb2ludC5wcm90b3R5cGUuU29sdmVQb3NpdGlvbkNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKGJhdW1nYXJ0ZSkge1xuICAgICAgaWYgKGJhdW1nYXJ0ZSA9PT0gdW5kZWZpbmVkKSBiYXVtZ2FydGUgPSAwO1xuICAgICAgdmFyIHRNYXQ7XG4gICAgICBpZiAodGhpcy5tX2ZyZXF1ZW5jeUh6ID4gMC4wKSB7XG4gICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIHZhciBiQSA9IHRoaXMubV9ib2R5QTtcbiAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcbiAgICAgIHRNYXQgPSBiQS5tX3hmLlI7XG4gICAgICB2YXIgcjFYID0gdGhpcy5tX2xvY2FsQW5jaG9yMS54IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci54O1xuICAgICAgdmFyIHIxWSA9IHRoaXMubV9sb2NhbEFuY2hvcjEueSAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcbiAgICAgIHZhciB0WCA9ICh0TWF0LmNvbDEueCAqIHIxWCArIHRNYXQuY29sMi54ICogcjFZKTtcbiAgICAgIHIxWSA9ICh0TWF0LmNvbDEueSAqIHIxWCArIHRNYXQuY29sMi55ICogcjFZKTtcbiAgICAgIHIxWCA9IHRYO1xuICAgICAgdE1hdCA9IGJCLm1feGYuUjtcbiAgICAgIHZhciByMlggPSB0aGlzLm1fbG9jYWxBbmNob3IyLnggLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XG4gICAgICB2YXIgcjJZID0gdGhpcy5tX2xvY2FsQW5jaG9yMi55IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci55O1xuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByMlggKyB0TWF0LmNvbDIueCAqIHIyWSk7XG4gICAgICByMlkgPSAodE1hdC5jb2wxLnkgKiByMlggKyB0TWF0LmNvbDIueSAqIHIyWSk7XG4gICAgICByMlggPSB0WDtcbiAgICAgIHZhciBkWCA9IGJCLm1fc3dlZXAuYy54ICsgcjJYIC0gYkEubV9zd2VlcC5jLnggLSByMVg7XG4gICAgICB2YXIgZFkgPSBiQi5tX3N3ZWVwLmMueSArIHIyWSAtIGJBLm1fc3dlZXAuYy55IC0gcjFZO1xuICAgICAgdmFyIGxlbmd0aCA9IE1hdGguc3FydChkWCAqIGRYICsgZFkgKiBkWSk7XG4gICAgICBkWCAvPSBsZW5ndGg7XG4gICAgICBkWSAvPSBsZW5ndGg7XG4gICAgICB2YXIgQyA9IGxlbmd0aCAtIHRoaXMubV9sZW5ndGg7XG4gICAgICBDID0gYjJNYXRoLkNsYW1wKEMsICgtYjJTZXR0aW5ncy5iMl9tYXhMaW5lYXJDb3JyZWN0aW9uKSwgYjJTZXR0aW5ncy5iMl9tYXhMaW5lYXJDb3JyZWN0aW9uKTtcbiAgICAgIHZhciBpbXB1bHNlID0gKC10aGlzLm1fbWFzcyAqIEMpO1xuICAgICAgdGhpcy5tX3UuU2V0KGRYLCBkWSk7XG4gICAgICB2YXIgUFggPSBpbXB1bHNlICogdGhpcy5tX3UueDtcbiAgICAgIHZhciBQWSA9IGltcHVsc2UgKiB0aGlzLm1fdS55O1xuICAgICAgYkEubV9zd2VlcC5jLnggLT0gYkEubV9pbnZNYXNzICogUFg7XG4gICAgICBiQS5tX3N3ZWVwLmMueSAtPSBiQS5tX2ludk1hc3MgKiBQWTtcbiAgICAgIGJBLm1fc3dlZXAuYSAtPSBiQS5tX2ludkkgKiAocjFYICogUFkgLSByMVkgKiBQWCk7XG4gICAgICBiQi5tX3N3ZWVwLmMueCArPSBiQi5tX2ludk1hc3MgKiBQWDtcbiAgICAgIGJCLm1fc3dlZXAuYy55ICs9IGJCLm1faW52TWFzcyAqIFBZO1xuICAgICAgYkIubV9zd2VlcC5hICs9IGJCLm1faW52SSAqIChyMlggKiBQWSAtIHIyWSAqIFBYKTtcbiAgICAgIGJBLlN5bmNocm9uaXplVHJhbnNmb3JtKCk7XG4gICAgICBiQi5TeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xuICAgICAgcmV0dXJuIGIyTWF0aC5BYnMoQykgPCBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3A7XG4gICB9XG4gICBCb3gyRC5pbmhlcml0KGIyRGlzdGFuY2VKb2ludERlZiwgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnREZWYpO1xuICAgYjJEaXN0YW5jZUpvaW50RGVmLnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnREZWYucHJvdG90eXBlO1xuICAgYjJEaXN0YW5jZUpvaW50RGVmLmIyRGlzdGFuY2VKb2ludERlZiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmLmIySm9pbnREZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIHRoaXMubG9jYWxBbmNob3JBID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy5sb2NhbEFuY2hvckIgPSBuZXcgYjJWZWMyKCk7XG4gICB9O1xuICAgYjJEaXN0YW5jZUpvaW50RGVmLnByb3RvdHlwZS5iMkRpc3RhbmNlSm9pbnREZWYgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLl9fc3VwZXIuYjJKb2ludERlZi5jYWxsKHRoaXMpO1xuICAgICAgdGhpcy50eXBlID0gYjJKb2ludC5lX2Rpc3RhbmNlSm9pbnQ7XG4gICAgICB0aGlzLmxlbmd0aCA9IDEuMDtcbiAgICAgIHRoaXMuZnJlcXVlbmN5SHogPSAwLjA7XG4gICAgICB0aGlzLmRhbXBpbmdSYXRpbyA9IDAuMDtcbiAgIH1cbiAgIGIyRGlzdGFuY2VKb2ludERlZi5wcm90b3R5cGUuSW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIChiQSwgYkIsIGFuY2hvckEsIGFuY2hvckIpIHtcbiAgICAgIHRoaXMuYm9keUEgPSBiQTtcbiAgICAgIHRoaXMuYm9keUIgPSBiQjtcbiAgICAgIHRoaXMubG9jYWxBbmNob3JBLlNldFYodGhpcy5ib2R5QS5HZXRMb2NhbFBvaW50KGFuY2hvckEpKTtcbiAgICAgIHRoaXMubG9jYWxBbmNob3JCLlNldFYodGhpcy5ib2R5Qi5HZXRMb2NhbFBvaW50KGFuY2hvckIpKTtcbiAgICAgIHZhciBkWCA9IGFuY2hvckIueCAtIGFuY2hvckEueDtcbiAgICAgIHZhciBkWSA9IGFuY2hvckIueSAtIGFuY2hvckEueTtcbiAgICAgIHRoaXMubGVuZ3RoID0gTWF0aC5zcXJ0KGRYICogZFggKyBkWSAqIGRZKTtcbiAgICAgIHRoaXMuZnJlcXVlbmN5SHogPSAwLjA7XG4gICAgICB0aGlzLmRhbXBpbmdSYXRpbyA9IDAuMDtcbiAgIH1cbiAgIEJveDJELmluaGVyaXQoYjJGcmljdGlvbkpvaW50LCBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludCk7XG4gICBiMkZyaWN0aW9uSm9pbnQucHJvdG90eXBlLl9fc3VwZXIgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5wcm90b3R5cGU7XG4gICBiMkZyaWN0aW9uSm9pbnQuYjJGcmljdGlvbkpvaW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQuYjJKb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQSA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvckIgPSBuZXcgYjJWZWMyKCk7XG4gICAgICB0aGlzLm1fbGluZWFyTWFzcyA9IG5ldyBiMk1hdDIyKCk7XG4gICAgICB0aGlzLm1fbGluZWFySW1wdWxzZSA9IG5ldyBiMlZlYzIoKTtcbiAgIH07XG4gICBiMkZyaWN0aW9uSm9pbnQucHJvdG90eXBlLkdldEFuY2hvckEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlBLkdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQSk7XG4gICB9XG4gICBiMkZyaWN0aW9uSm9pbnQucHJvdG90eXBlLkdldEFuY2hvckIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlCLkdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQik7XG4gICB9XG4gICBiMkZyaWN0aW9uSm9pbnQucHJvdG90eXBlLkdldFJlYWN0aW9uRm9yY2UgPSBmdW5jdGlvbiAoaW52X2R0KSB7XG4gICAgICBpZiAoaW52X2R0ID09PSB1bmRlZmluZWQpIGludl9kdCA9IDA7XG4gICAgICByZXR1cm4gbmV3IGIyVmVjMihpbnZfZHQgKiB0aGlzLm1fbGluZWFySW1wdWxzZS54LCBpbnZfZHQgKiB0aGlzLm1fbGluZWFySW1wdWxzZS55KTtcbiAgIH1cbiAgIGIyRnJpY3Rpb25Kb2ludC5wcm90b3R5cGUuR2V0UmVhY3Rpb25Ub3JxdWUgPSBmdW5jdGlvbiAoaW52X2R0KSB7XG4gICAgICBpZiAoaW52X2R0ID09PSB1bmRlZmluZWQpIGludl9kdCA9IDA7XG4gICAgICByZXR1cm4gaW52X2R0ICogdGhpcy5tX2FuZ3VsYXJJbXB1bHNlO1xuICAgfVxuICAgYjJGcmljdGlvbkpvaW50LnByb3RvdHlwZS5TZXRNYXhGb3JjZSA9IGZ1bmN0aW9uIChmb3JjZSkge1xuICAgICAgaWYgKGZvcmNlID09PSB1bmRlZmluZWQpIGZvcmNlID0gMDtcbiAgICAgIHRoaXMubV9tYXhGb3JjZSA9IGZvcmNlO1xuICAgfVxuICAgYjJGcmljdGlvbkpvaW50LnByb3RvdHlwZS5HZXRNYXhGb3JjZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fbWF4Rm9yY2U7XG4gICB9XG4gICBiMkZyaWN0aW9uSm9pbnQucHJvdG90eXBlLlNldE1heFRvcnF1ZSA9IGZ1bmN0aW9uICh0b3JxdWUpIHtcbiAgICAgIGlmICh0b3JxdWUgPT09IHVuZGVmaW5lZCkgdG9ycXVlID0gMDtcbiAgICAgIHRoaXMubV9tYXhUb3JxdWUgPSB0b3JxdWU7XG4gICB9XG4gICBiMkZyaWN0aW9uSm9pbnQucHJvdG90eXBlLkdldE1heFRvcnF1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fbWF4VG9ycXVlO1xuICAgfVxuICAgYjJGcmljdGlvbkpvaW50LnByb3RvdHlwZS5iMkZyaWN0aW9uSm9pbnQgPSBmdW5jdGlvbiAoZGVmKSB7XG4gICAgICB0aGlzLl9fc3VwZXIuYjJKb2ludC5jYWxsKHRoaXMsIGRlZik7XG4gICAgICB0aGlzLm1fbG9jYWxBbmNob3JBLlNldFYoZGVmLmxvY2FsQW5jaG9yQSk7XG4gICAgICB0aGlzLm1fbG9jYWxBbmNob3JCLlNldFYoZGVmLmxvY2FsQW5jaG9yQik7XG4gICAgICB0aGlzLm1fbGluZWFyTWFzcy5TZXRaZXJvKCk7XG4gICAgICB0aGlzLm1fYW5ndWxhck1hc3MgPSAwLjA7XG4gICAgICB0aGlzLm1fbGluZWFySW1wdWxzZS5TZXRaZXJvKCk7XG4gICAgICB0aGlzLm1fYW5ndWxhckltcHVsc2UgPSAwLjA7XG4gICAgICB0aGlzLm1fbWF4Rm9yY2UgPSBkZWYubWF4Rm9yY2U7XG4gICAgICB0aGlzLm1fbWF4VG9ycXVlID0gZGVmLm1heFRvcnF1ZTtcbiAgIH1cbiAgIGIyRnJpY3Rpb25Kb2ludC5wcm90b3R5cGUuSW5pdFZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbiAoc3RlcCkge1xuICAgICAgdmFyIHRNYXQ7XG4gICAgICB2YXIgdFggPSAwO1xuICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xuICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xuICAgICAgdE1hdCA9IGJBLm1feGYuUjtcbiAgICAgIHZhciByQVggPSB0aGlzLm1fbG9jYWxBbmNob3JBLnggLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XG4gICAgICB2YXIgckFZID0gdGhpcy5tX2xvY2FsQW5jaG9yQS55IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci55O1xuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByQVggKyB0TWF0LmNvbDIueCAqIHJBWSk7XG4gICAgICByQVkgPSAodE1hdC5jb2wxLnkgKiByQVggKyB0TWF0LmNvbDIueSAqIHJBWSk7XG4gICAgICByQVggPSB0WDtcbiAgICAgIHRNYXQgPSBiQi5tX3hmLlI7XG4gICAgICB2YXIgckJYID0gdGhpcy5tX2xvY2FsQW5jaG9yQi54IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci54O1xuICAgICAgdmFyIHJCWSA9IHRoaXMubV9sb2NhbEFuY2hvckIueSAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcbiAgICAgIHRYID0gKHRNYXQuY29sMS54ICogckJYICsgdE1hdC5jb2wyLnggKiByQlkpO1xuICAgICAgckJZID0gKHRNYXQuY29sMS55ICogckJYICsgdE1hdC5jb2wyLnkgKiByQlkpO1xuICAgICAgckJYID0gdFg7XG4gICAgICB2YXIgbUEgPSBiQS5tX2ludk1hc3M7XG4gICAgICB2YXIgbUIgPSBiQi5tX2ludk1hc3M7XG4gICAgICB2YXIgaUEgPSBiQS5tX2ludkk7XG4gICAgICB2YXIgaUIgPSBiQi5tX2ludkk7XG4gICAgICB2YXIgSyA9IG5ldyBiMk1hdDIyKCk7XG4gICAgICBLLmNvbDEueCA9IG1BICsgbUI7XG4gICAgICBLLmNvbDIueCA9IDAuMDtcbiAgICAgIEsuY29sMS55ID0gMC4wO1xuICAgICAgSy5jb2wyLnkgPSBtQSArIG1CO1xuICAgICAgSy5jb2wxLnggKz0gaUEgKiByQVkgKiByQVk7XG4gICAgICBLLmNvbDIueCArPSAoLWlBICogckFYICogckFZKTtcbiAgICAgIEsuY29sMS55ICs9ICgtaUEgKiByQVggKiByQVkpO1xuICAgICAgSy5jb2wyLnkgKz0gaUEgKiByQVggKiByQVg7XG4gICAgICBLLmNvbDEueCArPSBpQiAqIHJCWSAqIHJCWTtcbiAgICAgIEsuY29sMi54ICs9ICgtaUIgKiByQlggKiByQlkpO1xuICAgICAgSy5jb2wxLnkgKz0gKC1pQiAqIHJCWCAqIHJCWSk7XG4gICAgICBLLmNvbDIueSArPSBpQiAqIHJCWCAqIHJCWDtcbiAgICAgIEsuR2V0SW52ZXJzZSh0aGlzLm1fbGluZWFyTWFzcyk7XG4gICAgICB0aGlzLm1fYW5ndWxhck1hc3MgPSBpQSArIGlCO1xuICAgICAgaWYgKHRoaXMubV9hbmd1bGFyTWFzcyA+IDAuMCkge1xuICAgICAgICAgdGhpcy5tX2FuZ3VsYXJNYXNzID0gMS4wIC8gdGhpcy5tX2FuZ3VsYXJNYXNzO1xuICAgICAgfVxuICAgICAgaWYgKHN0ZXAud2FybVN0YXJ0aW5nKSB7XG4gICAgICAgICB0aGlzLm1fbGluZWFySW1wdWxzZS54ICo9IHN0ZXAuZHRSYXRpbztcbiAgICAgICAgIHRoaXMubV9saW5lYXJJbXB1bHNlLnkgKj0gc3RlcC5kdFJhdGlvO1xuICAgICAgICAgdGhpcy5tX2FuZ3VsYXJJbXB1bHNlICo9IHN0ZXAuZHRSYXRpbztcbiAgICAgICAgIHZhciBQID0gdGhpcy5tX2xpbmVhckltcHVsc2U7XG4gICAgICAgICBiQS5tX2xpbmVhclZlbG9jaXR5LnggLT0gbUEgKiBQLng7XG4gICAgICAgICBiQS5tX2xpbmVhclZlbG9jaXR5LnkgLT0gbUEgKiBQLnk7XG4gICAgICAgICBiQS5tX2FuZ3VsYXJWZWxvY2l0eSAtPSBpQSAqIChyQVggKiBQLnkgLSByQVkgKiBQLnggKyB0aGlzLm1fYW5ndWxhckltcHVsc2UpO1xuICAgICAgICAgYkIubV9saW5lYXJWZWxvY2l0eS54ICs9IG1CICogUC54O1xuICAgICAgICAgYkIubV9saW5lYXJWZWxvY2l0eS55ICs9IG1CICogUC55O1xuICAgICAgICAgYkIubV9hbmd1bGFyVmVsb2NpdHkgKz0gaUIgKiAockJYICogUC55IC0gckJZICogUC54ICsgdGhpcy5tX2FuZ3VsYXJJbXB1bHNlKTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICAgdGhpcy5tX2xpbmVhckltcHVsc2UuU2V0WmVybygpO1xuICAgICAgICAgdGhpcy5tX2FuZ3VsYXJJbXB1bHNlID0gMC4wO1xuICAgICAgfVxuICAgfVxuICAgYjJGcmljdGlvbkpvaW50LnByb3RvdHlwZS5Tb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbiAoc3RlcCkge1xuICAgICAgdmFyIHRNYXQ7XG4gICAgICB2YXIgdFggPSAwO1xuICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xuICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xuICAgICAgdmFyIHZBID0gYkEubV9saW5lYXJWZWxvY2l0eTtcbiAgICAgIHZhciB3QSA9IGJBLm1fYW5ndWxhclZlbG9jaXR5O1xuICAgICAgdmFyIHZCID0gYkIubV9saW5lYXJWZWxvY2l0eTtcbiAgICAgIHZhciB3QiA9IGJCLm1fYW5ndWxhclZlbG9jaXR5O1xuICAgICAgdmFyIG1BID0gYkEubV9pbnZNYXNzO1xuICAgICAgdmFyIG1CID0gYkIubV9pbnZNYXNzO1xuICAgICAgdmFyIGlBID0gYkEubV9pbnZJO1xuICAgICAgdmFyIGlCID0gYkIubV9pbnZJO1xuICAgICAgdE1hdCA9IGJBLm1feGYuUjtcbiAgICAgIHZhciByQVggPSB0aGlzLm1fbG9jYWxBbmNob3JBLnggLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XG4gICAgICB2YXIgckFZID0gdGhpcy5tX2xvY2FsQW5jaG9yQS55IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci55O1xuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByQVggKyB0TWF0LmNvbDIueCAqIHJBWSk7XG4gICAgICByQVkgPSAodE1hdC5jb2wxLnkgKiByQVggKyB0TWF0LmNvbDIueSAqIHJBWSk7XG4gICAgICByQVggPSB0WDtcbiAgICAgIHRNYXQgPSBiQi5tX3hmLlI7XG4gICAgICB2YXIgckJYID0gdGhpcy5tX2xvY2FsQW5jaG9yQi54IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci54O1xuICAgICAgdmFyIHJCWSA9IHRoaXMubV9sb2NhbEFuY2hvckIueSAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcbiAgICAgIHRYID0gKHRNYXQuY29sMS54ICogckJYICsgdE1hdC5jb2wyLnggKiByQlkpO1xuICAgICAgckJZID0gKHRNYXQuY29sMS55ICogckJYICsgdE1hdC5jb2wyLnkgKiByQlkpO1xuICAgICAgckJYID0gdFg7XG4gICAgICB2YXIgbWF4SW1wdWxzZSA9IDA7IHtcbiAgICAgICAgIHZhciBDZG90ID0gd0IgLSB3QTtcbiAgICAgICAgIHZhciBpbXB1bHNlID0gKC10aGlzLm1fYW5ndWxhck1hc3MgKiBDZG90KTtcbiAgICAgICAgIHZhciBvbGRJbXB1bHNlID0gdGhpcy5tX2FuZ3VsYXJJbXB1bHNlO1xuICAgICAgICAgbWF4SW1wdWxzZSA9IHN0ZXAuZHQgKiB0aGlzLm1fbWF4VG9ycXVlO1xuICAgICAgICAgdGhpcy5tX2FuZ3VsYXJJbXB1bHNlID0gYjJNYXRoLkNsYW1wKHRoaXMubV9hbmd1bGFySW1wdWxzZSArIGltcHVsc2UsICgtbWF4SW1wdWxzZSksIG1heEltcHVsc2UpO1xuICAgICAgICAgaW1wdWxzZSA9IHRoaXMubV9hbmd1bGFySW1wdWxzZSAtIG9sZEltcHVsc2U7XG4gICAgICAgICB3QSAtPSBpQSAqIGltcHVsc2U7XG4gICAgICAgICB3QiArPSBpQiAqIGltcHVsc2U7XG4gICAgICB9IHtcbiAgICAgICAgIHZhciBDZG90WCA9IHZCLnggLSB3QiAqIHJCWSAtIHZBLnggKyB3QSAqIHJBWTtcbiAgICAgICAgIHZhciBDZG90WSA9IHZCLnkgKyB3QiAqIHJCWCAtIHZBLnkgLSB3QSAqIHJBWDtcbiAgICAgICAgIHZhciBpbXB1bHNlViA9IGIyTWF0aC5NdWxNVih0aGlzLm1fbGluZWFyTWFzcywgbmV3IGIyVmVjMigoLUNkb3RYKSwgKC1DZG90WSkpKTtcbiAgICAgICAgIHZhciBvbGRJbXB1bHNlViA9IHRoaXMubV9saW5lYXJJbXB1bHNlLkNvcHkoKTtcbiAgICAgICAgIHRoaXMubV9saW5lYXJJbXB1bHNlLkFkZChpbXB1bHNlVik7XG4gICAgICAgICBtYXhJbXB1bHNlID0gc3RlcC5kdCAqIHRoaXMubV9tYXhGb3JjZTtcbiAgICAgICAgIGlmICh0aGlzLm1fbGluZWFySW1wdWxzZS5MZW5ndGhTcXVhcmVkKCkgPiBtYXhJbXB1bHNlICogbWF4SW1wdWxzZSkge1xuICAgICAgICAgICAgdGhpcy5tX2xpbmVhckltcHVsc2UuTm9ybWFsaXplKCk7XG4gICAgICAgICAgICB0aGlzLm1fbGluZWFySW1wdWxzZS5NdWx0aXBseShtYXhJbXB1bHNlKTtcbiAgICAgICAgIH1cbiAgICAgICAgIGltcHVsc2VWID0gYjJNYXRoLlN1YnRyYWN0VlYodGhpcy5tX2xpbmVhckltcHVsc2UsIG9sZEltcHVsc2VWKTtcbiAgICAgICAgIHZBLnggLT0gbUEgKiBpbXB1bHNlVi54O1xuICAgICAgICAgdkEueSAtPSBtQSAqIGltcHVsc2VWLnk7XG4gICAgICAgICB3QSAtPSBpQSAqIChyQVggKiBpbXB1bHNlVi55IC0gckFZICogaW1wdWxzZVYueCk7XG4gICAgICAgICB2Qi54ICs9IG1CICogaW1wdWxzZVYueDtcbiAgICAgICAgIHZCLnkgKz0gbUIgKiBpbXB1bHNlVi55O1xuICAgICAgICAgd0IgKz0gaUIgKiAockJYICogaW1wdWxzZVYueSAtIHJCWSAqIGltcHVsc2VWLngpO1xuICAgICAgfVxuICAgICAgYkEubV9hbmd1bGFyVmVsb2NpdHkgPSB3QTtcbiAgICAgIGJCLm1fYW5ndWxhclZlbG9jaXR5ID0gd0I7XG4gICB9XG4gICBiMkZyaWN0aW9uSm9pbnQucHJvdG90eXBlLlNvbHZlUG9zaXRpb25Db25zdHJhaW50cyA9IGZ1bmN0aW9uIChiYXVtZ2FydGUpIHtcbiAgICAgIGlmIChiYXVtZ2FydGUgPT09IHVuZGVmaW5lZCkgYmF1bWdhcnRlID0gMDtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgfVxuICAgQm94MkQuaW5oZXJpdChiMkZyaWN0aW9uSm9pbnREZWYsIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmKTtcbiAgIGIyRnJpY3Rpb25Kb2ludERlZi5wcm90b3R5cGUuX19zdXBlciA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmLnByb3RvdHlwZTtcbiAgIGIyRnJpY3Rpb25Kb2ludERlZi5iMkZyaWN0aW9uSm9pbnREZWYgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZi5iMkpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQSA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIHRoaXMubG9jYWxBbmNob3JCID0gbmV3IGIyVmVjMigpO1xuICAgfTtcbiAgIGIyRnJpY3Rpb25Kb2ludERlZi5wcm90b3R5cGUuYjJGcmljdGlvbkpvaW50RGVmID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5fX3N1cGVyLmIySm9pbnREZWYuY2FsbCh0aGlzKTtcbiAgICAgIHRoaXMudHlwZSA9IGIySm9pbnQuZV9mcmljdGlvbkpvaW50O1xuICAgICAgdGhpcy5tYXhGb3JjZSA9IDAuMDtcbiAgICAgIHRoaXMubWF4VG9ycXVlID0gMC4wO1xuICAgfVxuICAgYjJGcmljdGlvbkpvaW50RGVmLnByb3RvdHlwZS5Jbml0aWFsaXplID0gZnVuY3Rpb24gKGJBLCBiQiwgYW5jaG9yKSB7XG4gICAgICB0aGlzLmJvZHlBID0gYkE7XG4gICAgICB0aGlzLmJvZHlCID0gYkI7XG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQS5TZXRWKHRoaXMuYm9keUEuR2V0TG9jYWxQb2ludChhbmNob3IpKTtcbiAgICAgIHRoaXMubG9jYWxBbmNob3JCLlNldFYodGhpcy5ib2R5Qi5HZXRMb2NhbFBvaW50KGFuY2hvcikpO1xuICAgfVxuICAgQm94MkQuaW5oZXJpdChiMkdlYXJKb2ludCwgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQpO1xuICAgYjJHZWFySm9pbnQucHJvdG90eXBlLl9fc3VwZXIgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5wcm90b3R5cGU7XG4gICBiMkdlYXJKb2ludC5iMkdlYXJKb2ludCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50LmIySm9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIHRoaXMubV9ncm91bmRBbmNob3IxID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy5tX2dyb3VuZEFuY2hvcjIgPSBuZXcgYjJWZWMyKCk7XG4gICAgICB0aGlzLm1fbG9jYWxBbmNob3IxID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMiA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIHRoaXMubV9KID0gbmV3IGIySmFjb2JpYW4oKTtcbiAgIH07XG4gICBiMkdlYXJKb2ludC5wcm90b3R5cGUuR2V0QW5jaG9yQSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fYm9keUEuR2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3IxKTtcbiAgIH1cbiAgIGIyR2VhckpvaW50LnByb3RvdHlwZS5HZXRBbmNob3JCID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV9ib2R5Qi5HZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvcjIpO1xuICAgfVxuICAgYjJHZWFySm9pbnQucHJvdG90eXBlLkdldFJlYWN0aW9uRm9yY2UgPSBmdW5jdGlvbiAoaW52X2R0KSB7XG4gICAgICBpZiAoaW52X2R0ID09PSB1bmRlZmluZWQpIGludl9kdCA9IDA7XG4gICAgICByZXR1cm4gbmV3IGIyVmVjMihpbnZfZHQgKiB0aGlzLm1faW1wdWxzZSAqIHRoaXMubV9KLmxpbmVhckIueCwgaW52X2R0ICogdGhpcy5tX2ltcHVsc2UgKiB0aGlzLm1fSi5saW5lYXJCLnkpO1xuICAgfVxuICAgYjJHZWFySm9pbnQucHJvdG90eXBlLkdldFJlYWN0aW9uVG9ycXVlID0gZnVuY3Rpb24gKGludl9kdCkge1xuICAgICAgaWYgKGludl9kdCA9PT0gdW5kZWZpbmVkKSBpbnZfZHQgPSAwO1xuICAgICAgdmFyIHRNYXQgPSB0aGlzLm1fYm9keUIubV94Zi5SO1xuICAgICAgdmFyIHJYID0gdGhpcy5tX2xvY2FsQW5jaG9yMS54IC0gdGhpcy5tX2JvZHlCLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcbiAgICAgIHZhciByWSA9IHRoaXMubV9sb2NhbEFuY2hvcjEueSAtIHRoaXMubV9ib2R5Qi5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XG4gICAgICB2YXIgdFggPSB0TWF0LmNvbDEueCAqIHJYICsgdE1hdC5jb2wyLnggKiByWTtcbiAgICAgIHJZID0gdE1hdC5jb2wxLnkgKiByWCArIHRNYXQuY29sMi55ICogclk7XG4gICAgICByWCA9IHRYO1xuICAgICAgdmFyIFBYID0gdGhpcy5tX2ltcHVsc2UgKiB0aGlzLm1fSi5saW5lYXJCLng7XG4gICAgICB2YXIgUFkgPSB0aGlzLm1faW1wdWxzZSAqIHRoaXMubV9KLmxpbmVhckIueTtcbiAgICAgIHJldHVybiBpbnZfZHQgKiAodGhpcy5tX2ltcHVsc2UgKiB0aGlzLm1fSi5hbmd1bGFyQiAtIHJYICogUFkgKyByWSAqIFBYKTtcbiAgIH1cbiAgIGIyR2VhckpvaW50LnByb3RvdHlwZS5HZXRSYXRpbyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fcmF0aW87XG4gICB9XG4gICBiMkdlYXJKb2ludC5wcm90b3R5cGUuU2V0UmF0aW8gPSBmdW5jdGlvbiAocmF0aW8pIHtcbiAgICAgIGlmIChyYXRpbyA9PT0gdW5kZWZpbmVkKSByYXRpbyA9IDA7XG4gICAgICB0aGlzLm1fcmF0aW8gPSByYXRpbztcbiAgIH1cbiAgIGIyR2VhckpvaW50LnByb3RvdHlwZS5iMkdlYXJKb2ludCA9IGZ1bmN0aW9uIChkZWYpIHtcbiAgICAgIHRoaXMuX19zdXBlci5iMkpvaW50LmNhbGwodGhpcywgZGVmKTtcbiAgICAgIHZhciB0eXBlMSA9IHBhcnNlSW50KGRlZi5qb2ludDEubV90eXBlKTtcbiAgICAgIHZhciB0eXBlMiA9IHBhcnNlSW50KGRlZi5qb2ludDIubV90eXBlKTtcbiAgICAgIHRoaXMubV9yZXZvbHV0ZTEgPSBudWxsO1xuICAgICAgdGhpcy5tX3ByaXNtYXRpYzEgPSBudWxsO1xuICAgICAgdGhpcy5tX3Jldm9sdXRlMiA9IG51bGw7XG4gICAgICB0aGlzLm1fcHJpc21hdGljMiA9IG51bGw7XG4gICAgICB2YXIgY29vcmRpbmF0ZTEgPSAwO1xuICAgICAgdmFyIGNvb3JkaW5hdGUyID0gMDtcbiAgICAgIHRoaXMubV9ncm91bmQxID0gZGVmLmpvaW50MS5HZXRCb2R5QSgpO1xuICAgICAgdGhpcy5tX2JvZHlBID0gZGVmLmpvaW50MS5HZXRCb2R5QigpO1xuICAgICAgaWYgKHR5cGUxID09IGIySm9pbnQuZV9yZXZvbHV0ZUpvaW50KSB7XG4gICAgICAgICB0aGlzLm1fcmV2b2x1dGUxID0gKGRlZi5qb2ludDEgaW5zdGFuY2VvZiBiMlJldm9sdXRlSm9pbnQgPyBkZWYuam9pbnQxIDogbnVsbCk7XG4gICAgICAgICB0aGlzLm1fZ3JvdW5kQW5jaG9yMS5TZXRWKHRoaXMubV9yZXZvbHV0ZTEubV9sb2NhbEFuY2hvcjEpO1xuICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMS5TZXRWKHRoaXMubV9yZXZvbHV0ZTEubV9sb2NhbEFuY2hvcjIpO1xuICAgICAgICAgY29vcmRpbmF0ZTEgPSB0aGlzLm1fcmV2b2x1dGUxLkdldEpvaW50QW5nbGUoKTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICAgdGhpcy5tX3ByaXNtYXRpYzEgPSAoZGVmLmpvaW50MSBpbnN0YW5jZW9mIGIyUHJpc21hdGljSm9pbnQgPyBkZWYuam9pbnQxIDogbnVsbCk7XG4gICAgICAgICB0aGlzLm1fZ3JvdW5kQW5jaG9yMS5TZXRWKHRoaXMubV9wcmlzbWF0aWMxLm1fbG9jYWxBbmNob3IxKTtcbiAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvcjEuU2V0Vih0aGlzLm1fcHJpc21hdGljMS5tX2xvY2FsQW5jaG9yMik7XG4gICAgICAgICBjb29yZGluYXRlMSA9IHRoaXMubV9wcmlzbWF0aWMxLkdldEpvaW50VHJhbnNsYXRpb24oKTtcbiAgICAgIH1cbiAgICAgIHRoaXMubV9ncm91bmQyID0gZGVmLmpvaW50Mi5HZXRCb2R5QSgpO1xuICAgICAgdGhpcy5tX2JvZHlCID0gZGVmLmpvaW50Mi5HZXRCb2R5QigpO1xuICAgICAgaWYgKHR5cGUyID09IGIySm9pbnQuZV9yZXZvbHV0ZUpvaW50KSB7XG4gICAgICAgICB0aGlzLm1fcmV2b2x1dGUyID0gKGRlZi5qb2ludDIgaW5zdGFuY2VvZiBiMlJldm9sdXRlSm9pbnQgPyBkZWYuam9pbnQyIDogbnVsbCk7XG4gICAgICAgICB0aGlzLm1fZ3JvdW5kQW5jaG9yMi5TZXRWKHRoaXMubV9yZXZvbHV0ZTIubV9sb2NhbEFuY2hvcjEpO1xuICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMi5TZXRWKHRoaXMubV9yZXZvbHV0ZTIubV9sb2NhbEFuY2hvcjIpO1xuICAgICAgICAgY29vcmRpbmF0ZTIgPSB0aGlzLm1fcmV2b2x1dGUyLkdldEpvaW50QW5nbGUoKTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICAgdGhpcy5tX3ByaXNtYXRpYzIgPSAoZGVmLmpvaW50MiBpbnN0YW5jZW9mIGIyUHJpc21hdGljSm9pbnQgPyBkZWYuam9pbnQyIDogbnVsbCk7XG4gICAgICAgICB0aGlzLm1fZ3JvdW5kQW5jaG9yMi5TZXRWKHRoaXMubV9wcmlzbWF0aWMyLm1fbG9jYWxBbmNob3IxKTtcbiAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvcjIuU2V0Vih0aGlzLm1fcHJpc21hdGljMi5tX2xvY2FsQW5jaG9yMik7XG4gICAgICAgICBjb29yZGluYXRlMiA9IHRoaXMubV9wcmlzbWF0aWMyLkdldEpvaW50VHJhbnNsYXRpb24oKTtcbiAgICAgIH1cbiAgICAgIHRoaXMubV9yYXRpbyA9IGRlZi5yYXRpbztcbiAgICAgIHRoaXMubV9jb25zdGFudCA9IGNvb3JkaW5hdGUxICsgdGhpcy5tX3JhdGlvICogY29vcmRpbmF0ZTI7XG4gICAgICB0aGlzLm1faW1wdWxzZSA9IDAuMDtcbiAgIH1cbiAgIGIyR2VhckpvaW50LnByb3RvdHlwZS5Jbml0VmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uIChzdGVwKSB7XG4gICAgICB2YXIgZzEgPSB0aGlzLm1fZ3JvdW5kMTtcbiAgICAgIHZhciBnMiA9IHRoaXMubV9ncm91bmQyO1xuICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xuICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xuICAgICAgdmFyIHVnWCA9IDA7XG4gICAgICB2YXIgdWdZID0gMDtcbiAgICAgIHZhciByWCA9IDA7XG4gICAgICB2YXIgclkgPSAwO1xuICAgICAgdmFyIHRNYXQ7XG4gICAgICB2YXIgdFZlYztcbiAgICAgIHZhciBjcnVnID0gMDtcbiAgICAgIHZhciB0WCA9IDA7XG4gICAgICB2YXIgSyA9IDAuMDtcbiAgICAgIHRoaXMubV9KLlNldFplcm8oKTtcbiAgICAgIGlmICh0aGlzLm1fcmV2b2x1dGUxKSB7XG4gICAgICAgICB0aGlzLm1fSi5hbmd1bGFyQSA9ICgtMS4wKTtcbiAgICAgICAgIEsgKz0gYkEubV9pbnZJO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgICB0TWF0ID0gZzEubV94Zi5SO1xuICAgICAgICAgdFZlYyA9IHRoaXMubV9wcmlzbWF0aWMxLm1fbG9jYWxYQXhpczE7XG4gICAgICAgICB1Z1ggPSB0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55O1xuICAgICAgICAgdWdZID0gdE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueTtcbiAgICAgICAgIHRNYXQgPSBiQS5tX3hmLlI7XG4gICAgICAgICByWCA9IHRoaXMubV9sb2NhbEFuY2hvcjEueCAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcbiAgICAgICAgIHJZID0gdGhpcy5tX2xvY2FsQW5jaG9yMS55IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci55O1xuICAgICAgICAgdFggPSB0TWF0LmNvbDEueCAqIHJYICsgdE1hdC5jb2wyLnggKiByWTtcbiAgICAgICAgIHJZID0gdE1hdC5jb2wxLnkgKiByWCArIHRNYXQuY29sMi55ICogclk7XG4gICAgICAgICByWCA9IHRYO1xuICAgICAgICAgY3J1ZyA9IHJYICogdWdZIC0gclkgKiB1Z1g7XG4gICAgICAgICB0aGlzLm1fSi5saW5lYXJBLlNldCgoLXVnWCksICgtdWdZKSk7XG4gICAgICAgICB0aGlzLm1fSi5hbmd1bGFyQSA9ICgtY3J1Zyk7XG4gICAgICAgICBLICs9IGJBLm1faW52TWFzcyArIGJBLm1faW52SSAqIGNydWcgKiBjcnVnO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMubV9yZXZvbHV0ZTIpIHtcbiAgICAgICAgIHRoaXMubV9KLmFuZ3VsYXJCID0gKC10aGlzLm1fcmF0aW8pO1xuICAgICAgICAgSyArPSB0aGlzLm1fcmF0aW8gKiB0aGlzLm1fcmF0aW8gKiBiQi5tX2ludkk7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgIHRNYXQgPSBnMi5tX3hmLlI7XG4gICAgICAgICB0VmVjID0gdGhpcy5tX3ByaXNtYXRpYzIubV9sb2NhbFhBeGlzMTtcbiAgICAgICAgIHVnWCA9IHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnk7XG4gICAgICAgICB1Z1kgPSB0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55O1xuICAgICAgICAgdE1hdCA9IGJCLm1feGYuUjtcbiAgICAgICAgIHJYID0gdGhpcy5tX2xvY2FsQW5jaG9yMi54IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci54O1xuICAgICAgICAgclkgPSB0aGlzLm1fbG9jYWxBbmNob3IyLnkgLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XG4gICAgICAgICB0WCA9IHRNYXQuY29sMS54ICogclggKyB0TWF0LmNvbDIueCAqIHJZO1xuICAgICAgICAgclkgPSB0TWF0LmNvbDEueSAqIHJYICsgdE1hdC5jb2wyLnkgKiByWTtcbiAgICAgICAgIHJYID0gdFg7XG4gICAgICAgICBjcnVnID0gclggKiB1Z1kgLSByWSAqIHVnWDtcbiAgICAgICAgIHRoaXMubV9KLmxpbmVhckIuU2V0KCgtdGhpcy5tX3JhdGlvICogdWdYKSwgKC10aGlzLm1fcmF0aW8gKiB1Z1kpKTtcbiAgICAgICAgIHRoaXMubV9KLmFuZ3VsYXJCID0gKC10aGlzLm1fcmF0aW8gKiBjcnVnKTtcbiAgICAgICAgIEsgKz0gdGhpcy5tX3JhdGlvICogdGhpcy5tX3JhdGlvICogKGJCLm1faW52TWFzcyArIGJCLm1faW52SSAqIGNydWcgKiBjcnVnKTtcbiAgICAgIH1cbiAgICAgIHRoaXMubV9tYXNzID0gSyA+IDAuMCA/IDEuMCAvIEsgOiAwLjA7XG4gICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcbiAgICAgICAgIGJBLm1fbGluZWFyVmVsb2NpdHkueCArPSBiQS5tX2ludk1hc3MgKiB0aGlzLm1faW1wdWxzZSAqIHRoaXMubV9KLmxpbmVhckEueDtcbiAgICAgICAgIGJBLm1fbGluZWFyVmVsb2NpdHkueSArPSBiQS5tX2ludk1hc3MgKiB0aGlzLm1faW1wdWxzZSAqIHRoaXMubV9KLmxpbmVhckEueTtcbiAgICAgICAgIGJBLm1fYW5ndWxhclZlbG9jaXR5ICs9IGJBLm1faW52SSAqIHRoaXMubV9pbXB1bHNlICogdGhpcy5tX0ouYW5ndWxhckE7XG4gICAgICAgICBiQi5tX2xpbmVhclZlbG9jaXR5LnggKz0gYkIubV9pbnZNYXNzICogdGhpcy5tX2ltcHVsc2UgKiB0aGlzLm1fSi5saW5lYXJCLng7XG4gICAgICAgICBiQi5tX2xpbmVhclZlbG9jaXR5LnkgKz0gYkIubV9pbnZNYXNzICogdGhpcy5tX2ltcHVsc2UgKiB0aGlzLm1fSi5saW5lYXJCLnk7XG4gICAgICAgICBiQi5tX2FuZ3VsYXJWZWxvY2l0eSArPSBiQi5tX2ludkkgKiB0aGlzLm1faW1wdWxzZSAqIHRoaXMubV9KLmFuZ3VsYXJCO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgICB0aGlzLm1faW1wdWxzZSA9IDAuMDtcbiAgICAgIH1cbiAgIH1cbiAgIGIyR2VhckpvaW50LnByb3RvdHlwZS5Tb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbiAoc3RlcCkge1xuICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xuICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xuICAgICAgdmFyIENkb3QgPSB0aGlzLm1fSi5Db21wdXRlKGJBLm1fbGluZWFyVmVsb2NpdHksIGJBLm1fYW5ndWxhclZlbG9jaXR5LCBiQi5tX2xpbmVhclZlbG9jaXR5LCBiQi5tX2FuZ3VsYXJWZWxvY2l0eSk7XG4gICAgICB2YXIgaW1wdWxzZSA9ICgtdGhpcy5tX21hc3MgKiBDZG90KTtcbiAgICAgIHRoaXMubV9pbXB1bHNlICs9IGltcHVsc2U7XG4gICAgICBiQS5tX2xpbmVhclZlbG9jaXR5LnggKz0gYkEubV9pbnZNYXNzICogaW1wdWxzZSAqIHRoaXMubV9KLmxpbmVhckEueDtcbiAgICAgIGJBLm1fbGluZWFyVmVsb2NpdHkueSArPSBiQS5tX2ludk1hc3MgKiBpbXB1bHNlICogdGhpcy5tX0oubGluZWFyQS55O1xuICAgICAgYkEubV9hbmd1bGFyVmVsb2NpdHkgKz0gYkEubV9pbnZJICogaW1wdWxzZSAqIHRoaXMubV9KLmFuZ3VsYXJBO1xuICAgICAgYkIubV9saW5lYXJWZWxvY2l0eS54ICs9IGJCLm1faW52TWFzcyAqIGltcHVsc2UgKiB0aGlzLm1fSi5saW5lYXJCLng7XG4gICAgICBiQi5tX2xpbmVhclZlbG9jaXR5LnkgKz0gYkIubV9pbnZNYXNzICogaW1wdWxzZSAqIHRoaXMubV9KLmxpbmVhckIueTtcbiAgICAgIGJCLm1fYW5ndWxhclZlbG9jaXR5ICs9IGJCLm1faW52SSAqIGltcHVsc2UgKiB0aGlzLm1fSi5hbmd1bGFyQjtcbiAgIH1cbiAgIGIyR2VhckpvaW50LnByb3RvdHlwZS5Tb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMgPSBmdW5jdGlvbiAoYmF1bWdhcnRlKSB7XG4gICAgICBpZiAoYmF1bWdhcnRlID09PSB1bmRlZmluZWQpIGJhdW1nYXJ0ZSA9IDA7XG4gICAgICB2YXIgbGluZWFyRXJyb3IgPSAwLjA7XG4gICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XG4gICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XG4gICAgICB2YXIgY29vcmRpbmF0ZTEgPSAwO1xuICAgICAgdmFyIGNvb3JkaW5hdGUyID0gMDtcbiAgICAgIGlmICh0aGlzLm1fcmV2b2x1dGUxKSB7XG4gICAgICAgICBjb29yZGluYXRlMSA9IHRoaXMubV9yZXZvbHV0ZTEuR2V0Sm9pbnRBbmdsZSgpO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgICBjb29yZGluYXRlMSA9IHRoaXMubV9wcmlzbWF0aWMxLkdldEpvaW50VHJhbnNsYXRpb24oKTtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLm1fcmV2b2x1dGUyKSB7XG4gICAgICAgICBjb29yZGluYXRlMiA9IHRoaXMubV9yZXZvbHV0ZTIuR2V0Sm9pbnRBbmdsZSgpO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgICBjb29yZGluYXRlMiA9IHRoaXMubV9wcmlzbWF0aWMyLkdldEpvaW50VHJhbnNsYXRpb24oKTtcbiAgICAgIH1cbiAgICAgIHZhciBDID0gdGhpcy5tX2NvbnN0YW50IC0gKGNvb3JkaW5hdGUxICsgdGhpcy5tX3JhdGlvICogY29vcmRpbmF0ZTIpO1xuICAgICAgdmFyIGltcHVsc2UgPSAoLXRoaXMubV9tYXNzICogQyk7XG4gICAgICBiQS5tX3N3ZWVwLmMueCArPSBiQS5tX2ludk1hc3MgKiBpbXB1bHNlICogdGhpcy5tX0oubGluZWFyQS54O1xuICAgICAgYkEubV9zd2VlcC5jLnkgKz0gYkEubV9pbnZNYXNzICogaW1wdWxzZSAqIHRoaXMubV9KLmxpbmVhckEueTtcbiAgICAgIGJBLm1fc3dlZXAuYSArPSBiQS5tX2ludkkgKiBpbXB1bHNlICogdGhpcy5tX0ouYW5ndWxhckE7XG4gICAgICBiQi5tX3N3ZWVwLmMueCArPSBiQi5tX2ludk1hc3MgKiBpbXB1bHNlICogdGhpcy5tX0oubGluZWFyQi54O1xuICAgICAgYkIubV9zd2VlcC5jLnkgKz0gYkIubV9pbnZNYXNzICogaW1wdWxzZSAqIHRoaXMubV9KLmxpbmVhckIueTtcbiAgICAgIGJCLm1fc3dlZXAuYSArPSBiQi5tX2ludkkgKiBpbXB1bHNlICogdGhpcy5tX0ouYW5ndWxhckI7XG4gICAgICBiQS5TeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xuICAgICAgYkIuU3luY2hyb25pemVUcmFuc2Zvcm0oKTtcbiAgICAgIHJldHVybiBsaW5lYXJFcnJvciA8IGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcDtcbiAgIH1cbiAgIEJveDJELmluaGVyaXQoYjJHZWFySm9pbnREZWYsIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmKTtcbiAgIGIyR2VhckpvaW50RGVmLnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnREZWYucHJvdG90eXBlO1xuICAgYjJHZWFySm9pbnREZWYuYjJHZWFySm9pbnREZWYgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZi5iMkpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICB9O1xuICAgYjJHZWFySm9pbnREZWYucHJvdG90eXBlLmIyR2VhckpvaW50RGVmID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5fX3N1cGVyLmIySm9pbnREZWYuY2FsbCh0aGlzKTtcbiAgICAgIHRoaXMudHlwZSA9IGIySm9pbnQuZV9nZWFySm9pbnQ7XG4gICAgICB0aGlzLmpvaW50MSA9IG51bGw7XG4gICAgICB0aGlzLmpvaW50MiA9IG51bGw7XG4gICAgICB0aGlzLnJhdGlvID0gMS4wO1xuICAgfVxuICAgYjJKYWNvYmlhbi5iMkphY29iaWFuID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5saW5lYXJBID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy5saW5lYXJCID0gbmV3IGIyVmVjMigpO1xuICAgfTtcbiAgIGIySmFjb2JpYW4ucHJvdG90eXBlLlNldFplcm8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLmxpbmVhckEuU2V0WmVybygpO1xuICAgICAgdGhpcy5hbmd1bGFyQSA9IDAuMDtcbiAgICAgIHRoaXMubGluZWFyQi5TZXRaZXJvKCk7XG4gICAgICB0aGlzLmFuZ3VsYXJCID0gMC4wO1xuICAgfVxuICAgYjJKYWNvYmlhbi5wcm90b3R5cGUuU2V0ID0gZnVuY3Rpb24gKHgxLCBhMSwgeDIsIGEyKSB7XG4gICAgICBpZiAoYTEgPT09IHVuZGVmaW5lZCkgYTEgPSAwO1xuICAgICAgaWYgKGEyID09PSB1bmRlZmluZWQpIGEyID0gMDtcbiAgICAgIHRoaXMubGluZWFyQS5TZXRWKHgxKTtcbiAgICAgIHRoaXMuYW5ndWxhckEgPSBhMTtcbiAgICAgIHRoaXMubGluZWFyQi5TZXRWKHgyKTtcbiAgICAgIHRoaXMuYW5ndWxhckIgPSBhMjtcbiAgIH1cbiAgIGIySmFjb2JpYW4ucHJvdG90eXBlLkNvbXB1dGUgPSBmdW5jdGlvbiAoeDEsIGExLCB4MiwgYTIpIHtcbiAgICAgIGlmIChhMSA9PT0gdW5kZWZpbmVkKSBhMSA9IDA7XG4gICAgICBpZiAoYTIgPT09IHVuZGVmaW5lZCkgYTIgPSAwO1xuICAgICAgcmV0dXJuICh0aGlzLmxpbmVhckEueCAqIHgxLnggKyB0aGlzLmxpbmVhckEueSAqIHgxLnkpICsgdGhpcy5hbmd1bGFyQSAqIGExICsgKHRoaXMubGluZWFyQi54ICogeDIueCArIHRoaXMubGluZWFyQi55ICogeDIueSkgKyB0aGlzLmFuZ3VsYXJCICogYTI7XG4gICB9XG4gICBiMkpvaW50LmIySm9pbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLm1fZWRnZUEgPSBuZXcgYjJKb2ludEVkZ2UoKTtcbiAgICAgIHRoaXMubV9lZGdlQiA9IG5ldyBiMkpvaW50RWRnZSgpO1xuICAgICAgdGhpcy5tX2xvY2FsQ2VudGVyQSA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIHRoaXMubV9sb2NhbENlbnRlckIgPSBuZXcgYjJWZWMyKCk7XG4gICB9O1xuICAgYjJKb2ludC5wcm90b3R5cGUuR2V0VHlwZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fdHlwZTtcbiAgIH1cbiAgIGIySm9pbnQucHJvdG90eXBlLkdldEFuY2hvckEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgIH1cbiAgIGIySm9pbnQucHJvdG90eXBlLkdldEFuY2hvckIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgIH1cbiAgIGIySm9pbnQucHJvdG90eXBlLkdldFJlYWN0aW9uRm9yY2UgPSBmdW5jdGlvbiAoaW52X2R0KSB7XG4gICAgICBpZiAoaW52X2R0ID09PSB1bmRlZmluZWQpIGludl9kdCA9IDA7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgIH1cbiAgIGIySm9pbnQucHJvdG90eXBlLkdldFJlYWN0aW9uVG9ycXVlID0gZnVuY3Rpb24gKGludl9kdCkge1xuICAgICAgaWYgKGludl9kdCA9PT0gdW5kZWZpbmVkKSBpbnZfZHQgPSAwO1xuICAgICAgcmV0dXJuIDAuMDtcbiAgIH1cbiAgIGIySm9pbnQucHJvdG90eXBlLkdldEJvZHlBID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV9ib2R5QTtcbiAgIH1cbiAgIGIySm9pbnQucHJvdG90eXBlLkdldEJvZHlCID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV9ib2R5QjtcbiAgIH1cbiAgIGIySm9pbnQucHJvdG90eXBlLkdldE5leHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX25leHQ7XG4gICB9XG4gICBiMkpvaW50LnByb3RvdHlwZS5HZXRVc2VyRGF0YSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fdXNlckRhdGE7XG4gICB9XG4gICBiMkpvaW50LnByb3RvdHlwZS5TZXRVc2VyRGF0YSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICB0aGlzLm1fdXNlckRhdGEgPSBkYXRhO1xuICAgfVxuICAgYjJKb2ludC5wcm90b3R5cGUuSXNBY3RpdmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlBLklzQWN0aXZlKCkgJiYgdGhpcy5tX2JvZHlCLklzQWN0aXZlKCk7XG4gICB9XG4gICBiMkpvaW50LkNyZWF0ZSA9IGZ1bmN0aW9uIChkZWYsIGFsbG9jYXRvcikge1xuICAgICAgdmFyIGpvaW50ID0gbnVsbDtcbiAgICAgIHN3aXRjaCAoZGVmLnR5cGUpIHtcbiAgICAgIGNhc2UgYjJKb2ludC5lX2Rpc3RhbmNlSm9pbnQ6XG4gICAgICAgICB7XG4gICAgICAgICAgICBqb2ludCA9IG5ldyBiMkRpc3RhbmNlSm9pbnQoKGRlZiBpbnN0YW5jZW9mIGIyRGlzdGFuY2VKb2ludERlZiA/IGRlZiA6IG51bGwpKTtcbiAgICAgICAgIH1cbiAgICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBiMkpvaW50LmVfbW91c2VKb2ludDpcbiAgICAgICAgIHtcbiAgICAgICAgICAgIGpvaW50ID0gbmV3IGIyTW91c2VKb2ludCgoZGVmIGluc3RhbmNlb2YgYjJNb3VzZUpvaW50RGVmID8gZGVmIDogbnVsbCkpO1xuICAgICAgICAgfVxuICAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIGIySm9pbnQuZV9wcmlzbWF0aWNKb2ludDpcbiAgICAgICAgIHtcbiAgICAgICAgICAgIGpvaW50ID0gbmV3IGIyUHJpc21hdGljSm9pbnQoKGRlZiBpbnN0YW5jZW9mIGIyUHJpc21hdGljSm9pbnREZWYgPyBkZWYgOiBudWxsKSk7XG4gICAgICAgICB9XG4gICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgYjJKb2ludC5lX3Jldm9sdXRlSm9pbnQ6XG4gICAgICAgICB7XG4gICAgICAgICAgICBqb2ludCA9IG5ldyBiMlJldm9sdXRlSm9pbnQoKGRlZiBpbnN0YW5jZW9mIGIyUmV2b2x1dGVKb2ludERlZiA/IGRlZiA6IG51bGwpKTtcbiAgICAgICAgIH1cbiAgICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBiMkpvaW50LmVfcHVsbGV5Sm9pbnQ6XG4gICAgICAgICB7XG4gICAgICAgICAgICBqb2ludCA9IG5ldyBiMlB1bGxleUpvaW50KChkZWYgaW5zdGFuY2VvZiBiMlB1bGxleUpvaW50RGVmID8gZGVmIDogbnVsbCkpO1xuICAgICAgICAgfVxuICAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIGIySm9pbnQuZV9nZWFySm9pbnQ6XG4gICAgICAgICB7XG4gICAgICAgICAgICBqb2ludCA9IG5ldyBiMkdlYXJKb2ludCgoZGVmIGluc3RhbmNlb2YgYjJHZWFySm9pbnREZWYgPyBkZWYgOiBudWxsKSk7XG4gICAgICAgICB9XG4gICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgYjJKb2ludC5lX2xpbmVKb2ludDpcbiAgICAgICAgIHtcbiAgICAgICAgICAgIGpvaW50ID0gbmV3IGIyTGluZUpvaW50KChkZWYgaW5zdGFuY2VvZiBiMkxpbmVKb2ludERlZiA/IGRlZiA6IG51bGwpKTtcbiAgICAgICAgIH1cbiAgICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBiMkpvaW50LmVfd2VsZEpvaW50OlxuICAgICAgICAge1xuICAgICAgICAgICAgam9pbnQgPSBuZXcgYjJXZWxkSm9pbnQoKGRlZiBpbnN0YW5jZW9mIGIyV2VsZEpvaW50RGVmID8gZGVmIDogbnVsbCkpO1xuICAgICAgICAgfVxuICAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIGIySm9pbnQuZV9mcmljdGlvbkpvaW50OlxuICAgICAgICAge1xuICAgICAgICAgICAgam9pbnQgPSBuZXcgYjJGcmljdGlvbkpvaW50KChkZWYgaW5zdGFuY2VvZiBiMkZyaWN0aW9uSm9pbnREZWYgPyBkZWYgOiBudWxsKSk7XG4gICAgICAgICB9XG4gICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJldHVybiBqb2ludDtcbiAgIH1cbiAgIGIySm9pbnQuRGVzdHJveSA9IGZ1bmN0aW9uIChqb2ludCwgYWxsb2NhdG9yKSB7fVxuICAgYjJKb2ludC5wcm90b3R5cGUuYjJKb2ludCA9IGZ1bmN0aW9uIChkZWYpIHtcbiAgICAgIGIyU2V0dGluZ3MuYjJBc3NlcnQoZGVmLmJvZHlBICE9IGRlZi5ib2R5Qik7XG4gICAgICB0aGlzLm1fdHlwZSA9IGRlZi50eXBlO1xuICAgICAgdGhpcy5tX3ByZXYgPSBudWxsO1xuICAgICAgdGhpcy5tX25leHQgPSBudWxsO1xuICAgICAgdGhpcy5tX2JvZHlBID0gZGVmLmJvZHlBO1xuICAgICAgdGhpcy5tX2JvZHlCID0gZGVmLmJvZHlCO1xuICAgICAgdGhpcy5tX2NvbGxpZGVDb25uZWN0ZWQgPSBkZWYuY29sbGlkZUNvbm5lY3RlZDtcbiAgICAgIHRoaXMubV9pc2xhbmRGbGFnID0gZmFsc2U7XG4gICAgICB0aGlzLm1fdXNlckRhdGEgPSBkZWYudXNlckRhdGE7XG4gICB9XG4gICBiMkpvaW50LnByb3RvdHlwZS5Jbml0VmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uIChzdGVwKSB7fVxuICAgYjJKb2ludC5wcm90b3R5cGUuU29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKHN0ZXApIHt9XG4gICBiMkpvaW50LnByb3RvdHlwZS5GaW5hbGl6ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbiAoKSB7fVxuICAgYjJKb2ludC5wcm90b3R5cGUuU29sdmVQb3NpdGlvbkNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKGJhdW1nYXJ0ZSkge1xuICAgICAgaWYgKGJhdW1nYXJ0ZSA9PT0gdW5kZWZpbmVkKSBiYXVtZ2FydGUgPSAwO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgfVxuICAgQm94MkQucG9zdERlZnMucHVzaChmdW5jdGlvbiAoKSB7XG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5lX3Vua25vd25Kb2ludCA9IDA7XG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5lX3Jldm9sdXRlSm9pbnQgPSAxO1xuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQuZV9wcmlzbWF0aWNKb2ludCA9IDI7XG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5lX2Rpc3RhbmNlSm9pbnQgPSAzO1xuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQuZV9wdWxsZXlKb2ludCA9IDQ7XG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5lX21vdXNlSm9pbnQgPSA1O1xuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQuZV9nZWFySm9pbnQgPSA2O1xuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQuZV9saW5lSm9pbnQgPSA3O1xuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQuZV93ZWxkSm9pbnQgPSA4O1xuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQuZV9mcmljdGlvbkpvaW50ID0gOTtcbiAgICAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50LmVfaW5hY3RpdmVMaW1pdCA9IDA7XG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5lX2F0TG93ZXJMaW1pdCA9IDE7XG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5lX2F0VXBwZXJMaW1pdCA9IDI7XG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5lX2VxdWFsTGltaXRzID0gMztcbiAgIH0pO1xuICAgYjJKb2ludERlZi5iMkpvaW50RGVmID0gZnVuY3Rpb24gKCkge307XG4gICBiMkpvaW50RGVmLnByb3RvdHlwZS5iMkpvaW50RGVmID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy50eXBlID0gYjJKb2ludC5lX3Vua25vd25Kb2ludDtcbiAgICAgIHRoaXMudXNlckRhdGEgPSBudWxsO1xuICAgICAgdGhpcy5ib2R5QSA9IG51bGw7XG4gICAgICB0aGlzLmJvZHlCID0gbnVsbDtcbiAgICAgIHRoaXMuY29sbGlkZUNvbm5lY3RlZCA9IGZhbHNlO1xuICAgfVxuICAgYjJKb2ludEVkZ2UuYjJKb2ludEVkZ2UgPSBmdW5jdGlvbiAoKSB7fTtcbiAgIEJveDJELmluaGVyaXQoYjJMaW5lSm9pbnQsIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50KTtcbiAgIGIyTGluZUpvaW50LnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQucHJvdG90eXBlO1xuICAgYjJMaW5lSm9pbnQuYjJMaW5lSm9pbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5iMkpvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB0aGlzLm1fbG9jYWxBbmNob3IxID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMiA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIHRoaXMubV9sb2NhbFhBeGlzMSA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIHRoaXMubV9sb2NhbFlBeGlzMSA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIHRoaXMubV9heGlzID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy5tX3BlcnAgPSBuZXcgYjJWZWMyKCk7XG4gICAgICB0aGlzLm1fSyA9IG5ldyBiMk1hdDIyKCk7XG4gICAgICB0aGlzLm1faW1wdWxzZSA9IG5ldyBiMlZlYzIoKTtcbiAgIH07XG4gICBiMkxpbmVKb2ludC5wcm90b3R5cGUuR2V0QW5jaG9yQSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fYm9keUEuR2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3IxKTtcbiAgIH1cbiAgIGIyTGluZUpvaW50LnByb3RvdHlwZS5HZXRBbmNob3JCID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV9ib2R5Qi5HZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvcjIpO1xuICAgfVxuICAgYjJMaW5lSm9pbnQucHJvdG90eXBlLkdldFJlYWN0aW9uRm9yY2UgPSBmdW5jdGlvbiAoaW52X2R0KSB7XG4gICAgICBpZiAoaW52X2R0ID09PSB1bmRlZmluZWQpIGludl9kdCA9IDA7XG4gICAgICByZXR1cm4gbmV3IGIyVmVjMihpbnZfZHQgKiAodGhpcy5tX2ltcHVsc2UueCAqIHRoaXMubV9wZXJwLnggKyAodGhpcy5tX21vdG9ySW1wdWxzZSArIHRoaXMubV9pbXB1bHNlLnkpICogdGhpcy5tX2F4aXMueCksIGludl9kdCAqICh0aGlzLm1faW1wdWxzZS54ICogdGhpcy5tX3BlcnAueSArICh0aGlzLm1fbW90b3JJbXB1bHNlICsgdGhpcy5tX2ltcHVsc2UueSkgKiB0aGlzLm1fYXhpcy55KSk7XG4gICB9XG4gICBiMkxpbmVKb2ludC5wcm90b3R5cGUuR2V0UmVhY3Rpb25Ub3JxdWUgPSBmdW5jdGlvbiAoaW52X2R0KSB7XG4gICAgICBpZiAoaW52X2R0ID09PSB1bmRlZmluZWQpIGludl9kdCA9IDA7XG4gICAgICByZXR1cm4gaW52X2R0ICogdGhpcy5tX2ltcHVsc2UueTtcbiAgIH1cbiAgIGIyTGluZUpvaW50LnByb3RvdHlwZS5HZXRKb2ludFRyYW5zbGF0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xuICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xuICAgICAgdmFyIHRNYXQ7XG4gICAgICB2YXIgcDEgPSBiQS5HZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvcjEpO1xuICAgICAgdmFyIHAyID0gYkIuR2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3IyKTtcbiAgICAgIHZhciBkWCA9IHAyLnggLSBwMS54O1xuICAgICAgdmFyIGRZID0gcDIueSAtIHAxLnk7XG4gICAgICB2YXIgYXhpcyA9IGJBLkdldFdvcmxkVmVjdG9yKHRoaXMubV9sb2NhbFhBeGlzMSk7XG4gICAgICB2YXIgdHJhbnNsYXRpb24gPSBheGlzLnggKiBkWCArIGF4aXMueSAqIGRZO1xuICAgICAgcmV0dXJuIHRyYW5zbGF0aW9uO1xuICAgfVxuICAgYjJMaW5lSm9pbnQucHJvdG90eXBlLkdldEpvaW50U3BlZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XG4gICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XG4gICAgICB2YXIgdE1hdDtcbiAgICAgIHRNYXQgPSBiQS5tX3hmLlI7XG4gICAgICB2YXIgcjFYID0gdGhpcy5tX2xvY2FsQW5jaG9yMS54IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci54O1xuICAgICAgdmFyIHIxWSA9IHRoaXMubV9sb2NhbEFuY2hvcjEueSAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcbiAgICAgIHZhciB0WCA9ICh0TWF0LmNvbDEueCAqIHIxWCArIHRNYXQuY29sMi54ICogcjFZKTtcbiAgICAgIHIxWSA9ICh0TWF0LmNvbDEueSAqIHIxWCArIHRNYXQuY29sMi55ICogcjFZKTtcbiAgICAgIHIxWCA9IHRYO1xuICAgICAgdE1hdCA9IGJCLm1feGYuUjtcbiAgICAgIHZhciByMlggPSB0aGlzLm1fbG9jYWxBbmNob3IyLnggLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XG4gICAgICB2YXIgcjJZID0gdGhpcy5tX2xvY2FsQW5jaG9yMi55IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci55O1xuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByMlggKyB0TWF0LmNvbDIueCAqIHIyWSk7XG4gICAgICByMlkgPSAodE1hdC5jb2wxLnkgKiByMlggKyB0TWF0LmNvbDIueSAqIHIyWSk7XG4gICAgICByMlggPSB0WDtcbiAgICAgIHZhciBwMVggPSBiQS5tX3N3ZWVwLmMueCArIHIxWDtcbiAgICAgIHZhciBwMVkgPSBiQS5tX3N3ZWVwLmMueSArIHIxWTtcbiAgICAgIHZhciBwMlggPSBiQi5tX3N3ZWVwLmMueCArIHIyWDtcbiAgICAgIHZhciBwMlkgPSBiQi5tX3N3ZWVwLmMueSArIHIyWTtcbiAgICAgIHZhciBkWCA9IHAyWCAtIHAxWDtcbiAgICAgIHZhciBkWSA9IHAyWSAtIHAxWTtcbiAgICAgIHZhciBheGlzID0gYkEuR2V0V29ybGRWZWN0b3IodGhpcy5tX2xvY2FsWEF4aXMxKTtcbiAgICAgIHZhciB2MSA9IGJBLm1fbGluZWFyVmVsb2NpdHk7XG4gICAgICB2YXIgdjIgPSBiQi5tX2xpbmVhclZlbG9jaXR5O1xuICAgICAgdmFyIHcxID0gYkEubV9hbmd1bGFyVmVsb2NpdHk7XG4gICAgICB2YXIgdzIgPSBiQi5tX2FuZ3VsYXJWZWxvY2l0eTtcbiAgICAgIHZhciBzcGVlZCA9IChkWCAqICgoLXcxICogYXhpcy55KSkgKyBkWSAqICh3MSAqIGF4aXMueCkpICsgKGF4aXMueCAqICgoKHYyLnggKyAoKC13MiAqIHIyWSkpKSAtIHYxLngpIC0gKCgtdzEgKiByMVkpKSkgKyBheGlzLnkgKiAoKCh2Mi55ICsgKHcyICogcjJYKSkgLSB2MS55KSAtICh3MSAqIHIxWCkpKTtcbiAgICAgIHJldHVybiBzcGVlZDtcbiAgIH1cbiAgIGIyTGluZUpvaW50LnByb3RvdHlwZS5Jc0xpbWl0RW5hYmxlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fZW5hYmxlTGltaXQ7XG4gICB9XG4gICBiMkxpbmVKb2ludC5wcm90b3R5cGUuRW5hYmxlTGltaXQgPSBmdW5jdGlvbiAoZmxhZykge1xuICAgICAgdGhpcy5tX2JvZHlBLlNldEF3YWtlKHRydWUpO1xuICAgICAgdGhpcy5tX2JvZHlCLlNldEF3YWtlKHRydWUpO1xuICAgICAgdGhpcy5tX2VuYWJsZUxpbWl0ID0gZmxhZztcbiAgIH1cbiAgIGIyTGluZUpvaW50LnByb3RvdHlwZS5HZXRMb3dlckxpbWl0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV9sb3dlclRyYW5zbGF0aW9uO1xuICAgfVxuICAgYjJMaW5lSm9pbnQucHJvdG90eXBlLkdldFVwcGVyTGltaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX3VwcGVyVHJhbnNsYXRpb247XG4gICB9XG4gICBiMkxpbmVKb2ludC5wcm90b3R5cGUuU2V0TGltaXRzID0gZnVuY3Rpb24gKGxvd2VyLCB1cHBlcikge1xuICAgICAgaWYgKGxvd2VyID09PSB1bmRlZmluZWQpIGxvd2VyID0gMDtcbiAgICAgIGlmICh1cHBlciA9PT0gdW5kZWZpbmVkKSB1cHBlciA9IDA7XG4gICAgICB0aGlzLm1fYm9keUEuU2V0QXdha2UodHJ1ZSk7XG4gICAgICB0aGlzLm1fYm9keUIuU2V0QXdha2UodHJ1ZSk7XG4gICAgICB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbiA9IGxvd2VyO1xuICAgICAgdGhpcy5tX3VwcGVyVHJhbnNsYXRpb24gPSB1cHBlcjtcbiAgIH1cbiAgIGIyTGluZUpvaW50LnByb3RvdHlwZS5Jc01vdG9yRW5hYmxlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fZW5hYmxlTW90b3I7XG4gICB9XG4gICBiMkxpbmVKb2ludC5wcm90b3R5cGUuRW5hYmxlTW90b3IgPSBmdW5jdGlvbiAoZmxhZykge1xuICAgICAgdGhpcy5tX2JvZHlBLlNldEF3YWtlKHRydWUpO1xuICAgICAgdGhpcy5tX2JvZHlCLlNldEF3YWtlKHRydWUpO1xuICAgICAgdGhpcy5tX2VuYWJsZU1vdG9yID0gZmxhZztcbiAgIH1cbiAgIGIyTGluZUpvaW50LnByb3RvdHlwZS5TZXRNb3RvclNwZWVkID0gZnVuY3Rpb24gKHNwZWVkKSB7XG4gICAgICBpZiAoc3BlZWQgPT09IHVuZGVmaW5lZCkgc3BlZWQgPSAwO1xuICAgICAgdGhpcy5tX2JvZHlBLlNldEF3YWtlKHRydWUpO1xuICAgICAgdGhpcy5tX2JvZHlCLlNldEF3YWtlKHRydWUpO1xuICAgICAgdGhpcy5tX21vdG9yU3BlZWQgPSBzcGVlZDtcbiAgIH1cbiAgIGIyTGluZUpvaW50LnByb3RvdHlwZS5HZXRNb3RvclNwZWVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV9tb3RvclNwZWVkO1xuICAgfVxuICAgYjJMaW5lSm9pbnQucHJvdG90eXBlLlNldE1heE1vdG9yRm9yY2UgPSBmdW5jdGlvbiAoZm9yY2UpIHtcbiAgICAgIGlmIChmb3JjZSA9PT0gdW5kZWZpbmVkKSBmb3JjZSA9IDA7XG4gICAgICB0aGlzLm1fYm9keUEuU2V0QXdha2UodHJ1ZSk7XG4gICAgICB0aGlzLm1fYm9keUIuU2V0QXdha2UodHJ1ZSk7XG4gICAgICB0aGlzLm1fbWF4TW90b3JGb3JjZSA9IGZvcmNlO1xuICAgfVxuICAgYjJMaW5lSm9pbnQucHJvdG90eXBlLkdldE1heE1vdG9yRm9yY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX21heE1vdG9yRm9yY2U7XG4gICB9XG4gICBiMkxpbmVKb2ludC5wcm90b3R5cGUuR2V0TW90b3JGb3JjZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fbW90b3JJbXB1bHNlO1xuICAgfVxuICAgYjJMaW5lSm9pbnQucHJvdG90eXBlLmIyTGluZUpvaW50ID0gZnVuY3Rpb24gKGRlZikge1xuICAgICAgdGhpcy5fX3N1cGVyLmIySm9pbnQuY2FsbCh0aGlzLCBkZWYpO1xuICAgICAgdmFyIHRNYXQ7XG4gICAgICB2YXIgdFggPSAwO1xuICAgICAgdmFyIHRZID0gMDtcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvcjEuU2V0VihkZWYubG9jYWxBbmNob3JBKTtcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvcjIuU2V0VihkZWYubG9jYWxBbmNob3JCKTtcbiAgICAgIHRoaXMubV9sb2NhbFhBeGlzMS5TZXRWKGRlZi5sb2NhbEF4aXNBKTtcbiAgICAgIHRoaXMubV9sb2NhbFlBeGlzMS54ID0gKC10aGlzLm1fbG9jYWxYQXhpczEueSk7XG4gICAgICB0aGlzLm1fbG9jYWxZQXhpczEueSA9IHRoaXMubV9sb2NhbFhBeGlzMS54O1xuICAgICAgdGhpcy5tX2ltcHVsc2UuU2V0WmVybygpO1xuICAgICAgdGhpcy5tX21vdG9yTWFzcyA9IDAuMDtcbiAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgPSAwLjA7XG4gICAgICB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbiA9IGRlZi5sb3dlclRyYW5zbGF0aW9uO1xuICAgICAgdGhpcy5tX3VwcGVyVHJhbnNsYXRpb24gPSBkZWYudXBwZXJUcmFuc2xhdGlvbjtcbiAgICAgIHRoaXMubV9tYXhNb3RvckZvcmNlID0gZGVmLm1heE1vdG9yRm9yY2U7XG4gICAgICB0aGlzLm1fbW90b3JTcGVlZCA9IGRlZi5tb3RvclNwZWVkO1xuICAgICAgdGhpcy5tX2VuYWJsZUxpbWl0ID0gZGVmLmVuYWJsZUxpbWl0O1xuICAgICAgdGhpcy5tX2VuYWJsZU1vdG9yID0gZGVmLmVuYWJsZU1vdG9yO1xuICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBiMkpvaW50LmVfaW5hY3RpdmVMaW1pdDtcbiAgICAgIHRoaXMubV9heGlzLlNldFplcm8oKTtcbiAgICAgIHRoaXMubV9wZXJwLlNldFplcm8oKTtcbiAgIH1cbiAgIGIyTGluZUpvaW50LnByb3RvdHlwZS5Jbml0VmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uIChzdGVwKSB7XG4gICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XG4gICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XG4gICAgICB2YXIgdE1hdDtcbiAgICAgIHZhciB0WCA9IDA7XG4gICAgICB0aGlzLm1fbG9jYWxDZW50ZXJBLlNldFYoYkEuR2V0TG9jYWxDZW50ZXIoKSk7XG4gICAgICB0aGlzLm1fbG9jYWxDZW50ZXJCLlNldFYoYkIuR2V0TG9jYWxDZW50ZXIoKSk7XG4gICAgICB2YXIgeGYxID0gYkEuR2V0VHJhbnNmb3JtKCk7XG4gICAgICB2YXIgeGYyID0gYkIuR2V0VHJhbnNmb3JtKCk7XG4gICAgICB0TWF0ID0gYkEubV94Zi5SO1xuICAgICAgdmFyIHIxWCA9IHRoaXMubV9sb2NhbEFuY2hvcjEueCAtIHRoaXMubV9sb2NhbENlbnRlckEueDtcbiAgICAgIHZhciByMVkgPSB0aGlzLm1fbG9jYWxBbmNob3IxLnkgLSB0aGlzLm1fbG9jYWxDZW50ZXJBLnk7XG4gICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHIxWCArIHRNYXQuY29sMi54ICogcjFZKTtcbiAgICAgIHIxWSA9ICh0TWF0LmNvbDEueSAqIHIxWCArIHRNYXQuY29sMi55ICogcjFZKTtcbiAgICAgIHIxWCA9IHRYO1xuICAgICAgdE1hdCA9IGJCLm1feGYuUjtcbiAgICAgIHZhciByMlggPSB0aGlzLm1fbG9jYWxBbmNob3IyLnggLSB0aGlzLm1fbG9jYWxDZW50ZXJCLng7XG4gICAgICB2YXIgcjJZID0gdGhpcy5tX2xvY2FsQW5jaG9yMi55IC0gdGhpcy5tX2xvY2FsQ2VudGVyQi55O1xuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByMlggKyB0TWF0LmNvbDIueCAqIHIyWSk7XG4gICAgICByMlkgPSAodE1hdC5jb2wxLnkgKiByMlggKyB0TWF0LmNvbDIueSAqIHIyWSk7XG4gICAgICByMlggPSB0WDtcbiAgICAgIHZhciBkWCA9IGJCLm1fc3dlZXAuYy54ICsgcjJYIC0gYkEubV9zd2VlcC5jLnggLSByMVg7XG4gICAgICB2YXIgZFkgPSBiQi5tX3N3ZWVwLmMueSArIHIyWSAtIGJBLm1fc3dlZXAuYy55IC0gcjFZO1xuICAgICAgdGhpcy5tX2ludk1hc3NBID0gYkEubV9pbnZNYXNzO1xuICAgICAgdGhpcy5tX2ludk1hc3NCID0gYkIubV9pbnZNYXNzO1xuICAgICAgdGhpcy5tX2ludklBID0gYkEubV9pbnZJO1xuICAgICAgdGhpcy5tX2ludklCID0gYkIubV9pbnZJOyB7XG4gICAgICAgICB0aGlzLm1fYXhpcy5TZXRWKGIyTWF0aC5NdWxNVih4ZjEuUiwgdGhpcy5tX2xvY2FsWEF4aXMxKSk7XG4gICAgICAgICB0aGlzLm1fYTEgPSAoZFggKyByMVgpICogdGhpcy5tX2F4aXMueSAtIChkWSArIHIxWSkgKiB0aGlzLm1fYXhpcy54O1xuICAgICAgICAgdGhpcy5tX2EyID0gcjJYICogdGhpcy5tX2F4aXMueSAtIHIyWSAqIHRoaXMubV9heGlzLng7XG4gICAgICAgICB0aGlzLm1fbW90b3JNYXNzID0gdGhpcy5tX2ludk1hc3NBICsgdGhpcy5tX2ludk1hc3NCICsgdGhpcy5tX2ludklBICogdGhpcy5tX2ExICogdGhpcy5tX2ExICsgdGhpcy5tX2ludklCICogdGhpcy5tX2EyICogdGhpcy5tX2EyO1xuICAgICAgICAgdGhpcy5tX21vdG9yTWFzcyA9IHRoaXMubV9tb3Rvck1hc3MgPiBOdW1iZXIuTUlOX1ZBTFVFID8gMS4wIC8gdGhpcy5tX21vdG9yTWFzcyA6IDAuMDtcbiAgICAgIH0ge1xuICAgICAgICAgdGhpcy5tX3BlcnAuU2V0VihiMk1hdGguTXVsTVYoeGYxLlIsIHRoaXMubV9sb2NhbFlBeGlzMSkpO1xuICAgICAgICAgdGhpcy5tX3MxID0gKGRYICsgcjFYKSAqIHRoaXMubV9wZXJwLnkgLSAoZFkgKyByMVkpICogdGhpcy5tX3BlcnAueDtcbiAgICAgICAgIHRoaXMubV9zMiA9IHIyWCAqIHRoaXMubV9wZXJwLnkgLSByMlkgKiB0aGlzLm1fcGVycC54O1xuICAgICAgICAgdmFyIG0xID0gdGhpcy5tX2ludk1hc3NBO1xuICAgICAgICAgdmFyIG0yID0gdGhpcy5tX2ludk1hc3NCO1xuICAgICAgICAgdmFyIGkxID0gdGhpcy5tX2ludklBO1xuICAgICAgICAgdmFyIGkyID0gdGhpcy5tX2ludklCO1xuICAgICAgICAgdGhpcy5tX0suY29sMS54ID0gbTEgKyBtMiArIGkxICogdGhpcy5tX3MxICogdGhpcy5tX3MxICsgaTIgKiB0aGlzLm1fczIgKiB0aGlzLm1fczI7XG4gICAgICAgICB0aGlzLm1fSy5jb2wxLnkgPSBpMSAqIHRoaXMubV9zMSAqIHRoaXMubV9hMSArIGkyICogdGhpcy5tX3MyICogdGhpcy5tX2EyO1xuICAgICAgICAgdGhpcy5tX0suY29sMi54ID0gdGhpcy5tX0suY29sMS55O1xuICAgICAgICAgdGhpcy5tX0suY29sMi55ID0gbTEgKyBtMiArIGkxICogdGhpcy5tX2ExICogdGhpcy5tX2ExICsgaTIgKiB0aGlzLm1fYTIgKiB0aGlzLm1fYTI7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5tX2VuYWJsZUxpbWl0KSB7XG4gICAgICAgICB2YXIgam9pbnRUcmFuc2l0aW9uID0gdGhpcy5tX2F4aXMueCAqIGRYICsgdGhpcy5tX2F4aXMueSAqIGRZO1xuICAgICAgICAgaWYgKGIyTWF0aC5BYnModGhpcy5tX3VwcGVyVHJhbnNsYXRpb24gLSB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbikgPCAyLjAgKiBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3ApIHtcbiAgICAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gYjJKb2ludC5lX2VxdWFsTGltaXRzO1xuICAgICAgICAgfVxuICAgICAgICAgZWxzZSBpZiAoam9pbnRUcmFuc2l0aW9uIDw9IHRoaXMubV9sb3dlclRyYW5zbGF0aW9uKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5tX2xpbWl0U3RhdGUgIT0gYjJKb2ludC5lX2F0TG93ZXJMaW1pdCkge1xuICAgICAgICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBiMkpvaW50LmVfYXRMb3dlckxpbWl0O1xuICAgICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueSA9IDAuMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgIH1cbiAgICAgICAgIGVsc2UgaWYgKGpvaW50VHJhbnNpdGlvbiA+PSB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbikge1xuICAgICAgICAgICAgaWYgKHRoaXMubV9saW1pdFN0YXRlICE9IGIySm9pbnQuZV9hdFVwcGVyTGltaXQpIHtcbiAgICAgICAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gYjJKb2ludC5lX2F0VXBwZXJMaW1pdDtcbiAgICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgPSAwLjA7XG4gICAgICAgICAgICB9XG4gICAgICAgICB9XG4gICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gYjJKb2ludC5lX2luYWN0aXZlTGltaXQ7XG4gICAgICAgICAgICB0aGlzLm1faW1wdWxzZS55ID0gMC4wO1xuICAgICAgICAgfVxuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZSA9IGIySm9pbnQuZV9pbmFjdGl2ZUxpbWl0O1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMubV9lbmFibGVNb3RvciA9PSBmYWxzZSkge1xuICAgICAgICAgdGhpcy5tX21vdG9ySW1wdWxzZSA9IDAuMDtcbiAgICAgIH1cbiAgICAgIGlmIChzdGVwLndhcm1TdGFydGluZykge1xuICAgICAgICAgdGhpcy5tX2ltcHVsc2UueCAqPSBzdGVwLmR0UmF0aW87XG4gICAgICAgICB0aGlzLm1faW1wdWxzZS55ICo9IHN0ZXAuZHRSYXRpbztcbiAgICAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgKj0gc3RlcC5kdFJhdGlvO1xuICAgICAgICAgdmFyIFBYID0gdGhpcy5tX2ltcHVsc2UueCAqIHRoaXMubV9wZXJwLnggKyAodGhpcy5tX21vdG9ySW1wdWxzZSArIHRoaXMubV9pbXB1bHNlLnkpICogdGhpcy5tX2F4aXMueDtcbiAgICAgICAgIHZhciBQWSA9IHRoaXMubV9pbXB1bHNlLnggKiB0aGlzLm1fcGVycC55ICsgKHRoaXMubV9tb3RvckltcHVsc2UgKyB0aGlzLm1faW1wdWxzZS55KSAqIHRoaXMubV9heGlzLnk7XG4gICAgICAgICB2YXIgTDEgPSB0aGlzLm1faW1wdWxzZS54ICogdGhpcy5tX3MxICsgKHRoaXMubV9tb3RvckltcHVsc2UgKyB0aGlzLm1faW1wdWxzZS55KSAqIHRoaXMubV9hMTtcbiAgICAgICAgIHZhciBMMiA9IHRoaXMubV9pbXB1bHNlLnggKiB0aGlzLm1fczIgKyAodGhpcy5tX21vdG9ySW1wdWxzZSArIHRoaXMubV9pbXB1bHNlLnkpICogdGhpcy5tX2EyO1xuICAgICAgICAgYkEubV9saW5lYXJWZWxvY2l0eS54IC09IHRoaXMubV9pbnZNYXNzQSAqIFBYO1xuICAgICAgICAgYkEubV9saW5lYXJWZWxvY2l0eS55IC09IHRoaXMubV9pbnZNYXNzQSAqIFBZO1xuICAgICAgICAgYkEubV9hbmd1bGFyVmVsb2NpdHkgLT0gdGhpcy5tX2ludklBICogTDE7XG4gICAgICAgICBiQi5tX2xpbmVhclZlbG9jaXR5LnggKz0gdGhpcy5tX2ludk1hc3NCICogUFg7XG4gICAgICAgICBiQi5tX2xpbmVhclZlbG9jaXR5LnkgKz0gdGhpcy5tX2ludk1hc3NCICogUFk7XG4gICAgICAgICBiQi5tX2FuZ3VsYXJWZWxvY2l0eSArPSB0aGlzLm1faW52SUIgKiBMMjtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICAgdGhpcy5tX2ltcHVsc2UuU2V0WmVybygpO1xuICAgICAgICAgdGhpcy5tX21vdG9ySW1wdWxzZSA9IDAuMDtcbiAgICAgIH1cbiAgIH1cbiAgIGIyTGluZUpvaW50LnByb3RvdHlwZS5Tb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbiAoc3RlcCkge1xuICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xuICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xuICAgICAgdmFyIHYxID0gYkEubV9saW5lYXJWZWxvY2l0eTtcbiAgICAgIHZhciB3MSA9IGJBLm1fYW5ndWxhclZlbG9jaXR5O1xuICAgICAgdmFyIHYyID0gYkIubV9saW5lYXJWZWxvY2l0eTtcbiAgICAgIHZhciB3MiA9IGJCLm1fYW5ndWxhclZlbG9jaXR5O1xuICAgICAgdmFyIFBYID0gMDtcbiAgICAgIHZhciBQWSA9IDA7XG4gICAgICB2YXIgTDEgPSAwO1xuICAgICAgdmFyIEwyID0gMDtcbiAgICAgIGlmICh0aGlzLm1fZW5hYmxlTW90b3IgJiYgdGhpcy5tX2xpbWl0U3RhdGUgIT0gYjJKb2ludC5lX2VxdWFsTGltaXRzKSB7XG4gICAgICAgICB2YXIgQ2RvdCA9IHRoaXMubV9heGlzLnggKiAodjIueCAtIHYxLngpICsgdGhpcy5tX2F4aXMueSAqICh2Mi55IC0gdjEueSkgKyB0aGlzLm1fYTIgKiB3MiAtIHRoaXMubV9hMSAqIHcxO1xuICAgICAgICAgdmFyIGltcHVsc2UgPSB0aGlzLm1fbW90b3JNYXNzICogKHRoaXMubV9tb3RvclNwZWVkIC0gQ2RvdCk7XG4gICAgICAgICB2YXIgb2xkSW1wdWxzZSA9IHRoaXMubV9tb3RvckltcHVsc2U7XG4gICAgICAgICB2YXIgbWF4SW1wdWxzZSA9IHN0ZXAuZHQgKiB0aGlzLm1fbWF4TW90b3JGb3JjZTtcbiAgICAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgPSBiMk1hdGguQ2xhbXAodGhpcy5tX21vdG9ySW1wdWxzZSArIGltcHVsc2UsICgtbWF4SW1wdWxzZSksIG1heEltcHVsc2UpO1xuICAgICAgICAgaW1wdWxzZSA9IHRoaXMubV9tb3RvckltcHVsc2UgLSBvbGRJbXB1bHNlO1xuICAgICAgICAgUFggPSBpbXB1bHNlICogdGhpcy5tX2F4aXMueDtcbiAgICAgICAgIFBZID0gaW1wdWxzZSAqIHRoaXMubV9heGlzLnk7XG4gICAgICAgICBMMSA9IGltcHVsc2UgKiB0aGlzLm1fYTE7XG4gICAgICAgICBMMiA9IGltcHVsc2UgKiB0aGlzLm1fYTI7XG4gICAgICAgICB2MS54IC09IHRoaXMubV9pbnZNYXNzQSAqIFBYO1xuICAgICAgICAgdjEueSAtPSB0aGlzLm1faW52TWFzc0EgKiBQWTtcbiAgICAgICAgIHcxIC09IHRoaXMubV9pbnZJQSAqIEwxO1xuICAgICAgICAgdjIueCArPSB0aGlzLm1faW52TWFzc0IgKiBQWDtcbiAgICAgICAgIHYyLnkgKz0gdGhpcy5tX2ludk1hc3NCICogUFk7XG4gICAgICAgICB3MiArPSB0aGlzLm1faW52SUIgKiBMMjtcbiAgICAgIH1cbiAgICAgIHZhciBDZG90MSA9IHRoaXMubV9wZXJwLnggKiAodjIueCAtIHYxLngpICsgdGhpcy5tX3BlcnAueSAqICh2Mi55IC0gdjEueSkgKyB0aGlzLm1fczIgKiB3MiAtIHRoaXMubV9zMSAqIHcxO1xuICAgICAgaWYgKHRoaXMubV9lbmFibGVMaW1pdCAmJiB0aGlzLm1fbGltaXRTdGF0ZSAhPSBiMkpvaW50LmVfaW5hY3RpdmVMaW1pdCkge1xuICAgICAgICAgdmFyIENkb3QyID0gdGhpcy5tX2F4aXMueCAqICh2Mi54IC0gdjEueCkgKyB0aGlzLm1fYXhpcy55ICogKHYyLnkgLSB2MS55KSArIHRoaXMubV9hMiAqIHcyIC0gdGhpcy5tX2ExICogdzE7XG4gICAgICAgICB2YXIgZjEgPSB0aGlzLm1faW1wdWxzZS5Db3B5KCk7XG4gICAgICAgICB2YXIgZGYgPSB0aGlzLm1fSy5Tb2x2ZShuZXcgYjJWZWMyKCksICgtQ2RvdDEpLCAoLUNkb3QyKSk7XG4gICAgICAgICB0aGlzLm1faW1wdWxzZS5BZGQoZGYpO1xuICAgICAgICAgaWYgKHRoaXMubV9saW1pdFN0YXRlID09IGIySm9pbnQuZV9hdExvd2VyTGltaXQpIHtcbiAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgPSBiMk1hdGguTWF4KHRoaXMubV9pbXB1bHNlLnksIDAuMCk7XG4gICAgICAgICB9XG4gICAgICAgICBlbHNlIGlmICh0aGlzLm1fbGltaXRTdGF0ZSA9PSBiMkpvaW50LmVfYXRVcHBlckxpbWl0KSB7XG4gICAgICAgICAgICB0aGlzLm1faW1wdWxzZS55ID0gYjJNYXRoLk1pbih0aGlzLm1faW1wdWxzZS55LCAwLjApO1xuICAgICAgICAgfVxuICAgICAgICAgdmFyIGIgPSAoLUNkb3QxKSAtICh0aGlzLm1faW1wdWxzZS55IC0gZjEueSkgKiB0aGlzLm1fSy5jb2wyLng7XG4gICAgICAgICB2YXIgZjJyID0gMDtcbiAgICAgICAgIGlmICh0aGlzLm1fSy5jb2wxLnggIT0gMC4wKSB7XG4gICAgICAgICAgICBmMnIgPSBiIC8gdGhpcy5tX0suY29sMS54ICsgZjEueDtcbiAgICAgICAgIH1cbiAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZjJyID0gZjEueDtcbiAgICAgICAgIH1cbiAgICAgICAgIHRoaXMubV9pbXB1bHNlLnggPSBmMnI7XG4gICAgICAgICBkZi54ID0gdGhpcy5tX2ltcHVsc2UueCAtIGYxLng7XG4gICAgICAgICBkZi55ID0gdGhpcy5tX2ltcHVsc2UueSAtIGYxLnk7XG4gICAgICAgICBQWCA9IGRmLnggKiB0aGlzLm1fcGVycC54ICsgZGYueSAqIHRoaXMubV9heGlzLng7XG4gICAgICAgICBQWSA9IGRmLnggKiB0aGlzLm1fcGVycC55ICsgZGYueSAqIHRoaXMubV9heGlzLnk7XG4gICAgICAgICBMMSA9IGRmLnggKiB0aGlzLm1fczEgKyBkZi55ICogdGhpcy5tX2ExO1xuICAgICAgICAgTDIgPSBkZi54ICogdGhpcy5tX3MyICsgZGYueSAqIHRoaXMubV9hMjtcbiAgICAgICAgIHYxLnggLT0gdGhpcy5tX2ludk1hc3NBICogUFg7XG4gICAgICAgICB2MS55IC09IHRoaXMubV9pbnZNYXNzQSAqIFBZO1xuICAgICAgICAgdzEgLT0gdGhpcy5tX2ludklBICogTDE7XG4gICAgICAgICB2Mi54ICs9IHRoaXMubV9pbnZNYXNzQiAqIFBYO1xuICAgICAgICAgdjIueSArPSB0aGlzLm1faW52TWFzc0IgKiBQWTtcbiAgICAgICAgIHcyICs9IHRoaXMubV9pbnZJQiAqIEwyO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgICB2YXIgZGYyID0gMDtcbiAgICAgICAgIGlmICh0aGlzLm1fSy5jb2wxLnggIT0gMC4wKSB7XG4gICAgICAgICAgICBkZjIgPSAoKC1DZG90MSkpIC8gdGhpcy5tX0suY29sMS54O1xuICAgICAgICAgfVxuICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkZjIgPSAwLjA7XG4gICAgICAgICB9XG4gICAgICAgICB0aGlzLm1faW1wdWxzZS54ICs9IGRmMjtcbiAgICAgICAgIFBYID0gZGYyICogdGhpcy5tX3BlcnAueDtcbiAgICAgICAgIFBZID0gZGYyICogdGhpcy5tX3BlcnAueTtcbiAgICAgICAgIEwxID0gZGYyICogdGhpcy5tX3MxO1xuICAgICAgICAgTDIgPSBkZjIgKiB0aGlzLm1fczI7XG4gICAgICAgICB2MS54IC09IHRoaXMubV9pbnZNYXNzQSAqIFBYO1xuICAgICAgICAgdjEueSAtPSB0aGlzLm1faW52TWFzc0EgKiBQWTtcbiAgICAgICAgIHcxIC09IHRoaXMubV9pbnZJQSAqIEwxO1xuICAgICAgICAgdjIueCArPSB0aGlzLm1faW52TWFzc0IgKiBQWDtcbiAgICAgICAgIHYyLnkgKz0gdGhpcy5tX2ludk1hc3NCICogUFk7XG4gICAgICAgICB3MiArPSB0aGlzLm1faW52SUIgKiBMMjtcbiAgICAgIH1cbiAgICAgIGJBLm1fbGluZWFyVmVsb2NpdHkuU2V0Vih2MSk7XG4gICAgICBiQS5tX2FuZ3VsYXJWZWxvY2l0eSA9IHcxO1xuICAgICAgYkIubV9saW5lYXJWZWxvY2l0eS5TZXRWKHYyKTtcbiAgICAgIGJCLm1fYW5ndWxhclZlbG9jaXR5ID0gdzI7XG4gICB9XG4gICBiMkxpbmVKb2ludC5wcm90b3R5cGUuU29sdmVQb3NpdGlvbkNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKGJhdW1nYXJ0ZSkge1xuICAgICAgaWYgKGJhdW1nYXJ0ZSA9PT0gdW5kZWZpbmVkKSBiYXVtZ2FydGUgPSAwO1xuICAgICAgdmFyIGxpbWl0QyA9IDA7XG4gICAgICB2YXIgb2xkTGltaXRJbXB1bHNlID0gMDtcbiAgICAgIHZhciBiQSA9IHRoaXMubV9ib2R5QTtcbiAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcbiAgICAgIHZhciBjMSA9IGJBLm1fc3dlZXAuYztcbiAgICAgIHZhciBhMSA9IGJBLm1fc3dlZXAuYTtcbiAgICAgIHZhciBjMiA9IGJCLm1fc3dlZXAuYztcbiAgICAgIHZhciBhMiA9IGJCLm1fc3dlZXAuYTtcbiAgICAgIHZhciB0TWF0O1xuICAgICAgdmFyIHRYID0gMDtcbiAgICAgIHZhciBtMSA9IDA7XG4gICAgICB2YXIgbTIgPSAwO1xuICAgICAgdmFyIGkxID0gMDtcbiAgICAgIHZhciBpMiA9IDA7XG4gICAgICB2YXIgbGluZWFyRXJyb3IgPSAwLjA7XG4gICAgICB2YXIgYW5ndWxhckVycm9yID0gMC4wO1xuICAgICAgdmFyIGFjdGl2ZSA9IGZhbHNlO1xuICAgICAgdmFyIEMyID0gMC4wO1xuICAgICAgdmFyIFIxID0gYjJNYXQyMi5Gcm9tQW5nbGUoYTEpO1xuICAgICAgdmFyIFIyID0gYjJNYXQyMi5Gcm9tQW5nbGUoYTIpO1xuICAgICAgdE1hdCA9IFIxO1xuICAgICAgdmFyIHIxWCA9IHRoaXMubV9sb2NhbEFuY2hvcjEueCAtIHRoaXMubV9sb2NhbENlbnRlckEueDtcbiAgICAgIHZhciByMVkgPSB0aGlzLm1fbG9jYWxBbmNob3IxLnkgLSB0aGlzLm1fbG9jYWxDZW50ZXJBLnk7XG4gICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHIxWCArIHRNYXQuY29sMi54ICogcjFZKTtcbiAgICAgIHIxWSA9ICh0TWF0LmNvbDEueSAqIHIxWCArIHRNYXQuY29sMi55ICogcjFZKTtcbiAgICAgIHIxWCA9IHRYO1xuICAgICAgdE1hdCA9IFIyO1xuICAgICAgdmFyIHIyWCA9IHRoaXMubV9sb2NhbEFuY2hvcjIueCAtIHRoaXMubV9sb2NhbENlbnRlckIueDtcbiAgICAgIHZhciByMlkgPSB0aGlzLm1fbG9jYWxBbmNob3IyLnkgLSB0aGlzLm1fbG9jYWxDZW50ZXJCLnk7XG4gICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHIyWCArIHRNYXQuY29sMi54ICogcjJZKTtcbiAgICAgIHIyWSA9ICh0TWF0LmNvbDEueSAqIHIyWCArIHRNYXQuY29sMi55ICogcjJZKTtcbiAgICAgIHIyWCA9IHRYO1xuICAgICAgdmFyIGRYID0gYzIueCArIHIyWCAtIGMxLnggLSByMVg7XG4gICAgICB2YXIgZFkgPSBjMi55ICsgcjJZIC0gYzEueSAtIHIxWTtcbiAgICAgIGlmICh0aGlzLm1fZW5hYmxlTGltaXQpIHtcbiAgICAgICAgIHRoaXMubV9heGlzID0gYjJNYXRoLk11bE1WKFIxLCB0aGlzLm1fbG9jYWxYQXhpczEpO1xuICAgICAgICAgdGhpcy5tX2ExID0gKGRYICsgcjFYKSAqIHRoaXMubV9heGlzLnkgLSAoZFkgKyByMVkpICogdGhpcy5tX2F4aXMueDtcbiAgICAgICAgIHRoaXMubV9hMiA9IHIyWCAqIHRoaXMubV9heGlzLnkgLSByMlkgKiB0aGlzLm1fYXhpcy54O1xuICAgICAgICAgdmFyIHRyYW5zbGF0aW9uID0gdGhpcy5tX2F4aXMueCAqIGRYICsgdGhpcy5tX2F4aXMueSAqIGRZO1xuICAgICAgICAgaWYgKGIyTWF0aC5BYnModGhpcy5tX3VwcGVyVHJhbnNsYXRpb24gLSB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbikgPCAyLjAgKiBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3ApIHtcbiAgICAgICAgICAgIEMyID0gYjJNYXRoLkNsYW1wKHRyYW5zbGF0aW9uLCAoLWIyU2V0dGluZ3MuYjJfbWF4TGluZWFyQ29ycmVjdGlvbiksIGIyU2V0dGluZ3MuYjJfbWF4TGluZWFyQ29ycmVjdGlvbik7XG4gICAgICAgICAgICBsaW5lYXJFcnJvciA9IGIyTWF0aC5BYnModHJhbnNsYXRpb24pO1xuICAgICAgICAgICAgYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgIH1cbiAgICAgICAgIGVsc2UgaWYgKHRyYW5zbGF0aW9uIDw9IHRoaXMubV9sb3dlclRyYW5zbGF0aW9uKSB7XG4gICAgICAgICAgICBDMiA9IGIyTWF0aC5DbGFtcCh0cmFuc2xhdGlvbiAtIHRoaXMubV9sb3dlclRyYW5zbGF0aW9uICsgYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wLCAoLWIyU2V0dGluZ3MuYjJfbWF4TGluZWFyQ29ycmVjdGlvbiksIDAuMCk7XG4gICAgICAgICAgICBsaW5lYXJFcnJvciA9IHRoaXMubV9sb3dlclRyYW5zbGF0aW9uIC0gdHJhbnNsYXRpb247XG4gICAgICAgICAgICBhY3RpdmUgPSB0cnVlO1xuICAgICAgICAgfVxuICAgICAgICAgZWxzZSBpZiAodHJhbnNsYXRpb24gPj0gdGhpcy5tX3VwcGVyVHJhbnNsYXRpb24pIHtcbiAgICAgICAgICAgIEMyID0gYjJNYXRoLkNsYW1wKHRyYW5zbGF0aW9uIC0gdGhpcy5tX3VwcGVyVHJhbnNsYXRpb24gKyBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3AsIDAuMCwgYjJTZXR0aW5ncy5iMl9tYXhMaW5lYXJDb3JyZWN0aW9uKTtcbiAgICAgICAgICAgIGxpbmVhckVycm9yID0gdHJhbnNsYXRpb24gLSB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbjtcbiAgICAgICAgICAgIGFjdGl2ZSA9IHRydWU7XG4gICAgICAgICB9XG4gICAgICB9XG4gICAgICB0aGlzLm1fcGVycCA9IGIyTWF0aC5NdWxNVihSMSwgdGhpcy5tX2xvY2FsWUF4aXMxKTtcbiAgICAgIHRoaXMubV9zMSA9IChkWCArIHIxWCkgKiB0aGlzLm1fcGVycC55IC0gKGRZICsgcjFZKSAqIHRoaXMubV9wZXJwLng7XG4gICAgICB0aGlzLm1fczIgPSByMlggKiB0aGlzLm1fcGVycC55IC0gcjJZICogdGhpcy5tX3BlcnAueDtcbiAgICAgIHZhciBpbXB1bHNlID0gbmV3IGIyVmVjMigpO1xuICAgICAgdmFyIEMxID0gdGhpcy5tX3BlcnAueCAqIGRYICsgdGhpcy5tX3BlcnAueSAqIGRZO1xuICAgICAgbGluZWFyRXJyb3IgPSBiMk1hdGguTWF4KGxpbmVhckVycm9yLCBiMk1hdGguQWJzKEMxKSk7XG4gICAgICBhbmd1bGFyRXJyb3IgPSAwLjA7XG4gICAgICBpZiAoYWN0aXZlKSB7XG4gICAgICAgICBtMSA9IHRoaXMubV9pbnZNYXNzQTtcbiAgICAgICAgIG0yID0gdGhpcy5tX2ludk1hc3NCO1xuICAgICAgICAgaTEgPSB0aGlzLm1faW52SUE7XG4gICAgICAgICBpMiA9IHRoaXMubV9pbnZJQjtcbiAgICAgICAgIHRoaXMubV9LLmNvbDEueCA9IG0xICsgbTIgKyBpMSAqIHRoaXMubV9zMSAqIHRoaXMubV9zMSArIGkyICogdGhpcy5tX3MyICogdGhpcy5tX3MyO1xuICAgICAgICAgdGhpcy5tX0suY29sMS55ID0gaTEgKiB0aGlzLm1fczEgKiB0aGlzLm1fYTEgKyBpMiAqIHRoaXMubV9zMiAqIHRoaXMubV9hMjtcbiAgICAgICAgIHRoaXMubV9LLmNvbDIueCA9IHRoaXMubV9LLmNvbDEueTtcbiAgICAgICAgIHRoaXMubV9LLmNvbDIueSA9IG0xICsgbTIgKyBpMSAqIHRoaXMubV9hMSAqIHRoaXMubV9hMSArIGkyICogdGhpcy5tX2EyICogdGhpcy5tX2EyO1xuICAgICAgICAgdGhpcy5tX0suU29sdmUoaW1wdWxzZSwgKC1DMSksICgtQzIpKTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICAgbTEgPSB0aGlzLm1faW52TWFzc0E7XG4gICAgICAgICBtMiA9IHRoaXMubV9pbnZNYXNzQjtcbiAgICAgICAgIGkxID0gdGhpcy5tX2ludklBO1xuICAgICAgICAgaTIgPSB0aGlzLm1faW52SUI7XG4gICAgICAgICB2YXIgazExID0gbTEgKyBtMiArIGkxICogdGhpcy5tX3MxICogdGhpcy5tX3MxICsgaTIgKiB0aGlzLm1fczIgKiB0aGlzLm1fczI7XG4gICAgICAgICB2YXIgaW1wdWxzZTEgPSAwO1xuICAgICAgICAgaWYgKGsxMSAhPSAwLjApIHtcbiAgICAgICAgICAgIGltcHVsc2UxID0gKCgtQzEpKSAvIGsxMTtcbiAgICAgICAgIH1cbiAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaW1wdWxzZTEgPSAwLjA7XG4gICAgICAgICB9XG4gICAgICAgICBpbXB1bHNlLnggPSBpbXB1bHNlMTtcbiAgICAgICAgIGltcHVsc2UueSA9IDAuMDtcbiAgICAgIH1cbiAgICAgIHZhciBQWCA9IGltcHVsc2UueCAqIHRoaXMubV9wZXJwLnggKyBpbXB1bHNlLnkgKiB0aGlzLm1fYXhpcy54O1xuICAgICAgdmFyIFBZID0gaW1wdWxzZS54ICogdGhpcy5tX3BlcnAueSArIGltcHVsc2UueSAqIHRoaXMubV9heGlzLnk7XG4gICAgICB2YXIgTDEgPSBpbXB1bHNlLnggKiB0aGlzLm1fczEgKyBpbXB1bHNlLnkgKiB0aGlzLm1fYTE7XG4gICAgICB2YXIgTDIgPSBpbXB1bHNlLnggKiB0aGlzLm1fczIgKyBpbXB1bHNlLnkgKiB0aGlzLm1fYTI7XG4gICAgICBjMS54IC09IHRoaXMubV9pbnZNYXNzQSAqIFBYO1xuICAgICAgYzEueSAtPSB0aGlzLm1faW52TWFzc0EgKiBQWTtcbiAgICAgIGExIC09IHRoaXMubV9pbnZJQSAqIEwxO1xuICAgICAgYzIueCArPSB0aGlzLm1faW52TWFzc0IgKiBQWDtcbiAgICAgIGMyLnkgKz0gdGhpcy5tX2ludk1hc3NCICogUFk7XG4gICAgICBhMiArPSB0aGlzLm1faW52SUIgKiBMMjtcbiAgICAgIGJBLm1fc3dlZXAuYSA9IGExO1xuICAgICAgYkIubV9zd2VlcC5hID0gYTI7XG4gICAgICBiQS5TeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xuICAgICAgYkIuU3luY2hyb25pemVUcmFuc2Zvcm0oKTtcbiAgICAgIHJldHVybiBsaW5lYXJFcnJvciA8PSBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3AgJiYgYW5ndWxhckVycm9yIDw9IGIyU2V0dGluZ3MuYjJfYW5ndWxhclNsb3A7XG4gICB9XG4gICBCb3gyRC5pbmhlcml0KGIyTGluZUpvaW50RGVmLCBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZik7XG4gICBiMkxpbmVKb2ludERlZi5wcm90b3R5cGUuX19zdXBlciA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmLnByb3RvdHlwZTtcbiAgIGIyTGluZUpvaW50RGVmLmIyTGluZUpvaW50RGVmID0gZnVuY3Rpb24gKCkge1xuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnREZWYuYjJKb2ludERlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgdGhpcy5sb2NhbEFuY2hvckEgPSBuZXcgYjJWZWMyKCk7XG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQiA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIHRoaXMubG9jYWxBeGlzQSA9IG5ldyBiMlZlYzIoKTtcbiAgIH07XG4gICBiMkxpbmVKb2ludERlZi5wcm90b3R5cGUuYjJMaW5lSm9pbnREZWYgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLl9fc3VwZXIuYjJKb2ludERlZi5jYWxsKHRoaXMpO1xuICAgICAgdGhpcy50eXBlID0gYjJKb2ludC5lX2xpbmVKb2ludDtcbiAgICAgIHRoaXMubG9jYWxBeGlzQS5TZXQoMS4wLCAwLjApO1xuICAgICAgdGhpcy5lbmFibGVMaW1pdCA9IGZhbHNlO1xuICAgICAgdGhpcy5sb3dlclRyYW5zbGF0aW9uID0gMC4wO1xuICAgICAgdGhpcy51cHBlclRyYW5zbGF0aW9uID0gMC4wO1xuICAgICAgdGhpcy5lbmFibGVNb3RvciA9IGZhbHNlO1xuICAgICAgdGhpcy5tYXhNb3RvckZvcmNlID0gMC4wO1xuICAgICAgdGhpcy5tb3RvclNwZWVkID0gMC4wO1xuICAgfVxuICAgYjJMaW5lSm9pbnREZWYucHJvdG90eXBlLkluaXRpYWxpemUgPSBmdW5jdGlvbiAoYkEsIGJCLCBhbmNob3IsIGF4aXMpIHtcbiAgICAgIHRoaXMuYm9keUEgPSBiQTtcbiAgICAgIHRoaXMuYm9keUIgPSBiQjtcbiAgICAgIHRoaXMubG9jYWxBbmNob3JBID0gdGhpcy5ib2R5QS5HZXRMb2NhbFBvaW50KGFuY2hvcik7XG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQiA9IHRoaXMuYm9keUIuR2V0TG9jYWxQb2ludChhbmNob3IpO1xuICAgICAgdGhpcy5sb2NhbEF4aXNBID0gdGhpcy5ib2R5QS5HZXRMb2NhbFZlY3RvcihheGlzKTtcbiAgIH1cbiAgIEJveDJELmluaGVyaXQoYjJNb3VzZUpvaW50LCBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludCk7XG4gICBiMk1vdXNlSm9pbnQucHJvdG90eXBlLl9fc3VwZXIgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5wcm90b3R5cGU7XG4gICBiMk1vdXNlSm9pbnQuYjJNb3VzZUpvaW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQuYjJKb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgdGhpcy5LID0gbmV3IGIyTWF0MjIoKTtcbiAgICAgIHRoaXMuSzEgPSBuZXcgYjJNYXQyMigpO1xuICAgICAgdGhpcy5LMiA9IG5ldyBiMk1hdDIyKCk7XG4gICAgICB0aGlzLm1fbG9jYWxBbmNob3IgPSBuZXcgYjJWZWMyKCk7XG4gICAgICB0aGlzLm1fdGFyZ2V0ID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy5tX2ltcHVsc2UgPSBuZXcgYjJWZWMyKCk7XG4gICAgICB0aGlzLm1fbWFzcyA9IG5ldyBiMk1hdDIyKCk7XG4gICAgICB0aGlzLm1fQyA9IG5ldyBiMlZlYzIoKTtcbiAgIH07XG4gICBiMk1vdXNlSm9pbnQucHJvdG90eXBlLkdldEFuY2hvckEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX3RhcmdldDtcbiAgIH1cbiAgIGIyTW91c2VKb2ludC5wcm90b3R5cGUuR2V0QW5jaG9yQiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fYm9keUIuR2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3IpO1xuICAgfVxuICAgYjJNb3VzZUpvaW50LnByb3RvdHlwZS5HZXRSZWFjdGlvbkZvcmNlID0gZnVuY3Rpb24gKGludl9kdCkge1xuICAgICAgaWYgKGludl9kdCA9PT0gdW5kZWZpbmVkKSBpbnZfZHQgPSAwO1xuICAgICAgcmV0dXJuIG5ldyBiMlZlYzIoaW52X2R0ICogdGhpcy5tX2ltcHVsc2UueCwgaW52X2R0ICogdGhpcy5tX2ltcHVsc2UueSk7XG4gICB9XG4gICBiMk1vdXNlSm9pbnQucHJvdG90eXBlLkdldFJlYWN0aW9uVG9ycXVlID0gZnVuY3Rpb24gKGludl9kdCkge1xuICAgICAgaWYgKGludl9kdCA9PT0gdW5kZWZpbmVkKSBpbnZfZHQgPSAwO1xuICAgICAgcmV0dXJuIDAuMDtcbiAgIH1cbiAgIGIyTW91c2VKb2ludC5wcm90b3R5cGUuR2V0VGFyZ2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV90YXJnZXQ7XG4gICB9XG4gICBiMk1vdXNlSm9pbnQucHJvdG90eXBlLlNldFRhcmdldCA9IGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICAgIGlmICh0aGlzLm1fYm9keUIuSXNBd2FrZSgpID09IGZhbHNlKSB7XG4gICAgICAgICB0aGlzLm1fYm9keUIuU2V0QXdha2UodHJ1ZSk7XG4gICAgICB9XG4gICAgICB0aGlzLm1fdGFyZ2V0ID0gdGFyZ2V0O1xuICAgfVxuICAgYjJNb3VzZUpvaW50LnByb3RvdHlwZS5HZXRNYXhGb3JjZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fbWF4Rm9yY2U7XG4gICB9XG4gICBiMk1vdXNlSm9pbnQucHJvdG90eXBlLlNldE1heEZvcmNlID0gZnVuY3Rpb24gKG1heEZvcmNlKSB7XG4gICAgICBpZiAobWF4Rm9yY2UgPT09IHVuZGVmaW5lZCkgbWF4Rm9yY2UgPSAwO1xuICAgICAgdGhpcy5tX21heEZvcmNlID0gbWF4Rm9yY2U7XG4gICB9XG4gICBiMk1vdXNlSm9pbnQucHJvdG90eXBlLkdldEZyZXF1ZW5jeSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fZnJlcXVlbmN5SHo7XG4gICB9XG4gICBiMk1vdXNlSm9pbnQucHJvdG90eXBlLlNldEZyZXF1ZW5jeSA9IGZ1bmN0aW9uIChoeikge1xuICAgICAgaWYgKGh6ID09PSB1bmRlZmluZWQpIGh6ID0gMDtcbiAgICAgIHRoaXMubV9mcmVxdWVuY3lIeiA9IGh6O1xuICAgfVxuICAgYjJNb3VzZUpvaW50LnByb3RvdHlwZS5HZXREYW1waW5nUmF0aW8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX2RhbXBpbmdSYXRpbztcbiAgIH1cbiAgIGIyTW91c2VKb2ludC5wcm90b3R5cGUuU2V0RGFtcGluZ1JhdGlvID0gZnVuY3Rpb24gKHJhdGlvKSB7XG4gICAgICBpZiAocmF0aW8gPT09IHVuZGVmaW5lZCkgcmF0aW8gPSAwO1xuICAgICAgdGhpcy5tX2RhbXBpbmdSYXRpbyA9IHJhdGlvO1xuICAgfVxuICAgYjJNb3VzZUpvaW50LnByb3RvdHlwZS5iMk1vdXNlSm9pbnQgPSBmdW5jdGlvbiAoZGVmKSB7XG4gICAgICB0aGlzLl9fc3VwZXIuYjJKb2ludC5jYWxsKHRoaXMsIGRlZik7XG4gICAgICB0aGlzLm1fdGFyZ2V0LlNldFYoZGVmLnRhcmdldCk7XG4gICAgICB2YXIgdFggPSB0aGlzLm1fdGFyZ2V0LnggLSB0aGlzLm1fYm9keUIubV94Zi5wb3NpdGlvbi54O1xuICAgICAgdmFyIHRZID0gdGhpcy5tX3RhcmdldC55IC0gdGhpcy5tX2JvZHlCLm1feGYucG9zaXRpb24ueTtcbiAgICAgIHZhciB0TWF0ID0gdGhpcy5tX2JvZHlCLm1feGYuUjtcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvci54ID0gKHRYICogdE1hdC5jb2wxLnggKyB0WSAqIHRNYXQuY29sMS55KTtcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvci55ID0gKHRYICogdE1hdC5jb2wyLnggKyB0WSAqIHRNYXQuY29sMi55KTtcbiAgICAgIHRoaXMubV9tYXhGb3JjZSA9IGRlZi5tYXhGb3JjZTtcbiAgICAgIHRoaXMubV9pbXB1bHNlLlNldFplcm8oKTtcbiAgICAgIHRoaXMubV9mcmVxdWVuY3lIeiA9IGRlZi5mcmVxdWVuY3lIejtcbiAgICAgIHRoaXMubV9kYW1waW5nUmF0aW8gPSBkZWYuZGFtcGluZ1JhdGlvO1xuICAgICAgdGhpcy5tX2JldGEgPSAwLjA7XG4gICAgICB0aGlzLm1fZ2FtbWEgPSAwLjA7XG4gICB9XG4gICBiMk1vdXNlSm9pbnQucHJvdG90eXBlLkluaXRWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKHN0ZXApIHtcbiAgICAgIHZhciBiID0gdGhpcy5tX2JvZHlCO1xuICAgICAgdmFyIG1hc3MgPSBiLkdldE1hc3MoKTtcbiAgICAgIHZhciBvbWVnYSA9IDIuMCAqIE1hdGguUEkgKiB0aGlzLm1fZnJlcXVlbmN5SHo7XG4gICAgICB2YXIgZCA9IDIuMCAqIG1hc3MgKiB0aGlzLm1fZGFtcGluZ1JhdGlvICogb21lZ2E7XG4gICAgICB2YXIgayA9IG1hc3MgKiBvbWVnYSAqIG9tZWdhO1xuICAgICAgdGhpcy5tX2dhbW1hID0gc3RlcC5kdCAqIChkICsgc3RlcC5kdCAqIGspO1xuICAgICAgdGhpcy5tX2dhbW1hID0gdGhpcy5tX2dhbW1hICE9IDAgPyAxIC8gdGhpcy5tX2dhbW1hIDogMC4wO1xuICAgICAgdGhpcy5tX2JldGEgPSBzdGVwLmR0ICogayAqIHRoaXMubV9nYW1tYTtcbiAgICAgIHZhciB0TWF0O3RNYXQgPSBiLm1feGYuUjtcbiAgICAgIHZhciByWCA9IHRoaXMubV9sb2NhbEFuY2hvci54IC0gYi5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XG4gICAgICB2YXIgclkgPSB0aGlzLm1fbG9jYWxBbmNob3IueSAtIGIubV9zd2VlcC5sb2NhbENlbnRlci55O1xuICAgICAgdmFyIHRYID0gKHRNYXQuY29sMS54ICogclggKyB0TWF0LmNvbDIueCAqIHJZKTtyWSA9ICh0TWF0LmNvbDEueSAqIHJYICsgdE1hdC5jb2wyLnkgKiByWSk7XG4gICAgICByWCA9IHRYO1xuICAgICAgdmFyIGludk1hc3MgPSBiLm1faW52TWFzcztcbiAgICAgIHZhciBpbnZJID0gYi5tX2ludkk7dGhpcy5LMS5jb2wxLnggPSBpbnZNYXNzO1xuICAgICAgdGhpcy5LMS5jb2wyLnggPSAwLjA7XG4gICAgICB0aGlzLksxLmNvbDEueSA9IDAuMDtcbiAgICAgIHRoaXMuSzEuY29sMi55ID0gaW52TWFzcztcbiAgICAgIHRoaXMuSzIuY29sMS54ID0gaW52SSAqIHJZICogclk7XG4gICAgICB0aGlzLksyLmNvbDIueCA9ICgtaW52SSAqIHJYICogclkpO1xuICAgICAgdGhpcy5LMi5jb2wxLnkgPSAoLWludkkgKiByWCAqIHJZKTtcbiAgICAgIHRoaXMuSzIuY29sMi55ID0gaW52SSAqIHJYICogclg7XG4gICAgICB0aGlzLksuU2V0TSh0aGlzLksxKTtcbiAgICAgIHRoaXMuSy5BZGRNKHRoaXMuSzIpO1xuICAgICAgdGhpcy5LLmNvbDEueCArPSB0aGlzLm1fZ2FtbWE7XG4gICAgICB0aGlzLksuY29sMi55ICs9IHRoaXMubV9nYW1tYTtcbiAgICAgIHRoaXMuSy5HZXRJbnZlcnNlKHRoaXMubV9tYXNzKTtcbiAgICAgIHRoaXMubV9DLnggPSBiLm1fc3dlZXAuYy54ICsgclggLSB0aGlzLm1fdGFyZ2V0Lng7XG4gICAgICB0aGlzLm1fQy55ID0gYi5tX3N3ZWVwLmMueSArIHJZIC0gdGhpcy5tX3RhcmdldC55O1xuICAgICAgYi5tX2FuZ3VsYXJWZWxvY2l0eSAqPSAwLjk4O1xuICAgICAgdGhpcy5tX2ltcHVsc2UueCAqPSBzdGVwLmR0UmF0aW87XG4gICAgICB0aGlzLm1faW1wdWxzZS55ICo9IHN0ZXAuZHRSYXRpbztcbiAgICAgIGIubV9saW5lYXJWZWxvY2l0eS54ICs9IGludk1hc3MgKiB0aGlzLm1faW1wdWxzZS54O1xuICAgICAgYi5tX2xpbmVhclZlbG9jaXR5LnkgKz0gaW52TWFzcyAqIHRoaXMubV9pbXB1bHNlLnk7XG4gICAgICBiLm1fYW5ndWxhclZlbG9jaXR5ICs9IGludkkgKiAoclggKiB0aGlzLm1faW1wdWxzZS55IC0gclkgKiB0aGlzLm1faW1wdWxzZS54KTtcbiAgIH1cbiAgIGIyTW91c2VKb2ludC5wcm90b3R5cGUuU29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKHN0ZXApIHtcbiAgICAgIHZhciBiID0gdGhpcy5tX2JvZHlCO1xuICAgICAgdmFyIHRNYXQ7XG4gICAgICB2YXIgdFggPSAwO1xuICAgICAgdmFyIHRZID0gMDtcbiAgICAgIHRNYXQgPSBiLm1feGYuUjtcbiAgICAgIHZhciByWCA9IHRoaXMubV9sb2NhbEFuY2hvci54IC0gYi5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XG4gICAgICB2YXIgclkgPSB0aGlzLm1fbG9jYWxBbmNob3IueSAtIGIubV9zd2VlcC5sb2NhbENlbnRlci55O1xuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByWCArIHRNYXQuY29sMi54ICogclkpO1xuICAgICAgclkgPSAodE1hdC5jb2wxLnkgKiByWCArIHRNYXQuY29sMi55ICogclkpO1xuICAgICAgclggPSB0WDtcbiAgICAgIHZhciBDZG90WCA9IGIubV9saW5lYXJWZWxvY2l0eS54ICsgKCgtYi5tX2FuZ3VsYXJWZWxvY2l0eSAqIHJZKSk7XG4gICAgICB2YXIgQ2RvdFkgPSBiLm1fbGluZWFyVmVsb2NpdHkueSArIChiLm1fYW5ndWxhclZlbG9jaXR5ICogclgpO1xuICAgICAgdE1hdCA9IHRoaXMubV9tYXNzO1xuICAgICAgdFggPSBDZG90WCArIHRoaXMubV9iZXRhICogdGhpcy5tX0MueCArIHRoaXMubV9nYW1tYSAqIHRoaXMubV9pbXB1bHNlLng7XG4gICAgICB0WSA9IENkb3RZICsgdGhpcy5tX2JldGEgKiB0aGlzLm1fQy55ICsgdGhpcy5tX2dhbW1hICogdGhpcy5tX2ltcHVsc2UueTtcbiAgICAgIHZhciBpbXB1bHNlWCA9ICgtKHRNYXQuY29sMS54ICogdFggKyB0TWF0LmNvbDIueCAqIHRZKSk7XG4gICAgICB2YXIgaW1wdWxzZVkgPSAoLSh0TWF0LmNvbDEueSAqIHRYICsgdE1hdC5jb2wyLnkgKiB0WSkpO1xuICAgICAgdmFyIG9sZEltcHVsc2VYID0gdGhpcy5tX2ltcHVsc2UueDtcbiAgICAgIHZhciBvbGRJbXB1bHNlWSA9IHRoaXMubV9pbXB1bHNlLnk7XG4gICAgICB0aGlzLm1faW1wdWxzZS54ICs9IGltcHVsc2VYO1xuICAgICAgdGhpcy5tX2ltcHVsc2UueSArPSBpbXB1bHNlWTtcbiAgICAgIHZhciBtYXhJbXB1bHNlID0gc3RlcC5kdCAqIHRoaXMubV9tYXhGb3JjZTtcbiAgICAgIGlmICh0aGlzLm1faW1wdWxzZS5MZW5ndGhTcXVhcmVkKCkgPiBtYXhJbXB1bHNlICogbWF4SW1wdWxzZSkge1xuICAgICAgICAgdGhpcy5tX2ltcHVsc2UuTXVsdGlwbHkobWF4SW1wdWxzZSAvIHRoaXMubV9pbXB1bHNlLkxlbmd0aCgpKTtcbiAgICAgIH1cbiAgICAgIGltcHVsc2VYID0gdGhpcy5tX2ltcHVsc2UueCAtIG9sZEltcHVsc2VYO1xuICAgICAgaW1wdWxzZVkgPSB0aGlzLm1faW1wdWxzZS55IC0gb2xkSW1wdWxzZVk7XG4gICAgICBiLm1fbGluZWFyVmVsb2NpdHkueCArPSBiLm1faW52TWFzcyAqIGltcHVsc2VYO1xuICAgICAgYi5tX2xpbmVhclZlbG9jaXR5LnkgKz0gYi5tX2ludk1hc3MgKiBpbXB1bHNlWTtcbiAgICAgIGIubV9hbmd1bGFyVmVsb2NpdHkgKz0gYi5tX2ludkkgKiAoclggKiBpbXB1bHNlWSAtIHJZICogaW1wdWxzZVgpO1xuICAgfVxuICAgYjJNb3VzZUpvaW50LnByb3RvdHlwZS5Tb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMgPSBmdW5jdGlvbiAoYmF1bWdhcnRlKSB7XG4gICAgICBpZiAoYmF1bWdhcnRlID09PSB1bmRlZmluZWQpIGJhdW1nYXJ0ZSA9IDA7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgIH1cbiAgIEJveDJELmluaGVyaXQoYjJNb3VzZUpvaW50RGVmLCBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZik7XG4gICBiMk1vdXNlSm9pbnREZWYucHJvdG90eXBlLl9fc3VwZXIgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZi5wcm90b3R5cGU7XG4gICBiMk1vdXNlSm9pbnREZWYuYjJNb3VzZUpvaW50RGVmID0gZnVuY3Rpb24gKCkge1xuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnREZWYuYjJKb2ludERlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgdGhpcy50YXJnZXQgPSBuZXcgYjJWZWMyKCk7XG4gICB9O1xuICAgYjJNb3VzZUpvaW50RGVmLnByb3RvdHlwZS5iMk1vdXNlSm9pbnREZWYgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLl9fc3VwZXIuYjJKb2ludERlZi5jYWxsKHRoaXMpO1xuICAgICAgdGhpcy50eXBlID0gYjJKb2ludC5lX21vdXNlSm9pbnQ7XG4gICAgICB0aGlzLm1heEZvcmNlID0gMC4wO1xuICAgICAgdGhpcy5mcmVxdWVuY3lIeiA9IDUuMDtcbiAgICAgIHRoaXMuZGFtcGluZ1JhdGlvID0gMC43O1xuICAgfVxuICAgQm94MkQuaW5oZXJpdChiMlByaXNtYXRpY0pvaW50LCBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludCk7XG4gICBiMlByaXNtYXRpY0pvaW50LnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQucHJvdG90eXBlO1xuICAgYjJQcmlzbWF0aWNKb2ludC5iMlByaXNtYXRpY0pvaW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQuYjJKb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMSA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvcjIgPSBuZXcgYjJWZWMyKCk7XG4gICAgICB0aGlzLm1fbG9jYWxYQXhpczEgPSBuZXcgYjJWZWMyKCk7XG4gICAgICB0aGlzLm1fbG9jYWxZQXhpczEgPSBuZXcgYjJWZWMyKCk7XG4gICAgICB0aGlzLm1fYXhpcyA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIHRoaXMubV9wZXJwID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy5tX0sgPSBuZXcgYjJNYXQzMygpO1xuICAgICAgdGhpcy5tX2ltcHVsc2UgPSBuZXcgYjJWZWMzKCk7XG4gICB9O1xuICAgYjJQcmlzbWF0aWNKb2ludC5wcm90b3R5cGUuR2V0QW5jaG9yQSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fYm9keUEuR2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3IxKTtcbiAgIH1cbiAgIGIyUHJpc21hdGljSm9pbnQucHJvdG90eXBlLkdldEFuY2hvckIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlCLkdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yMik7XG4gICB9XG4gICBiMlByaXNtYXRpY0pvaW50LnByb3RvdHlwZS5HZXRSZWFjdGlvbkZvcmNlID0gZnVuY3Rpb24gKGludl9kdCkge1xuICAgICAgaWYgKGludl9kdCA9PT0gdW5kZWZpbmVkKSBpbnZfZHQgPSAwO1xuICAgICAgcmV0dXJuIG5ldyBiMlZlYzIoaW52X2R0ICogKHRoaXMubV9pbXB1bHNlLnggKiB0aGlzLm1fcGVycC54ICsgKHRoaXMubV9tb3RvckltcHVsc2UgKyB0aGlzLm1faW1wdWxzZS56KSAqIHRoaXMubV9heGlzLngpLCBpbnZfZHQgKiAodGhpcy5tX2ltcHVsc2UueCAqIHRoaXMubV9wZXJwLnkgKyAodGhpcy5tX21vdG9ySW1wdWxzZSArIHRoaXMubV9pbXB1bHNlLnopICogdGhpcy5tX2F4aXMueSkpO1xuICAgfVxuICAgYjJQcmlzbWF0aWNKb2ludC5wcm90b3R5cGUuR2V0UmVhY3Rpb25Ub3JxdWUgPSBmdW5jdGlvbiAoaW52X2R0KSB7XG4gICAgICBpZiAoaW52X2R0ID09PSB1bmRlZmluZWQpIGludl9kdCA9IDA7XG4gICAgICByZXR1cm4gaW52X2R0ICogdGhpcy5tX2ltcHVsc2UueTtcbiAgIH1cbiAgIGIyUHJpc21hdGljSm9pbnQucHJvdG90eXBlLkdldEpvaW50VHJhbnNsYXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XG4gICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XG4gICAgICB2YXIgdE1hdDtcbiAgICAgIHZhciBwMSA9IGJBLkdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yMSk7XG4gICAgICB2YXIgcDIgPSBiQi5HZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvcjIpO1xuICAgICAgdmFyIGRYID0gcDIueCAtIHAxLng7XG4gICAgICB2YXIgZFkgPSBwMi55IC0gcDEueTtcbiAgICAgIHZhciBheGlzID0gYkEuR2V0V29ybGRWZWN0b3IodGhpcy5tX2xvY2FsWEF4aXMxKTtcbiAgICAgIHZhciB0cmFuc2xhdGlvbiA9IGF4aXMueCAqIGRYICsgYXhpcy55ICogZFk7XG4gICAgICByZXR1cm4gdHJhbnNsYXRpb247XG4gICB9XG4gICBiMlByaXNtYXRpY0pvaW50LnByb3RvdHlwZS5HZXRKb2ludFNwZWVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xuICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xuICAgICAgdmFyIHRNYXQ7XG4gICAgICB0TWF0ID0gYkEubV94Zi5SO1xuICAgICAgdmFyIHIxWCA9IHRoaXMubV9sb2NhbEFuY2hvcjEueCAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcbiAgICAgIHZhciByMVkgPSB0aGlzLm1fbG9jYWxBbmNob3IxLnkgLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XG4gICAgICB2YXIgdFggPSAodE1hdC5jb2wxLnggKiByMVggKyB0TWF0LmNvbDIueCAqIHIxWSk7XG4gICAgICByMVkgPSAodE1hdC5jb2wxLnkgKiByMVggKyB0TWF0LmNvbDIueSAqIHIxWSk7XG4gICAgICByMVggPSB0WDtcbiAgICAgIHRNYXQgPSBiQi5tX3hmLlI7XG4gICAgICB2YXIgcjJYID0gdGhpcy5tX2xvY2FsQW5jaG9yMi54IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci54O1xuICAgICAgdmFyIHIyWSA9IHRoaXMubV9sb2NhbEFuY2hvcjIueSAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcbiAgICAgIHRYID0gKHRNYXQuY29sMS54ICogcjJYICsgdE1hdC5jb2wyLnggKiByMlkpO1xuICAgICAgcjJZID0gKHRNYXQuY29sMS55ICogcjJYICsgdE1hdC5jb2wyLnkgKiByMlkpO1xuICAgICAgcjJYID0gdFg7XG4gICAgICB2YXIgcDFYID0gYkEubV9zd2VlcC5jLnggKyByMVg7XG4gICAgICB2YXIgcDFZID0gYkEubV9zd2VlcC5jLnkgKyByMVk7XG4gICAgICB2YXIgcDJYID0gYkIubV9zd2VlcC5jLnggKyByMlg7XG4gICAgICB2YXIgcDJZID0gYkIubV9zd2VlcC5jLnkgKyByMlk7XG4gICAgICB2YXIgZFggPSBwMlggLSBwMVg7XG4gICAgICB2YXIgZFkgPSBwMlkgLSBwMVk7XG4gICAgICB2YXIgYXhpcyA9IGJBLkdldFdvcmxkVmVjdG9yKHRoaXMubV9sb2NhbFhBeGlzMSk7XG4gICAgICB2YXIgdjEgPSBiQS5tX2xpbmVhclZlbG9jaXR5O1xuICAgICAgdmFyIHYyID0gYkIubV9saW5lYXJWZWxvY2l0eTtcbiAgICAgIHZhciB3MSA9IGJBLm1fYW5ndWxhclZlbG9jaXR5O1xuICAgICAgdmFyIHcyID0gYkIubV9hbmd1bGFyVmVsb2NpdHk7XG4gICAgICB2YXIgc3BlZWQgPSAoZFggKiAoKC13MSAqIGF4aXMueSkpICsgZFkgKiAodzEgKiBheGlzLngpKSArIChheGlzLnggKiAoKCh2Mi54ICsgKCgtdzIgKiByMlkpKSkgLSB2MS54KSAtICgoLXcxICogcjFZKSkpICsgYXhpcy55ICogKCgodjIueSArICh3MiAqIHIyWCkpIC0gdjEueSkgLSAodzEgKiByMVgpKSk7XG4gICAgICByZXR1cm4gc3BlZWQ7XG4gICB9XG4gICBiMlByaXNtYXRpY0pvaW50LnByb3RvdHlwZS5Jc0xpbWl0RW5hYmxlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fZW5hYmxlTGltaXQ7XG4gICB9XG4gICBiMlByaXNtYXRpY0pvaW50LnByb3RvdHlwZS5FbmFibGVMaW1pdCA9IGZ1bmN0aW9uIChmbGFnKSB7XG4gICAgICB0aGlzLm1fYm9keUEuU2V0QXdha2UodHJ1ZSk7XG4gICAgICB0aGlzLm1fYm9keUIuU2V0QXdha2UodHJ1ZSk7XG4gICAgICB0aGlzLm1fZW5hYmxlTGltaXQgPSBmbGFnO1xuICAgfVxuICAgYjJQcmlzbWF0aWNKb2ludC5wcm90b3R5cGUuR2V0TG93ZXJMaW1pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbjtcbiAgIH1cbiAgIGIyUHJpc21hdGljSm9pbnQucHJvdG90eXBlLkdldFVwcGVyTGltaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX3VwcGVyVHJhbnNsYXRpb247XG4gICB9XG4gICBiMlByaXNtYXRpY0pvaW50LnByb3RvdHlwZS5TZXRMaW1pdHMgPSBmdW5jdGlvbiAobG93ZXIsIHVwcGVyKSB7XG4gICAgICBpZiAobG93ZXIgPT09IHVuZGVmaW5lZCkgbG93ZXIgPSAwO1xuICAgICAgaWYgKHVwcGVyID09PSB1bmRlZmluZWQpIHVwcGVyID0gMDtcbiAgICAgIHRoaXMubV9ib2R5QS5TZXRBd2FrZSh0cnVlKTtcbiAgICAgIHRoaXMubV9ib2R5Qi5TZXRBd2FrZSh0cnVlKTtcbiAgICAgIHRoaXMubV9sb3dlclRyYW5zbGF0aW9uID0gbG93ZXI7XG4gICAgICB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbiA9IHVwcGVyO1xuICAgfVxuICAgYjJQcmlzbWF0aWNKb2ludC5wcm90b3R5cGUuSXNNb3RvckVuYWJsZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX2VuYWJsZU1vdG9yO1xuICAgfVxuICAgYjJQcmlzbWF0aWNKb2ludC5wcm90b3R5cGUuRW5hYmxlTW90b3IgPSBmdW5jdGlvbiAoZmxhZykge1xuICAgICAgdGhpcy5tX2JvZHlBLlNldEF3YWtlKHRydWUpO1xuICAgICAgdGhpcy5tX2JvZHlCLlNldEF3YWtlKHRydWUpO1xuICAgICAgdGhpcy5tX2VuYWJsZU1vdG9yID0gZmxhZztcbiAgIH1cbiAgIGIyUHJpc21hdGljSm9pbnQucHJvdG90eXBlLlNldE1vdG9yU3BlZWQgPSBmdW5jdGlvbiAoc3BlZWQpIHtcbiAgICAgIGlmIChzcGVlZCA9PT0gdW5kZWZpbmVkKSBzcGVlZCA9IDA7XG4gICAgICB0aGlzLm1fYm9keUEuU2V0QXdha2UodHJ1ZSk7XG4gICAgICB0aGlzLm1fYm9keUIuU2V0QXdha2UodHJ1ZSk7XG4gICAgICB0aGlzLm1fbW90b3JTcGVlZCA9IHNwZWVkO1xuICAgfVxuICAgYjJQcmlzbWF0aWNKb2ludC5wcm90b3R5cGUuR2V0TW90b3JTcGVlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fbW90b3JTcGVlZDtcbiAgIH1cbiAgIGIyUHJpc21hdGljSm9pbnQucHJvdG90eXBlLlNldE1heE1vdG9yRm9yY2UgPSBmdW5jdGlvbiAoZm9yY2UpIHtcbiAgICAgIGlmIChmb3JjZSA9PT0gdW5kZWZpbmVkKSBmb3JjZSA9IDA7XG4gICAgICB0aGlzLm1fYm9keUEuU2V0QXdha2UodHJ1ZSk7XG4gICAgICB0aGlzLm1fYm9keUIuU2V0QXdha2UodHJ1ZSk7XG4gICAgICB0aGlzLm1fbWF4TW90b3JGb3JjZSA9IGZvcmNlO1xuICAgfVxuICAgYjJQcmlzbWF0aWNKb2ludC5wcm90b3R5cGUuR2V0TW90b3JGb3JjZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fbW90b3JJbXB1bHNlO1xuICAgfVxuICAgYjJQcmlzbWF0aWNKb2ludC5wcm90b3R5cGUuYjJQcmlzbWF0aWNKb2ludCA9IGZ1bmN0aW9uIChkZWYpIHtcbiAgICAgIHRoaXMuX19zdXBlci5iMkpvaW50LmNhbGwodGhpcywgZGVmKTtcbiAgICAgIHZhciB0TWF0O1xuICAgICAgdmFyIHRYID0gMDtcbiAgICAgIHZhciB0WSA9IDA7XG4gICAgICB0aGlzLm1fbG9jYWxBbmNob3IxLlNldFYoZGVmLmxvY2FsQW5jaG9yQSk7XG4gICAgICB0aGlzLm1fbG9jYWxBbmNob3IyLlNldFYoZGVmLmxvY2FsQW5jaG9yQik7XG4gICAgICB0aGlzLm1fbG9jYWxYQXhpczEuU2V0VihkZWYubG9jYWxBeGlzQSk7XG4gICAgICB0aGlzLm1fbG9jYWxZQXhpczEueCA9ICgtdGhpcy5tX2xvY2FsWEF4aXMxLnkpO1xuICAgICAgdGhpcy5tX2xvY2FsWUF4aXMxLnkgPSB0aGlzLm1fbG9jYWxYQXhpczEueDtcbiAgICAgIHRoaXMubV9yZWZBbmdsZSA9IGRlZi5yZWZlcmVuY2VBbmdsZTtcbiAgICAgIHRoaXMubV9pbXB1bHNlLlNldFplcm8oKTtcbiAgICAgIHRoaXMubV9tb3Rvck1hc3MgPSAwLjA7XG4gICAgICB0aGlzLm1fbW90b3JJbXB1bHNlID0gMC4wO1xuICAgICAgdGhpcy5tX2xvd2VyVHJhbnNsYXRpb24gPSBkZWYubG93ZXJUcmFuc2xhdGlvbjtcbiAgICAgIHRoaXMubV91cHBlclRyYW5zbGF0aW9uID0gZGVmLnVwcGVyVHJhbnNsYXRpb247XG4gICAgICB0aGlzLm1fbWF4TW90b3JGb3JjZSA9IGRlZi5tYXhNb3RvckZvcmNlO1xuICAgICAgdGhpcy5tX21vdG9yU3BlZWQgPSBkZWYubW90b3JTcGVlZDtcbiAgICAgIHRoaXMubV9lbmFibGVMaW1pdCA9IGRlZi5lbmFibGVMaW1pdDtcbiAgICAgIHRoaXMubV9lbmFibGVNb3RvciA9IGRlZi5lbmFibGVNb3RvcjtcbiAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gYjJKb2ludC5lX2luYWN0aXZlTGltaXQ7XG4gICAgICB0aGlzLm1fYXhpcy5TZXRaZXJvKCk7XG4gICAgICB0aGlzLm1fcGVycC5TZXRaZXJvKCk7XG4gICB9XG4gICBiMlByaXNtYXRpY0pvaW50LnByb3RvdHlwZS5Jbml0VmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uIChzdGVwKSB7XG4gICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XG4gICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XG4gICAgICB2YXIgdE1hdDtcbiAgICAgIHZhciB0WCA9IDA7XG4gICAgICB0aGlzLm1fbG9jYWxDZW50ZXJBLlNldFYoYkEuR2V0TG9jYWxDZW50ZXIoKSk7XG4gICAgICB0aGlzLm1fbG9jYWxDZW50ZXJCLlNldFYoYkIuR2V0TG9jYWxDZW50ZXIoKSk7XG4gICAgICB2YXIgeGYxID0gYkEuR2V0VHJhbnNmb3JtKCk7XG4gICAgICB2YXIgeGYyID0gYkIuR2V0VHJhbnNmb3JtKCk7XG4gICAgICB0TWF0ID0gYkEubV94Zi5SO1xuICAgICAgdmFyIHIxWCA9IHRoaXMubV9sb2NhbEFuY2hvcjEueCAtIHRoaXMubV9sb2NhbENlbnRlckEueDtcbiAgICAgIHZhciByMVkgPSB0aGlzLm1fbG9jYWxBbmNob3IxLnkgLSB0aGlzLm1fbG9jYWxDZW50ZXJBLnk7XG4gICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHIxWCArIHRNYXQuY29sMi54ICogcjFZKTtcbiAgICAgIHIxWSA9ICh0TWF0LmNvbDEueSAqIHIxWCArIHRNYXQuY29sMi55ICogcjFZKTtcbiAgICAgIHIxWCA9IHRYO1xuICAgICAgdE1hdCA9IGJCLm1feGYuUjtcbiAgICAgIHZhciByMlggPSB0aGlzLm1fbG9jYWxBbmNob3IyLnggLSB0aGlzLm1fbG9jYWxDZW50ZXJCLng7XG4gICAgICB2YXIgcjJZID0gdGhpcy5tX2xvY2FsQW5jaG9yMi55IC0gdGhpcy5tX2xvY2FsQ2VudGVyQi55O1xuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByMlggKyB0TWF0LmNvbDIueCAqIHIyWSk7XG4gICAgICByMlkgPSAodE1hdC5jb2wxLnkgKiByMlggKyB0TWF0LmNvbDIueSAqIHIyWSk7XG4gICAgICByMlggPSB0WDtcbiAgICAgIHZhciBkWCA9IGJCLm1fc3dlZXAuYy54ICsgcjJYIC0gYkEubV9zd2VlcC5jLnggLSByMVg7XG4gICAgICB2YXIgZFkgPSBiQi5tX3N3ZWVwLmMueSArIHIyWSAtIGJBLm1fc3dlZXAuYy55IC0gcjFZO1xuICAgICAgdGhpcy5tX2ludk1hc3NBID0gYkEubV9pbnZNYXNzO1xuICAgICAgdGhpcy5tX2ludk1hc3NCID0gYkIubV9pbnZNYXNzO1xuICAgICAgdGhpcy5tX2ludklBID0gYkEubV9pbnZJO1xuICAgICAgdGhpcy5tX2ludklCID0gYkIubV9pbnZJOyB7XG4gICAgICAgICB0aGlzLm1fYXhpcy5TZXRWKGIyTWF0aC5NdWxNVih4ZjEuUiwgdGhpcy5tX2xvY2FsWEF4aXMxKSk7XG4gICAgICAgICB0aGlzLm1fYTEgPSAoZFggKyByMVgpICogdGhpcy5tX2F4aXMueSAtIChkWSArIHIxWSkgKiB0aGlzLm1fYXhpcy54O1xuICAgICAgICAgdGhpcy5tX2EyID0gcjJYICogdGhpcy5tX2F4aXMueSAtIHIyWSAqIHRoaXMubV9heGlzLng7XG4gICAgICAgICB0aGlzLm1fbW90b3JNYXNzID0gdGhpcy5tX2ludk1hc3NBICsgdGhpcy5tX2ludk1hc3NCICsgdGhpcy5tX2ludklBICogdGhpcy5tX2ExICogdGhpcy5tX2ExICsgdGhpcy5tX2ludklCICogdGhpcy5tX2EyICogdGhpcy5tX2EyO1xuICAgICAgICAgaWYgKHRoaXMubV9tb3Rvck1hc3MgPiBOdW1iZXIuTUlOX1ZBTFVFKSB0aGlzLm1fbW90b3JNYXNzID0gMS4wIC8gdGhpcy5tX21vdG9yTWFzcztcbiAgICAgIH0ge1xuICAgICAgICAgdGhpcy5tX3BlcnAuU2V0VihiMk1hdGguTXVsTVYoeGYxLlIsIHRoaXMubV9sb2NhbFlBeGlzMSkpO1xuICAgICAgICAgdGhpcy5tX3MxID0gKGRYICsgcjFYKSAqIHRoaXMubV9wZXJwLnkgLSAoZFkgKyByMVkpICogdGhpcy5tX3BlcnAueDtcbiAgICAgICAgIHRoaXMubV9zMiA9IHIyWCAqIHRoaXMubV9wZXJwLnkgLSByMlkgKiB0aGlzLm1fcGVycC54O1xuICAgICAgICAgdmFyIG0xID0gdGhpcy5tX2ludk1hc3NBO1xuICAgICAgICAgdmFyIG0yID0gdGhpcy5tX2ludk1hc3NCO1xuICAgICAgICAgdmFyIGkxID0gdGhpcy5tX2ludklBO1xuICAgICAgICAgdmFyIGkyID0gdGhpcy5tX2ludklCO1xuICAgICAgICAgdGhpcy5tX0suY29sMS54ID0gbTEgKyBtMiArIGkxICogdGhpcy5tX3MxICogdGhpcy5tX3MxICsgaTIgKiB0aGlzLm1fczIgKiB0aGlzLm1fczI7XG4gICAgICAgICB0aGlzLm1fSy5jb2wxLnkgPSBpMSAqIHRoaXMubV9zMSArIGkyICogdGhpcy5tX3MyO1xuICAgICAgICAgdGhpcy5tX0suY29sMS56ID0gaTEgKiB0aGlzLm1fczEgKiB0aGlzLm1fYTEgKyBpMiAqIHRoaXMubV9zMiAqIHRoaXMubV9hMjtcbiAgICAgICAgIHRoaXMubV9LLmNvbDIueCA9IHRoaXMubV9LLmNvbDEueTtcbiAgICAgICAgIHRoaXMubV9LLmNvbDIueSA9IGkxICsgaTI7XG4gICAgICAgICB0aGlzLm1fSy5jb2wyLnogPSBpMSAqIHRoaXMubV9hMSArIGkyICogdGhpcy5tX2EyO1xuICAgICAgICAgdGhpcy5tX0suY29sMy54ID0gdGhpcy5tX0suY29sMS56O1xuICAgICAgICAgdGhpcy5tX0suY29sMy55ID0gdGhpcy5tX0suY29sMi56O1xuICAgICAgICAgdGhpcy5tX0suY29sMy56ID0gbTEgKyBtMiArIGkxICogdGhpcy5tX2ExICogdGhpcy5tX2ExICsgaTIgKiB0aGlzLm1fYTIgKiB0aGlzLm1fYTI7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5tX2VuYWJsZUxpbWl0KSB7XG4gICAgICAgICB2YXIgam9pbnRUcmFuc2l0aW9uID0gdGhpcy5tX2F4aXMueCAqIGRYICsgdGhpcy5tX2F4aXMueSAqIGRZO1xuICAgICAgICAgaWYgKGIyTWF0aC5BYnModGhpcy5tX3VwcGVyVHJhbnNsYXRpb24gLSB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbikgPCAyLjAgKiBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3ApIHtcbiAgICAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gYjJKb2ludC5lX2VxdWFsTGltaXRzO1xuICAgICAgICAgfVxuICAgICAgICAgZWxzZSBpZiAoam9pbnRUcmFuc2l0aW9uIDw9IHRoaXMubV9sb3dlclRyYW5zbGF0aW9uKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5tX2xpbWl0U3RhdGUgIT0gYjJKb2ludC5lX2F0TG93ZXJMaW1pdCkge1xuICAgICAgICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBiMkpvaW50LmVfYXRMb3dlckxpbWl0O1xuICAgICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiA9IDAuMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgIH1cbiAgICAgICAgIGVsc2UgaWYgKGpvaW50VHJhbnNpdGlvbiA+PSB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbikge1xuICAgICAgICAgICAgaWYgKHRoaXMubV9saW1pdFN0YXRlICE9IGIySm9pbnQuZV9hdFVwcGVyTGltaXQpIHtcbiAgICAgICAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gYjJKb2ludC5lX2F0VXBwZXJMaW1pdDtcbiAgICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSAwLjA7XG4gICAgICAgICAgICB9XG4gICAgICAgICB9XG4gICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gYjJKb2ludC5lX2luYWN0aXZlTGltaXQ7XG4gICAgICAgICAgICB0aGlzLm1faW1wdWxzZS56ID0gMC4wO1xuICAgICAgICAgfVxuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZSA9IGIySm9pbnQuZV9pbmFjdGl2ZUxpbWl0O1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMubV9lbmFibGVNb3RvciA9PSBmYWxzZSkge1xuICAgICAgICAgdGhpcy5tX21vdG9ySW1wdWxzZSA9IDAuMDtcbiAgICAgIH1cbiAgICAgIGlmIChzdGVwLndhcm1TdGFydGluZykge1xuICAgICAgICAgdGhpcy5tX2ltcHVsc2UueCAqPSBzdGVwLmR0UmF0aW87XG4gICAgICAgICB0aGlzLm1faW1wdWxzZS55ICo9IHN0ZXAuZHRSYXRpbztcbiAgICAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgKj0gc3RlcC5kdFJhdGlvO1xuICAgICAgICAgdmFyIFBYID0gdGhpcy5tX2ltcHVsc2UueCAqIHRoaXMubV9wZXJwLnggKyAodGhpcy5tX21vdG9ySW1wdWxzZSArIHRoaXMubV9pbXB1bHNlLnopICogdGhpcy5tX2F4aXMueDtcbiAgICAgICAgIHZhciBQWSA9IHRoaXMubV9pbXB1bHNlLnggKiB0aGlzLm1fcGVycC55ICsgKHRoaXMubV9tb3RvckltcHVsc2UgKyB0aGlzLm1faW1wdWxzZS56KSAqIHRoaXMubV9heGlzLnk7XG4gICAgICAgICB2YXIgTDEgPSB0aGlzLm1faW1wdWxzZS54ICogdGhpcy5tX3MxICsgdGhpcy5tX2ltcHVsc2UueSArICh0aGlzLm1fbW90b3JJbXB1bHNlICsgdGhpcy5tX2ltcHVsc2UueikgKiB0aGlzLm1fYTE7XG4gICAgICAgICB2YXIgTDIgPSB0aGlzLm1faW1wdWxzZS54ICogdGhpcy5tX3MyICsgdGhpcy5tX2ltcHVsc2UueSArICh0aGlzLm1fbW90b3JJbXB1bHNlICsgdGhpcy5tX2ltcHVsc2UueikgKiB0aGlzLm1fYTI7XG4gICAgICAgICBiQS5tX2xpbmVhclZlbG9jaXR5LnggLT0gdGhpcy5tX2ludk1hc3NBICogUFg7XG4gICAgICAgICBiQS5tX2xpbmVhclZlbG9jaXR5LnkgLT0gdGhpcy5tX2ludk1hc3NBICogUFk7XG4gICAgICAgICBiQS5tX2FuZ3VsYXJWZWxvY2l0eSAtPSB0aGlzLm1faW52SUEgKiBMMTtcbiAgICAgICAgIGJCLm1fbGluZWFyVmVsb2NpdHkueCArPSB0aGlzLm1faW52TWFzc0IgKiBQWDtcbiAgICAgICAgIGJCLm1fbGluZWFyVmVsb2NpdHkueSArPSB0aGlzLm1faW52TWFzc0IgKiBQWTtcbiAgICAgICAgIGJCLm1fYW5ndWxhclZlbG9jaXR5ICs9IHRoaXMubV9pbnZJQiAqIEwyO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgICB0aGlzLm1faW1wdWxzZS5TZXRaZXJvKCk7XG4gICAgICAgICB0aGlzLm1fbW90b3JJbXB1bHNlID0gMC4wO1xuICAgICAgfVxuICAgfVxuICAgYjJQcmlzbWF0aWNKb2ludC5wcm90b3R5cGUuU29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKHN0ZXApIHtcbiAgICAgIHZhciBiQSA9IHRoaXMubV9ib2R5QTtcbiAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcbiAgICAgIHZhciB2MSA9IGJBLm1fbGluZWFyVmVsb2NpdHk7XG4gICAgICB2YXIgdzEgPSBiQS5tX2FuZ3VsYXJWZWxvY2l0eTtcbiAgICAgIHZhciB2MiA9IGJCLm1fbGluZWFyVmVsb2NpdHk7XG4gICAgICB2YXIgdzIgPSBiQi5tX2FuZ3VsYXJWZWxvY2l0eTtcbiAgICAgIHZhciBQWCA9IDA7XG4gICAgICB2YXIgUFkgPSAwO1xuICAgICAgdmFyIEwxID0gMDtcbiAgICAgIHZhciBMMiA9IDA7XG4gICAgICBpZiAodGhpcy5tX2VuYWJsZU1vdG9yICYmIHRoaXMubV9saW1pdFN0YXRlICE9IGIySm9pbnQuZV9lcXVhbExpbWl0cykge1xuICAgICAgICAgdmFyIENkb3QgPSB0aGlzLm1fYXhpcy54ICogKHYyLnggLSB2MS54KSArIHRoaXMubV9heGlzLnkgKiAodjIueSAtIHYxLnkpICsgdGhpcy5tX2EyICogdzIgLSB0aGlzLm1fYTEgKiB3MTtcbiAgICAgICAgIHZhciBpbXB1bHNlID0gdGhpcy5tX21vdG9yTWFzcyAqICh0aGlzLm1fbW90b3JTcGVlZCAtIENkb3QpO1xuICAgICAgICAgdmFyIG9sZEltcHVsc2UgPSB0aGlzLm1fbW90b3JJbXB1bHNlO1xuICAgICAgICAgdmFyIG1heEltcHVsc2UgPSBzdGVwLmR0ICogdGhpcy5tX21heE1vdG9yRm9yY2U7XG4gICAgICAgICB0aGlzLm1fbW90b3JJbXB1bHNlID0gYjJNYXRoLkNsYW1wKHRoaXMubV9tb3RvckltcHVsc2UgKyBpbXB1bHNlLCAoLW1heEltcHVsc2UpLCBtYXhJbXB1bHNlKTtcbiAgICAgICAgIGltcHVsc2UgPSB0aGlzLm1fbW90b3JJbXB1bHNlIC0gb2xkSW1wdWxzZTtcbiAgICAgICAgIFBYID0gaW1wdWxzZSAqIHRoaXMubV9heGlzLng7XG4gICAgICAgICBQWSA9IGltcHVsc2UgKiB0aGlzLm1fYXhpcy55O1xuICAgICAgICAgTDEgPSBpbXB1bHNlICogdGhpcy5tX2ExO1xuICAgICAgICAgTDIgPSBpbXB1bHNlICogdGhpcy5tX2EyO1xuICAgICAgICAgdjEueCAtPSB0aGlzLm1faW52TWFzc0EgKiBQWDtcbiAgICAgICAgIHYxLnkgLT0gdGhpcy5tX2ludk1hc3NBICogUFk7XG4gICAgICAgICB3MSAtPSB0aGlzLm1faW52SUEgKiBMMTtcbiAgICAgICAgIHYyLnggKz0gdGhpcy5tX2ludk1hc3NCICogUFg7XG4gICAgICAgICB2Mi55ICs9IHRoaXMubV9pbnZNYXNzQiAqIFBZO1xuICAgICAgICAgdzIgKz0gdGhpcy5tX2ludklCICogTDI7XG4gICAgICB9XG4gICAgICB2YXIgQ2RvdDFYID0gdGhpcy5tX3BlcnAueCAqICh2Mi54IC0gdjEueCkgKyB0aGlzLm1fcGVycC55ICogKHYyLnkgLSB2MS55KSArIHRoaXMubV9zMiAqIHcyIC0gdGhpcy5tX3MxICogdzE7XG4gICAgICB2YXIgQ2RvdDFZID0gdzIgLSB3MTtcbiAgICAgIGlmICh0aGlzLm1fZW5hYmxlTGltaXQgJiYgdGhpcy5tX2xpbWl0U3RhdGUgIT0gYjJKb2ludC5lX2luYWN0aXZlTGltaXQpIHtcbiAgICAgICAgIHZhciBDZG90MiA9IHRoaXMubV9heGlzLnggKiAodjIueCAtIHYxLngpICsgdGhpcy5tX2F4aXMueSAqICh2Mi55IC0gdjEueSkgKyB0aGlzLm1fYTIgKiB3MiAtIHRoaXMubV9hMSAqIHcxO1xuICAgICAgICAgdmFyIGYxID0gdGhpcy5tX2ltcHVsc2UuQ29weSgpO1xuICAgICAgICAgdmFyIGRmID0gdGhpcy5tX0suU29sdmUzMyhuZXcgYjJWZWMzKCksICgtQ2RvdDFYKSwgKC1DZG90MVkpLCAoLUNkb3QyKSk7XG4gICAgICAgICB0aGlzLm1faW1wdWxzZS5BZGQoZGYpO1xuICAgICAgICAgaWYgKHRoaXMubV9saW1pdFN0YXRlID09IGIySm9pbnQuZV9hdExvd2VyTGltaXQpIHtcbiAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSBiMk1hdGguTWF4KHRoaXMubV9pbXB1bHNlLnosIDAuMCk7XG4gICAgICAgICB9XG4gICAgICAgICBlbHNlIGlmICh0aGlzLm1fbGltaXRTdGF0ZSA9PSBiMkpvaW50LmVfYXRVcHBlckxpbWl0KSB7XG4gICAgICAgICAgICB0aGlzLm1faW1wdWxzZS56ID0gYjJNYXRoLk1pbih0aGlzLm1faW1wdWxzZS56LCAwLjApO1xuICAgICAgICAgfVxuICAgICAgICAgdmFyIGJYID0gKC1DZG90MVgpIC0gKHRoaXMubV9pbXB1bHNlLnogLSBmMS56KSAqIHRoaXMubV9LLmNvbDMueDtcbiAgICAgICAgIHZhciBiWSA9ICgtQ2RvdDFZKSAtICh0aGlzLm1faW1wdWxzZS56IC0gZjEueikgKiB0aGlzLm1fSy5jb2wzLnk7XG4gICAgICAgICB2YXIgZjJyID0gdGhpcy5tX0suU29sdmUyMihuZXcgYjJWZWMyKCksIGJYLCBiWSk7XG4gICAgICAgICBmMnIueCArPSBmMS54O1xuICAgICAgICAgZjJyLnkgKz0gZjEueTtcbiAgICAgICAgIHRoaXMubV9pbXB1bHNlLnggPSBmMnIueDtcbiAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgPSBmMnIueTtcbiAgICAgICAgIGRmLnggPSB0aGlzLm1faW1wdWxzZS54IC0gZjEueDtcbiAgICAgICAgIGRmLnkgPSB0aGlzLm1faW1wdWxzZS55IC0gZjEueTtcbiAgICAgICAgIGRmLnogPSB0aGlzLm1faW1wdWxzZS56IC0gZjEuejtcbiAgICAgICAgIFBYID0gZGYueCAqIHRoaXMubV9wZXJwLnggKyBkZi56ICogdGhpcy5tX2F4aXMueDtcbiAgICAgICAgIFBZID0gZGYueCAqIHRoaXMubV9wZXJwLnkgKyBkZi56ICogdGhpcy5tX2F4aXMueTtcbiAgICAgICAgIEwxID0gZGYueCAqIHRoaXMubV9zMSArIGRmLnkgKyBkZi56ICogdGhpcy5tX2ExO1xuICAgICAgICAgTDIgPSBkZi54ICogdGhpcy5tX3MyICsgZGYueSArIGRmLnogKiB0aGlzLm1fYTI7XG4gICAgICAgICB2MS54IC09IHRoaXMubV9pbnZNYXNzQSAqIFBYO1xuICAgICAgICAgdjEueSAtPSB0aGlzLm1faW52TWFzc0EgKiBQWTtcbiAgICAgICAgIHcxIC09IHRoaXMubV9pbnZJQSAqIEwxO1xuICAgICAgICAgdjIueCArPSB0aGlzLm1faW52TWFzc0IgKiBQWDtcbiAgICAgICAgIHYyLnkgKz0gdGhpcy5tX2ludk1hc3NCICogUFk7XG4gICAgICAgICB3MiArPSB0aGlzLm1faW52SUIgKiBMMjtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICAgdmFyIGRmMiA9IHRoaXMubV9LLlNvbHZlMjIobmV3IGIyVmVjMigpLCAoLUNkb3QxWCksICgtQ2RvdDFZKSk7XG4gICAgICAgICB0aGlzLm1faW1wdWxzZS54ICs9IGRmMi54O1xuICAgICAgICAgdGhpcy5tX2ltcHVsc2UueSArPSBkZjIueTtcbiAgICAgICAgIFBYID0gZGYyLnggKiB0aGlzLm1fcGVycC54O1xuICAgICAgICAgUFkgPSBkZjIueCAqIHRoaXMubV9wZXJwLnk7XG4gICAgICAgICBMMSA9IGRmMi54ICogdGhpcy5tX3MxICsgZGYyLnk7XG4gICAgICAgICBMMiA9IGRmMi54ICogdGhpcy5tX3MyICsgZGYyLnk7XG4gICAgICAgICB2MS54IC09IHRoaXMubV9pbnZNYXNzQSAqIFBYO1xuICAgICAgICAgdjEueSAtPSB0aGlzLm1faW52TWFzc0EgKiBQWTtcbiAgICAgICAgIHcxIC09IHRoaXMubV9pbnZJQSAqIEwxO1xuICAgICAgICAgdjIueCArPSB0aGlzLm1faW52TWFzc0IgKiBQWDtcbiAgICAgICAgIHYyLnkgKz0gdGhpcy5tX2ludk1hc3NCICogUFk7XG4gICAgICAgICB3MiArPSB0aGlzLm1faW52SUIgKiBMMjtcbiAgICAgIH1cbiAgICAgIGJBLm1fbGluZWFyVmVsb2NpdHkuU2V0Vih2MSk7XG4gICAgICBiQS5tX2FuZ3VsYXJWZWxvY2l0eSA9IHcxO1xuICAgICAgYkIubV9saW5lYXJWZWxvY2l0eS5TZXRWKHYyKTtcbiAgICAgIGJCLm1fYW5ndWxhclZlbG9jaXR5ID0gdzI7XG4gICB9XG4gICBiMlByaXNtYXRpY0pvaW50LnByb3RvdHlwZS5Tb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMgPSBmdW5jdGlvbiAoYmF1bWdhcnRlKSB7XG4gICAgICBpZiAoYmF1bWdhcnRlID09PSB1bmRlZmluZWQpIGJhdW1nYXJ0ZSA9IDA7XG4gICAgICB2YXIgbGltaXRDID0gMDtcbiAgICAgIHZhciBvbGRMaW1pdEltcHVsc2UgPSAwO1xuICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xuICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xuICAgICAgdmFyIGMxID0gYkEubV9zd2VlcC5jO1xuICAgICAgdmFyIGExID0gYkEubV9zd2VlcC5hO1xuICAgICAgdmFyIGMyID0gYkIubV9zd2VlcC5jO1xuICAgICAgdmFyIGEyID0gYkIubV9zd2VlcC5hO1xuICAgICAgdmFyIHRNYXQ7XG4gICAgICB2YXIgdFggPSAwO1xuICAgICAgdmFyIG0xID0gMDtcbiAgICAgIHZhciBtMiA9IDA7XG4gICAgICB2YXIgaTEgPSAwO1xuICAgICAgdmFyIGkyID0gMDtcbiAgICAgIHZhciBsaW5lYXJFcnJvciA9IDAuMDtcbiAgICAgIHZhciBhbmd1bGFyRXJyb3IgPSAwLjA7XG4gICAgICB2YXIgYWN0aXZlID0gZmFsc2U7XG4gICAgICB2YXIgQzIgPSAwLjA7XG4gICAgICB2YXIgUjEgPSBiMk1hdDIyLkZyb21BbmdsZShhMSk7XG4gICAgICB2YXIgUjIgPSBiMk1hdDIyLkZyb21BbmdsZShhMik7XG4gICAgICB0TWF0ID0gUjE7XG4gICAgICB2YXIgcjFYID0gdGhpcy5tX2xvY2FsQW5jaG9yMS54IC0gdGhpcy5tX2xvY2FsQ2VudGVyQS54O1xuICAgICAgdmFyIHIxWSA9IHRoaXMubV9sb2NhbEFuY2hvcjEueSAtIHRoaXMubV9sb2NhbENlbnRlckEueTtcbiAgICAgIHRYID0gKHRNYXQuY29sMS54ICogcjFYICsgdE1hdC5jb2wyLnggKiByMVkpO1xuICAgICAgcjFZID0gKHRNYXQuY29sMS55ICogcjFYICsgdE1hdC5jb2wyLnkgKiByMVkpO1xuICAgICAgcjFYID0gdFg7XG4gICAgICB0TWF0ID0gUjI7XG4gICAgICB2YXIgcjJYID0gdGhpcy5tX2xvY2FsQW5jaG9yMi54IC0gdGhpcy5tX2xvY2FsQ2VudGVyQi54O1xuICAgICAgdmFyIHIyWSA9IHRoaXMubV9sb2NhbEFuY2hvcjIueSAtIHRoaXMubV9sb2NhbENlbnRlckIueTtcbiAgICAgIHRYID0gKHRNYXQuY29sMS54ICogcjJYICsgdE1hdC5jb2wyLnggKiByMlkpO1xuICAgICAgcjJZID0gKHRNYXQuY29sMS55ICogcjJYICsgdE1hdC5jb2wyLnkgKiByMlkpO1xuICAgICAgcjJYID0gdFg7XG4gICAgICB2YXIgZFggPSBjMi54ICsgcjJYIC0gYzEueCAtIHIxWDtcbiAgICAgIHZhciBkWSA9IGMyLnkgKyByMlkgLSBjMS55IC0gcjFZO1xuICAgICAgaWYgKHRoaXMubV9lbmFibGVMaW1pdCkge1xuICAgICAgICAgdGhpcy5tX2F4aXMgPSBiMk1hdGguTXVsTVYoUjEsIHRoaXMubV9sb2NhbFhBeGlzMSk7XG4gICAgICAgICB0aGlzLm1fYTEgPSAoZFggKyByMVgpICogdGhpcy5tX2F4aXMueSAtIChkWSArIHIxWSkgKiB0aGlzLm1fYXhpcy54O1xuICAgICAgICAgdGhpcy5tX2EyID0gcjJYICogdGhpcy5tX2F4aXMueSAtIHIyWSAqIHRoaXMubV9heGlzLng7XG4gICAgICAgICB2YXIgdHJhbnNsYXRpb24gPSB0aGlzLm1fYXhpcy54ICogZFggKyB0aGlzLm1fYXhpcy55ICogZFk7XG4gICAgICAgICBpZiAoYjJNYXRoLkFicyh0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbiAtIHRoaXMubV9sb3dlclRyYW5zbGF0aW9uKSA8IDIuMCAqIGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCkge1xuICAgICAgICAgICAgQzIgPSBiMk1hdGguQ2xhbXAodHJhbnNsYXRpb24sICgtYjJTZXR0aW5ncy5iMl9tYXhMaW5lYXJDb3JyZWN0aW9uKSwgYjJTZXR0aW5ncy5iMl9tYXhMaW5lYXJDb3JyZWN0aW9uKTtcbiAgICAgICAgICAgIGxpbmVhckVycm9yID0gYjJNYXRoLkFicyh0cmFuc2xhdGlvbik7XG4gICAgICAgICAgICBhY3RpdmUgPSB0cnVlO1xuICAgICAgICAgfVxuICAgICAgICAgZWxzZSBpZiAodHJhbnNsYXRpb24gPD0gdGhpcy5tX2xvd2VyVHJhbnNsYXRpb24pIHtcbiAgICAgICAgICAgIEMyID0gYjJNYXRoLkNsYW1wKHRyYW5zbGF0aW9uIC0gdGhpcy5tX2xvd2VyVHJhbnNsYXRpb24gKyBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3AsICgtYjJTZXR0aW5ncy5iMl9tYXhMaW5lYXJDb3JyZWN0aW9uKSwgMC4wKTtcbiAgICAgICAgICAgIGxpbmVhckVycm9yID0gdGhpcy5tX2xvd2VyVHJhbnNsYXRpb24gLSB0cmFuc2xhdGlvbjtcbiAgICAgICAgICAgIGFjdGl2ZSA9IHRydWU7XG4gICAgICAgICB9XG4gICAgICAgICBlbHNlIGlmICh0cmFuc2xhdGlvbiA+PSB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbikge1xuICAgICAgICAgICAgQzIgPSBiMk1hdGguQ2xhbXAodHJhbnNsYXRpb24gLSB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbiArIGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCwgMC4wLCBiMlNldHRpbmdzLmIyX21heExpbmVhckNvcnJlY3Rpb24pO1xuICAgICAgICAgICAgbGluZWFyRXJyb3IgPSB0cmFuc2xhdGlvbiAtIHRoaXMubV91cHBlclRyYW5zbGF0aW9uO1xuICAgICAgICAgICAgYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHRoaXMubV9wZXJwID0gYjJNYXRoLk11bE1WKFIxLCB0aGlzLm1fbG9jYWxZQXhpczEpO1xuICAgICAgdGhpcy5tX3MxID0gKGRYICsgcjFYKSAqIHRoaXMubV9wZXJwLnkgLSAoZFkgKyByMVkpICogdGhpcy5tX3BlcnAueDtcbiAgICAgIHRoaXMubV9zMiA9IHIyWCAqIHRoaXMubV9wZXJwLnkgLSByMlkgKiB0aGlzLm1fcGVycC54O1xuICAgICAgdmFyIGltcHVsc2UgPSBuZXcgYjJWZWMzKCk7XG4gICAgICB2YXIgQzFYID0gdGhpcy5tX3BlcnAueCAqIGRYICsgdGhpcy5tX3BlcnAueSAqIGRZO1xuICAgICAgdmFyIEMxWSA9IGEyIC0gYTEgLSB0aGlzLm1fcmVmQW5nbGU7XG4gICAgICBsaW5lYXJFcnJvciA9IGIyTWF0aC5NYXgobGluZWFyRXJyb3IsIGIyTWF0aC5BYnMoQzFYKSk7XG4gICAgICBhbmd1bGFyRXJyb3IgPSBiMk1hdGguQWJzKEMxWSk7XG4gICAgICBpZiAoYWN0aXZlKSB7XG4gICAgICAgICBtMSA9IHRoaXMubV9pbnZNYXNzQTtcbiAgICAgICAgIG0yID0gdGhpcy5tX2ludk1hc3NCO1xuICAgICAgICAgaTEgPSB0aGlzLm1faW52SUE7XG4gICAgICAgICBpMiA9IHRoaXMubV9pbnZJQjtcbiAgICAgICAgIHRoaXMubV9LLmNvbDEueCA9IG0xICsgbTIgKyBpMSAqIHRoaXMubV9zMSAqIHRoaXMubV9zMSArIGkyICogdGhpcy5tX3MyICogdGhpcy5tX3MyO1xuICAgICAgICAgdGhpcy5tX0suY29sMS55ID0gaTEgKiB0aGlzLm1fczEgKyBpMiAqIHRoaXMubV9zMjtcbiAgICAgICAgIHRoaXMubV9LLmNvbDEueiA9IGkxICogdGhpcy5tX3MxICogdGhpcy5tX2ExICsgaTIgKiB0aGlzLm1fczIgKiB0aGlzLm1fYTI7XG4gICAgICAgICB0aGlzLm1fSy5jb2wyLnggPSB0aGlzLm1fSy5jb2wxLnk7XG4gICAgICAgICB0aGlzLm1fSy5jb2wyLnkgPSBpMSArIGkyO1xuICAgICAgICAgdGhpcy5tX0suY29sMi56ID0gaTEgKiB0aGlzLm1fYTEgKyBpMiAqIHRoaXMubV9hMjtcbiAgICAgICAgIHRoaXMubV9LLmNvbDMueCA9IHRoaXMubV9LLmNvbDEuejtcbiAgICAgICAgIHRoaXMubV9LLmNvbDMueSA9IHRoaXMubV9LLmNvbDIuejtcbiAgICAgICAgIHRoaXMubV9LLmNvbDMueiA9IG0xICsgbTIgKyBpMSAqIHRoaXMubV9hMSAqIHRoaXMubV9hMSArIGkyICogdGhpcy5tX2EyICogdGhpcy5tX2EyO1xuICAgICAgICAgdGhpcy5tX0suU29sdmUzMyhpbXB1bHNlLCAoLUMxWCksICgtQzFZKSwgKC1DMikpO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgICBtMSA9IHRoaXMubV9pbnZNYXNzQTtcbiAgICAgICAgIG0yID0gdGhpcy5tX2ludk1hc3NCO1xuICAgICAgICAgaTEgPSB0aGlzLm1faW52SUE7XG4gICAgICAgICBpMiA9IHRoaXMubV9pbnZJQjtcbiAgICAgICAgIHZhciBrMTEgPSBtMSArIG0yICsgaTEgKiB0aGlzLm1fczEgKiB0aGlzLm1fczEgKyBpMiAqIHRoaXMubV9zMiAqIHRoaXMubV9zMjtcbiAgICAgICAgIHZhciBrMTIgPSBpMSAqIHRoaXMubV9zMSArIGkyICogdGhpcy5tX3MyO1xuICAgICAgICAgdmFyIGsyMiA9IGkxICsgaTI7XG4gICAgICAgICB0aGlzLm1fSy5jb2wxLlNldChrMTEsIGsxMiwgMC4wKTtcbiAgICAgICAgIHRoaXMubV9LLmNvbDIuU2V0KGsxMiwgazIyLCAwLjApO1xuICAgICAgICAgdmFyIGltcHVsc2UxID0gdGhpcy5tX0suU29sdmUyMihuZXcgYjJWZWMyKCksICgtQzFYKSwgKC1DMVkpKTtcbiAgICAgICAgIGltcHVsc2UueCA9IGltcHVsc2UxLng7XG4gICAgICAgICBpbXB1bHNlLnkgPSBpbXB1bHNlMS55O1xuICAgICAgICAgaW1wdWxzZS56ID0gMC4wO1xuICAgICAgfVxuICAgICAgdmFyIFBYID0gaW1wdWxzZS54ICogdGhpcy5tX3BlcnAueCArIGltcHVsc2UueiAqIHRoaXMubV9heGlzLng7XG4gICAgICB2YXIgUFkgPSBpbXB1bHNlLnggKiB0aGlzLm1fcGVycC55ICsgaW1wdWxzZS56ICogdGhpcy5tX2F4aXMueTtcbiAgICAgIHZhciBMMSA9IGltcHVsc2UueCAqIHRoaXMubV9zMSArIGltcHVsc2UueSArIGltcHVsc2UueiAqIHRoaXMubV9hMTtcbiAgICAgIHZhciBMMiA9IGltcHVsc2UueCAqIHRoaXMubV9zMiArIGltcHVsc2UueSArIGltcHVsc2UueiAqIHRoaXMubV9hMjtcbiAgICAgIGMxLnggLT0gdGhpcy5tX2ludk1hc3NBICogUFg7XG4gICAgICBjMS55IC09IHRoaXMubV9pbnZNYXNzQSAqIFBZO1xuICAgICAgYTEgLT0gdGhpcy5tX2ludklBICogTDE7XG4gICAgICBjMi54ICs9IHRoaXMubV9pbnZNYXNzQiAqIFBYO1xuICAgICAgYzIueSArPSB0aGlzLm1faW52TWFzc0IgKiBQWTtcbiAgICAgIGEyICs9IHRoaXMubV9pbnZJQiAqIEwyO1xuICAgICAgYkEubV9zd2VlcC5hID0gYTE7XG4gICAgICBiQi5tX3N3ZWVwLmEgPSBhMjtcbiAgICAgIGJBLlN5bmNocm9uaXplVHJhbnNmb3JtKCk7XG4gICAgICBiQi5TeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xuICAgICAgcmV0dXJuIGxpbmVhckVycm9yIDw9IGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCAmJiBhbmd1bGFyRXJyb3IgPD0gYjJTZXR0aW5ncy5iMl9hbmd1bGFyU2xvcDtcbiAgIH1cbiAgIEJveDJELmluaGVyaXQoYjJQcmlzbWF0aWNKb2ludERlZiwgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnREZWYpO1xuICAgYjJQcmlzbWF0aWNKb2ludERlZi5wcm90b3R5cGUuX19zdXBlciA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmLnByb3RvdHlwZTtcbiAgIGIyUHJpc21hdGljSm9pbnREZWYuYjJQcmlzbWF0aWNKb2ludERlZiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmLmIySm9pbnREZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIHRoaXMubG9jYWxBbmNob3JBID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy5sb2NhbEFuY2hvckIgPSBuZXcgYjJWZWMyKCk7XG4gICAgICB0aGlzLmxvY2FsQXhpc0EgPSBuZXcgYjJWZWMyKCk7XG4gICB9O1xuICAgYjJQcmlzbWF0aWNKb2ludERlZi5wcm90b3R5cGUuYjJQcmlzbWF0aWNKb2ludERlZiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX19zdXBlci5iMkpvaW50RGVmLmNhbGwodGhpcyk7XG4gICAgICB0aGlzLnR5cGUgPSBiMkpvaW50LmVfcHJpc21hdGljSm9pbnQ7XG4gICAgICB0aGlzLmxvY2FsQXhpc0EuU2V0KDEuMCwgMC4wKTtcbiAgICAgIHRoaXMucmVmZXJlbmNlQW5nbGUgPSAwLjA7XG4gICAgICB0aGlzLmVuYWJsZUxpbWl0ID0gZmFsc2U7XG4gICAgICB0aGlzLmxvd2VyVHJhbnNsYXRpb24gPSAwLjA7XG4gICAgICB0aGlzLnVwcGVyVHJhbnNsYXRpb24gPSAwLjA7XG4gICAgICB0aGlzLmVuYWJsZU1vdG9yID0gZmFsc2U7XG4gICAgICB0aGlzLm1heE1vdG9yRm9yY2UgPSAwLjA7XG4gICAgICB0aGlzLm1vdG9yU3BlZWQgPSAwLjA7XG4gICB9XG4gICBiMlByaXNtYXRpY0pvaW50RGVmLnByb3RvdHlwZS5Jbml0aWFsaXplID0gZnVuY3Rpb24gKGJBLCBiQiwgYW5jaG9yLCBheGlzKSB7XG4gICAgICB0aGlzLmJvZHlBID0gYkE7XG4gICAgICB0aGlzLmJvZHlCID0gYkI7XG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQSA9IHRoaXMuYm9keUEuR2V0TG9jYWxQb2ludChhbmNob3IpO1xuICAgICAgdGhpcy5sb2NhbEFuY2hvckIgPSB0aGlzLmJvZHlCLkdldExvY2FsUG9pbnQoYW5jaG9yKTtcbiAgICAgIHRoaXMubG9jYWxBeGlzQSA9IHRoaXMuYm9keUEuR2V0TG9jYWxWZWN0b3IoYXhpcyk7XG4gICAgICB0aGlzLnJlZmVyZW5jZUFuZ2xlID0gdGhpcy5ib2R5Qi5HZXRBbmdsZSgpIC0gdGhpcy5ib2R5QS5HZXRBbmdsZSgpO1xuICAgfVxuICAgQm94MkQuaW5oZXJpdChiMlB1bGxleUpvaW50LCBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludCk7XG4gICBiMlB1bGxleUpvaW50LnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQucHJvdG90eXBlO1xuICAgYjJQdWxsZXlKb2ludC5iMlB1bGxleUpvaW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQuYjJKb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgdGhpcy5tX2dyb3VuZEFuY2hvcjEgPSBuZXcgYjJWZWMyKCk7XG4gICAgICB0aGlzLm1fZ3JvdW5kQW5jaG9yMiA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvcjEgPSBuZXcgYjJWZWMyKCk7XG4gICAgICB0aGlzLm1fbG9jYWxBbmNob3IyID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy5tX3UxID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy5tX3UyID0gbmV3IGIyVmVjMigpO1xuICAgfTtcbiAgIGIyUHVsbGV5Sm9pbnQucHJvdG90eXBlLkdldEFuY2hvckEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlBLkdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yMSk7XG4gICB9XG4gICBiMlB1bGxleUpvaW50LnByb3RvdHlwZS5HZXRBbmNob3JCID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV9ib2R5Qi5HZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvcjIpO1xuICAgfVxuICAgYjJQdWxsZXlKb2ludC5wcm90b3R5cGUuR2V0UmVhY3Rpb25Gb3JjZSA9IGZ1bmN0aW9uIChpbnZfZHQpIHtcbiAgICAgIGlmIChpbnZfZHQgPT09IHVuZGVmaW5lZCkgaW52X2R0ID0gMDtcbiAgICAgIHJldHVybiBuZXcgYjJWZWMyKGludl9kdCAqIHRoaXMubV9pbXB1bHNlICogdGhpcy5tX3UyLngsIGludl9kdCAqIHRoaXMubV9pbXB1bHNlICogdGhpcy5tX3UyLnkpO1xuICAgfVxuICAgYjJQdWxsZXlKb2ludC5wcm90b3R5cGUuR2V0UmVhY3Rpb25Ub3JxdWUgPSBmdW5jdGlvbiAoaW52X2R0KSB7XG4gICAgICBpZiAoaW52X2R0ID09PSB1bmRlZmluZWQpIGludl9kdCA9IDA7XG4gICAgICByZXR1cm4gMC4wO1xuICAgfVxuICAgYjJQdWxsZXlKb2ludC5wcm90b3R5cGUuR2V0R3JvdW5kQW5jaG9yQSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBhID0gdGhpcy5tX2dyb3VuZC5tX3hmLnBvc2l0aW9uLkNvcHkoKTtcbiAgICAgIGEuQWRkKHRoaXMubV9ncm91bmRBbmNob3IxKTtcbiAgICAgIHJldHVybiBhO1xuICAgfVxuICAgYjJQdWxsZXlKb2ludC5wcm90b3R5cGUuR2V0R3JvdW5kQW5jaG9yQiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBhID0gdGhpcy5tX2dyb3VuZC5tX3hmLnBvc2l0aW9uLkNvcHkoKTtcbiAgICAgIGEuQWRkKHRoaXMubV9ncm91bmRBbmNob3IyKTtcbiAgICAgIHJldHVybiBhO1xuICAgfVxuICAgYjJQdWxsZXlKb2ludC5wcm90b3R5cGUuR2V0TGVuZ3RoMSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBwID0gdGhpcy5tX2JvZHlBLkdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yMSk7XG4gICAgICB2YXIgc1ggPSB0aGlzLm1fZ3JvdW5kLm1feGYucG9zaXRpb24ueCArIHRoaXMubV9ncm91bmRBbmNob3IxLng7XG4gICAgICB2YXIgc1kgPSB0aGlzLm1fZ3JvdW5kLm1feGYucG9zaXRpb24ueSArIHRoaXMubV9ncm91bmRBbmNob3IxLnk7XG4gICAgICB2YXIgZFggPSBwLnggLSBzWDtcbiAgICAgIHZhciBkWSA9IHAueSAtIHNZO1xuICAgICAgcmV0dXJuIE1hdGguc3FydChkWCAqIGRYICsgZFkgKiBkWSk7XG4gICB9XG4gICBiMlB1bGxleUpvaW50LnByb3RvdHlwZS5HZXRMZW5ndGgyID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHAgPSB0aGlzLm1fYm9keUIuR2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3IyKTtcbiAgICAgIHZhciBzWCA9IHRoaXMubV9ncm91bmQubV94Zi5wb3NpdGlvbi54ICsgdGhpcy5tX2dyb3VuZEFuY2hvcjIueDtcbiAgICAgIHZhciBzWSA9IHRoaXMubV9ncm91bmQubV94Zi5wb3NpdGlvbi55ICsgdGhpcy5tX2dyb3VuZEFuY2hvcjIueTtcbiAgICAgIHZhciBkWCA9IHAueCAtIHNYO1xuICAgICAgdmFyIGRZID0gcC55IC0gc1k7XG4gICAgICByZXR1cm4gTWF0aC5zcXJ0KGRYICogZFggKyBkWSAqIGRZKTtcbiAgIH1cbiAgIGIyUHVsbGV5Sm9pbnQucHJvdG90eXBlLkdldFJhdGlvID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV9yYXRpbztcbiAgIH1cbiAgIGIyUHVsbGV5Sm9pbnQucHJvdG90eXBlLmIyUHVsbGV5Sm9pbnQgPSBmdW5jdGlvbiAoZGVmKSB7XG4gICAgICB0aGlzLl9fc3VwZXIuYjJKb2ludC5jYWxsKHRoaXMsIGRlZik7XG4gICAgICB2YXIgdE1hdDtcbiAgICAgIHZhciB0WCA9IDA7XG4gICAgICB2YXIgdFkgPSAwO1xuICAgICAgdGhpcy5tX2dyb3VuZCA9IHRoaXMubV9ib2R5QS5tX3dvcmxkLm1fZ3JvdW5kQm9keTtcbiAgICAgIHRoaXMubV9ncm91bmRBbmNob3IxLnggPSBkZWYuZ3JvdW5kQW5jaG9yQS54IC0gdGhpcy5tX2dyb3VuZC5tX3hmLnBvc2l0aW9uLng7XG4gICAgICB0aGlzLm1fZ3JvdW5kQW5jaG9yMS55ID0gZGVmLmdyb3VuZEFuY2hvckEueSAtIHRoaXMubV9ncm91bmQubV94Zi5wb3NpdGlvbi55O1xuICAgICAgdGhpcy5tX2dyb3VuZEFuY2hvcjIueCA9IGRlZi5ncm91bmRBbmNob3JCLnggLSB0aGlzLm1fZ3JvdW5kLm1feGYucG9zaXRpb24ueDtcbiAgICAgIHRoaXMubV9ncm91bmRBbmNob3IyLnkgPSBkZWYuZ3JvdW5kQW5jaG9yQi55IC0gdGhpcy5tX2dyb3VuZC5tX3hmLnBvc2l0aW9uLnk7XG4gICAgICB0aGlzLm1fbG9jYWxBbmNob3IxLlNldFYoZGVmLmxvY2FsQW5jaG9yQSk7XG4gICAgICB0aGlzLm1fbG9jYWxBbmNob3IyLlNldFYoZGVmLmxvY2FsQW5jaG9yQik7XG4gICAgICB0aGlzLm1fcmF0aW8gPSBkZWYucmF0aW87XG4gICAgICB0aGlzLm1fY29uc3RhbnQgPSBkZWYubGVuZ3RoQSArIHRoaXMubV9yYXRpbyAqIGRlZi5sZW5ndGhCO1xuICAgICAgdGhpcy5tX21heExlbmd0aDEgPSBiMk1hdGguTWluKGRlZi5tYXhMZW5ndGhBLCB0aGlzLm1fY29uc3RhbnQgLSB0aGlzLm1fcmF0aW8gKiBiMlB1bGxleUpvaW50LmIyX21pblB1bGxleUxlbmd0aCk7XG4gICAgICB0aGlzLm1fbWF4TGVuZ3RoMiA9IGIyTWF0aC5NaW4oZGVmLm1heExlbmd0aEIsICh0aGlzLm1fY29uc3RhbnQgLSBiMlB1bGxleUpvaW50LmIyX21pblB1bGxleUxlbmd0aCkgLyB0aGlzLm1fcmF0aW8pO1xuICAgICAgdGhpcy5tX2ltcHVsc2UgPSAwLjA7XG4gICAgICB0aGlzLm1fbGltaXRJbXB1bHNlMSA9IDAuMDtcbiAgICAgIHRoaXMubV9saW1pdEltcHVsc2UyID0gMC4wO1xuICAgfVxuICAgYjJQdWxsZXlKb2ludC5wcm90b3R5cGUuSW5pdFZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbiAoc3RlcCkge1xuICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xuICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xuICAgICAgdmFyIHRNYXQ7XG4gICAgICB0TWF0ID0gYkEubV94Zi5SO1xuICAgICAgdmFyIHIxWCA9IHRoaXMubV9sb2NhbEFuY2hvcjEueCAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcbiAgICAgIHZhciByMVkgPSB0aGlzLm1fbG9jYWxBbmNob3IxLnkgLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XG4gICAgICB2YXIgdFggPSAodE1hdC5jb2wxLnggKiByMVggKyB0TWF0LmNvbDIueCAqIHIxWSk7XG4gICAgICByMVkgPSAodE1hdC5jb2wxLnkgKiByMVggKyB0TWF0LmNvbDIueSAqIHIxWSk7XG4gICAgICByMVggPSB0WDtcbiAgICAgIHRNYXQgPSBiQi5tX3hmLlI7XG4gICAgICB2YXIgcjJYID0gdGhpcy5tX2xvY2FsQW5jaG9yMi54IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci54O1xuICAgICAgdmFyIHIyWSA9IHRoaXMubV9sb2NhbEFuY2hvcjIueSAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcbiAgICAgIHRYID0gKHRNYXQuY29sMS54ICogcjJYICsgdE1hdC5jb2wyLnggKiByMlkpO1xuICAgICAgcjJZID0gKHRNYXQuY29sMS55ICogcjJYICsgdE1hdC5jb2wyLnkgKiByMlkpO1xuICAgICAgcjJYID0gdFg7XG4gICAgICB2YXIgcDFYID0gYkEubV9zd2VlcC5jLnggKyByMVg7XG4gICAgICB2YXIgcDFZID0gYkEubV9zd2VlcC5jLnkgKyByMVk7XG4gICAgICB2YXIgcDJYID0gYkIubV9zd2VlcC5jLnggKyByMlg7XG4gICAgICB2YXIgcDJZID0gYkIubV9zd2VlcC5jLnkgKyByMlk7XG4gICAgICB2YXIgczFYID0gdGhpcy5tX2dyb3VuZC5tX3hmLnBvc2l0aW9uLnggKyB0aGlzLm1fZ3JvdW5kQW5jaG9yMS54O1xuICAgICAgdmFyIHMxWSA9IHRoaXMubV9ncm91bmQubV94Zi5wb3NpdGlvbi55ICsgdGhpcy5tX2dyb3VuZEFuY2hvcjEueTtcbiAgICAgIHZhciBzMlggPSB0aGlzLm1fZ3JvdW5kLm1feGYucG9zaXRpb24ueCArIHRoaXMubV9ncm91bmRBbmNob3IyLng7XG4gICAgICB2YXIgczJZID0gdGhpcy5tX2dyb3VuZC5tX3hmLnBvc2l0aW9uLnkgKyB0aGlzLm1fZ3JvdW5kQW5jaG9yMi55O1xuICAgICAgdGhpcy5tX3UxLlNldChwMVggLSBzMVgsIHAxWSAtIHMxWSk7XG4gICAgICB0aGlzLm1fdTIuU2V0KHAyWCAtIHMyWCwgcDJZIC0gczJZKTtcbiAgICAgIHZhciBsZW5ndGgxID0gdGhpcy5tX3UxLkxlbmd0aCgpO1xuICAgICAgdmFyIGxlbmd0aDIgPSB0aGlzLm1fdTIuTGVuZ3RoKCk7XG4gICAgICBpZiAobGVuZ3RoMSA+IGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCkge1xuICAgICAgICAgdGhpcy5tX3UxLk11bHRpcGx5KDEuMCAvIGxlbmd0aDEpO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgICB0aGlzLm1fdTEuU2V0WmVybygpO1xuICAgICAgfVxuICAgICAgaWYgKGxlbmd0aDIgPiBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3ApIHtcbiAgICAgICAgIHRoaXMubV91Mi5NdWx0aXBseSgxLjAgLyBsZW5ndGgyKTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICAgdGhpcy5tX3UyLlNldFplcm8oKTtcbiAgICAgIH1cbiAgICAgIHZhciBDID0gdGhpcy5tX2NvbnN0YW50IC0gbGVuZ3RoMSAtIHRoaXMubV9yYXRpbyAqIGxlbmd0aDI7XG4gICAgICBpZiAoQyA+IDAuMCkge1xuICAgICAgICAgdGhpcy5tX3N0YXRlID0gYjJKb2ludC5lX2luYWN0aXZlTGltaXQ7XG4gICAgICAgICB0aGlzLm1faW1wdWxzZSA9IDAuMDtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICAgdGhpcy5tX3N0YXRlID0gYjJKb2ludC5lX2F0VXBwZXJMaW1pdDtcbiAgICAgIH1cbiAgICAgIGlmIChsZW5ndGgxIDwgdGhpcy5tX21heExlbmd0aDEpIHtcbiAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlMSA9IGIySm9pbnQuZV9pbmFjdGl2ZUxpbWl0O1xuICAgICAgICAgdGhpcy5tX2xpbWl0SW1wdWxzZTEgPSAwLjA7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlMSA9IGIySm9pbnQuZV9hdFVwcGVyTGltaXQ7XG4gICAgICB9XG4gICAgICBpZiAobGVuZ3RoMiA8IHRoaXMubV9tYXhMZW5ndGgyKSB7XG4gICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZTIgPSBiMkpvaW50LmVfaW5hY3RpdmVMaW1pdDtcbiAgICAgICAgIHRoaXMubV9saW1pdEltcHVsc2UyID0gMC4wO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZTIgPSBiMkpvaW50LmVfYXRVcHBlckxpbWl0O1xuICAgICAgfVxuICAgICAgdmFyIGNyMXUxID0gcjFYICogdGhpcy5tX3UxLnkgLSByMVkgKiB0aGlzLm1fdTEueDtcbiAgICAgIHZhciBjcjJ1MiA9IHIyWCAqIHRoaXMubV91Mi55IC0gcjJZICogdGhpcy5tX3UyLng7XG4gICAgICB0aGlzLm1fbGltaXRNYXNzMSA9IGJBLm1faW52TWFzcyArIGJBLm1faW52SSAqIGNyMXUxICogY3IxdTE7XG4gICAgICB0aGlzLm1fbGltaXRNYXNzMiA9IGJCLm1faW52TWFzcyArIGJCLm1faW52SSAqIGNyMnUyICogY3IydTI7XG4gICAgICB0aGlzLm1fcHVsbGV5TWFzcyA9IHRoaXMubV9saW1pdE1hc3MxICsgdGhpcy5tX3JhdGlvICogdGhpcy5tX3JhdGlvICogdGhpcy5tX2xpbWl0TWFzczI7XG4gICAgICB0aGlzLm1fbGltaXRNYXNzMSA9IDEuMCAvIHRoaXMubV9saW1pdE1hc3MxO1xuICAgICAgdGhpcy5tX2xpbWl0TWFzczIgPSAxLjAgLyB0aGlzLm1fbGltaXRNYXNzMjtcbiAgICAgIHRoaXMubV9wdWxsZXlNYXNzID0gMS4wIC8gdGhpcy5tX3B1bGxleU1hc3M7XG4gICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcbiAgICAgICAgIHRoaXMubV9pbXB1bHNlICo9IHN0ZXAuZHRSYXRpbztcbiAgICAgICAgIHRoaXMubV9saW1pdEltcHVsc2UxICo9IHN0ZXAuZHRSYXRpbztcbiAgICAgICAgIHRoaXMubV9saW1pdEltcHVsc2UyICo9IHN0ZXAuZHRSYXRpbztcbiAgICAgICAgIHZhciBQMVggPSAoKC10aGlzLm1faW1wdWxzZSkgLSB0aGlzLm1fbGltaXRJbXB1bHNlMSkgKiB0aGlzLm1fdTEueDtcbiAgICAgICAgIHZhciBQMVkgPSAoKC10aGlzLm1faW1wdWxzZSkgLSB0aGlzLm1fbGltaXRJbXB1bHNlMSkgKiB0aGlzLm1fdTEueTtcbiAgICAgICAgIHZhciBQMlggPSAoKC10aGlzLm1fcmF0aW8gKiB0aGlzLm1faW1wdWxzZSkgLSB0aGlzLm1fbGltaXRJbXB1bHNlMikgKiB0aGlzLm1fdTIueDtcbiAgICAgICAgIHZhciBQMlkgPSAoKC10aGlzLm1fcmF0aW8gKiB0aGlzLm1faW1wdWxzZSkgLSB0aGlzLm1fbGltaXRJbXB1bHNlMikgKiB0aGlzLm1fdTIueTtcbiAgICAgICAgIGJBLm1fbGluZWFyVmVsb2NpdHkueCArPSBiQS5tX2ludk1hc3MgKiBQMVg7XG4gICAgICAgICBiQS5tX2xpbmVhclZlbG9jaXR5LnkgKz0gYkEubV9pbnZNYXNzICogUDFZO1xuICAgICAgICAgYkEubV9hbmd1bGFyVmVsb2NpdHkgKz0gYkEubV9pbnZJICogKHIxWCAqIFAxWSAtIHIxWSAqIFAxWCk7XG4gICAgICAgICBiQi5tX2xpbmVhclZlbG9jaXR5LnggKz0gYkIubV9pbnZNYXNzICogUDJYO1xuICAgICAgICAgYkIubV9saW5lYXJWZWxvY2l0eS55ICs9IGJCLm1faW52TWFzcyAqIFAyWTtcbiAgICAgICAgIGJCLm1fYW5ndWxhclZlbG9jaXR5ICs9IGJCLm1faW52SSAqIChyMlggKiBQMlkgLSByMlkgKiBQMlgpO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgICB0aGlzLm1faW1wdWxzZSA9IDAuMDtcbiAgICAgICAgIHRoaXMubV9saW1pdEltcHVsc2UxID0gMC4wO1xuICAgICAgICAgdGhpcy5tX2xpbWl0SW1wdWxzZTIgPSAwLjA7XG4gICAgICB9XG4gICB9XG4gICBiMlB1bGxleUpvaW50LnByb3RvdHlwZS5Tb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbiAoc3RlcCkge1xuICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xuICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xuICAgICAgdmFyIHRNYXQ7XG4gICAgICB0TWF0ID0gYkEubV94Zi5SO1xuICAgICAgdmFyIHIxWCA9IHRoaXMubV9sb2NhbEFuY2hvcjEueCAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcbiAgICAgIHZhciByMVkgPSB0aGlzLm1fbG9jYWxBbmNob3IxLnkgLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XG4gICAgICB2YXIgdFggPSAodE1hdC5jb2wxLnggKiByMVggKyB0TWF0LmNvbDIueCAqIHIxWSk7XG4gICAgICByMVkgPSAodE1hdC5jb2wxLnkgKiByMVggKyB0TWF0LmNvbDIueSAqIHIxWSk7XG4gICAgICByMVggPSB0WDtcbiAgICAgIHRNYXQgPSBiQi5tX3hmLlI7XG4gICAgICB2YXIgcjJYID0gdGhpcy5tX2xvY2FsQW5jaG9yMi54IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci54O1xuICAgICAgdmFyIHIyWSA9IHRoaXMubV9sb2NhbEFuY2hvcjIueSAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcbiAgICAgIHRYID0gKHRNYXQuY29sMS54ICogcjJYICsgdE1hdC5jb2wyLnggKiByMlkpO1xuICAgICAgcjJZID0gKHRNYXQuY29sMS55ICogcjJYICsgdE1hdC5jb2wyLnkgKiByMlkpO1xuICAgICAgcjJYID0gdFg7XG4gICAgICB2YXIgdjFYID0gMDtcbiAgICAgIHZhciB2MVkgPSAwO1xuICAgICAgdmFyIHYyWCA9IDA7XG4gICAgICB2YXIgdjJZID0gMDtcbiAgICAgIHZhciBQMVggPSAwO1xuICAgICAgdmFyIFAxWSA9IDA7XG4gICAgICB2YXIgUDJYID0gMDtcbiAgICAgIHZhciBQMlkgPSAwO1xuICAgICAgdmFyIENkb3QgPSAwO1xuICAgICAgdmFyIGltcHVsc2UgPSAwO1xuICAgICAgdmFyIG9sZEltcHVsc2UgPSAwO1xuICAgICAgaWYgKHRoaXMubV9zdGF0ZSA9PSBiMkpvaW50LmVfYXRVcHBlckxpbWl0KSB7XG4gICAgICAgICB2MVggPSBiQS5tX2xpbmVhclZlbG9jaXR5LnggKyAoKC1iQS5tX2FuZ3VsYXJWZWxvY2l0eSAqIHIxWSkpO1xuICAgICAgICAgdjFZID0gYkEubV9saW5lYXJWZWxvY2l0eS55ICsgKGJBLm1fYW5ndWxhclZlbG9jaXR5ICogcjFYKTtcbiAgICAgICAgIHYyWCA9IGJCLm1fbGluZWFyVmVsb2NpdHkueCArICgoLWJCLm1fYW5ndWxhclZlbG9jaXR5ICogcjJZKSk7XG4gICAgICAgICB2MlkgPSBiQi5tX2xpbmVhclZlbG9jaXR5LnkgKyAoYkIubV9hbmd1bGFyVmVsb2NpdHkgKiByMlgpO1xuICAgICAgICAgQ2RvdCA9ICgtKHRoaXMubV91MS54ICogdjFYICsgdGhpcy5tX3UxLnkgKiB2MVkpKSAtIHRoaXMubV9yYXRpbyAqICh0aGlzLm1fdTIueCAqIHYyWCArIHRoaXMubV91Mi55ICogdjJZKTtcbiAgICAgICAgIGltcHVsc2UgPSB0aGlzLm1fcHVsbGV5TWFzcyAqICgoLUNkb3QpKTtcbiAgICAgICAgIG9sZEltcHVsc2UgPSB0aGlzLm1faW1wdWxzZTtcbiAgICAgICAgIHRoaXMubV9pbXB1bHNlID0gYjJNYXRoLk1heCgwLjAsIHRoaXMubV9pbXB1bHNlICsgaW1wdWxzZSk7XG4gICAgICAgICBpbXB1bHNlID0gdGhpcy5tX2ltcHVsc2UgLSBvbGRJbXB1bHNlO1xuICAgICAgICAgUDFYID0gKC1pbXB1bHNlICogdGhpcy5tX3UxLngpO1xuICAgICAgICAgUDFZID0gKC1pbXB1bHNlICogdGhpcy5tX3UxLnkpO1xuICAgICAgICAgUDJYID0gKC10aGlzLm1fcmF0aW8gKiBpbXB1bHNlICogdGhpcy5tX3UyLngpO1xuICAgICAgICAgUDJZID0gKC10aGlzLm1fcmF0aW8gKiBpbXB1bHNlICogdGhpcy5tX3UyLnkpO1xuICAgICAgICAgYkEubV9saW5lYXJWZWxvY2l0eS54ICs9IGJBLm1faW52TWFzcyAqIFAxWDtcbiAgICAgICAgIGJBLm1fbGluZWFyVmVsb2NpdHkueSArPSBiQS5tX2ludk1hc3MgKiBQMVk7XG4gICAgICAgICBiQS5tX2FuZ3VsYXJWZWxvY2l0eSArPSBiQS5tX2ludkkgKiAocjFYICogUDFZIC0gcjFZICogUDFYKTtcbiAgICAgICAgIGJCLm1fbGluZWFyVmVsb2NpdHkueCArPSBiQi5tX2ludk1hc3MgKiBQMlg7XG4gICAgICAgICBiQi5tX2xpbmVhclZlbG9jaXR5LnkgKz0gYkIubV9pbnZNYXNzICogUDJZO1xuICAgICAgICAgYkIubV9hbmd1bGFyVmVsb2NpdHkgKz0gYkIubV9pbnZJICogKHIyWCAqIFAyWSAtIHIyWSAqIFAyWCk7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5tX2xpbWl0U3RhdGUxID09IGIySm9pbnQuZV9hdFVwcGVyTGltaXQpIHtcbiAgICAgICAgIHYxWCA9IGJBLm1fbGluZWFyVmVsb2NpdHkueCArICgoLWJBLm1fYW5ndWxhclZlbG9jaXR5ICogcjFZKSk7XG4gICAgICAgICB2MVkgPSBiQS5tX2xpbmVhclZlbG9jaXR5LnkgKyAoYkEubV9hbmd1bGFyVmVsb2NpdHkgKiByMVgpO1xuICAgICAgICAgQ2RvdCA9ICgtKHRoaXMubV91MS54ICogdjFYICsgdGhpcy5tX3UxLnkgKiB2MVkpKTtcbiAgICAgICAgIGltcHVsc2UgPSAoLXRoaXMubV9saW1pdE1hc3MxICogQ2RvdCk7XG4gICAgICAgICBvbGRJbXB1bHNlID0gdGhpcy5tX2xpbWl0SW1wdWxzZTE7XG4gICAgICAgICB0aGlzLm1fbGltaXRJbXB1bHNlMSA9IGIyTWF0aC5NYXgoMC4wLCB0aGlzLm1fbGltaXRJbXB1bHNlMSArIGltcHVsc2UpO1xuICAgICAgICAgaW1wdWxzZSA9IHRoaXMubV9saW1pdEltcHVsc2UxIC0gb2xkSW1wdWxzZTtcbiAgICAgICAgIFAxWCA9ICgtaW1wdWxzZSAqIHRoaXMubV91MS54KTtcbiAgICAgICAgIFAxWSA9ICgtaW1wdWxzZSAqIHRoaXMubV91MS55KTtcbiAgICAgICAgIGJBLm1fbGluZWFyVmVsb2NpdHkueCArPSBiQS5tX2ludk1hc3MgKiBQMVg7XG4gICAgICAgICBiQS5tX2xpbmVhclZlbG9jaXR5LnkgKz0gYkEubV9pbnZNYXNzICogUDFZO1xuICAgICAgICAgYkEubV9hbmd1bGFyVmVsb2NpdHkgKz0gYkEubV9pbnZJICogKHIxWCAqIFAxWSAtIHIxWSAqIFAxWCk7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5tX2xpbWl0U3RhdGUyID09IGIySm9pbnQuZV9hdFVwcGVyTGltaXQpIHtcbiAgICAgICAgIHYyWCA9IGJCLm1fbGluZWFyVmVsb2NpdHkueCArICgoLWJCLm1fYW5ndWxhclZlbG9jaXR5ICogcjJZKSk7XG4gICAgICAgICB2MlkgPSBiQi5tX2xpbmVhclZlbG9jaXR5LnkgKyAoYkIubV9hbmd1bGFyVmVsb2NpdHkgKiByMlgpO1xuICAgICAgICAgQ2RvdCA9ICgtKHRoaXMubV91Mi54ICogdjJYICsgdGhpcy5tX3UyLnkgKiB2MlkpKTtcbiAgICAgICAgIGltcHVsc2UgPSAoLXRoaXMubV9saW1pdE1hc3MyICogQ2RvdCk7XG4gICAgICAgICBvbGRJbXB1bHNlID0gdGhpcy5tX2xpbWl0SW1wdWxzZTI7XG4gICAgICAgICB0aGlzLm1fbGltaXRJbXB1bHNlMiA9IGIyTWF0aC5NYXgoMC4wLCB0aGlzLm1fbGltaXRJbXB1bHNlMiArIGltcHVsc2UpO1xuICAgICAgICAgaW1wdWxzZSA9IHRoaXMubV9saW1pdEltcHVsc2UyIC0gb2xkSW1wdWxzZTtcbiAgICAgICAgIFAyWCA9ICgtaW1wdWxzZSAqIHRoaXMubV91Mi54KTtcbiAgICAgICAgIFAyWSA9ICgtaW1wdWxzZSAqIHRoaXMubV91Mi55KTtcbiAgICAgICAgIGJCLm1fbGluZWFyVmVsb2NpdHkueCArPSBiQi5tX2ludk1hc3MgKiBQMlg7XG4gICAgICAgICBiQi5tX2xpbmVhclZlbG9jaXR5LnkgKz0gYkIubV9pbnZNYXNzICogUDJZO1xuICAgICAgICAgYkIubV9hbmd1bGFyVmVsb2NpdHkgKz0gYkIubV9pbnZJICogKHIyWCAqIFAyWSAtIHIyWSAqIFAyWCk7XG4gICAgICB9XG4gICB9XG4gICBiMlB1bGxleUpvaW50LnByb3RvdHlwZS5Tb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMgPSBmdW5jdGlvbiAoYmF1bWdhcnRlKSB7XG4gICAgICBpZiAoYmF1bWdhcnRlID09PSB1bmRlZmluZWQpIGJhdW1nYXJ0ZSA9IDA7XG4gICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XG4gICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XG4gICAgICB2YXIgdE1hdDtcbiAgICAgIHZhciBzMVggPSB0aGlzLm1fZ3JvdW5kLm1feGYucG9zaXRpb24ueCArIHRoaXMubV9ncm91bmRBbmNob3IxLng7XG4gICAgICB2YXIgczFZID0gdGhpcy5tX2dyb3VuZC5tX3hmLnBvc2l0aW9uLnkgKyB0aGlzLm1fZ3JvdW5kQW5jaG9yMS55O1xuICAgICAgdmFyIHMyWCA9IHRoaXMubV9ncm91bmQubV94Zi5wb3NpdGlvbi54ICsgdGhpcy5tX2dyb3VuZEFuY2hvcjIueDtcbiAgICAgIHZhciBzMlkgPSB0aGlzLm1fZ3JvdW5kLm1feGYucG9zaXRpb24ueSArIHRoaXMubV9ncm91bmRBbmNob3IyLnk7XG4gICAgICB2YXIgcjFYID0gMDtcbiAgICAgIHZhciByMVkgPSAwO1xuICAgICAgdmFyIHIyWCA9IDA7XG4gICAgICB2YXIgcjJZID0gMDtcbiAgICAgIHZhciBwMVggPSAwO1xuICAgICAgdmFyIHAxWSA9IDA7XG4gICAgICB2YXIgcDJYID0gMDtcbiAgICAgIHZhciBwMlkgPSAwO1xuICAgICAgdmFyIGxlbmd0aDEgPSAwO1xuICAgICAgdmFyIGxlbmd0aDIgPSAwO1xuICAgICAgdmFyIEMgPSAwO1xuICAgICAgdmFyIGltcHVsc2UgPSAwO1xuICAgICAgdmFyIG9sZEltcHVsc2UgPSAwO1xuICAgICAgdmFyIG9sZExpbWl0UG9zaXRpb25JbXB1bHNlID0gMDtcbiAgICAgIHZhciB0WCA9IDA7XG4gICAgICB2YXIgbGluZWFyRXJyb3IgPSAwLjA7XG4gICAgICBpZiAodGhpcy5tX3N0YXRlID09IGIySm9pbnQuZV9hdFVwcGVyTGltaXQpIHtcbiAgICAgICAgIHRNYXQgPSBiQS5tX3hmLlI7XG4gICAgICAgICByMVggPSB0aGlzLm1fbG9jYWxBbmNob3IxLnggLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XG4gICAgICAgICByMVkgPSB0aGlzLm1fbG9jYWxBbmNob3IxLnkgLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XG4gICAgICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHIxWCArIHRNYXQuY29sMi54ICogcjFZKTtcbiAgICAgICAgIHIxWSA9ICh0TWF0LmNvbDEueSAqIHIxWCArIHRNYXQuY29sMi55ICogcjFZKTtcbiAgICAgICAgIHIxWCA9IHRYO1xuICAgICAgICAgdE1hdCA9IGJCLm1feGYuUjtcbiAgICAgICAgIHIyWCA9IHRoaXMubV9sb2NhbEFuY2hvcjIueCAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcbiAgICAgICAgIHIyWSA9IHRoaXMubV9sb2NhbEFuY2hvcjIueSAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcbiAgICAgICAgIHRYID0gKHRNYXQuY29sMS54ICogcjJYICsgdE1hdC5jb2wyLnggKiByMlkpO1xuICAgICAgICAgcjJZID0gKHRNYXQuY29sMS55ICogcjJYICsgdE1hdC5jb2wyLnkgKiByMlkpO1xuICAgICAgICAgcjJYID0gdFg7XG4gICAgICAgICBwMVggPSBiQS5tX3N3ZWVwLmMueCArIHIxWDtcbiAgICAgICAgIHAxWSA9IGJBLm1fc3dlZXAuYy55ICsgcjFZO1xuICAgICAgICAgcDJYID0gYkIubV9zd2VlcC5jLnggKyByMlg7XG4gICAgICAgICBwMlkgPSBiQi5tX3N3ZWVwLmMueSArIHIyWTtcbiAgICAgICAgIHRoaXMubV91MS5TZXQocDFYIC0gczFYLCBwMVkgLSBzMVkpO1xuICAgICAgICAgdGhpcy5tX3UyLlNldChwMlggLSBzMlgsIHAyWSAtIHMyWSk7XG4gICAgICAgICBsZW5ndGgxID0gdGhpcy5tX3UxLkxlbmd0aCgpO1xuICAgICAgICAgbGVuZ3RoMiA9IHRoaXMubV91Mi5MZW5ndGgoKTtcbiAgICAgICAgIGlmIChsZW5ndGgxID4gYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wKSB7XG4gICAgICAgICAgICB0aGlzLm1fdTEuTXVsdGlwbHkoMS4wIC8gbGVuZ3RoMSk7XG4gICAgICAgICB9XG4gICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubV91MS5TZXRaZXJvKCk7XG4gICAgICAgICB9XG4gICAgICAgICBpZiAobGVuZ3RoMiA+IGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCkge1xuICAgICAgICAgICAgdGhpcy5tX3UyLk11bHRpcGx5KDEuMCAvIGxlbmd0aDIpO1xuICAgICAgICAgfVxuICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm1fdTIuU2V0WmVybygpO1xuICAgICAgICAgfVxuICAgICAgICAgQyA9IHRoaXMubV9jb25zdGFudCAtIGxlbmd0aDEgLSB0aGlzLm1fcmF0aW8gKiBsZW5ndGgyO1xuICAgICAgICAgbGluZWFyRXJyb3IgPSBiMk1hdGguTWF4KGxpbmVhckVycm9yLCAoLUMpKTtcbiAgICAgICAgIEMgPSBiMk1hdGguQ2xhbXAoQyArIGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCwgKC1iMlNldHRpbmdzLmIyX21heExpbmVhckNvcnJlY3Rpb24pLCAwLjApO1xuICAgICAgICAgaW1wdWxzZSA9ICgtdGhpcy5tX3B1bGxleU1hc3MgKiBDKTtcbiAgICAgICAgIHAxWCA9ICgtaW1wdWxzZSAqIHRoaXMubV91MS54KTtcbiAgICAgICAgIHAxWSA9ICgtaW1wdWxzZSAqIHRoaXMubV91MS55KTtcbiAgICAgICAgIHAyWCA9ICgtdGhpcy5tX3JhdGlvICogaW1wdWxzZSAqIHRoaXMubV91Mi54KTtcbiAgICAgICAgIHAyWSA9ICgtdGhpcy5tX3JhdGlvICogaW1wdWxzZSAqIHRoaXMubV91Mi55KTtcbiAgICAgICAgIGJBLm1fc3dlZXAuYy54ICs9IGJBLm1faW52TWFzcyAqIHAxWDtcbiAgICAgICAgIGJBLm1fc3dlZXAuYy55ICs9IGJBLm1faW52TWFzcyAqIHAxWTtcbiAgICAgICAgIGJBLm1fc3dlZXAuYSArPSBiQS5tX2ludkkgKiAocjFYICogcDFZIC0gcjFZICogcDFYKTtcbiAgICAgICAgIGJCLm1fc3dlZXAuYy54ICs9IGJCLm1faW52TWFzcyAqIHAyWDtcbiAgICAgICAgIGJCLm1fc3dlZXAuYy55ICs9IGJCLm1faW52TWFzcyAqIHAyWTtcbiAgICAgICAgIGJCLm1fc3dlZXAuYSArPSBiQi5tX2ludkkgKiAocjJYICogcDJZIC0gcjJZICogcDJYKTtcbiAgICAgICAgIGJBLlN5bmNocm9uaXplVHJhbnNmb3JtKCk7XG4gICAgICAgICBiQi5TeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMubV9saW1pdFN0YXRlMSA9PSBiMkpvaW50LmVfYXRVcHBlckxpbWl0KSB7XG4gICAgICAgICB0TWF0ID0gYkEubV94Zi5SO1xuICAgICAgICAgcjFYID0gdGhpcy5tX2xvY2FsQW5jaG9yMS54IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci54O1xuICAgICAgICAgcjFZID0gdGhpcy5tX2xvY2FsQW5jaG9yMS55IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci55O1xuICAgICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByMVggKyB0TWF0LmNvbDIueCAqIHIxWSk7XG4gICAgICAgICByMVkgPSAodE1hdC5jb2wxLnkgKiByMVggKyB0TWF0LmNvbDIueSAqIHIxWSk7XG4gICAgICAgICByMVggPSB0WDtcbiAgICAgICAgIHAxWCA9IGJBLm1fc3dlZXAuYy54ICsgcjFYO1xuICAgICAgICAgcDFZID0gYkEubV9zd2VlcC5jLnkgKyByMVk7XG4gICAgICAgICB0aGlzLm1fdTEuU2V0KHAxWCAtIHMxWCwgcDFZIC0gczFZKTtcbiAgICAgICAgIGxlbmd0aDEgPSB0aGlzLm1fdTEuTGVuZ3RoKCk7XG4gICAgICAgICBpZiAobGVuZ3RoMSA+IGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCkge1xuICAgICAgICAgICAgdGhpcy5tX3UxLnggKj0gMS4wIC8gbGVuZ3RoMTtcbiAgICAgICAgICAgIHRoaXMubV91MS55ICo9IDEuMCAvIGxlbmd0aDE7XG4gICAgICAgICB9XG4gICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubV91MS5TZXRaZXJvKCk7XG4gICAgICAgICB9XG4gICAgICAgICBDID0gdGhpcy5tX21heExlbmd0aDEgLSBsZW5ndGgxO1xuICAgICAgICAgbGluZWFyRXJyb3IgPSBiMk1hdGguTWF4KGxpbmVhckVycm9yLCAoLUMpKTtcbiAgICAgICAgIEMgPSBiMk1hdGguQ2xhbXAoQyArIGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCwgKC1iMlNldHRpbmdzLmIyX21heExpbmVhckNvcnJlY3Rpb24pLCAwLjApO1xuICAgICAgICAgaW1wdWxzZSA9ICgtdGhpcy5tX2xpbWl0TWFzczEgKiBDKTtcbiAgICAgICAgIHAxWCA9ICgtaW1wdWxzZSAqIHRoaXMubV91MS54KTtcbiAgICAgICAgIHAxWSA9ICgtaW1wdWxzZSAqIHRoaXMubV91MS55KTtcbiAgICAgICAgIGJBLm1fc3dlZXAuYy54ICs9IGJBLm1faW52TWFzcyAqIHAxWDtcbiAgICAgICAgIGJBLm1fc3dlZXAuYy55ICs9IGJBLm1faW52TWFzcyAqIHAxWTtcbiAgICAgICAgIGJBLm1fc3dlZXAuYSArPSBiQS5tX2ludkkgKiAocjFYICogcDFZIC0gcjFZICogcDFYKTtcbiAgICAgICAgIGJBLlN5bmNocm9uaXplVHJhbnNmb3JtKCk7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5tX2xpbWl0U3RhdGUyID09IGIySm9pbnQuZV9hdFVwcGVyTGltaXQpIHtcbiAgICAgICAgIHRNYXQgPSBiQi5tX3hmLlI7XG4gICAgICAgICByMlggPSB0aGlzLm1fbG9jYWxBbmNob3IyLnggLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XG4gICAgICAgICByMlkgPSB0aGlzLm1fbG9jYWxBbmNob3IyLnkgLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XG4gICAgICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHIyWCArIHRNYXQuY29sMi54ICogcjJZKTtcbiAgICAgICAgIHIyWSA9ICh0TWF0LmNvbDEueSAqIHIyWCArIHRNYXQuY29sMi55ICogcjJZKTtcbiAgICAgICAgIHIyWCA9IHRYO1xuICAgICAgICAgcDJYID0gYkIubV9zd2VlcC5jLnggKyByMlg7XG4gICAgICAgICBwMlkgPSBiQi5tX3N3ZWVwLmMueSArIHIyWTtcbiAgICAgICAgIHRoaXMubV91Mi5TZXQocDJYIC0gczJYLCBwMlkgLSBzMlkpO1xuICAgICAgICAgbGVuZ3RoMiA9IHRoaXMubV91Mi5MZW5ndGgoKTtcbiAgICAgICAgIGlmIChsZW5ndGgyID4gYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wKSB7XG4gICAgICAgICAgICB0aGlzLm1fdTIueCAqPSAxLjAgLyBsZW5ndGgyO1xuICAgICAgICAgICAgdGhpcy5tX3UyLnkgKj0gMS4wIC8gbGVuZ3RoMjtcbiAgICAgICAgIH1cbiAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5tX3UyLlNldFplcm8oKTtcbiAgICAgICAgIH1cbiAgICAgICAgIEMgPSB0aGlzLm1fbWF4TGVuZ3RoMiAtIGxlbmd0aDI7XG4gICAgICAgICBsaW5lYXJFcnJvciA9IGIyTWF0aC5NYXgobGluZWFyRXJyb3IsICgtQykpO1xuICAgICAgICAgQyA9IGIyTWF0aC5DbGFtcChDICsgYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wLCAoLWIyU2V0dGluZ3MuYjJfbWF4TGluZWFyQ29ycmVjdGlvbiksIDAuMCk7XG4gICAgICAgICBpbXB1bHNlID0gKC10aGlzLm1fbGltaXRNYXNzMiAqIEMpO1xuICAgICAgICAgcDJYID0gKC1pbXB1bHNlICogdGhpcy5tX3UyLngpO1xuICAgICAgICAgcDJZID0gKC1pbXB1bHNlICogdGhpcy5tX3UyLnkpO1xuICAgICAgICAgYkIubV9zd2VlcC5jLnggKz0gYkIubV9pbnZNYXNzICogcDJYO1xuICAgICAgICAgYkIubV9zd2VlcC5jLnkgKz0gYkIubV9pbnZNYXNzICogcDJZO1xuICAgICAgICAgYkIubV9zd2VlcC5hICs9IGJCLm1faW52SSAqIChyMlggKiBwMlkgLSByMlkgKiBwMlgpO1xuICAgICAgICAgYkIuU3luY2hyb25pemVUcmFuc2Zvcm0oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBsaW5lYXJFcnJvciA8IGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcDtcbiAgIH1cbiAgIEJveDJELnBvc3REZWZzLnB1c2goZnVuY3Rpb24gKCkge1xuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyUHVsbGV5Sm9pbnQuYjJfbWluUHVsbGV5TGVuZ3RoID0gMi4wO1xuICAgfSk7XG4gICBCb3gyRC5pbmhlcml0KGIyUHVsbGV5Sm9pbnREZWYsIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmKTtcbiAgIGIyUHVsbGV5Sm9pbnREZWYucHJvdG90eXBlLl9fc3VwZXIgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZi5wcm90b3R5cGU7XG4gICBiMlB1bGxleUpvaW50RGVmLmIyUHVsbGV5Sm9pbnREZWYgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZi5iMkpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB0aGlzLmdyb3VuZEFuY2hvckEgPSBuZXcgYjJWZWMyKCk7XG4gICAgICB0aGlzLmdyb3VuZEFuY2hvckIgPSBuZXcgYjJWZWMyKCk7XG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQSA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIHRoaXMubG9jYWxBbmNob3JCID0gbmV3IGIyVmVjMigpO1xuICAgfTtcbiAgIGIyUHVsbGV5Sm9pbnREZWYucHJvdG90eXBlLmIyUHVsbGV5Sm9pbnREZWYgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLl9fc3VwZXIuYjJKb2ludERlZi5jYWxsKHRoaXMpO1xuICAgICAgdGhpcy50eXBlID0gYjJKb2ludC5lX3B1bGxleUpvaW50O1xuICAgICAgdGhpcy5ncm91bmRBbmNob3JBLlNldCgoLTEuMCksIDEuMCk7XG4gICAgICB0aGlzLmdyb3VuZEFuY2hvckIuU2V0KDEuMCwgMS4wKTtcbiAgICAgIHRoaXMubG9jYWxBbmNob3JBLlNldCgoLTEuMCksIDAuMCk7XG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQi5TZXQoMS4wLCAwLjApO1xuICAgICAgdGhpcy5sZW5ndGhBID0gMC4wO1xuICAgICAgdGhpcy5tYXhMZW5ndGhBID0gMC4wO1xuICAgICAgdGhpcy5sZW5ndGhCID0gMC4wO1xuICAgICAgdGhpcy5tYXhMZW5ndGhCID0gMC4wO1xuICAgICAgdGhpcy5yYXRpbyA9IDEuMDtcbiAgICAgIHRoaXMuY29sbGlkZUNvbm5lY3RlZCA9IHRydWU7XG4gICB9XG4gICBiMlB1bGxleUpvaW50RGVmLnByb3RvdHlwZS5Jbml0aWFsaXplID0gZnVuY3Rpb24gKGJBLCBiQiwgZ2FBLCBnYUIsIGFuY2hvckEsIGFuY2hvckIsIHIpIHtcbiAgICAgIGlmIChyID09PSB1bmRlZmluZWQpIHIgPSAwO1xuICAgICAgdGhpcy5ib2R5QSA9IGJBO1xuICAgICAgdGhpcy5ib2R5QiA9IGJCO1xuICAgICAgdGhpcy5ncm91bmRBbmNob3JBLlNldFYoZ2FBKTtcbiAgICAgIHRoaXMuZ3JvdW5kQW5jaG9yQi5TZXRWKGdhQik7XG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQSA9IHRoaXMuYm9keUEuR2V0TG9jYWxQb2ludChhbmNob3JBKTtcbiAgICAgIHRoaXMubG9jYWxBbmNob3JCID0gdGhpcy5ib2R5Qi5HZXRMb2NhbFBvaW50KGFuY2hvckIpO1xuICAgICAgdmFyIGQxWCA9IGFuY2hvckEueCAtIGdhQS54O1xuICAgICAgdmFyIGQxWSA9IGFuY2hvckEueSAtIGdhQS55O1xuICAgICAgdGhpcy5sZW5ndGhBID0gTWF0aC5zcXJ0KGQxWCAqIGQxWCArIGQxWSAqIGQxWSk7XG4gICAgICB2YXIgZDJYID0gYW5jaG9yQi54IC0gZ2FCLng7XG4gICAgICB2YXIgZDJZID0gYW5jaG9yQi55IC0gZ2FCLnk7XG4gICAgICB0aGlzLmxlbmd0aEIgPSBNYXRoLnNxcnQoZDJYICogZDJYICsgZDJZICogZDJZKTtcbiAgICAgIHRoaXMucmF0aW8gPSByO1xuICAgICAgdmFyIEMgPSB0aGlzLmxlbmd0aEEgKyB0aGlzLnJhdGlvICogdGhpcy5sZW5ndGhCO1xuICAgICAgdGhpcy5tYXhMZW5ndGhBID0gQyAtIHRoaXMucmF0aW8gKiBiMlB1bGxleUpvaW50LmIyX21pblB1bGxleUxlbmd0aDtcbiAgICAgIHRoaXMubWF4TGVuZ3RoQiA9IChDIC0gYjJQdWxsZXlKb2ludC5iMl9taW5QdWxsZXlMZW5ndGgpIC8gdGhpcy5yYXRpbztcbiAgIH1cbiAgIEJveDJELmluaGVyaXQoYjJSZXZvbHV0ZUpvaW50LCBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludCk7XG4gICBiMlJldm9sdXRlSm9pbnQucHJvdG90eXBlLl9fc3VwZXIgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5wcm90b3R5cGU7XG4gICBiMlJldm9sdXRlSm9pbnQuYjJSZXZvbHV0ZUpvaW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQuYjJKb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgdGhpcy5LID0gbmV3IGIyTWF0MjIoKTtcbiAgICAgIHRoaXMuSzEgPSBuZXcgYjJNYXQyMigpO1xuICAgICAgdGhpcy5LMiA9IG5ldyBiMk1hdDIyKCk7XG4gICAgICB0aGlzLkszID0gbmV3IGIyTWF0MjIoKTtcbiAgICAgIHRoaXMuaW1wdWxzZTMgPSBuZXcgYjJWZWMzKCk7XG4gICAgICB0aGlzLmltcHVsc2UyID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy5yZWR1Y2VkID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMSA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvcjIgPSBuZXcgYjJWZWMyKCk7XG4gICAgICB0aGlzLm1faW1wdWxzZSA9IG5ldyBiMlZlYzMoKTtcbiAgICAgIHRoaXMubV9tYXNzID0gbmV3IGIyTWF0MzMoKTtcbiAgIH07XG4gICBiMlJldm9sdXRlSm9pbnQucHJvdG90eXBlLkdldEFuY2hvckEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlBLkdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yMSk7XG4gICB9XG4gICBiMlJldm9sdXRlSm9pbnQucHJvdG90eXBlLkdldEFuY2hvckIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlCLkdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yMik7XG4gICB9XG4gICBiMlJldm9sdXRlSm9pbnQucHJvdG90eXBlLkdldFJlYWN0aW9uRm9yY2UgPSBmdW5jdGlvbiAoaW52X2R0KSB7XG4gICAgICBpZiAoaW52X2R0ID09PSB1bmRlZmluZWQpIGludl9kdCA9IDA7XG4gICAgICByZXR1cm4gbmV3IGIyVmVjMihpbnZfZHQgKiB0aGlzLm1faW1wdWxzZS54LCBpbnZfZHQgKiB0aGlzLm1faW1wdWxzZS55KTtcbiAgIH1cbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuR2V0UmVhY3Rpb25Ub3JxdWUgPSBmdW5jdGlvbiAoaW52X2R0KSB7XG4gICAgICBpZiAoaW52X2R0ID09PSB1bmRlZmluZWQpIGludl9kdCA9IDA7XG4gICAgICByZXR1cm4gaW52X2R0ICogdGhpcy5tX2ltcHVsc2UuejtcbiAgIH1cbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuR2V0Sm9pbnRBbmdsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fYm9keUIubV9zd2VlcC5hIC0gdGhpcy5tX2JvZHlBLm1fc3dlZXAuYSAtIHRoaXMubV9yZWZlcmVuY2VBbmdsZTtcbiAgIH1cbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuR2V0Sm9pbnRTcGVlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fYm9keUIubV9hbmd1bGFyVmVsb2NpdHkgLSB0aGlzLm1fYm9keUEubV9hbmd1bGFyVmVsb2NpdHk7XG4gICB9XG4gICBiMlJldm9sdXRlSm9pbnQucHJvdG90eXBlLklzTGltaXRFbmFibGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV9lbmFibGVMaW1pdDtcbiAgIH1cbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuRW5hYmxlTGltaXQgPSBmdW5jdGlvbiAoZmxhZykge1xuICAgICAgdGhpcy5tX2VuYWJsZUxpbWl0ID0gZmxhZztcbiAgIH1cbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuR2V0TG93ZXJMaW1pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fbG93ZXJBbmdsZTtcbiAgIH1cbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuR2V0VXBwZXJMaW1pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fdXBwZXJBbmdsZTtcbiAgIH1cbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuU2V0TGltaXRzID0gZnVuY3Rpb24gKGxvd2VyLCB1cHBlcikge1xuICAgICAgaWYgKGxvd2VyID09PSB1bmRlZmluZWQpIGxvd2VyID0gMDtcbiAgICAgIGlmICh1cHBlciA9PT0gdW5kZWZpbmVkKSB1cHBlciA9IDA7XG4gICAgICB0aGlzLm1fbG93ZXJBbmdsZSA9IGxvd2VyO1xuICAgICAgdGhpcy5tX3VwcGVyQW5nbGUgPSB1cHBlcjtcbiAgIH1cbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuSXNNb3RvckVuYWJsZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLm1fYm9keUEuU2V0QXdha2UodHJ1ZSk7XG4gICAgICB0aGlzLm1fYm9keUIuU2V0QXdha2UodHJ1ZSk7XG4gICAgICByZXR1cm4gdGhpcy5tX2VuYWJsZU1vdG9yO1xuICAgfVxuICAgYjJSZXZvbHV0ZUpvaW50LnByb3RvdHlwZS5FbmFibGVNb3RvciA9IGZ1bmN0aW9uIChmbGFnKSB7XG4gICAgICB0aGlzLm1fZW5hYmxlTW90b3IgPSBmbGFnO1xuICAgfVxuICAgYjJSZXZvbHV0ZUpvaW50LnByb3RvdHlwZS5TZXRNb3RvclNwZWVkID0gZnVuY3Rpb24gKHNwZWVkKSB7XG4gICAgICBpZiAoc3BlZWQgPT09IHVuZGVmaW5lZCkgc3BlZWQgPSAwO1xuICAgICAgdGhpcy5tX2JvZHlBLlNldEF3YWtlKHRydWUpO1xuICAgICAgdGhpcy5tX2JvZHlCLlNldEF3YWtlKHRydWUpO1xuICAgICAgdGhpcy5tX21vdG9yU3BlZWQgPSBzcGVlZDtcbiAgIH1cbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuR2V0TW90b3JTcGVlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fbW90b3JTcGVlZDtcbiAgIH1cbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuU2V0TWF4TW90b3JUb3JxdWUgPSBmdW5jdGlvbiAodG9ycXVlKSB7XG4gICAgICBpZiAodG9ycXVlID09PSB1bmRlZmluZWQpIHRvcnF1ZSA9IDA7XG4gICAgICB0aGlzLm1fbWF4TW90b3JUb3JxdWUgPSB0b3JxdWU7XG4gICB9XG4gICBiMlJldm9sdXRlSm9pbnQucHJvdG90eXBlLkdldE1vdG9yVG9ycXVlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV9tYXhNb3RvclRvcnF1ZTtcbiAgIH1cbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuYjJSZXZvbHV0ZUpvaW50ID0gZnVuY3Rpb24gKGRlZikge1xuICAgICAgdGhpcy5fX3N1cGVyLmIySm9pbnQuY2FsbCh0aGlzLCBkZWYpO1xuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMS5TZXRWKGRlZi5sb2NhbEFuY2hvckEpO1xuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMi5TZXRWKGRlZi5sb2NhbEFuY2hvckIpO1xuICAgICAgdGhpcy5tX3JlZmVyZW5jZUFuZ2xlID0gZGVmLnJlZmVyZW5jZUFuZ2xlO1xuICAgICAgdGhpcy5tX2ltcHVsc2UuU2V0WmVybygpO1xuICAgICAgdGhpcy5tX21vdG9ySW1wdWxzZSA9IDAuMDtcbiAgICAgIHRoaXMubV9sb3dlckFuZ2xlID0gZGVmLmxvd2VyQW5nbGU7XG4gICAgICB0aGlzLm1fdXBwZXJBbmdsZSA9IGRlZi51cHBlckFuZ2xlO1xuICAgICAgdGhpcy5tX21heE1vdG9yVG9ycXVlID0gZGVmLm1heE1vdG9yVG9ycXVlO1xuICAgICAgdGhpcy5tX21vdG9yU3BlZWQgPSBkZWYubW90b3JTcGVlZDtcbiAgICAgIHRoaXMubV9lbmFibGVMaW1pdCA9IGRlZi5lbmFibGVMaW1pdDtcbiAgICAgIHRoaXMubV9lbmFibGVNb3RvciA9IGRlZi5lbmFibGVNb3RvcjtcbiAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gYjJKb2ludC5lX2luYWN0aXZlTGltaXQ7XG4gICB9XG4gICBiMlJldm9sdXRlSm9pbnQucHJvdG90eXBlLkluaXRWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKHN0ZXApIHtcbiAgICAgIHZhciBiQSA9IHRoaXMubV9ib2R5QTtcbiAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcbiAgICAgIHZhciB0TWF0O1xuICAgICAgdmFyIHRYID0gMDtcbiAgICAgIGlmICh0aGlzLm1fZW5hYmxlTW90b3IgfHwgdGhpcy5tX2VuYWJsZUxpbWl0KSB7fVxuICAgICAgdE1hdCA9IGJBLm1feGYuUjtcbiAgICAgIHZhciByMVggPSB0aGlzLm1fbG9jYWxBbmNob3IxLnggLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XG4gICAgICB2YXIgcjFZID0gdGhpcy5tX2xvY2FsQW5jaG9yMS55IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci55O1xuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByMVggKyB0TWF0LmNvbDIueCAqIHIxWSk7XG4gICAgICByMVkgPSAodE1hdC5jb2wxLnkgKiByMVggKyB0TWF0LmNvbDIueSAqIHIxWSk7XG4gICAgICByMVggPSB0WDtcbiAgICAgIHRNYXQgPSBiQi5tX3hmLlI7XG4gICAgICB2YXIgcjJYID0gdGhpcy5tX2xvY2FsQW5jaG9yMi54IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci54O1xuICAgICAgdmFyIHIyWSA9IHRoaXMubV9sb2NhbEFuY2hvcjIueSAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcbiAgICAgIHRYID0gKHRNYXQuY29sMS54ICogcjJYICsgdE1hdC5jb2wyLnggKiByMlkpO1xuICAgICAgcjJZID0gKHRNYXQuY29sMS55ICogcjJYICsgdE1hdC5jb2wyLnkgKiByMlkpO1xuICAgICAgcjJYID0gdFg7XG4gICAgICB2YXIgbTEgPSBiQS5tX2ludk1hc3M7XG4gICAgICB2YXIgbTIgPSBiQi5tX2ludk1hc3M7XG4gICAgICB2YXIgaTEgPSBiQS5tX2ludkk7XG4gICAgICB2YXIgaTIgPSBiQi5tX2ludkk7XG4gICAgICB0aGlzLm1fbWFzcy5jb2wxLnggPSBtMSArIG0yICsgcjFZICogcjFZICogaTEgKyByMlkgKiByMlkgKiBpMjtcbiAgICAgIHRoaXMubV9tYXNzLmNvbDIueCA9ICgtcjFZICogcjFYICogaTEpIC0gcjJZICogcjJYICogaTI7XG4gICAgICB0aGlzLm1fbWFzcy5jb2wzLnggPSAoLXIxWSAqIGkxKSAtIHIyWSAqIGkyO1xuICAgICAgdGhpcy5tX21hc3MuY29sMS55ID0gdGhpcy5tX21hc3MuY29sMi54O1xuICAgICAgdGhpcy5tX21hc3MuY29sMi55ID0gbTEgKyBtMiArIHIxWCAqIHIxWCAqIGkxICsgcjJYICogcjJYICogaTI7XG4gICAgICB0aGlzLm1fbWFzcy5jb2wzLnkgPSByMVggKiBpMSArIHIyWCAqIGkyO1xuICAgICAgdGhpcy5tX21hc3MuY29sMS56ID0gdGhpcy5tX21hc3MuY29sMy54O1xuICAgICAgdGhpcy5tX21hc3MuY29sMi56ID0gdGhpcy5tX21hc3MuY29sMy55O1xuICAgICAgdGhpcy5tX21hc3MuY29sMy56ID0gaTEgKyBpMjtcbiAgICAgIHRoaXMubV9tb3Rvck1hc3MgPSAxLjAgLyAoaTEgKyBpMik7XG4gICAgICBpZiAodGhpcy5tX2VuYWJsZU1vdG9yID09IGZhbHNlKSB7XG4gICAgICAgICB0aGlzLm1fbW90b3JJbXB1bHNlID0gMC4wO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMubV9lbmFibGVMaW1pdCkge1xuICAgICAgICAgdmFyIGpvaW50QW5nbGUgPSBiQi5tX3N3ZWVwLmEgLSBiQS5tX3N3ZWVwLmEgLSB0aGlzLm1fcmVmZXJlbmNlQW5nbGU7XG4gICAgICAgICBpZiAoYjJNYXRoLkFicyh0aGlzLm1fdXBwZXJBbmdsZSAtIHRoaXMubV9sb3dlckFuZ2xlKSA8IDIuMCAqIGIyU2V0dGluZ3MuYjJfYW5ndWxhclNsb3ApIHtcbiAgICAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gYjJKb2ludC5lX2VxdWFsTGltaXRzO1xuICAgICAgICAgfVxuICAgICAgICAgZWxzZSBpZiAoam9pbnRBbmdsZSA8PSB0aGlzLm1fbG93ZXJBbmdsZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMubV9saW1pdFN0YXRlICE9IGIySm9pbnQuZV9hdExvd2VyTGltaXQpIHtcbiAgICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSAwLjA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZSA9IGIySm9pbnQuZV9hdExvd2VyTGltaXQ7XG4gICAgICAgICB9XG4gICAgICAgICBlbHNlIGlmIChqb2ludEFuZ2xlID49IHRoaXMubV91cHBlckFuZ2xlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5tX2xpbWl0U3RhdGUgIT0gYjJKb2ludC5lX2F0VXBwZXJMaW1pdCkge1xuICAgICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiA9IDAuMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gYjJKb2ludC5lX2F0VXBwZXJMaW1pdDtcbiAgICAgICAgIH1cbiAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBiMkpvaW50LmVfaW5hY3RpdmVMaW1pdDtcbiAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSAwLjA7XG4gICAgICAgICB9XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gYjJKb2ludC5lX2luYWN0aXZlTGltaXQ7XG4gICAgICB9XG4gICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcbiAgICAgICAgIHRoaXMubV9pbXB1bHNlLnggKj0gc3RlcC5kdFJhdGlvO1xuICAgICAgICAgdGhpcy5tX2ltcHVsc2UueSAqPSBzdGVwLmR0UmF0aW87XG4gICAgICAgICB0aGlzLm1fbW90b3JJbXB1bHNlICo9IHN0ZXAuZHRSYXRpbztcbiAgICAgICAgIHZhciBQWCA9IHRoaXMubV9pbXB1bHNlLng7XG4gICAgICAgICB2YXIgUFkgPSB0aGlzLm1faW1wdWxzZS55O1xuICAgICAgICAgYkEubV9saW5lYXJWZWxvY2l0eS54IC09IG0xICogUFg7XG4gICAgICAgICBiQS5tX2xpbmVhclZlbG9jaXR5LnkgLT0gbTEgKiBQWTtcbiAgICAgICAgIGJBLm1fYW5ndWxhclZlbG9jaXR5IC09IGkxICogKChyMVggKiBQWSAtIHIxWSAqIFBYKSArIHRoaXMubV9tb3RvckltcHVsc2UgKyB0aGlzLm1faW1wdWxzZS56KTtcbiAgICAgICAgIGJCLm1fbGluZWFyVmVsb2NpdHkueCArPSBtMiAqIFBYO1xuICAgICAgICAgYkIubV9saW5lYXJWZWxvY2l0eS55ICs9IG0yICogUFk7XG4gICAgICAgICBiQi5tX2FuZ3VsYXJWZWxvY2l0eSArPSBpMiAqICgocjJYICogUFkgLSByMlkgKiBQWCkgKyB0aGlzLm1fbW90b3JJbXB1bHNlICsgdGhpcy5tX2ltcHVsc2Uueik7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgIHRoaXMubV9pbXB1bHNlLlNldFplcm8oKTtcbiAgICAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgPSAwLjA7XG4gICAgICB9XG4gICB9XG4gICBiMlJldm9sdXRlSm9pbnQucHJvdG90eXBlLlNvbHZlVmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uIChzdGVwKSB7XG4gICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XG4gICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XG4gICAgICB2YXIgdE1hdDtcbiAgICAgIHZhciB0WCA9IDA7XG4gICAgICB2YXIgbmV3SW1wdWxzZSA9IDA7XG4gICAgICB2YXIgcjFYID0gMDtcbiAgICAgIHZhciByMVkgPSAwO1xuICAgICAgdmFyIHIyWCA9IDA7XG4gICAgICB2YXIgcjJZID0gMDtcbiAgICAgIHZhciB2MSA9IGJBLm1fbGluZWFyVmVsb2NpdHk7XG4gICAgICB2YXIgdzEgPSBiQS5tX2FuZ3VsYXJWZWxvY2l0eTtcbiAgICAgIHZhciB2MiA9IGJCLm1fbGluZWFyVmVsb2NpdHk7XG4gICAgICB2YXIgdzIgPSBiQi5tX2FuZ3VsYXJWZWxvY2l0eTtcbiAgICAgIHZhciBtMSA9IGJBLm1faW52TWFzcztcbiAgICAgIHZhciBtMiA9IGJCLm1faW52TWFzcztcbiAgICAgIHZhciBpMSA9IGJBLm1faW52STtcbiAgICAgIHZhciBpMiA9IGJCLm1faW52STtcbiAgICAgIGlmICh0aGlzLm1fZW5hYmxlTW90b3IgJiYgdGhpcy5tX2xpbWl0U3RhdGUgIT0gYjJKb2ludC5lX2VxdWFsTGltaXRzKSB7XG4gICAgICAgICB2YXIgQ2RvdCA9IHcyIC0gdzEgLSB0aGlzLm1fbW90b3JTcGVlZDtcbiAgICAgICAgIHZhciBpbXB1bHNlID0gdGhpcy5tX21vdG9yTWFzcyAqICgoLUNkb3QpKTtcbiAgICAgICAgIHZhciBvbGRJbXB1bHNlID0gdGhpcy5tX21vdG9ySW1wdWxzZTtcbiAgICAgICAgIHZhciBtYXhJbXB1bHNlID0gc3RlcC5kdCAqIHRoaXMubV9tYXhNb3RvclRvcnF1ZTtcbiAgICAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgPSBiMk1hdGguQ2xhbXAodGhpcy5tX21vdG9ySW1wdWxzZSArIGltcHVsc2UsICgtbWF4SW1wdWxzZSksIG1heEltcHVsc2UpO1xuICAgICAgICAgaW1wdWxzZSA9IHRoaXMubV9tb3RvckltcHVsc2UgLSBvbGRJbXB1bHNlO1xuICAgICAgICAgdzEgLT0gaTEgKiBpbXB1bHNlO1xuICAgICAgICAgdzIgKz0gaTIgKiBpbXB1bHNlO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMubV9lbmFibGVMaW1pdCAmJiB0aGlzLm1fbGltaXRTdGF0ZSAhPSBiMkpvaW50LmVfaW5hY3RpdmVMaW1pdCkge1xuICAgICAgICAgdE1hdCA9IGJBLm1feGYuUjtcbiAgICAgICAgIHIxWCA9IHRoaXMubV9sb2NhbEFuY2hvcjEueCAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcbiAgICAgICAgIHIxWSA9IHRoaXMubV9sb2NhbEFuY2hvcjEueSAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcbiAgICAgICAgIHRYID0gKHRNYXQuY29sMS54ICogcjFYICsgdE1hdC5jb2wyLnggKiByMVkpO1xuICAgICAgICAgcjFZID0gKHRNYXQuY29sMS55ICogcjFYICsgdE1hdC5jb2wyLnkgKiByMVkpO1xuICAgICAgICAgcjFYID0gdFg7XG4gICAgICAgICB0TWF0ID0gYkIubV94Zi5SO1xuICAgICAgICAgcjJYID0gdGhpcy5tX2xvY2FsQW5jaG9yMi54IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci54O1xuICAgICAgICAgcjJZID0gdGhpcy5tX2xvY2FsQW5jaG9yMi55IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci55O1xuICAgICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByMlggKyB0TWF0LmNvbDIueCAqIHIyWSk7XG4gICAgICAgICByMlkgPSAodE1hdC5jb2wxLnkgKiByMlggKyB0TWF0LmNvbDIueSAqIHIyWSk7XG4gICAgICAgICByMlggPSB0WDtcbiAgICAgICAgIHZhciBDZG90MVggPSB2Mi54ICsgKCgtdzIgKiByMlkpKSAtIHYxLnggLSAoKC13MSAqIHIxWSkpO1xuICAgICAgICAgdmFyIENkb3QxWSA9IHYyLnkgKyAodzIgKiByMlgpIC0gdjEueSAtICh3MSAqIHIxWCk7XG4gICAgICAgICB2YXIgQ2RvdDIgPSB3MiAtIHcxO1xuICAgICAgICAgdGhpcy5tX21hc3MuU29sdmUzMyh0aGlzLmltcHVsc2UzLCAoLUNkb3QxWCksICgtQ2RvdDFZKSwgKC1DZG90MikpO1xuICAgICAgICAgaWYgKHRoaXMubV9saW1pdFN0YXRlID09IGIySm9pbnQuZV9lcXVhbExpbWl0cykge1xuICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UuQWRkKHRoaXMuaW1wdWxzZTMpO1xuICAgICAgICAgfVxuICAgICAgICAgZWxzZSBpZiAodGhpcy5tX2xpbWl0U3RhdGUgPT0gYjJKb2ludC5lX2F0TG93ZXJMaW1pdCkge1xuICAgICAgICAgICAgbmV3SW1wdWxzZSA9IHRoaXMubV9pbXB1bHNlLnogKyB0aGlzLmltcHVsc2UzLno7XG4gICAgICAgICAgICBpZiAobmV3SW1wdWxzZSA8IDAuMCkge1xuICAgICAgICAgICAgICAgdGhpcy5tX21hc3MuU29sdmUyMih0aGlzLnJlZHVjZWQsICgtQ2RvdDFYKSwgKC1DZG90MVkpKTtcbiAgICAgICAgICAgICAgIHRoaXMuaW1wdWxzZTMueCA9IHRoaXMucmVkdWNlZC54O1xuICAgICAgICAgICAgICAgdGhpcy5pbXB1bHNlMy55ID0gdGhpcy5yZWR1Y2VkLnk7XG4gICAgICAgICAgICAgICB0aGlzLmltcHVsc2UzLnogPSAoLXRoaXMubV9pbXB1bHNlLnopO1xuICAgICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueCArPSB0aGlzLnJlZHVjZWQueDtcbiAgICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgKz0gdGhpcy5yZWR1Y2VkLnk7XG4gICAgICAgICAgICAgICB0aGlzLm1faW1wdWxzZS56ID0gMC4wO1xuICAgICAgICAgICAgfVxuICAgICAgICAgfVxuICAgICAgICAgZWxzZSBpZiAodGhpcy5tX2xpbWl0U3RhdGUgPT0gYjJKb2ludC5lX2F0VXBwZXJMaW1pdCkge1xuICAgICAgICAgICAgbmV3SW1wdWxzZSA9IHRoaXMubV9pbXB1bHNlLnogKyB0aGlzLmltcHVsc2UzLno7XG4gICAgICAgICAgICBpZiAobmV3SW1wdWxzZSA+IDAuMCkge1xuICAgICAgICAgICAgICAgdGhpcy5tX21hc3MuU29sdmUyMih0aGlzLnJlZHVjZWQsICgtQ2RvdDFYKSwgKC1DZG90MVkpKTtcbiAgICAgICAgICAgICAgIHRoaXMuaW1wdWxzZTMueCA9IHRoaXMucmVkdWNlZC54O1xuICAgICAgICAgICAgICAgdGhpcy5pbXB1bHNlMy55ID0gdGhpcy5yZWR1Y2VkLnk7XG4gICAgICAgICAgICAgICB0aGlzLmltcHVsc2UzLnogPSAoLXRoaXMubV9pbXB1bHNlLnopO1xuICAgICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueCArPSB0aGlzLnJlZHVjZWQueDtcbiAgICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgKz0gdGhpcy5yZWR1Y2VkLnk7XG4gICAgICAgICAgICAgICB0aGlzLm1faW1wdWxzZS56ID0gMC4wO1xuICAgICAgICAgICAgfVxuICAgICAgICAgfVxuICAgICAgICAgdjEueCAtPSBtMSAqIHRoaXMuaW1wdWxzZTMueDtcbiAgICAgICAgIHYxLnkgLT0gbTEgKiB0aGlzLmltcHVsc2UzLnk7XG4gICAgICAgICB3MSAtPSBpMSAqIChyMVggKiB0aGlzLmltcHVsc2UzLnkgLSByMVkgKiB0aGlzLmltcHVsc2UzLnggKyB0aGlzLmltcHVsc2UzLnopO1xuICAgICAgICAgdjIueCArPSBtMiAqIHRoaXMuaW1wdWxzZTMueDtcbiAgICAgICAgIHYyLnkgKz0gbTIgKiB0aGlzLmltcHVsc2UzLnk7XG4gICAgICAgICB3MiArPSBpMiAqIChyMlggKiB0aGlzLmltcHVsc2UzLnkgLSByMlkgKiB0aGlzLmltcHVsc2UzLnggKyB0aGlzLmltcHVsc2UzLnopO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgICB0TWF0ID0gYkEubV94Zi5SO1xuICAgICAgICAgcjFYID0gdGhpcy5tX2xvY2FsQW5jaG9yMS54IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci54O1xuICAgICAgICAgcjFZID0gdGhpcy5tX2xvY2FsQW5jaG9yMS55IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci55O1xuICAgICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByMVggKyB0TWF0LmNvbDIueCAqIHIxWSk7XG4gICAgICAgICByMVkgPSAodE1hdC5jb2wxLnkgKiByMVggKyB0TWF0LmNvbDIueSAqIHIxWSk7XG4gICAgICAgICByMVggPSB0WDtcbiAgICAgICAgIHRNYXQgPSBiQi5tX3hmLlI7XG4gICAgICAgICByMlggPSB0aGlzLm1fbG9jYWxBbmNob3IyLnggLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XG4gICAgICAgICByMlkgPSB0aGlzLm1fbG9jYWxBbmNob3IyLnkgLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XG4gICAgICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHIyWCArIHRNYXQuY29sMi54ICogcjJZKTtcbiAgICAgICAgIHIyWSA9ICh0TWF0LmNvbDEueSAqIHIyWCArIHRNYXQuY29sMi55ICogcjJZKTtcbiAgICAgICAgIHIyWCA9IHRYO1xuICAgICAgICAgdmFyIENkb3RYID0gdjIueCArICgoLXcyICogcjJZKSkgLSB2MS54IC0gKCgtdzEgKiByMVkpKTtcbiAgICAgICAgIHZhciBDZG90WSA9IHYyLnkgKyAodzIgKiByMlgpIC0gdjEueSAtICh3MSAqIHIxWCk7XG4gICAgICAgICB0aGlzLm1fbWFzcy5Tb2x2ZTIyKHRoaXMuaW1wdWxzZTIsICgtQ2RvdFgpLCAoLUNkb3RZKSk7XG4gICAgICAgICB0aGlzLm1faW1wdWxzZS54ICs9IHRoaXMuaW1wdWxzZTIueDtcbiAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgKz0gdGhpcy5pbXB1bHNlMi55O1xuICAgICAgICAgdjEueCAtPSBtMSAqIHRoaXMuaW1wdWxzZTIueDtcbiAgICAgICAgIHYxLnkgLT0gbTEgKiB0aGlzLmltcHVsc2UyLnk7XG4gICAgICAgICB3MSAtPSBpMSAqIChyMVggKiB0aGlzLmltcHVsc2UyLnkgLSByMVkgKiB0aGlzLmltcHVsc2UyLngpO1xuICAgICAgICAgdjIueCArPSBtMiAqIHRoaXMuaW1wdWxzZTIueDtcbiAgICAgICAgIHYyLnkgKz0gbTIgKiB0aGlzLmltcHVsc2UyLnk7XG4gICAgICAgICB3MiArPSBpMiAqIChyMlggKiB0aGlzLmltcHVsc2UyLnkgLSByMlkgKiB0aGlzLmltcHVsc2UyLngpO1xuICAgICAgfVxuICAgICAgYkEubV9saW5lYXJWZWxvY2l0eS5TZXRWKHYxKTtcbiAgICAgIGJBLm1fYW5ndWxhclZlbG9jaXR5ID0gdzE7XG4gICAgICBiQi5tX2xpbmVhclZlbG9jaXR5LlNldFYodjIpO1xuICAgICAgYkIubV9hbmd1bGFyVmVsb2NpdHkgPSB3MjtcbiAgIH1cbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuU29sdmVQb3NpdGlvbkNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKGJhdW1nYXJ0ZSkge1xuICAgICAgaWYgKGJhdW1nYXJ0ZSA9PT0gdW5kZWZpbmVkKSBiYXVtZ2FydGUgPSAwO1xuICAgICAgdmFyIG9sZExpbWl0SW1wdWxzZSA9IDA7XG4gICAgICB2YXIgQyA9IDA7XG4gICAgICB2YXIgdE1hdDtcbiAgICAgIHZhciBiQSA9IHRoaXMubV9ib2R5QTtcbiAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcbiAgICAgIHZhciBhbmd1bGFyRXJyb3IgPSAwLjA7XG4gICAgICB2YXIgcG9zaXRpb25FcnJvciA9IDAuMDtcbiAgICAgIHZhciB0WCA9IDA7XG4gICAgICB2YXIgaW1wdWxzZVggPSAwO1xuICAgICAgdmFyIGltcHVsc2VZID0gMDtcbiAgICAgIGlmICh0aGlzLm1fZW5hYmxlTGltaXQgJiYgdGhpcy5tX2xpbWl0U3RhdGUgIT0gYjJKb2ludC5lX2luYWN0aXZlTGltaXQpIHtcbiAgICAgICAgIHZhciBhbmdsZSA9IGJCLm1fc3dlZXAuYSAtIGJBLm1fc3dlZXAuYSAtIHRoaXMubV9yZWZlcmVuY2VBbmdsZTtcbiAgICAgICAgIHZhciBsaW1pdEltcHVsc2UgPSAwLjA7XG4gICAgICAgICBpZiAodGhpcy5tX2xpbWl0U3RhdGUgPT0gYjJKb2ludC5lX2VxdWFsTGltaXRzKSB7XG4gICAgICAgICAgICBDID0gYjJNYXRoLkNsYW1wKGFuZ2xlIC0gdGhpcy5tX2xvd2VyQW5nbGUsICgtYjJTZXR0aW5ncy5iMl9tYXhBbmd1bGFyQ29ycmVjdGlvbiksIGIyU2V0dGluZ3MuYjJfbWF4QW5ndWxhckNvcnJlY3Rpb24pO1xuICAgICAgICAgICAgbGltaXRJbXB1bHNlID0gKC10aGlzLm1fbW90b3JNYXNzICogQyk7XG4gICAgICAgICAgICBhbmd1bGFyRXJyb3IgPSBiMk1hdGguQWJzKEMpO1xuICAgICAgICAgfVxuICAgICAgICAgZWxzZSBpZiAodGhpcy5tX2xpbWl0U3RhdGUgPT0gYjJKb2ludC5lX2F0TG93ZXJMaW1pdCkge1xuICAgICAgICAgICAgQyA9IGFuZ2xlIC0gdGhpcy5tX2xvd2VyQW5nbGU7XG4gICAgICAgICAgICBhbmd1bGFyRXJyb3IgPSAoLUMpO1xuICAgICAgICAgICAgQyA9IGIyTWF0aC5DbGFtcChDICsgYjJTZXR0aW5ncy5iMl9hbmd1bGFyU2xvcCwgKC1iMlNldHRpbmdzLmIyX21heEFuZ3VsYXJDb3JyZWN0aW9uKSwgMC4wKTtcbiAgICAgICAgICAgIGxpbWl0SW1wdWxzZSA9ICgtdGhpcy5tX21vdG9yTWFzcyAqIEMpO1xuICAgICAgICAgfVxuICAgICAgICAgZWxzZSBpZiAodGhpcy5tX2xpbWl0U3RhdGUgPT0gYjJKb2ludC5lX2F0VXBwZXJMaW1pdCkge1xuICAgICAgICAgICAgQyA9IGFuZ2xlIC0gdGhpcy5tX3VwcGVyQW5nbGU7XG4gICAgICAgICAgICBhbmd1bGFyRXJyb3IgPSBDO1xuICAgICAgICAgICAgQyA9IGIyTWF0aC5DbGFtcChDIC0gYjJTZXR0aW5ncy5iMl9hbmd1bGFyU2xvcCwgMC4wLCBiMlNldHRpbmdzLmIyX21heEFuZ3VsYXJDb3JyZWN0aW9uKTtcbiAgICAgICAgICAgIGxpbWl0SW1wdWxzZSA9ICgtdGhpcy5tX21vdG9yTWFzcyAqIEMpO1xuICAgICAgICAgfVxuICAgICAgICAgYkEubV9zd2VlcC5hIC09IGJBLm1faW52SSAqIGxpbWl0SW1wdWxzZTtcbiAgICAgICAgIGJCLm1fc3dlZXAuYSArPSBiQi5tX2ludkkgKiBsaW1pdEltcHVsc2U7XG4gICAgICAgICBiQS5TeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xuICAgICAgICAgYkIuU3luY2hyb25pemVUcmFuc2Zvcm0oKTtcbiAgICAgIH0ge1xuICAgICAgICAgdE1hdCA9IGJBLm1feGYuUjtcbiAgICAgICAgIHZhciByMVggPSB0aGlzLm1fbG9jYWxBbmNob3IxLnggLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XG4gICAgICAgICB2YXIgcjFZID0gdGhpcy5tX2xvY2FsQW5jaG9yMS55IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci55O1xuICAgICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByMVggKyB0TWF0LmNvbDIueCAqIHIxWSk7XG4gICAgICAgICByMVkgPSAodE1hdC5jb2wxLnkgKiByMVggKyB0TWF0LmNvbDIueSAqIHIxWSk7XG4gICAgICAgICByMVggPSB0WDtcbiAgICAgICAgIHRNYXQgPSBiQi5tX3hmLlI7XG4gICAgICAgICB2YXIgcjJYID0gdGhpcy5tX2xvY2FsQW5jaG9yMi54IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci54O1xuICAgICAgICAgdmFyIHIyWSA9IHRoaXMubV9sb2NhbEFuY2hvcjIueSAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcbiAgICAgICAgIHRYID0gKHRNYXQuY29sMS54ICogcjJYICsgdE1hdC5jb2wyLnggKiByMlkpO1xuICAgICAgICAgcjJZID0gKHRNYXQuY29sMS55ICogcjJYICsgdE1hdC5jb2wyLnkgKiByMlkpO1xuICAgICAgICAgcjJYID0gdFg7XG4gICAgICAgICB2YXIgQ1ggPSBiQi5tX3N3ZWVwLmMueCArIHIyWCAtIGJBLm1fc3dlZXAuYy54IC0gcjFYO1xuICAgICAgICAgdmFyIENZID0gYkIubV9zd2VlcC5jLnkgKyByMlkgLSBiQS5tX3N3ZWVwLmMueSAtIHIxWTtcbiAgICAgICAgIHZhciBDTGVuZ3RoU3F1YXJlZCA9IENYICogQ1ggKyBDWSAqIENZO1xuICAgICAgICAgdmFyIENMZW5ndGggPSBNYXRoLnNxcnQoQ0xlbmd0aFNxdWFyZWQpO1xuICAgICAgICAgcG9zaXRpb25FcnJvciA9IENMZW5ndGg7XG4gICAgICAgICB2YXIgaW52TWFzczEgPSBiQS5tX2ludk1hc3M7XG4gICAgICAgICB2YXIgaW52TWFzczIgPSBiQi5tX2ludk1hc3M7XG4gICAgICAgICB2YXIgaW52STEgPSBiQS5tX2ludkk7XG4gICAgICAgICB2YXIgaW52STIgPSBiQi5tX2ludkk7XG4gICAgICAgICB2YXIga19hbGxvd2VkU3RyZXRjaCA9IDEwLjAgKiBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3A7XG4gICAgICAgICBpZiAoQ0xlbmd0aFNxdWFyZWQgPiBrX2FsbG93ZWRTdHJldGNoICoga19hbGxvd2VkU3RyZXRjaCkge1xuICAgICAgICAgICAgdmFyIHVYID0gQ1ggLyBDTGVuZ3RoO1xuICAgICAgICAgICAgdmFyIHVZID0gQ1kgLyBDTGVuZ3RoO1xuICAgICAgICAgICAgdmFyIGsgPSBpbnZNYXNzMSArIGludk1hc3MyO1xuICAgICAgICAgICAgdmFyIG0gPSAxLjAgLyBrO1xuICAgICAgICAgICAgaW1wdWxzZVggPSBtICogKCgtQ1gpKTtcbiAgICAgICAgICAgIGltcHVsc2VZID0gbSAqICgoLUNZKSk7XG4gICAgICAgICAgICB2YXIga19iZXRhID0gMC41O1xuICAgICAgICAgICAgYkEubV9zd2VlcC5jLnggLT0ga19iZXRhICogaW52TWFzczEgKiBpbXB1bHNlWDtcbiAgICAgICAgICAgIGJBLm1fc3dlZXAuYy55IC09IGtfYmV0YSAqIGludk1hc3MxICogaW1wdWxzZVk7XG4gICAgICAgICAgICBiQi5tX3N3ZWVwLmMueCArPSBrX2JldGEgKiBpbnZNYXNzMiAqIGltcHVsc2VYO1xuICAgICAgICAgICAgYkIubV9zd2VlcC5jLnkgKz0ga19iZXRhICogaW52TWFzczIgKiBpbXB1bHNlWTtcbiAgICAgICAgICAgIENYID0gYkIubV9zd2VlcC5jLnggKyByMlggLSBiQS5tX3N3ZWVwLmMueCAtIHIxWDtcbiAgICAgICAgICAgIENZID0gYkIubV9zd2VlcC5jLnkgKyByMlkgLSBiQS5tX3N3ZWVwLmMueSAtIHIxWTtcbiAgICAgICAgIH1cbiAgICAgICAgIHRoaXMuSzEuY29sMS54ID0gaW52TWFzczEgKyBpbnZNYXNzMjtcbiAgICAgICAgIHRoaXMuSzEuY29sMi54ID0gMC4wO1xuICAgICAgICAgdGhpcy5LMS5jb2wxLnkgPSAwLjA7XG4gICAgICAgICB0aGlzLksxLmNvbDIueSA9IGludk1hc3MxICsgaW52TWFzczI7XG4gICAgICAgICB0aGlzLksyLmNvbDEueCA9IGludkkxICogcjFZICogcjFZO1xuICAgICAgICAgdGhpcy5LMi5jb2wyLnggPSAoLWludkkxICogcjFYICogcjFZKTtcbiAgICAgICAgIHRoaXMuSzIuY29sMS55ID0gKC1pbnZJMSAqIHIxWCAqIHIxWSk7XG4gICAgICAgICB0aGlzLksyLmNvbDIueSA9IGludkkxICogcjFYICogcjFYO1xuICAgICAgICAgdGhpcy5LMy5jb2wxLnggPSBpbnZJMiAqIHIyWSAqIHIyWTtcbiAgICAgICAgIHRoaXMuSzMuY29sMi54ID0gKC1pbnZJMiAqIHIyWCAqIHIyWSk7XG4gICAgICAgICB0aGlzLkszLmNvbDEueSA9ICgtaW52STIgKiByMlggKiByMlkpO1xuICAgICAgICAgdGhpcy5LMy5jb2wyLnkgPSBpbnZJMiAqIHIyWCAqIHIyWDtcbiAgICAgICAgIHRoaXMuSy5TZXRNKHRoaXMuSzEpO1xuICAgICAgICAgdGhpcy5LLkFkZE0odGhpcy5LMik7XG4gICAgICAgICB0aGlzLksuQWRkTSh0aGlzLkszKTtcbiAgICAgICAgIHRoaXMuSy5Tb2x2ZShiMlJldm9sdXRlSm9pbnQudEltcHVsc2UsICgtQ1gpLCAoLUNZKSk7XG4gICAgICAgICBpbXB1bHNlWCA9IGIyUmV2b2x1dGVKb2ludC50SW1wdWxzZS54O1xuICAgICAgICAgaW1wdWxzZVkgPSBiMlJldm9sdXRlSm9pbnQudEltcHVsc2UueTtcbiAgICAgICAgIGJBLm1fc3dlZXAuYy54IC09IGJBLm1faW52TWFzcyAqIGltcHVsc2VYO1xuICAgICAgICAgYkEubV9zd2VlcC5jLnkgLT0gYkEubV9pbnZNYXNzICogaW1wdWxzZVk7XG4gICAgICAgICBiQS5tX3N3ZWVwLmEgLT0gYkEubV9pbnZJICogKHIxWCAqIGltcHVsc2VZIC0gcjFZICogaW1wdWxzZVgpO1xuICAgICAgICAgYkIubV9zd2VlcC5jLnggKz0gYkIubV9pbnZNYXNzICogaW1wdWxzZVg7XG4gICAgICAgICBiQi5tX3N3ZWVwLmMueSArPSBiQi5tX2ludk1hc3MgKiBpbXB1bHNlWTtcbiAgICAgICAgIGJCLm1fc3dlZXAuYSArPSBiQi5tX2ludkkgKiAocjJYICogaW1wdWxzZVkgLSByMlkgKiBpbXB1bHNlWCk7XG4gICAgICAgICBiQS5TeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xuICAgICAgICAgYkIuU3luY2hyb25pemVUcmFuc2Zvcm0oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBwb3NpdGlvbkVycm9yIDw9IGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCAmJiBhbmd1bGFyRXJyb3IgPD0gYjJTZXR0aW5ncy5iMl9hbmd1bGFyU2xvcDtcbiAgIH1cbiAgIEJveDJELnBvc3REZWZzLnB1c2goZnVuY3Rpb24gKCkge1xuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyUmV2b2x1dGVKb2ludC50SW1wdWxzZSA9IG5ldyBiMlZlYzIoKTtcbiAgIH0pO1xuICAgQm94MkQuaW5oZXJpdChiMlJldm9sdXRlSm9pbnREZWYsIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmKTtcbiAgIGIyUmV2b2x1dGVKb2ludERlZi5wcm90b3R5cGUuX19zdXBlciA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmLnByb3RvdHlwZTtcbiAgIGIyUmV2b2x1dGVKb2ludERlZi5iMlJldm9sdXRlSm9pbnREZWYgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZi5iMkpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQSA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIHRoaXMubG9jYWxBbmNob3JCID0gbmV3IGIyVmVjMigpO1xuICAgfTtcbiAgIGIyUmV2b2x1dGVKb2ludERlZi5wcm90b3R5cGUuYjJSZXZvbHV0ZUpvaW50RGVmID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5fX3N1cGVyLmIySm9pbnREZWYuY2FsbCh0aGlzKTtcbiAgICAgIHRoaXMudHlwZSA9IGIySm9pbnQuZV9yZXZvbHV0ZUpvaW50O1xuICAgICAgdGhpcy5sb2NhbEFuY2hvckEuU2V0KDAuMCwgMC4wKTtcbiAgICAgIHRoaXMubG9jYWxBbmNob3JCLlNldCgwLjAsIDAuMCk7XG4gICAgICB0aGlzLnJlZmVyZW5jZUFuZ2xlID0gMC4wO1xuICAgICAgdGhpcy5sb3dlckFuZ2xlID0gMC4wO1xuICAgICAgdGhpcy51cHBlckFuZ2xlID0gMC4wO1xuICAgICAgdGhpcy5tYXhNb3RvclRvcnF1ZSA9IDAuMDtcbiAgICAgIHRoaXMubW90b3JTcGVlZCA9IDAuMDtcbiAgICAgIHRoaXMuZW5hYmxlTGltaXQgPSBmYWxzZTtcbiAgICAgIHRoaXMuZW5hYmxlTW90b3IgPSBmYWxzZTtcbiAgIH1cbiAgIGIyUmV2b2x1dGVKb2ludERlZi5wcm90b3R5cGUuSW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIChiQSwgYkIsIGFuY2hvcikge1xuICAgICAgdGhpcy5ib2R5QSA9IGJBO1xuICAgICAgdGhpcy5ib2R5QiA9IGJCO1xuICAgICAgdGhpcy5sb2NhbEFuY2hvckEgPSB0aGlzLmJvZHlBLkdldExvY2FsUG9pbnQoYW5jaG9yKTtcbiAgICAgIHRoaXMubG9jYWxBbmNob3JCID0gdGhpcy5ib2R5Qi5HZXRMb2NhbFBvaW50KGFuY2hvcik7XG4gICAgICB0aGlzLnJlZmVyZW5jZUFuZ2xlID0gdGhpcy5ib2R5Qi5HZXRBbmdsZSgpIC0gdGhpcy5ib2R5QS5HZXRBbmdsZSgpO1xuICAgfVxuICAgQm94MkQuaW5oZXJpdChiMldlbGRKb2ludCwgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQpO1xuICAgYjJXZWxkSm9pbnQucHJvdG90eXBlLl9fc3VwZXIgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5wcm90b3R5cGU7XG4gICBiMldlbGRKb2ludC5iMldlbGRKb2ludCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50LmIySm9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvckEgPSBuZXcgYjJWZWMyKCk7XG4gICAgICB0aGlzLm1fbG9jYWxBbmNob3JCID0gbmV3IGIyVmVjMigpO1xuICAgICAgdGhpcy5tX2ltcHVsc2UgPSBuZXcgYjJWZWMzKCk7XG4gICAgICB0aGlzLm1fbWFzcyA9IG5ldyBiMk1hdDMzKCk7XG4gICB9O1xuICAgYjJXZWxkSm9pbnQucHJvdG90eXBlLkdldEFuY2hvckEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlBLkdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQSk7XG4gICB9XG4gICBiMldlbGRKb2ludC5wcm90b3R5cGUuR2V0QW5jaG9yQiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fYm9keUIuR2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JCKTtcbiAgIH1cbiAgIGIyV2VsZEpvaW50LnByb3RvdHlwZS5HZXRSZWFjdGlvbkZvcmNlID0gZnVuY3Rpb24gKGludl9kdCkge1xuICAgICAgaWYgKGludl9kdCA9PT0gdW5kZWZpbmVkKSBpbnZfZHQgPSAwO1xuICAgICAgcmV0dXJuIG5ldyBiMlZlYzIoaW52X2R0ICogdGhpcy5tX2ltcHVsc2UueCwgaW52X2R0ICogdGhpcy5tX2ltcHVsc2UueSk7XG4gICB9XG4gICBiMldlbGRKb2ludC5wcm90b3R5cGUuR2V0UmVhY3Rpb25Ub3JxdWUgPSBmdW5jdGlvbiAoaW52X2R0KSB7XG4gICAgICBpZiAoaW52X2R0ID09PSB1bmRlZmluZWQpIGludl9kdCA9IDA7XG4gICAgICByZXR1cm4gaW52X2R0ICogdGhpcy5tX2ltcHVsc2UuejtcbiAgIH1cbiAgIGIyV2VsZEpvaW50LnByb3RvdHlwZS5iMldlbGRKb2ludCA9IGZ1bmN0aW9uIChkZWYpIHtcbiAgICAgIHRoaXMuX19zdXBlci5iMkpvaW50LmNhbGwodGhpcywgZGVmKTtcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvckEuU2V0VihkZWYubG9jYWxBbmNob3JBKTtcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvckIuU2V0VihkZWYubG9jYWxBbmNob3JCKTtcbiAgICAgIHRoaXMubV9yZWZlcmVuY2VBbmdsZSA9IGRlZi5yZWZlcmVuY2VBbmdsZTtcbiAgICAgIHRoaXMubV9pbXB1bHNlLlNldFplcm8oKTtcbiAgICAgIHRoaXMubV9tYXNzID0gbmV3IGIyTWF0MzMoKTtcbiAgIH1cbiAgIGIyV2VsZEpvaW50LnByb3RvdHlwZS5Jbml0VmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uIChzdGVwKSB7XG4gICAgICB2YXIgdE1hdDtcbiAgICAgIHZhciB0WCA9IDA7XG4gICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XG4gICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XG4gICAgICB0TWF0ID0gYkEubV94Zi5SO1xuICAgICAgdmFyIHJBWCA9IHRoaXMubV9sb2NhbEFuY2hvckEueCAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcbiAgICAgIHZhciByQVkgPSB0aGlzLm1fbG9jYWxBbmNob3JBLnkgLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XG4gICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHJBWCArIHRNYXQuY29sMi54ICogckFZKTtcbiAgICAgIHJBWSA9ICh0TWF0LmNvbDEueSAqIHJBWCArIHRNYXQuY29sMi55ICogckFZKTtcbiAgICAgIHJBWCA9IHRYO1xuICAgICAgdE1hdCA9IGJCLm1feGYuUjtcbiAgICAgIHZhciByQlggPSB0aGlzLm1fbG9jYWxBbmNob3JCLnggLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XG4gICAgICB2YXIgckJZID0gdGhpcy5tX2xvY2FsQW5jaG9yQi55IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci55O1xuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByQlggKyB0TWF0LmNvbDIueCAqIHJCWSk7XG4gICAgICByQlkgPSAodE1hdC5jb2wxLnkgKiByQlggKyB0TWF0LmNvbDIueSAqIHJCWSk7XG4gICAgICByQlggPSB0WDtcbiAgICAgIHZhciBtQSA9IGJBLm1faW52TWFzcztcbiAgICAgIHZhciBtQiA9IGJCLm1faW52TWFzcztcbiAgICAgIHZhciBpQSA9IGJBLm1faW52STtcbiAgICAgIHZhciBpQiA9IGJCLm1faW52STtcbiAgICAgIHRoaXMubV9tYXNzLmNvbDEueCA9IG1BICsgbUIgKyByQVkgKiByQVkgKiBpQSArIHJCWSAqIHJCWSAqIGlCO1xuICAgICAgdGhpcy5tX21hc3MuY29sMi54ID0gKC1yQVkgKiByQVggKiBpQSkgLSByQlkgKiByQlggKiBpQjtcbiAgICAgIHRoaXMubV9tYXNzLmNvbDMueCA9ICgtckFZICogaUEpIC0gckJZICogaUI7XG4gICAgICB0aGlzLm1fbWFzcy5jb2wxLnkgPSB0aGlzLm1fbWFzcy5jb2wyLng7XG4gICAgICB0aGlzLm1fbWFzcy5jb2wyLnkgPSBtQSArIG1CICsgckFYICogckFYICogaUEgKyByQlggKiByQlggKiBpQjtcbiAgICAgIHRoaXMubV9tYXNzLmNvbDMueSA9IHJBWCAqIGlBICsgckJYICogaUI7XG4gICAgICB0aGlzLm1fbWFzcy5jb2wxLnogPSB0aGlzLm1fbWFzcy5jb2wzLng7XG4gICAgICB0aGlzLm1fbWFzcy5jb2wyLnogPSB0aGlzLm1fbWFzcy5jb2wzLnk7XG4gICAgICB0aGlzLm1fbWFzcy5jb2wzLnogPSBpQSArIGlCO1xuICAgICAgaWYgKHN0ZXAud2FybVN0YXJ0aW5nKSB7XG4gICAgICAgICB0aGlzLm1faW1wdWxzZS54ICo9IHN0ZXAuZHRSYXRpbztcbiAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgKj0gc3RlcC5kdFJhdGlvO1xuICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiAqPSBzdGVwLmR0UmF0aW87XG4gICAgICAgICBiQS5tX2xpbmVhclZlbG9jaXR5LnggLT0gbUEgKiB0aGlzLm1faW1wdWxzZS54O1xuICAgICAgICAgYkEubV9saW5lYXJWZWxvY2l0eS55IC09IG1BICogdGhpcy5tX2ltcHVsc2UueTtcbiAgICAgICAgIGJBLm1fYW5ndWxhclZlbG9jaXR5IC09IGlBICogKHJBWCAqIHRoaXMubV9pbXB1bHNlLnkgLSByQVkgKiB0aGlzLm1faW1wdWxzZS54ICsgdGhpcy5tX2ltcHVsc2Uueik7XG4gICAgICAgICBiQi5tX2xpbmVhclZlbG9jaXR5LnggKz0gbUIgKiB0aGlzLm1faW1wdWxzZS54O1xuICAgICAgICAgYkIubV9saW5lYXJWZWxvY2l0eS55ICs9IG1CICogdGhpcy5tX2ltcHVsc2UueTtcbiAgICAgICAgIGJCLm1fYW5ndWxhclZlbG9jaXR5ICs9IGlCICogKHJCWCAqIHRoaXMubV9pbXB1bHNlLnkgLSByQlkgKiB0aGlzLm1faW1wdWxzZS54ICsgdGhpcy5tX2ltcHVsc2Uueik7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgIHRoaXMubV9pbXB1bHNlLlNldFplcm8oKTtcbiAgICAgIH1cbiAgIH1cbiAgIGIyV2VsZEpvaW50LnByb3RvdHlwZS5Tb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbiAoc3RlcCkge1xuICAgICAgdmFyIHRNYXQ7XG4gICAgICB2YXIgdFggPSAwO1xuICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xuICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xuICAgICAgdmFyIHZBID0gYkEubV9saW5lYXJWZWxvY2l0eTtcbiAgICAgIHZhciB3QSA9IGJBLm1fYW5ndWxhclZlbG9jaXR5O1xuICAgICAgdmFyIHZCID0gYkIubV9saW5lYXJWZWxvY2l0eTtcbiAgICAgIHZhciB3QiA9IGJCLm1fYW5ndWxhclZlbG9jaXR5O1xuICAgICAgdmFyIG1BID0gYkEubV9pbnZNYXNzO1xuICAgICAgdmFyIG1CID0gYkIubV9pbnZNYXNzO1xuICAgICAgdmFyIGlBID0gYkEubV9pbnZJO1xuICAgICAgdmFyIGlCID0gYkIubV9pbnZJO1xuICAgICAgdE1hdCA9IGJBLm1feGYuUjtcbiAgICAgIHZhciByQVggPSB0aGlzLm1fbG9jYWxBbmNob3JBLnggLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XG4gICAgICB2YXIgckFZID0gdGhpcy5tX2xvY2FsQW5jaG9yQS55IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci55O1xuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByQVggKyB0TWF0LmNvbDIueCAqIHJBWSk7XG4gICAgICByQVkgPSAodE1hdC5jb2wxLnkgKiByQVggKyB0TWF0LmNvbDIueSAqIHJBWSk7XG4gICAgICByQVggPSB0WDtcbiAgICAgIHRNYXQgPSBiQi5tX3hmLlI7XG4gICAgICB2YXIgckJYID0gdGhpcy5tX2xvY2FsQW5jaG9yQi54IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci54O1xuICAgICAgdmFyIHJCWSA9IHRoaXMubV9sb2NhbEFuY2hvckIueSAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcbiAgICAgIHRYID0gKHRNYXQuY29sMS54ICogckJYICsgdE1hdC5jb2wyLnggKiByQlkpO1xuICAgICAgckJZID0gKHRNYXQuY29sMS55ICogckJYICsgdE1hdC5jb2wyLnkgKiByQlkpO1xuICAgICAgckJYID0gdFg7XG4gICAgICB2YXIgQ2RvdDFYID0gdkIueCAtIHdCICogckJZIC0gdkEueCArIHdBICogckFZO1xuICAgICAgdmFyIENkb3QxWSA9IHZCLnkgKyB3QiAqIHJCWCAtIHZBLnkgLSB3QSAqIHJBWDtcbiAgICAgIHZhciBDZG90MiA9IHdCIC0gd0E7XG4gICAgICB2YXIgaW1wdWxzZSA9IG5ldyBiMlZlYzMoKTtcbiAgICAgIHRoaXMubV9tYXNzLlNvbHZlMzMoaW1wdWxzZSwgKC1DZG90MVgpLCAoLUNkb3QxWSksICgtQ2RvdDIpKTtcbiAgICAgIHRoaXMubV9pbXB1bHNlLkFkZChpbXB1bHNlKTtcbiAgICAgIHZBLnggLT0gbUEgKiBpbXB1bHNlLng7XG4gICAgICB2QS55IC09IG1BICogaW1wdWxzZS55O1xuICAgICAgd0EgLT0gaUEgKiAockFYICogaW1wdWxzZS55IC0gckFZICogaW1wdWxzZS54ICsgaW1wdWxzZS56KTtcbiAgICAgIHZCLnggKz0gbUIgKiBpbXB1bHNlLng7XG4gICAgICB2Qi55ICs9IG1CICogaW1wdWxzZS55O1xuICAgICAgd0IgKz0gaUIgKiAockJYICogaW1wdWxzZS55IC0gckJZICogaW1wdWxzZS54ICsgaW1wdWxzZS56KTtcbiAgICAgIGJBLm1fYW5ndWxhclZlbG9jaXR5ID0gd0E7XG4gICAgICBiQi5tX2FuZ3VsYXJWZWxvY2l0eSA9IHdCO1xuICAgfVxuICAgYjJXZWxkSm9pbnQucHJvdG90eXBlLlNvbHZlUG9zaXRpb25Db25zdHJhaW50cyA9IGZ1bmN0aW9uIChiYXVtZ2FydGUpIHtcbiAgICAgIGlmIChiYXVtZ2FydGUgPT09IHVuZGVmaW5lZCkgYmF1bWdhcnRlID0gMDtcbiAgICAgIHZhciB0TWF0O1xuICAgICAgdmFyIHRYID0gMDtcbiAgICAgIHZhciBiQSA9IHRoaXMubV9ib2R5QTtcbiAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcbiAgICAgIHRNYXQgPSBiQS5tX3hmLlI7XG4gICAgICB2YXIgckFYID0gdGhpcy5tX2xvY2FsQW5jaG9yQS54IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci54O1xuICAgICAgdmFyIHJBWSA9IHRoaXMubV9sb2NhbEFuY2hvckEueSAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcbiAgICAgIHRYID0gKHRNYXQuY29sMS54ICogckFYICsgdE1hdC5jb2wyLnggKiByQVkpO1xuICAgICAgckFZID0gKHRNYXQuY29sMS55ICogckFYICsgdE1hdC5jb2wyLnkgKiByQVkpO1xuICAgICAgckFYID0gdFg7XG4gICAgICB0TWF0ID0gYkIubV94Zi5SO1xuICAgICAgdmFyIHJCWCA9IHRoaXMubV9sb2NhbEFuY2hvckIueCAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcbiAgICAgIHZhciByQlkgPSB0aGlzLm1fbG9jYWxBbmNob3JCLnkgLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XG4gICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHJCWCArIHRNYXQuY29sMi54ICogckJZKTtcbiAgICAgIHJCWSA9ICh0TWF0LmNvbDEueSAqIHJCWCArIHRNYXQuY29sMi55ICogckJZKTtcbiAgICAgIHJCWCA9IHRYO1xuICAgICAgdmFyIG1BID0gYkEubV9pbnZNYXNzO1xuICAgICAgdmFyIG1CID0gYkIubV9pbnZNYXNzO1xuICAgICAgdmFyIGlBID0gYkEubV9pbnZJO1xuICAgICAgdmFyIGlCID0gYkIubV9pbnZJO1xuICAgICAgdmFyIEMxWCA9IGJCLm1fc3dlZXAuYy54ICsgckJYIC0gYkEubV9zd2VlcC5jLnggLSByQVg7XG4gICAgICB2YXIgQzFZID0gYkIubV9zd2VlcC5jLnkgKyByQlkgLSBiQS5tX3N3ZWVwLmMueSAtIHJBWTtcbiAgICAgIHZhciBDMiA9IGJCLm1fc3dlZXAuYSAtIGJBLm1fc3dlZXAuYSAtIHRoaXMubV9yZWZlcmVuY2VBbmdsZTtcbiAgICAgIHZhciBrX2FsbG93ZWRTdHJldGNoID0gMTAuMCAqIGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcDtcbiAgICAgIHZhciBwb3NpdGlvbkVycm9yID0gTWF0aC5zcXJ0KEMxWCAqIEMxWCArIEMxWSAqIEMxWSk7XG4gICAgICB2YXIgYW5ndWxhckVycm9yID0gYjJNYXRoLkFicyhDMik7XG4gICAgICBpZiAocG9zaXRpb25FcnJvciA+IGtfYWxsb3dlZFN0cmV0Y2gpIHtcbiAgICAgICAgIGlBICo9IDEuMDtcbiAgICAgICAgIGlCICo9IDEuMDtcbiAgICAgIH1cbiAgICAgIHRoaXMubV9tYXNzLmNvbDEueCA9IG1BICsgbUIgKyByQVkgKiByQVkgKiBpQSArIHJCWSAqIHJCWSAqIGlCO1xuICAgICAgdGhpcy5tX21hc3MuY29sMi54ID0gKC1yQVkgKiByQVggKiBpQSkgLSByQlkgKiByQlggKiBpQjtcbiAgICAgIHRoaXMubV9tYXNzLmNvbDMueCA9ICgtckFZICogaUEpIC0gckJZICogaUI7XG4gICAgICB0aGlzLm1fbWFzcy5jb2wxLnkgPSB0aGlzLm1fbWFzcy5jb2wyLng7XG4gICAgICB0aGlzLm1fbWFzcy5jb2wyLnkgPSBtQSArIG1CICsgckFYICogckFYICogaUEgKyByQlggKiByQlggKiBpQjtcbiAgICAgIHRoaXMubV9tYXNzLmNvbDMueSA9IHJBWCAqIGlBICsgckJYICogaUI7XG4gICAgICB0aGlzLm1fbWFzcy5jb2wxLnogPSB0aGlzLm1fbWFzcy5jb2wzLng7XG4gICAgICB0aGlzLm1fbWFzcy5jb2wyLnogPSB0aGlzLm1fbWFzcy5jb2wzLnk7XG4gICAgICB0aGlzLm1fbWFzcy5jb2wzLnogPSBpQSArIGlCO1xuICAgICAgdmFyIGltcHVsc2UgPSBuZXcgYjJWZWMzKCk7XG4gICAgICB0aGlzLm1fbWFzcy5Tb2x2ZTMzKGltcHVsc2UsICgtQzFYKSwgKC1DMVkpLCAoLUMyKSk7XG4gICAgICBiQS5tX3N3ZWVwLmMueCAtPSBtQSAqIGltcHVsc2UueDtcbiAgICAgIGJBLm1fc3dlZXAuYy55IC09IG1BICogaW1wdWxzZS55O1xuICAgICAgYkEubV9zd2VlcC5hIC09IGlBICogKHJBWCAqIGltcHVsc2UueSAtIHJBWSAqIGltcHVsc2UueCArIGltcHVsc2Uueik7XG4gICAgICBiQi5tX3N3ZWVwLmMueCArPSBtQiAqIGltcHVsc2UueDtcbiAgICAgIGJCLm1fc3dlZXAuYy55ICs9IG1CICogaW1wdWxzZS55O1xuICAgICAgYkIubV9zd2VlcC5hICs9IGlCICogKHJCWCAqIGltcHVsc2UueSAtIHJCWSAqIGltcHVsc2UueCArIGltcHVsc2Uueik7XG4gICAgICBiQS5TeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xuICAgICAgYkIuU3luY2hyb25pemVUcmFuc2Zvcm0oKTtcbiAgICAgIHJldHVybiBwb3NpdGlvbkVycm9yIDw9IGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCAmJiBhbmd1bGFyRXJyb3IgPD0gYjJTZXR0aW5ncy5iMl9hbmd1bGFyU2xvcDtcbiAgIH1cbiAgIEJveDJELmluaGVyaXQoYjJXZWxkSm9pbnREZWYsIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmKTtcbiAgIGIyV2VsZEpvaW50RGVmLnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnREZWYucHJvdG90eXBlO1xuICAgYjJXZWxkSm9pbnREZWYuYjJXZWxkSm9pbnREZWYgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZi5iMkpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQSA9IG5ldyBiMlZlYzIoKTtcbiAgICAgIHRoaXMubG9jYWxBbmNob3JCID0gbmV3IGIyVmVjMigpO1xuICAgfTtcbiAgIGIyV2VsZEpvaW50RGVmLnByb3RvdHlwZS5iMldlbGRKb2ludERlZiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX19zdXBlci5iMkpvaW50RGVmLmNhbGwodGhpcyk7XG4gICAgICB0aGlzLnR5cGUgPSBiMkpvaW50LmVfd2VsZEpvaW50O1xuICAgICAgdGhpcy5yZWZlcmVuY2VBbmdsZSA9IDAuMDtcbiAgIH1cbiAgIGIyV2VsZEpvaW50RGVmLnByb3RvdHlwZS5Jbml0aWFsaXplID0gZnVuY3Rpb24gKGJBLCBiQiwgYW5jaG9yKSB7XG4gICAgICB0aGlzLmJvZHlBID0gYkE7XG4gICAgICB0aGlzLmJvZHlCID0gYkI7XG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQS5TZXRWKHRoaXMuYm9keUEuR2V0TG9jYWxQb2ludChhbmNob3IpKTtcbiAgICAgIHRoaXMubG9jYWxBbmNob3JCLlNldFYodGhpcy5ib2R5Qi5HZXRMb2NhbFBvaW50KGFuY2hvcikpO1xuICAgICAgdGhpcy5yZWZlcmVuY2VBbmdsZSA9IHRoaXMuYm9keUIuR2V0QW5nbGUoKSAtIHRoaXMuYm9keUEuR2V0QW5nbGUoKTtcbiAgIH1cbn0pKCk7XG4oZnVuY3Rpb24gKCkge1xuICAgdmFyIGIyRGVidWdEcmF3ID0gQm94MkQuRHluYW1pY3MuYjJEZWJ1Z0RyYXc7XG4gICBiMkRlYnVnRHJhdy5iMkRlYnVnRHJhdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMubV9kcmF3U2NhbGUgPSAxLjA7XG4gICAgICB0aGlzLm1fbGluZVRoaWNrbmVzcyA9IDEuMDtcbiAgICAgIHRoaXMubV9hbHBoYSA9IDEuMDtcbiAgICAgIHRoaXMubV9maWxsQWxwaGEgPSAxLjA7XG4gICAgICB0aGlzLm1feGZvcm1TY2FsZSA9IDEuMDtcbiAgICAgIHZhciBfX3RoaXMgPSB0aGlzO1xuICAgICAgLy8jV09SS0FST1VORFxuICAgICAgdGhpcy5tX3Nwcml0ZSA9IHtcbiAgICAgICAgIGdyYXBoaWNzOiB7XG4gICAgICAgICAgICBjbGVhcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgX190aGlzLm1fY3R4LmNsZWFyUmVjdCgwLCAwLCBfX3RoaXMubV9jdHguY2FudmFzLndpZHRoLCBfX3RoaXMubV9jdHguY2FudmFzLmhlaWdodClcbiAgICAgICAgICAgIH1cbiAgICAgICAgIH1cbiAgICAgIH07XG4gICB9O1xuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLl9jb2xvciA9IGZ1bmN0aW9uIChjb2xvciwgYWxwaGEpIHtcbiAgICAgIHJldHVybiBcInJnYmEoXCIgKyAoKGNvbG9yICYgMHhGRjAwMDApID4+IDE2KSArIFwiLFwiICsgKChjb2xvciAmIDB4RkYwMCkgPj4gOCkgKyBcIixcIiArIChjb2xvciAmIDB4RkYpICsgXCIsXCIgKyBhbHBoYSArIFwiKVwiO1xuICAgfTtcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5iMkRlYnVnRHJhdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMubV9kcmF3RmxhZ3MgPSAwO1xuICAgfTtcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5TZXRGbGFncyA9IGZ1bmN0aW9uIChmbGFncykge1xuICAgICAgaWYgKGZsYWdzID09PSB1bmRlZmluZWQpIGZsYWdzID0gMDtcbiAgICAgIHRoaXMubV9kcmF3RmxhZ3MgPSBmbGFncztcbiAgIH07XG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuR2V0RmxhZ3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX2RyYXdGbGFncztcbiAgIH07XG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuQXBwZW5kRmxhZ3MgPSBmdW5jdGlvbiAoZmxhZ3MpIHtcbiAgICAgIGlmIChmbGFncyA9PT0gdW5kZWZpbmVkKSBmbGFncyA9IDA7XG4gICAgICB0aGlzLm1fZHJhd0ZsYWdzIHw9IGZsYWdzO1xuICAgfTtcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5DbGVhckZsYWdzID0gZnVuY3Rpb24gKGZsYWdzKSB7XG4gICAgICBpZiAoZmxhZ3MgPT09IHVuZGVmaW5lZCkgZmxhZ3MgPSAwO1xuICAgICAgdGhpcy5tX2RyYXdGbGFncyAmPSB+ZmxhZ3M7XG4gICB9O1xuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLlNldFNwcml0ZSA9IGZ1bmN0aW9uIChzcHJpdGUpIHtcbiAgICAgIHRoaXMubV9jdHggPSBzcHJpdGU7XG4gICB9O1xuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLkdldFNwcml0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fY3R4O1xuICAgfTtcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5TZXREcmF3U2NhbGUgPSBmdW5jdGlvbiAoZHJhd1NjYWxlKSB7XG4gICAgICBpZiAoZHJhd1NjYWxlID09PSB1bmRlZmluZWQpIGRyYXdTY2FsZSA9IDA7XG4gICAgICB0aGlzLm1fZHJhd1NjYWxlID0gZHJhd1NjYWxlO1xuICAgfTtcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5HZXREcmF3U2NhbGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX2RyYXdTY2FsZTtcbiAgIH07XG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuU2V0TGluZVRoaWNrbmVzcyA9IGZ1bmN0aW9uIChsaW5lVGhpY2tuZXNzKSB7XG4gICAgICBpZiAobGluZVRoaWNrbmVzcyA9PT0gdW5kZWZpbmVkKSBsaW5lVGhpY2tuZXNzID0gMDtcbiAgICAgIHRoaXMubV9saW5lVGhpY2tuZXNzID0gbGluZVRoaWNrbmVzcztcbiAgICAgIHRoaXMubV9jdHguc3Ryb2tlV2lkdGggPSBsaW5lVGhpY2tuZXNzO1xuICAgfTtcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5HZXRMaW5lVGhpY2tuZXNzID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV9saW5lVGhpY2tuZXNzO1xuICAgfTtcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5TZXRBbHBoYSA9IGZ1bmN0aW9uIChhbHBoYSkge1xuICAgICAgaWYgKGFscGhhID09PSB1bmRlZmluZWQpIGFscGhhID0gMDtcbiAgICAgIHRoaXMubV9hbHBoYSA9IGFscGhhO1xuICAgfTtcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5HZXRBbHBoYSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1fYWxwaGE7XG4gICB9O1xuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLlNldEZpbGxBbHBoYSA9IGZ1bmN0aW9uIChhbHBoYSkge1xuICAgICAgaWYgKGFscGhhID09PSB1bmRlZmluZWQpIGFscGhhID0gMDtcbiAgICAgIHRoaXMubV9maWxsQWxwaGEgPSBhbHBoYTtcbiAgIH07XG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuR2V0RmlsbEFscGhhID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubV9maWxsQWxwaGE7XG4gICB9O1xuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLlNldFhGb3JtU2NhbGUgPSBmdW5jdGlvbiAoeGZvcm1TY2FsZSkge1xuICAgICAgaWYgKHhmb3JtU2NhbGUgPT09IHVuZGVmaW5lZCkgeGZvcm1TY2FsZSA9IDA7XG4gICAgICB0aGlzLm1feGZvcm1TY2FsZSA9IHhmb3JtU2NhbGU7XG4gICB9O1xuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLkdldFhGb3JtU2NhbGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tX3hmb3JtU2NhbGU7XG4gICB9O1xuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLkRyYXdQb2x5Z29uID0gZnVuY3Rpb24gKHZlcnRpY2VzLCB2ZXJ0ZXhDb3VudCwgY29sb3IpIHtcbiAgICAgIGlmICghdmVydGV4Q291bnQpIHJldHVybjtcbiAgICAgIHZhciBzID0gdGhpcy5tX2N0eDtcbiAgICAgIHZhciBkcmF3U2NhbGUgPSB0aGlzLm1fZHJhd1NjYWxlO1xuICAgICAgcy5iZWdpblBhdGgoKTtcbiAgICAgIHMuc3Ryb2tlU3R5bGUgPSB0aGlzLl9jb2xvcihjb2xvci5jb2xvciwgdGhpcy5tX2FscGhhKTtcbiAgICAgIHMubW92ZVRvKHZlcnRpY2VzWzBdLnggKiBkcmF3U2NhbGUsIHZlcnRpY2VzWzBdLnkgKiBkcmF3U2NhbGUpO1xuICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCB2ZXJ0ZXhDb3VudDsgaSsrKSB7XG4gICAgICAgICBzLmxpbmVUbyh2ZXJ0aWNlc1tpXS54ICogZHJhd1NjYWxlLCB2ZXJ0aWNlc1tpXS55ICogZHJhd1NjYWxlKTtcbiAgICAgIH1cbiAgICAgIHMubGluZVRvKHZlcnRpY2VzWzBdLnggKiBkcmF3U2NhbGUsIHZlcnRpY2VzWzBdLnkgKiBkcmF3U2NhbGUpO1xuICAgICAgcy5jbG9zZVBhdGgoKTtcbiAgICAgIHMuc3Ryb2tlKCk7XG4gICB9O1xuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLkRyYXdTb2xpZFBvbHlnb24gPSBmdW5jdGlvbiAodmVydGljZXMsIHZlcnRleENvdW50LCBjb2xvcikge1xuICAgICAgaWYgKCF2ZXJ0ZXhDb3VudCkgcmV0dXJuO1xuICAgICAgdmFyIHMgPSB0aGlzLm1fY3R4O1xuICAgICAgdmFyIGRyYXdTY2FsZSA9IHRoaXMubV9kcmF3U2NhbGU7XG4gICAgICBzLmJlZ2luUGF0aCgpO1xuICAgICAgcy5zdHJva2VTdHlsZSA9IHRoaXMuX2NvbG9yKGNvbG9yLmNvbG9yLCB0aGlzLm1fYWxwaGEpO1xuICAgICAgcy5maWxsU3R5bGUgPSB0aGlzLl9jb2xvcihjb2xvci5jb2xvciwgdGhpcy5tX2ZpbGxBbHBoYSk7XG4gICAgICBzLm1vdmVUbyh2ZXJ0aWNlc1swXS54ICogZHJhd1NjYWxlLCB2ZXJ0aWNlc1swXS55ICogZHJhd1NjYWxlKTtcbiAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgdmVydGV4Q291bnQ7IGkrKykge1xuICAgICAgICAgcy5saW5lVG8odmVydGljZXNbaV0ueCAqIGRyYXdTY2FsZSwgdmVydGljZXNbaV0ueSAqIGRyYXdTY2FsZSk7XG4gICAgICB9XG4gICAgICBzLmxpbmVUbyh2ZXJ0aWNlc1swXS54ICogZHJhd1NjYWxlLCB2ZXJ0aWNlc1swXS55ICogZHJhd1NjYWxlKTtcbiAgICAgIHMuY2xvc2VQYXRoKCk7XG4gICAgICBzLmZpbGwoKTtcbiAgICAgIHMuc3Ryb2tlKCk7XG4gICB9O1xuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLkRyYXdDaXJjbGUgPSBmdW5jdGlvbiAoY2VudGVyLCByYWRpdXMsIGNvbG9yKSB7XG4gICAgICBpZiAoIXJhZGl1cykgcmV0dXJuO1xuICAgICAgdmFyIHMgPSB0aGlzLm1fY3R4O1xuICAgICAgdmFyIGRyYXdTY2FsZSA9IHRoaXMubV9kcmF3U2NhbGU7XG4gICAgICBzLmJlZ2luUGF0aCgpO1xuICAgICAgcy5zdHJva2VTdHlsZSA9IHRoaXMuX2NvbG9yKGNvbG9yLmNvbG9yLCB0aGlzLm1fYWxwaGEpO1xuICAgICAgcy5hcmMoY2VudGVyLnggKiBkcmF3U2NhbGUsIGNlbnRlci55ICogZHJhd1NjYWxlLCByYWRpdXMgKiBkcmF3U2NhbGUsIDAsIE1hdGguUEkgKiAyLCB0cnVlKTtcbiAgICAgIHMuY2xvc2VQYXRoKCk7XG4gICAgICBzLnN0cm9rZSgpO1xuICAgfTtcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5EcmF3U29saWRDaXJjbGUgPSBmdW5jdGlvbiAoY2VudGVyLCByYWRpdXMsIGF4aXMsIGNvbG9yKSB7XG4gICAgICBpZiAoIXJhZGl1cykgcmV0dXJuO1xuICAgICAgdmFyIHMgPSB0aGlzLm1fY3R4LFxuICAgICAgICAgZHJhd1NjYWxlID0gdGhpcy5tX2RyYXdTY2FsZSxcbiAgICAgICAgIGN4ID0gY2VudGVyLnggKiBkcmF3U2NhbGUsXG4gICAgICAgICBjeSA9IGNlbnRlci55ICogZHJhd1NjYWxlO1xuICAgICAgcy5tb3ZlVG8oMCwgMCk7XG4gICAgICBzLmJlZ2luUGF0aCgpO1xuICAgICAgcy5zdHJva2VTdHlsZSA9IHRoaXMuX2NvbG9yKGNvbG9yLmNvbG9yLCB0aGlzLm1fYWxwaGEpO1xuICAgICAgcy5maWxsU3R5bGUgPSB0aGlzLl9jb2xvcihjb2xvci5jb2xvciwgdGhpcy5tX2ZpbGxBbHBoYSk7XG4gICAgICBzLmFyYyhjeCwgY3ksIHJhZGl1cyAqIGRyYXdTY2FsZSwgMCwgTWF0aC5QSSAqIDIsIHRydWUpO1xuICAgICAgcy5tb3ZlVG8oY3gsIGN5KTtcbiAgICAgIHMubGluZVRvKChjZW50ZXIueCArIGF4aXMueCAqIHJhZGl1cykgKiBkcmF3U2NhbGUsIChjZW50ZXIueSArIGF4aXMueSAqIHJhZGl1cykgKiBkcmF3U2NhbGUpO1xuICAgICAgcy5jbG9zZVBhdGgoKTtcbiAgICAgIHMuZmlsbCgpO1xuICAgICAgcy5zdHJva2UoKTtcbiAgIH07XG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuRHJhd1NlZ21lbnQgPSBmdW5jdGlvbiAocDEsIHAyLCBjb2xvcikge1xuICAgICAgdmFyIHMgPSB0aGlzLm1fY3R4LFxuICAgICAgICAgZHJhd1NjYWxlID0gdGhpcy5tX2RyYXdTY2FsZTtcbiAgICAgIHMuc3Ryb2tlU3R5bGUgPSB0aGlzLl9jb2xvcihjb2xvci5jb2xvciwgdGhpcy5tX2FscGhhKTtcbiAgICAgIHMuYmVnaW5QYXRoKCk7XG4gICAgICBzLm1vdmVUbyhwMS54ICogZHJhd1NjYWxlLCBwMS55ICogZHJhd1NjYWxlKTtcbiAgICAgIHMubGluZVRvKHAyLnggKiBkcmF3U2NhbGUsIHAyLnkgKiBkcmF3U2NhbGUpO1xuICAgICAgcy5jbG9zZVBhdGgoKTtcbiAgICAgIHMuc3Ryb2tlKCk7XG4gICB9O1xuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLkRyYXdUcmFuc2Zvcm0gPSBmdW5jdGlvbiAoeGYpIHtcbiAgICAgIHZhciBzID0gdGhpcy5tX2N0eCxcbiAgICAgICAgIGRyYXdTY2FsZSA9IHRoaXMubV9kcmF3U2NhbGU7XG4gICAgICBzLmJlZ2luUGF0aCgpO1xuICAgICAgcy5zdHJva2VTdHlsZSA9IHRoaXMuX2NvbG9yKDB4ZmYwMDAwLCB0aGlzLm1fYWxwaGEpO1xuICAgICAgcy5tb3ZlVG8oeGYucG9zaXRpb24ueCAqIGRyYXdTY2FsZSwgeGYucG9zaXRpb24ueSAqIGRyYXdTY2FsZSk7XG4gICAgICBzLmxpbmVUbygoeGYucG9zaXRpb24ueCArIHRoaXMubV94Zm9ybVNjYWxlICogeGYuUi5jb2wxLngpICogZHJhd1NjYWxlLCAoeGYucG9zaXRpb24ueSArIHRoaXMubV94Zm9ybVNjYWxlICogeGYuUi5jb2wxLnkpICogZHJhd1NjYWxlKTtcblxuICAgICAgcy5zdHJva2VTdHlsZSA9IHRoaXMuX2NvbG9yKDB4ZmYwMCwgdGhpcy5tX2FscGhhKTtcbiAgICAgIHMubW92ZVRvKHhmLnBvc2l0aW9uLnggKiBkcmF3U2NhbGUsIHhmLnBvc2l0aW9uLnkgKiBkcmF3U2NhbGUpO1xuICAgICAgcy5saW5lVG8oKHhmLnBvc2l0aW9uLnggKyB0aGlzLm1feGZvcm1TY2FsZSAqIHhmLlIuY29sMi54KSAqIGRyYXdTY2FsZSwgKHhmLnBvc2l0aW9uLnkgKyB0aGlzLm1feGZvcm1TY2FsZSAqIHhmLlIuY29sMi55KSAqIGRyYXdTY2FsZSk7XG4gICAgICBzLmNsb3NlUGF0aCgpO1xuICAgICAgcy5zdHJva2UoKTtcbiAgIH07XG59KSgpO1xudmFyIGk7XG5mb3IgKGkgPSAwOyBpIDwgQm94MkQucG9zdERlZnMubGVuZ3RoOyArK2kpIEJveDJELnBvc3REZWZzW2ldKCk7XG5cbm1vZHVsZS5leHBvcnRzID0gQm94MkQiXX0=
